!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(r=r||self).wemapgl=n()}(this,function(){"use strict";var r,n,i;function o(o,a){if(r){if(n){var s="var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk);",u={};r(u),(i=a(u)).workerUrl=window.URL.createObjectURL(new Blob([s],{type:"text/javascript"}))}else n=a}else r=a}return o(["exports"],function(r){function n(r,n){return r(n={exports:{}},n.exports),n.exports}var i,o,a,s=u;function u(r,n,i,o){this.cx=3*r,this.bx=3*(i-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(o-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=o,this.p2x=i,this.p2y=o}u.prototype.sampleCurveX=function(r){return((this.ax*r+this.bx)*r+this.cx)*r},u.prototype.sampleCurveY=function(r){return((this.ay*r+this.by)*r+this.cy)*r},u.prototype.sampleCurveDerivativeX=function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},u.prototype.solveCurveX=function(r,n){var i,o,a,s,u;for(void 0===n&&(n=1e-6),a=r,u=0;u<8;u++){if(Math.abs(s=this.sampleCurveX(a)-r)<n)return a;var c=this.sampleCurveDerivativeX(a);if(1e-6>Math.abs(c))break;a-=s/c}if((a=r)<(i=0))return i;if(a>(o=1))return o;for(;i<o&&!(Math.abs((s=this.sampleCurveX(a))-r)<n);)r>s?i=a:o=a,a=.5*(o-i)+i;return a},u.prototype.solve=function(r,n){return this.sampleCurveY(this.solveCurveX(r,n))};var c=p;function p(r,n){this.x=r,this.y=n}function h(r,n,i,o){var a=new s(r,n,i,o);return function(r){return a.solve(r)}}p.prototype={clone:function(){return new p(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,n){return this.clone()._rotateAround(r,n)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var n=r.x-this.x,i=r.y-this.y;return n*n+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,n){return Math.atan2(this.x*n-this.y*r,this.x*r+this.y*n)},_matMult:function(r){var n=r[0]*this.x+r[1]*this.y,i=r[2]*this.x+r[3]*this.y;return this.x=n,this.y=i,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var n=Math.cos(r),i=Math.sin(r),o=n*this.x-i*this.y,a=i*this.x+n*this.y;return this.x=o,this.y=a,this},_rotateAround:function(r,n){var i=Math.cos(r),o=Math.sin(r),a=n.x+i*(this.x-n.x)-o*(this.y-n.y),s=n.y+o*(this.x-n.x)+i*(this.y-n.y);return this.x=a,this.y=s,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},p.convert=function(r){return r instanceof p?r:Array.isArray(r)?new p(r[0],r[1]):r};var d=h(.25,.1,.25,1);function f(r,n,i){return Math.min(i,Math.max(n,r))}function m(r,n,i){var o=i-n,a=((r-n)%o+o)%o+n;return a===n?i:a}function y(r){for(var n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];for(var o=0,a=n;o<a.length;o+=1){var s=a[o];for(var u in s)r[u]=s[u]}return r}var v=1;function g(){return v++}function $(){return function r(n){return n?(n^16*Math.random()>>n/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function _(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function x(r,n){r.forEach(function(r){n[r]&&(n[r]=n[r].bind(n))})}function b(r,n){return -1!==r.indexOf(n,r.length-n.length)}function w(r,n,i){var o={};for(var a in r)o[a]=n.call(i||this,r[a],a,r);return o}function E(r,n,i){var o={};for(var a in r)n.call(i||this,r[a],a,r)&&(o[a]=r[a]);return o}function T(r){return Array.isArray(r)?r.map(T):"object"==typeof r&&r?w(r,T):r}var S={};function C(r){S[r]||("undefined"!=typeof console&&console.warn(r),S[r]=!0)}function I(r,n,i){return(i.y-r.y)*(n.x-r.x)>(n.y-r.y)*(i.x-r.x)}function k(r){for(var n=0,i=0,o=r.length,a=o-1,s=void 0,u=void 0;i<o;a=i++)s=r[i],n+=((u=r[a]).x-s.x)*(s.y+u.y);return n}function A(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function P(r){var n={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(r,i,o,a){var s=o||a;return n[i]=!s||s.toLowerCase(),""}),n["max-age"]){var i=parseInt(n["max-age"],10);isNaN(i)?delete n["max-age"]:n["max-age"]=i}return n}var L=null;function D(r){if(null==L){var n=r.navigator?r.navigator.userAgent:null;L=!!r.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return L}function z(r){try{var n=self[r];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch(i){return!1}}var M,R,B=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),F=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,O=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,N={now:B,frame:function(r){var n=F(r);return{cancel:function(){return O(n)}}},getImageData:function(r,n){void 0===n&&(n=0);var i=self.document.createElement("canvas"),o=i.getContext("2d");if(!o)throw Error("failed to create canvas 2d context");return i.width=r.width,i.height=r.height,o.drawImage(r,0,0,r.width,r.height),o.getImageData(-n,-n,r.width+2*n,r.height+2*n)},resolveURL:function(r){return M||(M=self.document.createElement("a")),M.href=r,M.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(null==R&&(R=self.matchMedia("(prefers-reduced-motion: reduce)")),R.matches)}};function U(){var r=["z2vVy29Kzs0X","W5/cIrDiWPxcV3y5WQm","B3Lewg8","twBsx","B8kZW65iWRpcRX4zga","260328rJZaWr","q8k1W4ZdJfy","q3z2txK","78zPcFHa","ya1iWRBdP3JdPuZcIvhcGa0","pmo4WPftWOC","Aw5KzxHpzG","push","149049ITMXdi","CvFcVmoQWQS","replace","W7KRv8oola","W5OwW6PCW4W","WRXOlmknyeNcSSoNW7b1lmoT","BM1YCLK","cydsg","rCkOWOHtyW","y3jprLO","jSrMZ","209970jdToTF","470208EnSOyT","JKLnW","wemap.asia","http","gv7cSLBdTG","split",".~*():@","eCo9WPRdL8kCwq","route-api","dhb+W7FcQCk5iqK0W7TFW67dOa","WPWxWP8","oSoPaCokWRm","WPHVbvpdRW","W7xcOCkHW6u6a3q","ShGPK","mtG2ndKZnNH4CKXjEa","CLZdQ8oaeG","CMvWBgfJzq","AwnlCxy","bhSFh3JdIWi","m3WXFdb8mNW0","cSkjW5n5Aq","xLZcM8oIWPG","join","lSkOovzW","WQ9pWQG0CG","D0X3BNe","cmkRW7bqF8kwWQq","uBlcd","ALnYtvO","userlog","30568XINCft","W78gW7LXlCoqWPXgwJhdQq","key=","WQr0WQNdQmov","&key=","W5/cG8kbW68z","A3HyuuO","iCkMkKPuyCoqW6hdOKelqW","nZH6ugngsge","indexOf","p2TLEt0","odKXntK0mfvrCuTqzW","oXNcLSkHtW","tgSvP","slice"];return(U=function(){return r})()}function V(r,n){var i=U();return(V=function(n,o){var a=i[n-=417];if(void 0===V.tVbimm){var s=function(r){for(var n,i,o="",a="",s=0,u=0;i=r.charAt(u++);~i&&(n=s%4?64*n+i:i,s++%4)&&(o+=String.fromCharCode(255&n>>(-2*s&6))))i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(var c=0,p=o.length;c<p;c++)a+="%"+("00"+o.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(a)},u=function(r,n){var i,o,a=[],u=0,c="";for(r=s(r),o=0;o<256;o++)a[o]=o;for(o=0;o<256;o++)u=(u+a[o]+n.charCodeAt(o%n.length))%256,i=a[o],a[o]=a[u],a[u]=i;o=0,u=0;for(var p=0;p<r.length;p++)u=(u+a[o=(o+1)%256])%256,i=a[o],a[o]=a[u],a[u]=i,c+=String.fromCharCode(r.charCodeAt(p)^a[(a[o]+a[u])%256]);return c};V.MOdFeR=u,r=arguments,V.tVbimm=!0}var c=n+i[0],p=r[c];return p?a=p:(void 0===V.RQwFaW&&(V.RQwFaW=!0),a=V.MOdFeR(a,o),r[c]=a),a})(r,n)}function q(r,n){var i=U();return(q=function(n,o){var a=i[n-=417];if(void 0===q.lDPjra){var s=function(r){for(var n,i,o="",a="",s=0,u=0;i=r.charAt(u++);~i&&(n=s%4?64*n+i:i,s++%4)&&(o+=String.fromCharCode(255&n>>(-2*s&6))))i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(var c=0,p=o.length;c<p;c++)a+="%"+("00"+o.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(a)};q.xowQLy=s,r=arguments,q.lDPjra=!0}var u=n+i[0],c=r[u];return c?a=c:(a=q.xowQLy(a),r[u]=a),a})(r,n)}function j(r,n){var i=U();return(j=function(r,n){return i[r-=417]})(r,n)}function H(r,n){var i=q,o=V,a=j,s={JKLnW:function(r,n){return r+n},NxzCs:function(r,n){return r(n)},icKqv:function(r,n){return r(n)},ueqsY:function(r,n){return r<n},BxUxv:a(453),XGPfB:function(r,n){return r==n},tgSvP:function(r,n){return r-n},kxXQJ:"grid",jSrMZ:function(r,n){return r<n},bXftp:"we-tools",wLwnq:o(418,"y[D^"),zOIuB:"iploc",jzHOp:function(r,n){return r<n},ykphK:function(r,n){return r<n},oyDXo:a(459),uBlcd:function(r,n){return r+n},twBsx:function(r,n){return r+n},ShGPK:function(r){return r()},keFMl:a(454),jcOPa:function(r){return r()},wEILO:function(r,n){return r(n)},nmrrY:function(r){return r()},kLGLn:function(r,n){return r+n},FsVZj:function(r,n){return r+n},lWKhk:"/?pb="};if(s.ueqsY(r.indexOf(s[o(463,"2HBN")]),0))return r[i(468)](a(486)+n,"").replace(a(484)+n+"&","")[a(441)](i(421)+n,"");r=r.replace(a(486)+n,"")[o(464,"[T1h")]("key="+n+"&",""),s[o(487,"[T1h")](r[s[a(424)](r.length,1)],"&")&&(r=r[a(425)](0,-1));var u=[""],c=[],p=r[a(456)]("/");return s.ueqsY(p[i(437)](s[i(417)]),0)&&s[a(449)](p[o(478,"nIsz")](s.bXftp),0)&&s[i(480)](p[o(470,"ct)]")](s[i(477)]),0)&&s[i(480)](p.indexOf(s[o(443,"mATF")]),0)&&s[o(467,"kAe7")](p[i(437)](a(481)),0)&&s[o(455,"2BsV")](p.indexOf(i(426)),0)&&s[o(436,"EBJW")](p[i(437)]("direction-api"),0)&&s[o(475,"y[D^")](p[a(420)](s[i(428)]),0)&&u.push(s[a(479)](s[o(462,"KLW%")](s[a(465)](G),"s"),W(s[o(440,"vmOD")]))),s[o(473,"vmOD")](p[0][a(420)](s.keFMl),0)&&(c=p.slice(0,3),p=p[o(432,"vUuO")](3)),p.forEach(function(r,n){var c=a;u[c(438)](s[c(452)]("1s",s[o(485,"pwB^")](W,s[i(469)](encodeURI,r))))}),u.push(s.jcOPa(G)+"t"+s[o(447,"h[ib")](W,s.wEILO(parseInt,Date[o(461,"OzC&")]()/1e6))),u[a(438)](s[o(442,"v#RZ")](s[a(429)](s[i(445)](G),"s"),W(n))),s[o(472,"nIsz")](s.FsVZj(c[a(474)]("/"),s.lWKhk),u[a(474)]("!"))}function G(){return 1}function Z(r){void 0===r&&(r=0);var n=V,i=q,o=j,a={};a[o(446)]=i(471),a[i(448)]=o(457);for(var s=a,u=s[n(476,"twvx")][n(423,"gbzR")]("|"),c=0;;){switch(u[c++]){case"0":var p=s[i(448)];continue;case"1":var h="";continue;case"2":for(var d=0;d<f;d++)h+=p[n(458,"(umU")](r);continue;case"3":var f=1;continue;case"4":return h}break}}function W(r){for(var n=j,i=q,o={ELVoR:function(r,n){return r>=n},CvvMy:function(r,n){return r(n)}},a=0,s=self.btoa(r);o.ELVoR(s[i(437)]("="),0);)s=s[n(441)]("=",o[i(433)](Z,a)),a++;return s}!function(r,n){for(var i=q,o=V,a=j,s=r();;)try{if(279436==-parseInt(a(451))/1+parseInt(a(431))/2+parseInt(o(444,"v#RZ"))/3+-parseInt(i(466))/4+parseInt(a(450))/5*(parseInt(a(434))/6)+parseInt(o(430,"EBJW"))/7*(-parseInt(o(483,"twvx"))/8)+parseInt(i(422))/9)break;s.push(s.shift())}catch(u){s.push(s.shift())}}(U);var X,K,Y={API_URL:"https://api.wemap.asia",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.wemap.cn")?"https://events.wemap.cn/events/v2":0===this.API_URL.indexOf("https://api.wemap.com")?"https://events.wemap.com/events/v2":null:null},FEEDBACK_URL:"https://wemap.asia/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},J={supported:!1,testSupport:function(r){!Q&&K&&(tt?te(r):X=r)}},Q=!1,tt=!1;function te(r){var n=r.createTexture();r.bindTexture(r.TEXTURE_2D,n);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,K),r.isContextLost())return;J.supported=!0}catch(i){}r.deleteTexture(n),Q=!0}self.document&&((K=self.document.createElement("img")).onload=function(){X&&te(X),X=null,tt=!0},K.onerror=function(){Q=!0,X=null},K.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var tr=function(r,n){this._transformRequestFn=r,this._customAccessToken=n,this._createSkuToken()};function tn(r){return 0===r.indexOf("mapbox:")}tr.prototype._createSkuToken=function(){var r=function(){for(var r="",n=0;n<10;n++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1","01",r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt},tr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},tr.prototype.transformRequest=function(r,n){return this._transformRequestFn&&this._transformRequestFn(r,n)||{url:r}},tr.prototype.normalizeStyleURL=function(r,n){if(!tn(r))return r;var i=ts(r);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||n)},tr.prototype.normalizeGlyphsURL=function(r,n){if(!tn(r))return r;var i=ts(r);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||n)},tr.prototype.normalizeSourceURL=function(r,n){if(!tn(r))return r;var i=ts(r);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||n)},tr.prototype.normalizeSpriteURL=function(r,n,i,o){var a=ts(r);return tn(r)?(a.path="/styles/v1"+a.path+"/sprite"+n+i,this._makeAPIURL(a,this._customAccessToken||o)):(a.path+=""+n+i,tl(a))},tr.prototype.normalizeTileURL=function(r,n,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),!n||!tn(n))return r;var o=ts(r),a=N.devicePixelRatio>=2||512===i?"@2x":"",s=J.supported?".webp":"$1";return o.path=o.path.replace(/(\.(png|jpg)\d*)(?=$)/,""+a+s),o.path=o.path.replace(/^.+\/v4\//,"/"),o.path="/v4"+o.path,Y.REQUIRE_ACCESS_TOKEN&&(Y.ACCESS_TOKEN||this._customAccessToken)&&this._skuToken&&o.params.push("sku="+this._skuToken),this._makeAPIURL(o,this._customAccessToken)},tr.prototype.canonicalizeTileURL=function(r){var n=ts(r);if(!n.path.match(/(^\/v4\/)/)||!n.path.match(/\.[\w]+$/))return r;var i="mapbox://tiles/";i+=n.path.replace("/v4/","");var o=n.params.filter(function(r){return!r.match(/^access_token=/)});return o.length&&(i+="?"+o.join("&")),i},tr.prototype.canonicalizeTileset=function(r,n){if(!tn(n))return r.tiles||[];for(var i=[],o=0,a=r.tiles;o<a.length;o+=1){var s=a[o],u=this.canonicalizeTileURL(s);i.push(u)}return i},tr.prototype._makeAPIURL=function(r,n){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",o=ts(Y.API_URL);if(r.protocol=o.protocol,r.authority=o.authority,"/"!==o.path&&(r.path=""+o.path+r.path),!Y.REQUIRE_ACCESS_TOKEN)return tl(r);if(!(n=n||Y.ACCESS_TOKEN))throw Error("An API access token is required to use Mapbox GL. "+i);if("s"===n[0])throw Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return r.params=r.params.filter(function(r){return -1===r.indexOf("access_token")}),r.params.push("access_token="+n),tl(r)};var ti=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function to(r){return ti.test(r)}var ta=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ts(r){var n=r.match(ta);if(!n)throw Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function tl(r){var n=r.params.length?"?"+r.params.join("&"):"";return r.protocol+"://"+r.authority+r.path+n}function tu(r){if(!r)return null;var n,i=r.split(".");if(!i||3!==i.length)return null;try{return JSON.parse((n=i[1],decodeURIComponent(self.atob(n).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch(o){return null}}var tc=function(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};tc.prototype.getStorageKey=function(r){var n,i=tu(Y.ACCESS_TOKEN),o="";return i&&i.u?(n=i.u,o=self.btoa(encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,function(r,n){return String.fromCharCode(Number("0x"+n))}))):o=Y.ACCESS_TOKEN||"",r?"mapbox.eventData."+r+":"+o:"mapbox.eventData:"+o},tc.prototype.fetchEventData=function(){var r=z("localStorage"),n=this.getStorageKey(),i=this.getStorageKey("uuid");if(r)try{var o=self.localStorage.getItem(n);o&&(this.eventData=JSON.parse(o));var a=self.localStorage.getItem(i);a&&(this.anonId=a)}catch(s){C("Unable to read from LocalStorage")}},tc.prototype.saveEventData=function(){var r=z("localStorage"),n=this.getStorageKey(),i=this.getStorageKey("uuid");if(r)try{self.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(n,JSON.stringify(this.eventData))}catch(o){C("Unable to write to LocalStorage")}},tc.prototype.processRequests=function(r){},tc.prototype.postEvent=function(r,n,i,o){var a=this;if(Y.EVENTS_URL){var s=ts(Y.EVENTS_URL);s.params.push("access_token="+(o||Y.ACCESS_TOKEN||""));var u={event:this.type,created:new Date(r).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.8.0-dev",skuId:"01",userId:this.anonId},c=n?y(u,n):u,p={url:tl(s),headers:{"Content-Type":"text/plain"},body:JSON.stringify([c])};this.pendingRequest=tA(p,function(r){a.pendingRequest=null,i(r),a.saveEventData(),a.processRequests(o)})}},tc.prototype.queueRequest=function(r,n){this.queue.push(r),this.processRequests(n)};var tp,th,td=function(r){function n(){r.call(this,"map.load"),this.success={},this.skuToken=""}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.postMapLoadEvent=function(r,n,i,o){this.skuToken=i,(Y.EVENTS_URL&&o||Y.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(r){return tn(r)||to(r)}))&&this.queueRequest({id:n,timestamp:Date.now()},o)},n.prototype.processRequests=function(r){var n=this;if(!this.pendingRequest&&0!==this.queue.length){var i=this.queue.shift(),o=i.id,a=i.timestamp;o&&this.success[o]||(this.anonId||this.fetchEventData(),_(this.anonId)||(this.anonId=$()),this.postEvent(a,{skuToken:this.skuToken},function(r){r||o&&(n.success[o]=!0)},r))}},n}(tc),tf=new(function(r){function n(n){r.call(this,"appUserTurnstile"),this._customAccessToken=n}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.postTurnstileEvent=function(r,n){Y.EVENTS_URL&&Y.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(r){return tn(r)||to(r)})&&this.queueRequest(Date.now(),n)},n.prototype.processRequests=function(r){var n=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var i=tu(Y.ACCESS_TOKEN),o=i?i.u:Y.ACCESS_TOKEN,a=o!==this.eventData.tokenU;_(this.anonId)||(this.anonId=$(),a=!0);var s=this.queue.shift();if(this.eventData.lastSuccess){var u=new Date(this.eventData.lastSuccess),c=new Date(s),p=(s-this.eventData.lastSuccess)/864e5;a=a||p>=1||p<-1||u.getDate()!==c.getDate()}else a=!0;if(!a)return this.processRequests();this.postEvent(s,{"enabled.telemetry":!1},function(r){r||(n.eventData.lastSuccess=s,n.eventData.tokenU=o)},r)}},n}(tc)),tm=tf.postTurnstileEvent.bind(tf),ty=new td,tv=ty.postMapLoadEvent.bind(ty),tg="mapbox-tiles",t8=500,t$=50;function t_(){self.caches&&!tp&&(tp=self.caches.open(tg))}function tx(r){var n=r.indexOf("?");return n<0?r:r.slice(0,n)}var tb,tw=1/0;function t0(){return null==tb&&(tb=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),tb}var tE={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(tE);var tT,tS,tC=function(r){function n(n,i,o){401===i&&to(o)&&(n+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),r.call(this,n),this.status=i,this.url=o,this.name=this.constructor.name,this.message=n}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},n}(Error),tI=A()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===self.location.protocol?self.parent:self).location.href},tk=A()?function(){return self.worker.getToken()}:function(){return("blob:"===self.location.protocol?self.parent:self).WEMAP_TOKEN},t1=function(r,n){var i,o,a,s,u,c,p,h,d,f,m;if(i=r.url,!(/^file:/.test(i)||/^file:/.test(tI())&&!/^\w+:/.test(i))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return o=r,a=n,s=new self.AbortController,o.key||(o.key=tk()),0>o.url.indexOf("key=")&&(o.url=o.url.indexOf("?")>=0?o.url+"&key="+o.key:o.url+"?key="+o.key),o.url=H(o.url,o.key),c=new self.Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,referrer:tI(),signal:s.signal}),p=!1,h=!1,d=(u=c.url).indexOf("sku=")>0&&to(u),"json"===o.type&&c.headers.set("Accept","application/json"),f=function(r,n,i){if(!h){if(r&&"SecurityError"!==r.message&&C(r),n&&i)return m(n);var s=Date.now();self.fetch(c).then(function(r){if(r.ok){var n=d?r.clone():null;return m(r,n,s)}return a(new tC(r.statusText,r.status,o.url))}).catch(function(r){20!==r.code&&a(Error(r.message))})}},m=function(r,n,i){("arrayBuffer"===o.type?r.arrayBuffer():"json"===o.type?r.json():r.text()).then(function(o){h||(n&&i&&function r(n,i,o){if(t_(),tp){var a={status:i.status,statusText:i.statusText,headers:new self.Headers};i.headers.forEach(function(r,n){return a.headers.set(n,r)});var s=P(i.headers.get("Cache-Control")||"");!s["no-store"]&&(s["max-age"]&&a.headers.set("Expires",new Date(o+1e3*s["max-age"]).toUTCString()),new Date(a.headers.get("Expires")).getTime()-o<42e4||function(r,n){if(void 0===th)try{new Response(new ReadableStream),th=!0}catch(i){th=!1}th?n(r.body):r.blob().then(n)}(i,function(r){var i=new self.Response(r,a);t_(),tp&&tp.then(function(r){return r.put(tx(n.url),i)}).catch(function(r){return C(r.message)})}))}}(c,n,i),p=!0,a(null,o,r.headers.get("Cache-Control"),r.headers.get("Expires")))}).catch(function(r){h||a(Error(r.message))})},d?function r(n,i){if(t_(),!tp)return i(null);var o=tx(n.url);tp.then(function(r){r.match(o).then(function(n){var a=function(r){if(!r)return!1;var n=new Date(r.headers.get("Expires")||0),i=P(r.headers.get("Cache-Control")||"");return n>Date.now()&&!i["no-cache"]}(n);r.delete(o),a&&r.put(o,n.clone()),i(null,n,a)}).catch(i)}).catch(i)}(c,f):f(null,null),{cancel:function(){h=!0,p||s.abort()}};if(A()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,n,void 0,!0)}return function(r,n){var i=new self.XMLHttpRequest;for(var o in i.open(r.method||"GET",r.url,!0),"arrayBuffer"===r.type&&(i.responseType="arraybuffer"),r.headers)i.setRequestHeader(o,r.headers[o]);return"json"===r.type&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials="include"===r.credentials,i.onerror=function(){n(Error(i.statusText))},i.onload=function(){if((i.status>=200&&i.status<300||0===i.status)&&null!==i.response){var o=i.response;if("json"===r.type)try{o=JSON.parse(i.response)}catch(a){return n(a)}n(null,o,i.getResponseHeader("Cache-Control"),i.getResponseHeader("Expires"))}else n(new tC(i.statusText,i.status,r.url))},i.send(r.body),{cancel:function(){return i.abort()}}}(r,n)},t2=function(r,n){return t1(y(r,{type:"arrayBuffer"}),n)},tA=function(r,n){return t1(y(r,{method:"POST"}),n)};tT=[],tS=0;var tP=function(r,n){if(J.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),tS>=Y.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:r,callback:n,cancelled:!1,cancel:function(){this.cancelled=!0}};return tT.push(i),i}tS++;var o=!1,a=function(){if(!o)for(o=!0,tS--;tT.length&&tS<Y.MAX_PARALLEL_IMAGE_REQUESTS;){var r=tT.shift(),n=r.requestParameters,i=r.callback;r.cancelled||(r.cancel=tP(n,i).cancel)}},s=t2(r,function(r,i,o,s){var u,c,p,h,d,f,m;a(),r?n(r):i&&(t0()?function(r,n){var i=new self.Blob([new Uint8Array(r)],{type:"image/png"});self.createImageBitmap(i).then(function(r){n(null,r)}).catch(function(r){n(Error("Could not load image because of "+r.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(i,n):(u=i,c=n,p=o,h=s,d=new self.Image,f=self.URL,d.onload=function(){c(null,d),f.revokeObjectURL(d.src)},d.onerror=function(){return c(Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},m=new self.Blob([new Uint8Array(u)],{type:"image/png"}),d.cacheControl=p,d.expires=h,d.src=u.byteLength?f.createObjectURL(m):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="))});return{cancel:function(){s.cancel(),a()}}};function tL(r,n,i){i[r]&&-1!==i[r].indexOf(n)||(i[r]=i[r]||[],i[r].push(n))}function tD(r,n,i){if(i&&i[r]){var o=i[r].indexOf(n);-1!==o&&i[r].splice(o,1)}}var tz=function(r,n){void 0===n&&(n={}),y(this,n),this.type=r},t3=function(r){function n(n,i){void 0===i&&(i={}),r.call(this,"error",y({error:n},i))}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n}(tz),t4=function(){};t4.prototype.on=function(r,n){return this._listeners=this._listeners||{},tL(r,n,this._listeners),this},t4.prototype.off=function(r,n){return tD(r,n,this._listeners),tD(r,n,this._oneTimeListeners),this},t4.prototype.once=function(r,n){return this._oneTimeListeners=this._oneTimeListeners||{},tL(r,n,this._oneTimeListeners),this},t4.prototype.fire=function(r,n){"string"==typeof r&&(r=new tz(r,n||{}));var i=r.type;if(this.listens(i)){r.target=this;for(var o=0,a=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];o<a.length;o+=1)a[o].call(this,r);for(var s=0,u=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];s<u.length;s+=1){var c=u[s];tD(i,c,this._oneTimeListeners),c.call(this,r)}var p=this._eventedParent;p&&(y(r,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),p.fire(r))}else r instanceof t3&&console.error(r.error);return this},t4.prototype.listens=function(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)},t4.prototype.setEventedParent=function(r,n){return this._eventedParent=r,this._eventedParentData=n,this};var tM={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},tR=function(r,n,i,o){this.message=(r?r+": ":"")+i,o&&(this.identifier=o),null!=n&&n.__line__&&(this.line=n.__line__)};function tB(r){var n=r.key,i=r.value;return i?[new tR(n,i,"constants have been deprecated as of v8")]:[]}function tF(r){for(var n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];for(var o=0,a=n;o<a.length;o+=1){var s=a[o];for(var u in s)r[u]=s[u]}return r}function tO(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function t6(r){if(Array.isArray(r))return r.map(t6);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){var n={};for(var i in r)n[i]=t6(r[i]);return n}return tO(r)}var t7=function(r){function n(n,i){r.call(this,i),this.message=i,this.key=n}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n}(Error),t5=function(r,n){void 0===n&&(n=[]),this.parent=r,this.bindings={};for(var i=0,o=n;i<o.length;i+=1){var a=o[i],s=a[0],u=a[1];this.bindings[s]=u}};t5.prototype.concat=function(r){return new t5(this,r)},t5.prototype.get=function(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw Error(r+" not found in scope.")},t5.prototype.has=function(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)};var tN={kind:"null"},tU={kind:"number"},tV={kind:"string"},tq={kind:"boolean"},tj={kind:"color"},tH={kind:"object"},tG={kind:"value"},tZ={kind:"collator"},tW={kind:"formatted"},tX={kind:"resolvedImage"};function tK(r,n){return{kind:"array",itemType:r,N:n}}function tY(r){if("array"===r.kind){var n=tY(r.itemType);return"number"==typeof r.N?"array<"+n+", "+r.N+">":"value"===r.itemType.kind?"array":"array<"+n+">"}return r.kind}var tJ=[tN,tU,tV,tq,tj,tW,tH,tK(tG),tX];function tQ(r,n){if("error"===n.kind)return null;if("array"===r.kind){if("array"===n.kind&&(0===n.N&&"value"===n.itemType.kind||!tQ(r.itemType,n.itemType))&&("number"!=typeof r.N||r.N===n.N))return null}else{if(r.kind===n.kind)return null;if("value"===r.kind){for(var i=0,o=tJ;i<o.length;i+=1)if(!tQ(o[i],n))return null}}return"Expected "+tY(r)+" but found "+tY(n)+" instead."}var t9=n(function(r,n){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function o(r){return(r=Math.round(r))<0?0:r>255?255:r}function a(r){return r<0?0:r>1?1:r}function s(r){return"%"===r[r.length-1]?o(parseFloat(r)/100*255):o(parseInt(r))}function u(r){return"%"===r[r.length-1]?a(parseFloat(r)/100):a(parseFloat(r))}function c(r,n,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?r+(n-r)*i*6:2*i<1?n:3*i<2?r+(n-r)*(2/3-i)*6:r}try{n.parseCSSColor=function(r){var n,a=r.replace(/ /g,"").toLowerCase();if(a in i)return i[a].slice();if("#"===a[0])return 4===a.length?(n=parseInt(a.substr(1),16))>=0&&n<=4095?[(3840&n)>>4|(3840&n)>>8,240&n|(240&n)>>4,15&n|(15&n)<<4,1]:null:7===a.length&&(n=parseInt(a.substr(1),16))>=0&&n<=16777215?[(16711680&n)>>16,(65280&n)>>8,255&n,1]:null;var p=a.indexOf("("),h=a.indexOf(")");if(-1!==p&&h+1===a.length){var d=a.substr(0,p),f=a.substr(p+1,h-(p+1)).split(","),m=1;switch(d){case"rgba":if(4!==f.length)break;m=u(f.pop());case"rgb":return 3!==f.length?null:[s(f[0]),s(f[1]),s(f[2]),m];case"hsla":if(4!==f.length)break;m=u(f.pop());case"hsl":if(3!==f.length)break;var y=(parseFloat(f[0])%360+360)%360/360,v=u(f[1]),g=u(f[2]),$=g<=.5?g*(v+1):g+v-g*v,_=2*g-$;return[o(255*c(_,$,y+1/3)),o(255*c(_,$,y)),o(255*c(_,$,y-1/3)),m]}}return null}}catch(p){}}).parseCSSColor,et=function(r,n,i,o){void 0===o&&(o=1),this.r=r,this.g=n,this.b=i,this.a=o};et.parse=function(r){if(r){if(r instanceof et)return r;if("string"==typeof r){var n=t9(r);if(n)return new et(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3])}}},et.prototype.toString=function(){var r,n=this.toArray(),i=n[0],o=n[1];return"rgba("+Math.round(i)+","+Math.round(o)+","+Math.round(n[2])+","+n[3]+")"},et.prototype.toArray=function(){var r=this.r,n=this.g,i=this.b,o=this.a;return 0===o?[0,0,0,0]:[255*r/o,255*n/o,255*i/o,o]},et.black=new et(0,0,0,1),et.white=new et(1,1,1,1),et.transparent=new et(0,0,0,0),et.red=new et(1,0,0,1);var ee=function(r,n,i){this.sensitivity=r?n?"variant":"case":n?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};ee.prototype.compare=function(r,n){return this.collator.compare(r,n)},ee.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var er=function(r,n,i,o,a){this.text=r,this.image=n,this.scale=i,this.fontStack=o,this.textColor=a},en=function(r){this.sections=r};en.fromString=function(r){return new en([new er(r,null,null,null,null)])},en.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(r){return 0!==r.text.length||r.image&&0!==r.image.name.length})},en.factory=function(r){return r instanceof en?r:en.fromString(r)},en.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(r){return r.text}).join("")},en.prototype.serialize=function(){for(var r=["format"],n=0,i=this.sections;n<i.length;n+=1){var o=i[n];if(o.image)r.push(["image",o.image.name]);else{r.push(o.text);var a={};o.fontStack&&(a["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(a["font-scale"]=o.scale),o.textColor&&(a["text-color"]=["rgba"].concat(o.textColor.toArray())),r.push(a)}}return r};var ei=function(r){this.name=r.name,this.available=r.available};function eo(r,n,i,o){return"number"==typeof r&&r>=0&&r<=255&&"number"==typeof n&&n>=0&&n<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===o||"number"==typeof o&&o>=0&&o<=1?null:"Invalid rgba value ["+[r,n,i,o].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof o?[r,n,i,o]:[r,n,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ea(r){if(null===r)return tN;if("string"==typeof r)return tV;if("boolean"==typeof r)return tq;if("number"==typeof r)return tU;if(r instanceof et)return tj;if(r instanceof ee)return tZ;if(r instanceof en)return tW;if(r instanceof ei)return tX;if(Array.isArray(r)){for(var n,i=r.length,o=0,a=r;o<a.length;o+=1){var s=ea(a[o]);if(n){if(n===s)continue;n=tG;break}n=s}return tK(n||tG,i)}return tH}function es(r){var n=typeof r;return null===r?"":"string"===n||"number"===n||"boolean"===n?String(r):r instanceof et||r instanceof en||r instanceof ei?r.toString():JSON.stringify(r)}ei.prototype.toString=function(){return this.name},ei.fromString=function(r){return new ei({name:r,available:!1})},ei.prototype.serialize=function(){return["image",this.name]};var el=function(r,n){this.type=r,this.value=n};el.parse=function(r,n){if(2!==r.length)return n.error("'literal' expression requires exactly one argument, but found "+(r.length-1)+" instead.");if(!function r(n){if(null===n||"string"==typeof n||"boolean"==typeof n||"number"==typeof n||n instanceof et||n instanceof ee||n instanceof en||n instanceof ei)return!0;if(Array.isArray(n)){for(var i=0,o=n;i<o.length;i+=1)if(!r(o[i]))return!1;return!0}if("object"==typeof n){for(var a in n)if(!r(n[a]))return!1;return!0}return!1}(r[1]))return n.error("invalid value");var i=r[1],o=ea(i),a=n.expectedType;return"array"===o.kind&&0===o.N&&a&&"array"===a.kind&&("number"!=typeof a.N||0===a.N)&&(o=a),new el(o,i)},el.prototype.evaluate=function(){return this.value},el.prototype.eachChild=function(){},el.prototype.possibleOutputs=function(){return[this.value]},el.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof et?["rgba"].concat(this.value.toArray()):this.value instanceof en?this.value.serialize():this.value};var eu=function(r){this.name="ExpressionEvaluationError",this.message=r};eu.prototype.toJSON=function(){return this.message};var ec={string:tV,number:tU,boolean:tq,object:tH},ep=function(r,n){this.type=r,this.args=n};ep.parse=function(r,n){if(r.length<2)return n.error("Expected at least one argument.");var i,o,a,s=1,u=r[0];if("array"===u){if(r.length>2){var c=r[1];if("string"!=typeof c||!(c in ec)||"object"===c)return n.error('The item type argument of "array" must be one of string, number, boolean',1);i=ec[c],s++}else i=tG;if(r.length>3){if(null!==r[2]&&("number"!=typeof r[2]||r[2]<0||r[2]!==Math.floor(r[2])))return n.error('The length argument to "array" must be a positive integer literal',2);o=r[2],s++}a=tK(i,o)}else a=ec[u];for(var p=[];s<r.length;s++){var h=n.parse(r[s],s,tG);if(!h)return null;p.push(h)}return new ep(a,p)},ep.prototype.evaluate=function(r){for(var n=0;n<this.args.length;n++){var i=this.args[n].evaluate(r);if(!tQ(this.type,ea(i)))return i;if(n===this.args.length-1)throw new eu("Expected value to be of type "+tY(this.type)+", but found "+tY(ea(i))+" instead.")}return null},ep.prototype.eachChild=function(r){this.args.forEach(r)},ep.prototype.possibleOutputs=function(){var r;return(r=[]).concat.apply(r,this.args.map(function(r){return r.possibleOutputs()}))},ep.prototype.serialize=function(){var r=this.type,n=[r.kind];if("array"===r.kind){var i=r.itemType;if("string"===i.kind||"number"===i.kind||"boolean"===i.kind){n.push(i.kind);var o=r.N;("number"==typeof o||this.args.length>1)&&n.push(o)}}return n.concat(this.args.map(function(r){return r.serialize()}))};var eh=function(r){this.type=tW,this.sections=r};eh.parse=function(r,n){if(r.length<2)return n.error("Expected at least one argument.");var i=r[1];if(!Array.isArray(i)&&"object"==typeof i)return n.error("First argument must be an image or text section.");for(var o=[],a=!1,s=1;s<=r.length-1;++s){var u=r[s];if(a&&"object"==typeof u&&!Array.isArray(u)){a=!1;var c=null;if(u["font-scale"]&&!(c=n.parse(u["font-scale"],1,tU)))return null;var p=null;if(u["text-font"]&&!(p=n.parse(u["text-font"],1,tK(tV))))return null;var h=null;if(u["text-color"]&&!(h=n.parse(u["text-color"],1,tj)))return null;var d=o[o.length-1];d.scale=c,d.font=p,d.textColor=h}else{var f=n.parse(r[s],1,tG);if(!f)return null;var m=f.type.kind;if("string"!==m&&"value"!==m&&"null"!==m&&"resolvedImage"!==m)return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,o.push({content:f,scale:null,font:null,textColor:null})}}return new eh(o)},eh.prototype.evaluate=function(r){return new en(this.sections.map(function(n){var i=n.content.evaluate(r);return ea(i)===tX?new er("",i,null,null,null):new er(es(i),null,n.scale?n.scale.evaluate(r):null,n.font?n.font.evaluate(r).join(","):null,n.textColor?n.textColor.evaluate(r):null)}))},eh.prototype.eachChild=function(r){for(var n=0,i=this.sections;n<i.length;n+=1){var o=i[n];r(o.content),o.scale&&r(o.scale),o.font&&r(o.font),o.textColor&&r(o.textColor)}},eh.prototype.possibleOutputs=function(){return[void 0]},eh.prototype.serialize=function(){for(var r=["format"],n=0,i=this.sections;n<i.length;n+=1){var o=i[n];r.push(o.content.serialize());var a={};o.scale&&(a["font-scale"]=o.scale.serialize()),o.font&&(a["text-font"]=o.font.serialize()),o.textColor&&(a["text-color"]=o.textColor.serialize()),r.push(a)}return r};var ed=function(r){this.type=tX,this.input=r};ed.parse=function(r,n){if(2!==r.length)return n.error("Expected two arguments.");var i=n.parse(r[1],1,tV);return i?new ed(i):n.error("No image name provided.")},ed.prototype.evaluate=function(r){var n=this.input.evaluate(r),i=!1;return r.availableImages&&r.availableImages.indexOf(n)>-1&&(i=!0),new ei({name:n,available:i})},ed.prototype.eachChild=function(r){r(this.input)},ed.prototype.possibleOutputs=function(){return[void 0]},ed.prototype.serialize=function(){return["image",this.input.serialize()]};var ef={"to-boolean":tq,"to-color":tj,"to-number":tU,"to-string":tV},em=function(r,n){this.type=r,this.args=n};em.parse=function(r,n){if(r.length<2)return n.error("Expected at least one argument.");var i=r[0];if(("to-boolean"===i||"to-string"===i)&&2!==r.length)return n.error("Expected one argument.");for(var o=ef[i],a=[],s=1;s<r.length;s++){var u=n.parse(r[s],s,tG);if(!u)return null;a.push(u)}return new em(o,a)},em.prototype.evaluate=function(r){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(r));if("color"===this.type.kind){for(var n,i,o=0,a=this.args;o<a.length;o+=1){if(i=null,(n=a[o].evaluate(r))instanceof et)return n;if("string"==typeof n){var s=r.parseColor(n);if(s)return s}else if(Array.isArray(n)&&!(i=n.length<3||n.length>4?"Invalid rbga value "+JSON.stringify(n)+": expected an array containing either three or four numeric values.":eo(n[0],n[1],n[2],n[3])))return new et(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new eu(i||"Could not parse color from value '"+("string"==typeof n?n:String(JSON.stringify(n)))+"'")}if("number"===this.type.kind){for(var u=null,c=0,p=this.args;c<p.length;c+=1){if(null===(u=p[c].evaluate(r)))return 0;var h=Number(u);if(!isNaN(h))return h}throw new eu("Could not convert "+JSON.stringify(u)+" to number.")}return"formatted"===this.type.kind?en.fromString(es(this.args[0].evaluate(r))):"resolvedImage"===this.type.kind?ei.fromString(es(this.args[0].evaluate(r))):es(this.args[0].evaluate(r))},em.prototype.eachChild=function(r){this.args.forEach(r)},em.prototype.possibleOutputs=function(){var r;return(r=[]).concat.apply(r,this.args.map(function(r){return r.possibleOutputs()}))},em.prototype.serialize=function(){if("formatted"===this.type.kind)return new eh([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ed(this.args[0]).serialize();var r=["to-"+this.type.kind];return this.eachChild(function(n){r.push(n.serialize())}),r};var ey=["Unknown","Point","LineString","Polygon"],ev=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null};ev.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ev.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?ey[this.feature.type]:this.feature.type:null},ev.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ev.prototype.parseColor=function(r){var n=this._parseColorCache[r];return n||(n=this._parseColorCache[r]=et.parse(r)),n};var eg=function(r,n,i,o){this.name=r,this.type=n,this._evaluate=i,this.args=o};eg.prototype.evaluate=function(r){return this._evaluate(r,this.args)},eg.prototype.eachChild=function(r){this.args.forEach(r)},eg.prototype.possibleOutputs=function(){return[void 0]},eg.prototype.serialize=function(){return[this.name].concat(this.args.map(function(r){return r.serialize()}))},eg.parse=function(r,n){var i,o=r[0],a=eg.definitions[o];if(!a)return n.error('Unknown expression "'+o+'". If you wanted a literal array, use ["literal", [...]].',0);for(var s=Array.isArray(a)?a[0]:a.type,u=Array.isArray(a)?[[a[1],a[2]]]:a.overloads,c=u.filter(function(n){var i=n[0];return!Array.isArray(i)||i.length===r.length-1}),p=null,h=0,d=c;h<d.length;h+=1){var f=d[h],m=f[0],y=f[1];p=new ew(n.registry,n.path,null,n.scope);for(var v=[],g=!1,$=1;$<r.length;$++){var _=r[$],x=Array.isArray(m)?m[$-1]:m.type,b=p.parse(_,1+v.length,x);if(!b){g=!0;break}v.push(b)}if(!g){if(Array.isArray(m)&&m.length!==v.length)p.error("Expected "+m.length+" arguments, but found "+v.length+" instead.");else{for(var w=0;w<v.length;w++){var E=Array.isArray(m)?m[w]:m.type,T=v[w];p.concat(w+1).checkSubtype(E,T.type)}if(0===p.errors.length)return new eg(o,s,y,v)}}}if(1===c.length)(i=n.errors).push.apply(i,p.errors);else{for(var S=(c.length?c:u).map(function(r){var n;return Array.isArray(n=r[0])?"("+n.map(tY).join(", ")+")":"("+tY(n.type)+"...)"}).join(" | "),C=[],I=1;I<r.length;I++){var k=n.parse(r[I],1+C.length);if(!k)return null;C.push(tY(k.type))}n.error("Expected arguments of type "+S+", but found ("+C.join(", ")+") instead.")}return null},eg.register=function(r,n){for(var i in eg.definitions=n,n)r[i]=eg};var e8=function(r,n,i){this.type=tZ,this.locale=i,this.caseSensitive=r,this.diacriticSensitive=n};function e$(r){if(r instanceof eg&&("get"===r.name&&1===r.args.length||"feature-state"===r.name||"has"===r.name&&1===r.args.length||"properties"===r.name||"geometry-type"===r.name||"id"===r.name||/^filter-/.test(r.name)))return!1;var n=!0;return r.eachChild(function(r){n&&!e$(r)&&(n=!1)}),n}function e_(r){if(r instanceof eg&&"feature-state"===r.name)return!1;var n=!0;return r.eachChild(function(r){n&&!e_(r)&&(n=!1)}),n}function ex(r,n){if(r instanceof eg&&n.indexOf(r.name)>=0)return!1;var i=!0;return r.eachChild(function(r){i&&!ex(r,n)&&(i=!1)}),i}e8.parse=function(r,n){if(2!==r.length)return n.error("Expected one argument.");var i=r[1];if("object"!=typeof i||Array.isArray(i))return n.error("Collator options argument must be an object.");var o=n.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,tq);if(!o)return null;var a=n.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,tq);if(!a)return null;var s=null;return!i.locale||(s=n.parse(i.locale,1,tV))?new e8(o,a,s):null},e8.prototype.evaluate=function(r){return new ee(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)},e8.prototype.eachChild=function(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)},e8.prototype.possibleOutputs=function(){return[void 0]},e8.prototype.serialize=function(){var r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]};var eb=function(r,n){this.type=n.type,this.name=r,this.boundExpression=n};eb.parse=function(r,n){if(2!==r.length||"string"!=typeof r[1])return n.error("'var' expression requires exactly one string literal argument.");var i=r[1];return n.scope.has(i)?new eb(i,n.scope.get(i)):n.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},eb.prototype.evaluate=function(r){return this.boundExpression.evaluate(r)},eb.prototype.eachChild=function(){},eb.prototype.possibleOutputs=function(){return[void 0]},eb.prototype.serialize=function(){return["var",this.name]};var ew=function(r,n,i,o,a){void 0===n&&(n=[]),void 0===o&&(o=new t5),void 0===a&&(a=[]),this.registry=r,this.path=n,this.key=n.map(function(r){return"["+r+"]"}).join(""),this.scope=o,this.errors=a,this.expectedType=i};function e0(r,n){for(var i,o,a=r.length-1,s=0,u=a,c=0;s<=u;)if(i=r[c=Math.floor((s+u)/2)],o=r[c+1],i<=n){if(c===a||n<o)return c;s=c+1}else{if(!(i>n))throw new eu("Input is not a number.");u=c-1}return 0}ew.prototype.parse=function(r,n,i,o,a){return void 0===a&&(a={}),n?this.concat(n,i,o)._parse(r,a):this._parse(r,a)},ew.prototype._parse=function(r,n){function i(r,n,i){return"assert"===i?new ep(n,[r]):"coerce"===i?new em(n,[r]):r}if(null!==r&&"string"!=typeof r&&"boolean"!=typeof r&&"number"!=typeof r||(r=["literal",r]),Array.isArray(r)){if(0===r.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var o=r[0];if("string"!=typeof o)return this.error("Expression name must be a string, but found "+typeof o+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var a=this.registry[o];if(a){var s=a.parse(r,this);if(!s)return null;if(this.expectedType){var u=this.expectedType,c=s.type;if("string"!==u.kind&&"number"!==u.kind&&"boolean"!==u.kind&&"object"!==u.kind&&"array"!==u.kind||"value"!==c.kind){if("color"!==u.kind&&"formatted"!==u.kind&&"resolvedImage"!==u.kind||"value"!==c.kind&&"string"!==c.kind){if(this.checkSubtype(u,c))return null}else s=i(s,u,n.typeAnnotation||"coerce")}else s=i(s,u,n.typeAnnotation||"assert")}if(!(s instanceof el)&&"resolvedImage"!==s.type.kind&&function r(n){if(n instanceof eb)return r(n.boundExpression);if(n instanceof eg&&"error"===n.name||n instanceof e8)return!1;var i=n instanceof em||n instanceof ep,o=!0;return n.eachChild(function(n){o=i?o&&r(n):o&&n instanceof el}),!!o&&e$(n)&&ex(n,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(s)){var p=new ev;try{s=new el(s.type,s.evaluate(p))}catch(h){return this.error(h.message),null}}return s}return this.error('Unknown expression "'+o+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===r?this.error("'undefined' value invalid. Use null instead."):"object"==typeof r?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof r+" instead.")},ew.prototype.concat=function(r,n,i){var o="number"==typeof r?this.path.concat(r):this.path,a=i?this.scope.concat(i):this.scope;return new ew(this.registry,o,n||null,a,this.errors)},ew.prototype.error=function(r){for(var n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];var o=""+this.key+n.map(function(r){return"["+r+"]"}).join("");this.errors.push(new t7(o,r))},ew.prototype.checkSubtype=function(r,n){var i=tQ(r,n);return i&&this.error(i),i};var eE=function(r,n,i){this.type=r,this.input=n,this.labels=[],this.outputs=[];for(var o=0,a=i;o<a.length;o+=1){var s=a[o],u=s[0],c=s[1];this.labels.push(u),this.outputs.push(c)}};function eT(r,n,i){return r*(1-i)+n*i}eE.parse=function(r,n){if(r.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(r.length-1)+".");if((r.length-1)%2!=0)return n.error("Expected an even number of arguments.");var i=n.parse(r[1],1,tU);if(!i)return null;var o=[],a=null;n.expectedType&&"value"!==n.expectedType.kind&&(a=n.expectedType);for(var s=1;s<r.length;s+=2){var u=1===s?-1/0:r[s],c=r[s+1],p=s,h=s+1;if("number"!=typeof u)return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(o.length&&o[o.length-1][0]>=u)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',p);var d=n.parse(c,h,a);if(!d)return null;a=a||d.type,o.push([u,d])}return new eE(a,i,o)},eE.prototype.evaluate=function(r){var n=this.labels,i=this.outputs;if(1===n.length)return i[0].evaluate(r);var o=this.input.evaluate(r);if(o<=n[0])return i[0].evaluate(r);var a=n.length;return o>=n[a-1]?i[a-1].evaluate(r):i[e0(n,o)].evaluate(r)},eE.prototype.eachChild=function(r){r(this.input);for(var n=0,i=this.outputs;n<i.length;n+=1)r(i[n])},eE.prototype.possibleOutputs=function(){var r;return(r=[]).concat.apply(r,this.outputs.map(function(r){return r.possibleOutputs()}))},eE.prototype.serialize=function(){for(var r=["step",this.input.serialize()],n=0;n<this.labels.length;n++)n>0&&r.push(this.labels[n]),r.push(this.outputs[n].serialize());return r};var eS=Object.freeze({__proto__:null,number:eT,color:function(r,n,i){return new et(eT(r.r,n.r,i),eT(r.g,n.g,i),eT(r.b,n.b,i),eT(r.a,n.a,i))},array:function(r,n,i){return r.map(function(r,o){return eT(r,n[o],i)})}}),eC=4/29,eI=6/29,ek=3*eI*eI,e1=eI*eI*eI,e2=Math.PI/180,eA=180/Math.PI;function eP(r){return r>e1?Math.pow(r,1/3):r/ek+eC}function eL(r){return r>eI?r*r*r:ek*(r-eC)}function eD(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function ez(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function e3(r){var n=ez(r.r),i=ez(r.g),o=ez(r.b),a=eP((.4124564*n+.3575761*i+.1804375*o)/.95047),s=eP((.2126729*n+.7151522*i+.072175*o)/1);return{l:116*s-16,a:500*(a-s),b:200*(s-eP((.0193339*n+.119192*i+.9503041*o)/1.08883)),alpha:r.a}}function e4(r){var n=(r.l+16)/116,i=isNaN(r.a)?n:n+r.a/500,o=isNaN(r.b)?n:n-r.b/200;return n=1*eL(n),i=.95047*eL(i),o=1.08883*eL(o),new et(eD(3.2404542*i-1.5371385*n-.4985314*o),eD(-.969266*i+1.8760108*n+.041556*o),eD(.0556434*i-.2040259*n+1.0572252*o),r.alpha)}var eM={forward:e3,reverse:e4,interpolate:function(r,n,i){return{l:eT(r.l,n.l,i),a:eT(r.a,n.a,i),b:eT(r.b,n.b,i),alpha:eT(r.alpha,n.alpha,i)}}},eR={forward:function(r){var n=e3(r),i=n.l,o=n.a,a=n.b,s=Math.atan2(a,o)*eA;return{h:s<0?s+360:s,c:Math.sqrt(o*o+a*a),l:i,alpha:r.a}},reverse:function(r){var n=r.h*e2,i=r.c;return e4({l:r.l,a:Math.cos(n)*i,b:Math.sin(n)*i,alpha:r.alpha})},interpolate:function(r,n,i){var o,a,s,u;return{h:(o=r.h,a=n.h,s=i,u=a-o,o+s*(u>180||u<-180?u-360*Math.round(u/360):u)),c:eT(r.c,n.c,i),l:eT(r.l,n.l,i),alpha:eT(r.alpha,n.alpha,i)}}},eB=Object.freeze({__proto__:null,lab:eM,hcl:eR}),eF=function(r,n,i,o,a){this.type=r,this.operator=n,this.interpolation=i,this.input=o,this.labels=[],this.outputs=[];for(var s=0,u=a;s<u.length;s+=1){var c=u[s],p=c[0],h=c[1];this.labels.push(p),this.outputs.push(h)}};function eO(r,n,i,o){var a=o-i,s=r-i;return 0===a?0:1===n?s/a:(Math.pow(n,s)-1)/(Math.pow(n,a)-1)}eF.interpolationFactor=function(r,n,i,o){var a=0;if("exponential"===r.name)a=eO(n,r.base,i,o);else if("linear"===r.name)a=eO(n,1,i,o);else if("cubic-bezier"===r.name){var u=r.controlPoints;a=new s(u[0],u[1],u[2],u[3]).solve(eO(n,1,i,o))}return a},eF.parse=function(r,n){var i=r[0],o=r[1],a=r[2],s=r.slice(3);if(!Array.isArray(o)||0===o.length)return n.error("Expected an interpolation type expression.",1);if("linear"===o[0])o={name:"linear"};else if("exponential"===o[0]){var u=o[1];if("number"!=typeof u)return n.error("Exponential interpolation requires a numeric base.",1,1);o={name:"exponential",base:u}}else{if("cubic-bezier"!==o[0])return n.error("Unknown interpolation type "+String(o[0]),1,0);var c=o.slice(1);if(4!==c.length||c.some(function(r){return"number"!=typeof r||r<0||r>1}))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);o={name:"cubic-bezier",controlPoints:c}}if(r.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(r.length-1)+".");if((r.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(!(a=n.parse(a,2,tU)))return null;var p=[],h=null;"interpolate-hcl"===i||"interpolate-lab"===i?h=tj:n.expectedType&&"value"!==n.expectedType.kind&&(h=n.expectedType);for(var d=0;d<s.length;d+=2){var f=s[d],m=s[d+1],y=d+3,v=d+4;if("number"!=typeof f)return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',y);if(p.length&&p[p.length-1][0]>=f)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',y);var g=n.parse(m,v,h);if(!g)return null;h=h||g.type,p.push([f,g])}return"number"===h.kind||"color"===h.kind||"array"===h.kind&&"number"===h.itemType.kind&&"number"==typeof h.N?new eF(h,i,o,a,p):n.error("Type "+tY(h)+" is not interpolatable.")},eF.prototype.evaluate=function(r){var n=this.labels,i=this.outputs;if(1===n.length)return i[0].evaluate(r);var o=this.input.evaluate(r);if(o<=n[0])return i[0].evaluate(r);var a=n.length;if(o>=n[a-1])return i[a-1].evaluate(r);var s=e0(n,o),u=n[s],c=n[s+1],p=eF.interpolationFactor(this.interpolation,o,u,c),h=i[s].evaluate(r),d=i[s+1].evaluate(r);return"interpolate"===this.operator?eS[this.type.kind.toLowerCase()](h,d,p):"interpolate-hcl"===this.operator?eR.reverse(eR.interpolate(eR.forward(h),eR.forward(d),p)):eM.reverse(eM.interpolate(eM.forward(h),eM.forward(d),p))},eF.prototype.eachChild=function(r){r(this.input);for(var n=0,i=this.outputs;n<i.length;n+=1)r(i[n])},eF.prototype.possibleOutputs=function(){var r;return(r=[]).concat.apply(r,this.outputs.map(function(r){return r.possibleOutputs()}))},eF.prototype.serialize=function(){var r;r="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var n=[this.operator,r,this.input.serialize()],i=0;i<this.labels.length;i++)n.push(this.labels[i],this.outputs[i].serialize());return n};var e6=function(r,n){this.type=r,this.args=n};e6.parse=function(r,n){if(r.length<2)return n.error("Expectected at least one argument.");var i=null,o=n.expectedType;o&&"value"!==o.kind&&(i=o);for(var a=[],s=0,u=r.slice(1);s<u.length;s+=1){var c=u[s],p=n.parse(c,1+a.length,i,void 0,{typeAnnotation:"omit"});if(!p)return null;i=i||p.type,a.push(p)}var h=o&&a.some(function(r){return tQ(o,r.type)});return new e6(h?tG:i,a)},e6.prototype.evaluate=function(r){for(var n,i=null,o=0,a=0,s=this.args;a<s.length&&(o++,(i=s[a].evaluate(r))&&i instanceof ei&&!i.available&&(n||(n=i.name),i=null,o===this.args.length&&(i=n)),null===i);a+=1);return i},e6.prototype.eachChild=function(r){this.args.forEach(r)},e6.prototype.possibleOutputs=function(){var r;return(r=[]).concat.apply(r,this.args.map(function(r){return r.possibleOutputs()}))},e6.prototype.serialize=function(){var r=["coalesce"];return this.eachChild(function(n){r.push(n.serialize())}),r};var e7=function(r,n){this.type=n.type,this.bindings=[].concat(r),this.result=n};e7.prototype.evaluate=function(r){return this.result.evaluate(r)},e7.prototype.eachChild=function(r){for(var n=0,i=this.bindings;n<i.length;n+=1)r(i[n][1]);r(this.result)},e7.parse=function(r,n){if(r.length<4)return n.error("Expected at least 3 arguments, but found "+(r.length-1)+" instead.");for(var i=[],o=1;o<r.length-1;o+=2){var a=r[o];if("string"!=typeof a)return n.error("Expected string, but found "+typeof a+" instead.",o);if(/[^a-zA-Z0-9_]/.test(a))return n.error("Variable names must contain only alphanumeric characters or '_'.",o);var s=n.parse(r[o+1],o+1);if(!s)return null;i.push([a,s])}var u=n.parse(r[r.length-1],r.length-1,n.expectedType,i);return u?new e7(i,u):null},e7.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},e7.prototype.serialize=function(){for(var r=["let"],n=0,i=this.bindings;n<i.length;n+=1){var o=i[n],a=o[0],s=o[1];r.push(a,s.serialize())}return r.push(this.result.serialize()),r};var e5=function(r,n,i){this.type=r,this.index=n,this.input=i};e5.parse=function(r,n){if(3!==r.length)return n.error("Expected 2 arguments, but found "+(r.length-1)+" instead.");var i=n.parse(r[1],1,tU),o=n.parse(r[2],2,tK(n.expectedType||tG));if(!i||!o)return null;var a=o.type;return new e5(a.itemType,i,o)},e5.prototype.evaluate=function(r){var n=this.index.evaluate(r),i=this.input.evaluate(r);if(n<0)throw new eu("Array index out of bounds: "+n+" < 0.");if(n>=i.length)throw new eu("Array index out of bounds: "+n+" > "+(i.length-1)+".");if(n!==Math.floor(n))throw new eu("Array index must be an integer, but found "+n+" instead.");return i[n]},e5.prototype.eachChild=function(r){r(this.index),r(this.input)},e5.prototype.possibleOutputs=function(){return[void 0]},e5.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var eN=function(r,n){this.type=tq,this.needle=r,this.haystack=n};eN.parse=function(r,n){if(3!==r.length)return n.error("Expected 2 arguments, but found "+(r.length-1)+" instead.");var i,o=n.parse(r[1],1,tG),a=n.parse(r[2],2,tG);return o&&a?"boolean"!==(i=o.type).kind&&"string"!==i.kind&&"number"!==i.kind&&"null"!==i.kind&&"value"!==i.kind?n.error("Expected first argument to be of type boolean, string, number or null, but found "+tY(o.type)+" instead"):new eN(o,a):null},eN.prototype.evaluate=function(r){var n,i,o=this.needle.evaluate(r),a=this.haystack.evaluate(r);if(!o||!a)return!1;if("boolean"!=typeof(n=o)&&"string"!=typeof n&&"number"!=typeof n)throw new eu("Expected first argument to be of type boolean, string or number, but found "+tY(ea(o))+" instead.");if(!Array.isArray(i=a)&&"string"!=typeof i)throw new eu("Expected second argument to be of type array or string, but found "+tY(ea(a))+" instead.");return a.indexOf(o)>=0},eN.prototype.eachChild=function(r){r(this.needle),r(this.haystack)},eN.prototype.possibleOutputs=function(){return[!0,!1]},eN.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var eU=function(r,n,i,o,a,s){this.inputType=r,this.type=n,this.input=i,this.cases=o,this.outputs=a,this.otherwise=s};eU.parse=function(r,n){if(r.length<5)return n.error("Expected at least 4 arguments, but found only "+(r.length-1)+".");if(r.length%2!=1)return n.error("Expected an even number of arguments.");n.expectedType&&"value"!==n.expectedType.kind&&(o=n.expectedType);for(var i,o,a={},s=[],u=2;u<r.length-1;u+=2){var c=r[u],p=r[u+1];Array.isArray(c)||(c=[c]);var h=n.concat(u);if(0===c.length)return h.error("Expected at least one branch label.");for(var d=0,f=c;d<f.length;d+=1){var m=f[d];if("number"!=typeof m&&"string"!=typeof m)return h.error("Branch labels must be numbers or strings.");if("number"==typeof m&&Math.abs(m)>Number.MAX_SAFE_INTEGER)return h.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof m&&Math.floor(m)!==m)return h.error("Numeric branch labels must be integer values.");if(i){if(h.checkSubtype(i,ea(m)))return null}else i=ea(m);if(void 0!==a[String(m)])return h.error("Branch labels must be unique.");a[String(m)]=s.length}var y=n.parse(p,u,o);if(!y)return null;o=o||y.type,s.push(y)}var v=n.parse(r[1],1,tG);if(!v)return null;var g=n.parse(r[r.length-1],r.length-1,o);return g?"value"!==v.type.kind&&n.concat(1).checkSubtype(i,v.type)?null:new eU(i,o,v,a,s,g):null},eU.prototype.evaluate=function(r){var n=this.input.evaluate(r);return(ea(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(r)},eU.prototype.eachChild=function(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)},eU.prototype.possibleOutputs=function(){var r;return(r=[]).concat.apply(r,this.outputs.map(function(r){return r.possibleOutputs()})).concat(this.otherwise.possibleOutputs())},eU.prototype.serialize=function(){for(var r=this,n=["match",this.input.serialize()],i=[],o={},a=0,s=Object.keys(this.cases).sort();a<s.length;a+=1){var u=s[a];void 0===(f=o[this.cases[u]])?(o[this.cases[u]]=i.length,i.push([this.cases[u],[u]])):i[f][1].push(u)}for(var c=function(n){return"number"===r.inputType.kind?Number(n):n},p=0,h=i;p<h.length;p+=1){var d=h[p],f=d[0],m=d[1];1===m.length?n.push(c(m[0])):n.push(m.map(c)),n.push(this.outputs[outputIndex$1].serialize())}return n.push(this.otherwise.serialize()),n};var eV=function(r,n,i){this.type=r,this.branches=n,this.otherwise=i};function eq(r,n){return"=="===r||"!="===r?"boolean"===n.kind||"string"===n.kind||"number"===n.kind||"null"===n.kind||"value"===n.kind:"string"===n.kind||"number"===n.kind||"value"===n.kind}function ej(r,n,i,o){return 0===o.compare(n,i)}function eH(r,n,i){var o="=="!==r&&"!="!==r;return function(){function a(r,n,i){this.type=tq,this.lhs=r,this.rhs=n,this.collator=i,this.hasUntypedArgument="value"===r.type.kind||"value"===n.type.kind}return a.parse=function(r,n){if(3!==r.length&&4!==r.length)return n.error("Expected two or three arguments.");var i=r[0],s=n.parse(r[1],1,tG);if(!s)return null;if(!eq(i,s.type))return n.concat(1).error('"'+i+"\" comparisons are not supported for type '"+tY(s.type)+"'.");var u=n.parse(r[2],2,tG);if(!u)return null;if(!eq(i,u.type))return n.concat(2).error('"'+i+"\" comparisons are not supported for type '"+tY(u.type)+"'.");if(s.type.kind!==u.type.kind&&"value"!==s.type.kind&&"value"!==u.type.kind)return n.error("Cannot compare types '"+tY(s.type)+"' and '"+tY(u.type)+"'.");o&&("value"===s.type.kind&&"value"!==u.type.kind?s=new ep(u.type,[s]):"value"!==s.type.kind&&"value"===u.type.kind&&(u=new ep(s.type,[u])));var c=null;if(4===r.length){if("string"!==s.type.kind&&"string"!==u.type.kind&&"value"!==s.type.kind&&"value"!==u.type.kind)return n.error("Cannot use collator to compare non-string types.");if(!(c=n.parse(r[3],3,tZ)))return null}return new a(s,u,c)},a.prototype.evaluate=function(a){var s=this.lhs.evaluate(a),u=this.rhs.evaluate(a);if(o&&this.hasUntypedArgument){var c=ea(s),p=ea(u);if(c.kind!==p.kind||"string"!==c.kind&&"number"!==c.kind)throw new eu('Expected arguments for "'+r+'" to be (string, string) or (number, number), but found ('+c.kind+", "+p.kind+") instead.")}if(this.collator&&!o&&this.hasUntypedArgument){var h=ea(s),d=ea(u);if("string"!==h.kind||"string"!==d.kind)return n(a,s,u)}return this.collator?i(a,s,u,this.collator.evaluate(a)):n(a,s,u)},a.prototype.eachChild=function(r){r(this.lhs),r(this.rhs),this.collator&&r(this.collator)},a.prototype.possibleOutputs=function(){return[!0,!1]},a.prototype.serialize=function(){var n=[r];return this.eachChild(function(r){n.push(r.serialize())}),n},a}()}eV.parse=function(r,n){if(r.length<4)return n.error("Expected at least 3 arguments, but found only "+(r.length-1)+".");if(r.length%2!=0)return n.error("Expected an odd number of arguments.");n.expectedType&&"value"!==n.expectedType.kind&&(i=n.expectedType);for(var i,o=[],a=1;a<r.length-1;a+=2){var s=n.parse(r[a],a,tq);if(!s)return null;var u=n.parse(r[a+1],a+1,i);if(!u)return null;o.push([s,u]),i=i||u.type}var c=n.parse(r[r.length-1],r.length-1,i);return c?new eV(i,o,c):null},eV.prototype.evaluate=function(r){for(var n=0,i=this.branches;n<i.length;n+=1){var o=i[n],a=o[0],s=o[1];if(a.evaluate(r))return s.evaluate(r)}return this.otherwise.evaluate(r)},eV.prototype.eachChild=function(r){for(var n=0,i=this.branches;n<i.length;n+=1){var o=i[n],a=o[0],s=o[1];r(a),r(s)}r(this.otherwise)},eV.prototype.possibleOutputs=function(){var r;return(r=[]).concat.apply(r,this.branches.map(function(r){return r[0],r[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs())},eV.prototype.serialize=function(){var r=["case"];return this.eachChild(function(n){r.push(n.serialize())}),r};var eG=eH("==",function(r,n,i){return n===i},ej),eZ=eH("!=",function(r,n,i){return n!==i},function(r,n,i,o){return!ej(0,n,i,o)}),eW=eH("<",function(r,n,i){return n<i},function(r,n,i,o){return 0>o.compare(n,i)}),eX=eH(">",function(r,n,i){return n>i},function(r,n,i,o){return o.compare(n,i)>0}),eK=eH("<=",function(r,n,i){return n<=i},function(r,n,i,o){return 0>=o.compare(n,i)}),eY=eH(">=",function(r,n,i){return n>=i},function(r,n,i,o){return o.compare(n,i)>=0}),eJ=function(r,n,i,o,a){this.type=tV,this.number=r,this.locale=n,this.currency=i,this.minFractionDigits=o,this.maxFractionDigits=a};eJ.parse=function(r,n){if(3!==r.length)return n.error("Expected two arguments.");var i=n.parse(r[1],1,tU);if(!i)return null;var o=r[2];if("object"!=typeof o||Array.isArray(o))return n.error("NumberFormat options argument must be an object.");var a=null;if(o.locale&&!(a=n.parse(o.locale,1,tV)))return null;var s=null;if(o.currency&&!(s=n.parse(o.currency,1,tV)))return null;var u=null;if(o["min-fraction-digits"]&&!(u=n.parse(o["min-fraction-digits"],1,tU)))return null;var c=null;return!o["max-fraction-digits"]||(c=n.parse(o["max-fraction-digits"],1,tU))?new eJ(i,a,s,u,c):null},eJ.prototype.evaluate=function(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))},eJ.prototype.eachChild=function(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)},eJ.prototype.possibleOutputs=function(){return[void 0]},eJ.prototype.serialize=function(){var r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]};var eQ=function(r){this.type=tU,this.input=r};eQ.parse=function(r,n){if(2!==r.length)return n.error("Expected 1 argument, but found "+(r.length-1)+" instead.");var i=n.parse(r[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?n.error("Expected argument of type string or array, but found "+tY(i.type)+" instead."):new eQ(i):null},eQ.prototype.evaluate=function(r){var n=this.input.evaluate(r);if("string"==typeof n||Array.isArray(n))return n.length;throw new eu("Expected value to be of type string or array, but found "+tY(ea(n))+" instead.")},eQ.prototype.eachChild=function(r){r(this.input)},eQ.prototype.possibleOutputs=function(){return[void 0]},eQ.prototype.serialize=function(){var r=["length"];return this.eachChild(function(n){r.push(n.serialize())}),r};var e9={"==":eG,"!=":eZ,">":eX,"<":eW,">=":eY,"<=":eK,array:ep,at:e5,boolean:ep,case:eV,coalesce:e6,collator:e8,format:eh,image:ed,in:eN,interpolate:eF,"interpolate-hcl":eF,"interpolate-lab":eF,length:eQ,let:e7,literal:el,match:eU,number:ep,"number-format":eJ,object:ep,step:eE,string:ep,"to-boolean":em,"to-color":em,"to-number":em,"to-string":em,var:eb};function rt(r,n){var i=n[0],o=n[1],a=n[2],s=n[3];i=i.evaluate(r),o=o.evaluate(r),a=a.evaluate(r);var u=s?s.evaluate(r):1,c=eo(i,o,a,u);if(c)throw new eu(c);return new et(i/255*u,o/255*u,a/255*u,u)}function re(r,n){return r in n}function rr(r,n){var i=n[r];return void 0===i?null:i}function rn(r){return{type:r}}function ri(r){return{result:"success",value:r}}function ro(r){return{result:"error",value:r}}function ra(r){return"data-driven"===r["property-type"]||"cross-faded-data-driven"===r["property-type"]}function rs(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function rl(r){return!!r.expression&&r.expression.interpolated}function ru(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":null===r?"null":typeof r}function rc(r){return"object"==typeof r&&null!==r&&!Array.isArray(r)}function rp(r){return r}function rh(r,n,i){return void 0!==r?r:void 0!==n?n:void 0!==i?i:void 0}function rd(r,n,i,o,a){return rh(typeof i===a?o[i]:void 0,r.default,n.default)}function rf(r,n,i){if("number"!==ru(i))return rh(r.default,n.default);var o=r.stops.length;if(1===o||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[o-1][0])return r.stops[o-1][1];var a=e0(r.stops.map(function(r){return r[0]}),i);return r.stops[a][1]}function rm(r,n,i){var o=void 0!==r.base?r.base:1;if("number"!==ru(i))return rh(r.default,n.default);var a=r.stops.length;if(1===a||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[a-1][0])return r.stops[a-1][1];var s,u,c,p,h,d,f=e0(r.stops.map(function(r){return r[0]}),i),m=(s=i,u=o,c=r.stops[f][0],h=(p=r.stops[f+1][0])-c,d=s-c,0===h?0:1===u?d/h:(Math.pow(u,d)-1)/(Math.pow(u,h)-1)),y=r.stops[f][1],v=r.stops[f+1][1],g=eS[n.type]||rp;if(r.colorSpace&&"rgb"!==r.colorSpace){var $=eB[r.colorSpace];g=function(r,n){return $.reverse($.interpolate($.forward(r),$.forward(n),m))}}return"function"==typeof y.evaluate?{evaluate:function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];var i=y.evaluate.apply(void 0,r),o=v.evaluate.apply(void 0,r);if(void 0!==i&&void 0!==o)return g(i,o,m)}}:g(y,v,m)}function ry(r,n,i){return"color"===n.type?i=et.parse(i):"formatted"===n.type?i=en.fromString(i.toString()):"resolvedImage"===n.type?i=ei.fromString(i.toString()):ru(i)===n.type||"enum"===n.type&&n.values[i]||(i=void 0),rh(i,r.default,n.default)}eg.register(e9,{error:[{kind:"error"},[tV],function(r,n){var i=n[0];throw new eu(i.evaluate(r))}],typeof:[tV,[tG],function(r,n){return tY(ea(n[0].evaluate(r)))}],"to-rgba":[tK(tU,4),[tj],function(r,n){return n[0].evaluate(r).toArray()}],rgb:[tj,[tU,tU,tU],rt],rgba:[tj,[tU,tU,tU,tU],rt],has:{type:tq,overloads:[[[tV],function(r,n){var i,o;return i=n[0].evaluate(r),i in(o=r.properties())}],[[tV,tH],function(r,n){var i,o,a=n[0],s=n[1];return i=a.evaluate(r),i in(o=s.evaluate(r))}]]},get:{type:tG,overloads:[[[tV],function(r,n){return rr(n[0].evaluate(r),r.properties())}],[[tV,tH],function(r,n){var i=n[0],o=n[1];return rr(i.evaluate(r),o.evaluate(r))}]]},"feature-state":[tG,[tV],function(r,n){return rr(n[0].evaluate(r),r.featureState||{})}],properties:[tH,[],function(r){return r.properties()}],"geometry-type":[tV,[],function(r){return r.geometryType()}],id:[tG,[],function(r){return r.id()}],zoom:[tU,[],function(r){return r.globals.zoom}],"heatmap-density":[tU,[],function(r){return r.globals.heatmapDensity||0}],"line-progress":[tU,[],function(r){return r.globals.lineProgress||0}],accumulated:[tG,[],function(r){return void 0===r.globals.accumulated?null:r.globals.accumulated}],"+":[tU,rn(tU),function(r,n){for(var i=0,o=0,a=n;o<a.length;o+=1)i+=a[o].evaluate(r);return i}],"*":[tU,rn(tU),function(r,n){for(var i=1,o=0,a=n;o<a.length;o+=1)i*=a[o].evaluate(r);return i}],"-":{type:tU,overloads:[[[tU,tU],function(r,n){var i=n[0],o=n[1];return i.evaluate(r)-o.evaluate(r)}],[[tU],function(r,n){return-n[0].evaluate(r)}]]},"/":[tU,[tU,tU],function(r,n){var i=n[0],o=n[1];return i.evaluate(r)/o.evaluate(r)}],"%":[tU,[tU,tU],function(r,n){var i=n[0],o=n[1];return i.evaluate(r)%o.evaluate(r)}],ln2:[tU,[],function(){return Math.LN2}],pi:[tU,[],function(){return Math.PI}],e:[tU,[],function(){return Math.E}],"^":[tU,[tU,tU],function(r,n){var i=n[0],o=n[1];return Math.pow(i.evaluate(r),o.evaluate(r))}],sqrt:[tU,[tU],function(r,n){return Math.sqrt(n[0].evaluate(r))}],log10:[tU,[tU],function(r,n){return Math.log(n[0].evaluate(r))/Math.LN10}],ln:[tU,[tU],function(r,n){return Math.log(n[0].evaluate(r))}],log2:[tU,[tU],function(r,n){return Math.log(n[0].evaluate(r))/Math.LN2}],sin:[tU,[tU],function(r,n){return Math.sin(n[0].evaluate(r))}],cos:[tU,[tU],function(r,n){return Math.cos(n[0].evaluate(r))}],tan:[tU,[tU],function(r,n){return Math.tan(n[0].evaluate(r))}],asin:[tU,[tU],function(r,n){return Math.asin(n[0].evaluate(r))}],acos:[tU,[tU],function(r,n){return Math.acos(n[0].evaluate(r))}],atan:[tU,[tU],function(r,n){return Math.atan(n[0].evaluate(r))}],min:[tU,rn(tU),function(r,n){return Math.min.apply(Math,n.map(function(n){return n.evaluate(r)}))}],max:[tU,rn(tU),function(r,n){return Math.max.apply(Math,n.map(function(n){return n.evaluate(r)}))}],abs:[tU,[tU],function(r,n){return Math.abs(n[0].evaluate(r))}],round:[tU,[tU],function(r,n){var i=n[0].evaluate(r);return i<0?-Math.round(-i):Math.round(i)}],floor:[tU,[tU],function(r,n){return Math.floor(n[0].evaluate(r))}],ceil:[tU,[tU],function(r,n){return Math.ceil(n[0].evaluate(r))}],"filter-==":[tq,[tV,tG],function(r,n){var i=n[0],o=n[1];return r.properties()[i.value]===o.value}],"filter-id-==":[tq,[tG],function(r,n){var i=n[0];return r.id()===i.value}],"filter-type-==":[tq,[tV],function(r,n){var i=n[0];return r.geometryType()===i.value}],"filter-<":[tq,[tV,tG],function(r,n){var i=n[0],o=n[1],a=r.properties()[i.value],s=o.value;return typeof a==typeof s&&a<s}],"filter-id-<":[tq,[tG],function(r,n){var i=n[0],o=r.id(),a=i.value;return typeof o==typeof a&&o<a}],"filter->":[tq,[tV,tG],function(r,n){var i=n[0],o=n[1],a=r.properties()[i.value],s=o.value;return typeof a==typeof s&&a>s}],"filter-id->":[tq,[tG],function(r,n){var i=n[0],o=r.id(),a=i.value;return typeof o==typeof a&&o>a}],"filter-<=":[tq,[tV,tG],function(r,n){var i=n[0],o=n[1],a=r.properties()[i.value],s=o.value;return typeof a==typeof s&&a<=s}],"filter-id-<=":[tq,[tG],function(r,n){var i=n[0],o=r.id(),a=i.value;return typeof o==typeof a&&o<=a}],"filter->=":[tq,[tV,tG],function(r,n){var i=n[0],o=n[1],a=r.properties()[i.value],s=o.value;return typeof a==typeof s&&a>=s}],"filter-id->=":[tq,[tG],function(r,n){var i=n[0],o=r.id(),a=i.value;return typeof o==typeof a&&o>=a}],"filter-has":[tq,[tG],function(r,n){return n[0].value in r.properties()}],"filter-has-id":[tq,[],function(r){return null!==r.id()}],"filter-type-in":[tq,[tK(tV)],function(r,n){return n[0].value.indexOf(r.geometryType())>=0}],"filter-id-in":[tq,[tK(tG)],function(r,n){return n[0].value.indexOf(r.id())>=0}],"filter-in-small":[tq,[tV,tK(tG)],function(r,n){var i=n[0];return n[1].value.indexOf(r.properties()[i.value])>=0}],"filter-in-large":[tq,[tV,tK(tG)],function(r,n){var i=n[0],o=n[1];return function(r,n,i,o){for(;i<=o;){var a=i+o>>1;if(n[a]===r)return!0;n[a]>r?o=a-1:i=a+1}return!1}(r.properties()[i.value],o.value,0,o.value.length-1)}],all:{type:tq,overloads:[[[tq,tq],function(r,n){var i=n[0],o=n[1];return i.evaluate(r)&&o.evaluate(r)}],[rn(tq),function(r,n){for(var i=0,o=n;i<o.length;i+=1)if(!o[i].evaluate(r))return!1;return!0}]]},any:{type:tq,overloads:[[[tq,tq],function(r,n){var i=n[0],o=n[1];return i.evaluate(r)||o.evaluate(r)}],[rn(tq),function(r,n){for(var i=0,o=n;i<o.length;i+=1)if(o[i].evaluate(r))return!0;return!1}]]},"!":[tq,[tq],function(r,n){return!n[0].evaluate(r)}],"is-supported-script":[tq,[tV],function(r,n){var i=n[0],o=r.globals&&r.globals.isSupportedScript;return!o||o(i.evaluate(r))}],upcase:[tV,[tV],function(r,n){return n[0].evaluate(r).toUpperCase()}],downcase:[tV,[tV],function(r,n){return n[0].evaluate(r).toLowerCase()}],concat:[tV,rn(tG),function(r,n){return n.map(function(n){return es(n.evaluate(r))}).join("")}],"resolved-locale":[tV,[tZ],function(r,n){return n[0].evaluate(r).resolvedLocale()}]});var rv=function(r,n){var i;this.expression=r,this._warningHistory={},this._evaluator=new ev,this._defaultValue=n?"color"===(i=n).type&&rc(i.default)?new et(0,0,0,0):"color"===i.type?et.parse(i.default)||null:void 0===i.default?null:i.default:null,this._enumValues=n&&"enum"===n.type?n.values:null};function rg(r){return Array.isArray(r)&&r.length>0&&"string"==typeof r[0]&&r[0]in e9}function r8(r,n){var i,o,a=new ew(e9,[],n?(i=n,o={color:tj,string:tV,number:tU,enum:tV,boolean:tq,formatted:tW,resolvedImage:tX},"array"===i.type?tK(o[i.value]||tG,i.length):o[i.type]):void 0),s=a.parse(r,void 0,void 0,void 0,n&&"string"===n.type?{typeAnnotation:"coerce"}:void 0);return s?ri(new rv(s,n)):ro(a.errors)}rv.prototype.evaluateWithoutErrorHandling=function(r,n,i,o,a){return this._evaluator.globals=r,this._evaluator.feature=n,this._evaluator.featureState=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)},rv.prototype.evaluate=function(r,n,i,o,a){this._evaluator.globals=r,this._evaluator.feature=n||null,this._evaluator.featureState=i||null,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a||null;try{var s=this.expression.evaluate(this._evaluator);if(null==s||"number"==typeof s&&s!=s)return this._defaultValue;if(this._enumValues&&!(s in this._enumValues))throw new eu("Expected value to be one of "+Object.keys(this._enumValues).map(function(r){return JSON.stringify(r)}).join(", ")+", but found "+JSON.stringify(s)+" instead.");return s}catch(u){return this._warningHistory[u.message]||(this._warningHistory[u.message]=!0,"undefined"!=typeof console&&console.warn(u.message)),this._defaultValue}};var r$=function(r,n){this.kind=r,this._styleExpression=n,this.isStateDependent="constant"!==r&&!e_(n.expression)};r$.prototype.evaluateWithoutErrorHandling=function(r,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(r,n,i,o,a)},r$.prototype.evaluate=function(r,n,i,o,a){return this._styleExpression.evaluate(r,n,i,o,a)};var r_=function(r,n,i,o){this.kind=r,this.zoomStops=i,this._styleExpression=n,this.isStateDependent="camera"!==r&&!e_(n.expression),this.interpolationType=o};function rx(r,n){if("error"===(r=r8(r,n)).result)return r;var i=r.value.expression,o=e$(i);if(!o&&!ra(n))return ro([new t7("","data expressions not supported")]);var a=ex(i,["zoom"]);if(!a&&!rs(n))return ro([new t7("","zoom expressions not supported")]);var s=function r(n){var i=null;if(n instanceof e7)i=r(n.result);else if(n instanceof e6)for(var o=0,a=n.args;o<a.length&&!(i=r(a[o]));o+=1);else(n instanceof eE||n instanceof eF)&&n.input instanceof eg&&"zoom"===n.input.name&&(i=n);return i instanceof t7||n.eachChild(function(n){var o=r(n);o instanceof t7?i=o:!i&&o?i=new t7("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&o&&i!==o&&(i=new t7("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}(i);if(!s&&!a)return ro([new t7("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(s instanceof t7)return ro([s]);if(s instanceof eF&&!rl(n))return ro([new t7("",'"interpolate" expressions cannot be used with this property')]);if(!s)return ri(new r$(o?"constant":"source",r.value));var u=s instanceof eF?s.interpolation:void 0;return ri(new r_(o?"camera":"composite",r.value,s.labels,u))}r_.prototype.evaluateWithoutErrorHandling=function(r,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(r,n,i,o,a)},r_.prototype.evaluate=function(r,n,i,o,a){return this._styleExpression.evaluate(r,n,i,o,a)},r_.prototype.interpolationFactor=function(r,n,i){return this.interpolationType?eF.interpolationFactor(this.interpolationType,r,n,i):0};var rb=function(r,n){this._parameters=r,this._specification=n,tF(this,function r(n,i){var o,a,s,u="color"===i.type,c=n.stops&&"object"==typeof n.stops[0][0],p=c||void 0!==n.property,h=n.type||(rl(i)?"exponential":"interval");if(u&&((n=tF({},n)).stops&&(n.stops=n.stops.map(function(r){return[r[0],et.parse(r[1])]})),n.default?n.default=et.parse(n.default):n.default=et.parse(i.default)),n.colorSpace&&"rgb"!==n.colorSpace&&!eB[n.colorSpace])throw Error("Unknown color space: "+n.colorSpace);if("exponential"===h)o=rm;else if("interval"===h)o=rf;else if("categorical"===h){o=rd,a=Object.create(null);for(var d=0,f=n.stops;d<f.length;d+=1){var m=f[d];a[m[0]]=m[1]}s=typeof n.stops[0][0]}else{if("identity"!==h)throw Error('Unknown function type "'+h+'"');o=ry}if(c){for(var y={},v=[],g=0;g<n.stops.length;g++){var $=n.stops[g],_=$[0].zoom;void 0===y[_]&&(y[_]={zoom:_,type:n.type,property:n.property,default:n.default,stops:[]},v.push(_)),y[_].stops.push([$[0].value,$[1]])}for(var x=[],b=0,w=v;b<w.length;b+=1){var E=w[b];x.push([y[E].zoom,r(y[E],i)])}var T={name:"linear"};return{kind:"composite",interpolationType:T,interpolationFactor:eF.interpolationFactor.bind(void 0,T),zoomStops:x.map(function(r){return r[0]}),evaluate:function(r,o){var a=r.zoom;return rm({stops:x,base:n.base},i,a).evaluate(a,o)}}}if(c||!p){var S="exponential"===h?{name:"exponential",base:void 0!==n.base?n.base:1}:null;return{kind:"camera",interpolationType:S,interpolationFactor:eF.interpolationFactor.bind(void 0,S),zoomStops:n.stops.map(function(r){return r[0]}),evaluate:function(r){return o(n,i,r.zoom,a,s)}}}return{kind:"source",evaluate:function(r,u){var c=u&&u.properties?u.properties[n.property]:void 0;return void 0===c?rh(n.default,i.default):o(n,i,c,a,s)}}}(this._parameters,this._specification))};function rw(r){var n=r.key,i=r.value,o=r.valueSpec||{},a=r.objectElementValidators||{},s=r.style,u=r.styleSpec,c=[],p=ru(i);if("object"!==p)return[new tR(n,i,"object expected, "+p+" found")];for(var h in i){var d=h.split(".")[0],f=o[d]||o["*"],m=void 0;if(a[d])m=a[d];else if(o[d])m=r5;else if(a["*"])m=a["*"];else{if(!o["*"]){c.push(new tR(n,i[h],'unknown property "'+h+'"'));continue}m=r5}c=c.concat(m({key:(n?n+".":n)+h,value:i[h],valueSpec:f,style:s,styleSpec:u,object:i,objectKey:h},i))}for(var y in o)a[y]||o[y].required&&void 0===o[y].default&&void 0===i[y]&&c.push(new tR(n,i,'missing required property "'+y+'"'));return c}function r0(r){var n=r.value,i=r.valueSpec,o=r.style,a=r.styleSpec,s=r.key,u=r.arrayElementValidator||r5;if("array"!==ru(n))return[new tR(s,n,"array expected, "+ru(n)+" found")];if(i.length&&n.length!==i.length)return[new tR(s,n,"array length "+i.length+" expected, length "+n.length+" found")];if(i["min-length"]&&n.length<i["min-length"])return[new tR(s,n,"array length at least "+i["min-length"]+" expected, length "+n.length+" found")];var c={type:i.value,values:i.values};a.$version<7&&(c.function=i.function),"object"===ru(i.value)&&(c=i.value);for(var p=[],h=0;h<n.length;h++)p=p.concat(u({array:n,arrayIndex:h,value:n[h],valueSpec:c,style:o,styleSpec:a,key:s+"["+h+"]"}));return p}function rE(r){var n=r.key,i=r.value,o=r.valueSpec,a=ru(i);return"number"===a&&i!=i&&(a="NaN"),"number"!==a?[new tR(n,i,"number expected, "+a+" found")]:"minimum"in o&&i<o.minimum?[new tR(n,i,i+" is less than the minimum value "+o.minimum)]:"maximum"in o&&i>o.maximum?[new tR(n,i,i+" is greater than the maximum value "+o.maximum)]:[]}function rT(r){var n,i,o,a=r.valueSpec,s=tO(r.value.type),u={},c="categorical"!==s&&void 0===r.value.property,p="array"===ru(r.value.stops)&&"array"===ru(r.value.stops[0])&&"object"===ru(r.value.stops[0][0]),h=rw({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(r){if("identity"===s)return[new tR(r.key,r.value,'identity function may not have a "stops" property')];var n=[],i=r.value;return n=n.concat(r0({key:r.key,value:i,valueSpec:r.valueSpec,style:r.style,styleSpec:r.styleSpec,arrayElementValidator:d})),"array"===ru(i)&&0===i.length&&n.push(new tR(r.key,i,"array must have at least one stop")),n},default:function(r){return r5({key:r.key,value:r.value,valueSpec:a,style:r.style,styleSpec:r.styleSpec})}}});return"identity"===s&&c&&h.push(new tR(r.key,r.value,'missing required property "property"')),"identity"===s||r.value.stops||h.push(new tR(r.key,r.value,'missing required property "stops"')),"exponential"===s&&r.valueSpec.expression&&!rl(r.valueSpec)&&h.push(new tR(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(c||ra(r.valueSpec)?c&&!rs(r.valueSpec)&&h.push(new tR(r.key,r.value,"zoom functions not supported")):h.push(new tR(r.key,r.value,"property functions not supported"))),("categorical"===s||p)&&void 0===r.value.property&&h.push(new tR(r.key,r.value,'"property" property is required')),h;function d(r){var n=[],s=r.value,c=r.key;if("array"!==ru(s))return[new tR(c,s,"array expected, "+ru(s)+" found")];if(2!==s.length)return[new tR(c,s,"array length 2 expected, length "+s.length+" found")];if(p){if("object"!==ru(s[0]))return[new tR(c,s,"object expected, "+ru(s[0])+" found")];if(void 0===s[0].zoom)return[new tR(c,s,"object stop key must have zoom")];if(void 0===s[0].value)return[new tR(c,s,"object stop key must have value")];if(o&&o>tO(s[0].zoom))return[new tR(c,s[0].zoom,"stop zoom values must appear in ascending order")];tO(s[0].zoom)!==o&&(o=tO(s[0].zoom),i=void 0,u={}),n=n.concat(rw({key:c+"[0]",value:s[0],valueSpec:{zoom:{}},style:r.style,styleSpec:r.styleSpec,objectElementValidators:{zoom:rE,value:f}}))}else n=n.concat(f({key:c+"[0]",value:s[0],valueSpec:{},style:r.style,styleSpec:r.styleSpec},s));return rg(t6(s[1]))?n.concat([new tR(c+"[1]",s[1],"expressions are not allowed in function stops.")]):n.concat(r5({key:c+"[1]",value:s[1],valueSpec:a,style:r.style,styleSpec:r.styleSpec}))}function f(r,o){var c=ru(r.value),p=tO(r.value),h=null!==r.value?r.value:o;if(n){if(c!==n)return[new tR(r.key,h,c+" stop domain type must match previous stop domain type "+n)]}else n=c;if("number"!==c&&"string"!==c&&"boolean"!==c)return[new tR(r.key,h,"stop domain value must be a number, string, or boolean")];if("number"!==c&&"categorical"!==s){var d="number expected, "+c+" found";return ra(a)&&void 0===s&&(d+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new tR(r.key,h,d)]}return"categorical"!==s||"number"!==c||isFinite(p)&&Math.floor(p)===p?"categorical"!==s&&"number"===c&&void 0!==i&&p<i?[new tR(r.key,h,"stop domain values must appear in ascending order")]:(i=p,"categorical"===s&&p in u?[new tR(r.key,h,"stop domain values must be unique")]:(u[p]=!0,[])):[new tR(r.key,h,"integer expected, found "+p)]}}function rS(r){var n=("property"===r.expressionContext?rx:r8)(t6(r.value),r.valueSpec);if("error"===n.result)return n.value.map(function(n){return new tR(""+r.key+n.key,r.value,n.message)});var i=n.value.expression||n.value._styleExpression.expression;if("property"===r.expressionContext&&"text-font"===r.propertyKey&&-1!==i.possibleOutputs().indexOf(void 0))return[new tR(r.key,r.value,'Invalid data expression for "'+r.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===r.expressionContext&&"layout"===r.propertyType&&!e_(i))return[new tR(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===r.expressionContext&&!e_(i))return[new tR(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&0===r.expressionContext.indexOf("cluster")){if(!ex(i,["zoom","feature-state"]))return[new tR(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===r.expressionContext&&!e$(i))return[new tR(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function rC(r){var n=r.key,i=r.value,o=r.valueSpec,a=[];return Array.isArray(o.values)?-1===o.values.indexOf(tO(i))&&a.push(new tR(n,i,"expected one of ["+o.values.join(", ")+"], "+JSON.stringify(i)+" found")):-1===Object.keys(o.values).indexOf(tO(i))&&a.push(new tR(n,i,"expected one of ["+Object.keys(o.values).join(", ")+"], "+JSON.stringify(i)+" found")),a}function rI(r){if(!0===r||!1===r)return!0;if(!Array.isArray(r)||0===r.length)return!1;switch(r[0]){case"has":return r.length>=2&&"$id"!==r[1]&&"$type"!==r[1];case"in":return r.length>=3&&Array.isArray(r[2]);case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==r.length||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(var n=0,i=r.slice(1);n<i.length;n+=1){var o=i[n];if(!rI(o)&&"boolean"!=typeof o)return!1}return!0;default:return!0}}rb.deserialize=function(r){return new rb(r._parameters,r._specification)},rb.serialize=function(r){return{_parameters:r._parameters,_specification:r._specification}};var rk={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function r1(r){if(null==r)return function(){return!0};rI(r)||(r=function r(n){if(!n)return!0;var i,o=n[0];return n.length<=1?"any"!==o:"=="===o?rA(n[1],n[2],"=="):"!="===o?rD(rA(n[1],n[2],"==")):"<"===o||">"===o||"<="===o||">="===o?rA(n[1],n[2],o):"any"===o?["any"].concat((i=n.slice(1)).map(r)):"all"===o?["all"].concat(n.slice(1).map(r)):"none"===o?["all"].concat(n.slice(1).map(r).map(rD)):"in"===o?rP(n[1],n.slice(2)):"!in"===o?rD(rP(n[1],n.slice(2))):"has"===o?rL(n[1]):"!has"!==o||rD(rL(n[1]))}(r));var n=r8(r,rk);if("error"===n.result)throw Error(n.value.map(function(r){return r.key+": "+r.message}).join(", "));return function(r,i){return n.value.evaluate(r,i)}}function r2(r,n){return r<n?-1:r>n?1:0}function rA(r,n,i){switch(r){case"$type":return["filter-type-"+i,n];case"$id":return["filter-id-"+i,n];default:return["filter-"+i,r,n]}}function rP(r,n){if(0===n.length)return!1;switch(r){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(function(r){return typeof r!=typeof n[0]})?["filter-in-large",r,["literal",n.sort(r2)]]:["filter-in-small",r,["literal",n]]}}function rL(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function rD(r){return["!",r]}function rz(r){return rI(t6(r.value))?rS(tF({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function r(n){var i,o=n.value,a=n.key;if("array"!==ru(o))return[new tR(a,o,"array expected, "+ru(o)+" found")];var s=n.styleSpec,u=[];if(o.length<1)return[new tR(a,o,"filter array must have at least 1 element")];switch(u=u.concat(rC({key:a+"[0]",value:o[0],valueSpec:s.filter_operator,style:n.style,styleSpec:n.styleSpec})),tO(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&"$type"===tO(o[1])&&u.push(new tR(a,o,'"$type" cannot be use with operator "'+o[0]+'"'));case"==":case"!=":3!==o.length&&u.push(new tR(a,o,'filter array for operator "'+o[0]+'" must have 3 elements'));case"in":case"!in":o.length>=2&&"string"!==(i=ru(o[1]))&&u.push(new tR(a+"[1]",o[1],"string expected, "+i+" found"));for(var c=2;c<o.length;c++)i=ru(o[c]),"$type"===tO(o[1])?u=u.concat(rC({key:a+"["+c+"]",value:o[c],valueSpec:s.geometry_type,style:n.style,styleSpec:n.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&u.push(new tR(a+"["+c+"]",o[c],"string, number, or boolean expected, "+i+" found"));break;case"any":case"all":case"none":for(var p=1;p<o.length;p++)u=u.concat(r({key:a+"["+p+"]",value:o[p],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":i=ru(o[1]),2!==o.length?u.push(new tR(a,o,'filter array for "'+o[0]+'" operator must have 2 elements')):"string"!==i&&u.push(new tR(a+"[1]",o[1],"string expected, "+i+" found"))}return u}(r)}function r3(r,n){var i=r.key,o=r.style,a=r.styleSpec,s=r.value,u=r.objectKey,c=a[n+"_"+r.layerType];if(!c)return[];var p=u.match(/^(.*)-transition$/);if("paint"===n&&p&&c[p[1]]&&c[p[1]].transition)return r5({key:i,value:s,valueSpec:a.transition,style:o,styleSpec:a});var h,d=r.valueSpec||c[u];if(!d)return[new tR(i,s,'unknown property "'+u+'"')];if("string"===ru(s)&&ra(d)&&!d.tokens&&(h=/^{([^}]+)}$/.exec(s)))return[new tR(i,s,'"'+u+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(h[1])+" }`.")];var f=[];return"symbol"===r.layerType&&("text-field"===u&&o&&!o.glyphs&&f.push(new tR(i,s,'use of "text-field" requires a style "glyphs" property')),"text-font"===u&&rc(t6(s))&&"identity"===tO(s.type)&&f.push(new tR(i,s,'"text-font" does not support identity functions'))),f.concat(r5({key:r.key,value:s,valueSpec:d,style:o,styleSpec:a,expressionContext:"property",propertyType:n,propertyKey:u}))}function r4(r){return r3(r,"paint")}function rM(r){return r3(r,"layout")}function rR(r){var n=[],i=r.value,o=r.key,a=r.style,s=r.styleSpec;i.type||i.ref||n.push(new tR(o,i,'either "type" or "ref" is required'));var u,c=tO(i.type),p=tO(i.ref);if(i.id)for(var h=tO(i.id),d=0;d<r.arrayIndex;d++){var f=a.layers[d];tO(f.id)===h&&n.push(new tR(o,i.id,'duplicate layer id "'+i.id+'", previously used at line '+f.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(r){r in i&&n.push(new tR(o,i[r],'"'+r+'" is prohibited for ref layers'))}),a.layers.forEach(function(r){tO(r.id)===p&&(u=r)}),u?u.ref?n.push(new tR(o,i.ref,"ref cannot reference another ref layer")):c=tO(u.type):n.push(new tR(o,i.ref,'ref layer "'+p+'" not found'));else if("background"!==c){if(i.source){var m=a.sources&&a.sources[i.source],y=m&&tO(m.type);m?"vector"===y&&"raster"===c?n.push(new tR(o,i.source,'layer "'+i.id+'" requires a raster source')):"raster"===y&&"raster"!==c?n.push(new tR(o,i.source,'layer "'+i.id+'" requires a vector source')):"vector"!==y||i["source-layer"]?"raster-dem"===y&&"hillshade"!==c?n.push(new tR(o,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"===c&&i.paint&&i.paint["line-gradient"]&&("geojson"!==y||!m.lineMetrics)&&n.push(new tR(o,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):n.push(new tR(o,i,'layer "'+i.id+'" must specify a "source-layer"')):n.push(new tR(o,i.source,'source "'+i.source+'" not found'))}else n.push(new tR(o,i,'missing required property "source"'))}return n=n.concat(rw({key:o,value:i,valueSpec:s.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return r5({key:o+".type",value:i.type,valueSpec:s.layer.type,style:r.style,styleSpec:r.styleSpec,object:i,objectKey:"type"})},filter:rz,layout:function(r){return rw({layer:i,key:r.key,value:r.value,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":function(r){return rM(tF({layerType:c},r))}}})},paint:function(r){return rw({layer:i,key:r.key,value:r.value,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":function(r){return r4(tF({layerType:c},r))}}})}}}))}function rB(r){var n=r.value,i=r.key,o=ru(n);return"string"!==o?[new tR(i,n,"string expected, "+o+" found")]:[]}var rF={promoteId:function(r){var n=r.key,i=r.value;if("string"===ru(i))return rB({key:n,value:i});var o=[];for(var a in i)o.push.apply(o,rB({key:n+"."+a,value:i[a]}));return o}};function rO(r){var n=r.value,i=r.key,o=r.styleSpec,a=r.style;if(!n.type)return[new tR(i,n,'"type" is required')];var s,u=tO(n.type);switch(u){case"vector":case"raster":case"raster-dem":return rw({key:i,value:n,valueSpec:o["source_"+u.replace("-","_")],style:r.style,styleSpec:o,objectElementValidators:rF});case"geojson":if(s=rw({key:i,value:n,valueSpec:o.source_geojson,style:a,styleSpec:o,objectElementValidators:rF}),n.cluster)for(var c in n.clusterProperties){var p=n.clusterProperties[c],h=p[0],d=p[1],f="string"==typeof h?[h,["accumulated"],["get",c]]:h;s.push.apply(s,rS({key:i+"."+c+".map",value:d,expressionContext:"cluster-map"})),s.push.apply(s,rS({key:i+"."+c+".reduce",value:f,expressionContext:"cluster-reduce"}))}return s;case"video":return rw({key:i,value:n,valueSpec:o.source_video,style:a,styleSpec:o});case"image":return rw({key:i,value:n,valueSpec:o.source_image,style:a,styleSpec:o});case"canvas":return[new tR(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return rC({key:i+".type",value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:a,styleSpec:o})}}function r6(r){var n=r.value,i=r.styleSpec,o=i.light,a=r.style,s=[],u=ru(n);if(void 0===n)return s;if("object"!==u)return s.concat([new tR("light",n,"object expected, "+u+" found")]);for(var c in n){var p=c.match(/^(.*)-transition$/);s=p&&o[p[1]]&&o[p[1]].transition?s.concat(r5({key:c,value:n[c],valueSpec:i.transition,style:a,styleSpec:i})):o[c]?s.concat(r5({key:c,value:n[c],valueSpec:o[c],style:a,styleSpec:i})):s.concat([new tR(c,n[c],'unknown property "'+c+'"')])}return s}var r7={"*":function(){return[]},array:r0,boolean:function(r){var n=r.value,i=r.key,o=ru(n);return"boolean"!==o?[new tR(i,n,"boolean expected, "+o+" found")]:[]},number:rE,color:function(r){var n=r.key,i=r.value,o=ru(i);return"string"!==o?[new tR(n,i,"color expected, "+o+" found")]:null===t9(i)?[new tR(n,i,'color expected, "'+i+'" found')]:[]},constants:tB,enum:rC,filter:rz,function:rT,layer:rR,object:rw,source:rO,light:r6,string:rB,formatted:function(r){return 0===rB(r).length?[]:rS(r)},resolvedImage:function(r){return 0===rB(r).length?[]:rS(r)}};function r5(r){var n=r.value,i=r.valueSpec,o=r.styleSpec;return i.expression&&rc(tO(n))?rT(r):i.expression&&rg(t6(n))?rS(r):i.type&&r7[i.type]?r7[i.type](r):rw(tF({},r,{valueSpec:i.type?o[i.type]:i}))}function rN(r){var n=r.value,i=r.key,o=rB(r);return o.length||(-1===n.indexOf("{fontstack}")&&o.push(new tR(i,n,'"glyphs" url must include a "{fontstack}" token')),-1===n.indexOf("{range}")&&o.push(new tR(i,n,'"glyphs" url must include a "{range}" token'))),o}function rU(r,n){void 0===n&&(n=tM);var i=[];return i=i.concat(r5({key:"",value:r,valueSpec:n.$root,styleSpec:n,style:r,objectElementValidators:{glyphs:rN,"*":function(){return[]}}})),r.constants&&(i=i.concat(tB({key:"constants",value:r.constants,style:r,styleSpec:n}))),rV(i)}function rV(r){return[].concat(r).sort(function(r,n){return r.line-n.line})}function rq(r){return function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return rV(r.apply(this,n))}}rU.source=rq(rO),rU.light=rq(r6),rU.layer=rq(rR),rU.filter=rq(rz),rU.paintProperty=rq(r4),rU.layoutProperty=rq(rM);var rj=rU,rH=rj.light,rG=rj.paintProperty,rZ=rj.layoutProperty;function rW(r,n){var i=!1;if(n&&n.length)for(var o=0,a=n;o<a.length;o+=1){var s=a[o];r.fire(new t3(Error(s.message))),i=!0}return i}var rX=rK;function rK(r,n,i){var o=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var a=new Int32Array(this.arrayBuffer);r=a[0],n=a[1],i=a[2],this.d=n+2*i;for(var s=0;s<this.d*this.d;s++){var u=a[3+s],c=a[3+s+1];o.push(u===c?null:a.subarray(u,c))}var p=a[3+o.length],h=a[3+o.length+1];this.keys=a.subarray(p,h),this.bboxes=a.subarray(h),this.insert=this._insertReadonly}else{this.d=n+2*i;for(var d=0;d<this.d*this.d;d++)o.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=r,this.padding=i,this.scale=n/r,this.uid=0;var f=i/n*r;this.min=-f,this.max=r+f}rK.prototype.insert=function(r,n,i,o,a){this._forEachCell(n,i,o,a,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(o),this.bboxes.push(a)},rK.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},rK.prototype._insertCell=function(r,n,i,o,a,s){this.cells[a].push(s)},rK.prototype.query=function(r,n,i,o,a){var s=this.min,u=this.max;if(r<=s&&n<=s&&u<=i&&u<=o&&!a)return Array.prototype.slice.call(this.keys);var c=[];return this._forEachCell(r,n,i,o,this._queryCell,c,{},a),c},rK.prototype._queryCell=function(r,n,i,o,a,s,u,c){var p=this.cells[a];if(null!==p)for(var h=this.keys,d=this.bboxes,f=0;f<p.length;f++){var m=p[f];if(void 0===u[m]){var y=4*m;(c?c(d[y+0],d[y+1],d[y+2],d[y+3]):r<=d[y+2]&&n<=d[y+3]&&i>=d[y+0]&&o>=d[y+1])?(u[m]=!0,s.push(h[m])):u[m]=!1}}},rK.prototype._forEachCell=function(r,n,i,o,a,s,u,c){for(var p=this._convertToCellCoord(r),h=this._convertToCellCoord(n),d=this._convertToCellCoord(i),f=this._convertToCellCoord(o),m=p;m<=d;m++)for(var y=h;y<=f;y++){var v=this.d*y+m;if((!c||c(this._convertFromCellCoord(m),this._convertFromCellCoord(y),this._convertFromCellCoord(m+1),this._convertFromCellCoord(y+1)))&&a.call(this,r,n,i,o,v,s,u,c))return}},rK.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},rK.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},rK.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,n=3+this.cells.length+1+1,i=0,o=0;o<this.cells.length;o++)i+=this.cells[o].length;var a=new Int32Array(n+i+this.keys.length+this.bboxes.length);a[0]=this.extent,a[1]=this.n,a[2]=this.padding;for(var s=n,u=0;u<r.length;u++){var c=r[u];a[3+u]=s,a.set(c,s),s+=c.length}return a[3+r.length]=s,a.set(this.keys,s),s+=this.keys.length,a[3+r.length+1]=s,a.set(this.bboxes,s),s+=this.bboxes.length,a.buffer};var rY=self.ImageData,rJ=self.ImageBitmap,rQ={};function r9(r,n,i){void 0===i&&(i={}),Object.defineProperty(n,"_classRegistryKey",{value:r,writeable:!1}),rQ[r]={klass:n,omit:i.omit||[],shallow:i.shallow||[]}}for(var nt in r9("Object",Object),rX.serialize=function(r,n){var i=r.toArrayBuffer();return n&&n.push(i),{buffer:i}},rX.deserialize=function(r){return new rX(r.buffer)},r9("Grid",rX),r9("Color",et),r9("Error",Error),r9("ResolvedImage",ei),r9("StylePropertyFunction",rb),r9("StyleExpression",rv,{omit:["_evaluator"]}),r9("ZoomDependentExpression",r_),r9("ZoomConstantExpression",r$),r9("CompoundExpression",eg,{omit:["_evaluate"]}),e9)e9[nt]._classRegistryKey||r9("Expression_"+nt,e9[nt]);function ne(r){return r&&"undefined"!=typeof ArrayBuffer&&(r instanceof ArrayBuffer||r.constructor&&"ArrayBuffer"===r.constructor.name)}function nr(r){return rJ&&r instanceof rJ}function nn(r,n){if(null==r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(ne(r)||nr(r))return n&&n.push(r),r;if(ArrayBuffer.isView(r)){var i=r;return n&&n.push(i.buffer),i}if(r instanceof rY)return n&&n.push(r.data.buffer),r;if(Array.isArray(r)){for(var o=[],a=0,s=r;a<s.length;a+=1){var u=s[a];o.push(nn(u,n))}return o}if("object"==typeof r){var c=r.constructor,p=c._classRegistryKey;if(!p)throw Error("can't serialize object of unregistered class");var h=c.serialize?c.serialize(r,n):{};if(!c.serialize){for(var d in r)if(r.hasOwnProperty(d)&&!(rQ[p].omit.indexOf(d)>=0)){var f=r[d];h[d]=rQ[p].shallow.indexOf(d)>=0?f:nn(f,n)}r instanceof Error&&(h.message=r.message)}if(h.$name)throw Error("$name property is reserved for worker serialization logic.");return"Object"!==p&&(h.$name=p),h}throw Error("can't serialize object of type "+typeof r)}function ni(r){if(null==r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||ne(r)||nr(r)||ArrayBuffer.isView(r)||r instanceof rY)return r;if(Array.isArray(r))return r.map(ni);if("object"==typeof r){var n=r.$name||"Object",i=rQ[n].klass;if(!i)throw Error("can't deserialize unregistered class "+n);if(i.deserialize)return i.deserialize(r);for(var o=Object.create(i.prototype),a=0,s=Object.keys(r);a<s.length;a+=1){var u=s[a];if("$name"!==u){var c=r[u];o[u]=rQ[n].shallow.indexOf(u)>=0?c:ni(c)}}return o}throw Error("can't deserialize object of type "+typeof r)}var no=function(){this.first=!0};no.prototype.update=function(r,n){var i=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=n),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=i,!0))};var na={"Latin-1 Supplement":function(r){return r>=128&&r<=255},Arabic:function(r){return r>=1536&&r<=1791},"Arabic Supplement":function(r){return r>=1872&&r<=1919},"Arabic Extended-A":function(r){return r>=2208&&r<=2303},"Hangul Jamo":function(r){return r>=4352&&r<=4607},"Unified Canadian Aboriginal Syllabics":function(r){return r>=5120&&r<=5759},Khmer:function(r){return r>=6016&&r<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(r){return r>=6320&&r<=6399},"General Punctuation":function(r){return r>=8192&&r<=8303},"Letterlike Symbols":function(r){return r>=8448&&r<=8527},"Number Forms":function(r){return r>=8528&&r<=8591},"Miscellaneous Technical":function(r){return r>=8960&&r<=9215},"Control Pictures":function(r){return r>=9216&&r<=9279},"Optical Character Recognition":function(r){return r>=9280&&r<=9311},"Enclosed Alphanumerics":function(r){return r>=9312&&r<=9471},"Geometric Shapes":function(r){return r>=9632&&r<=9727},"Miscellaneous Symbols":function(r){return r>=9728&&r<=9983},"Miscellaneous Symbols and Arrows":function(r){return r>=11008&&r<=11263},"CJK Radicals Supplement":function(r){return r>=11904&&r<=12031},"Kangxi Radicals":function(r){return r>=12032&&r<=12255},"Ideographic Description Characters":function(r){return r>=12272&&r<=12287},"CJK Symbols and Punctuation":function(r){return r>=12288&&r<=12351},Hiragana:function(r){return r>=12352&&r<=12447},Katakana:function(r){return r>=12448&&r<=12543},Bopomofo:function(r){return r>=12544&&r<=12591},"Hangul Compatibility Jamo":function(r){return r>=12592&&r<=12687},Kanbun:function(r){return r>=12688&&r<=12703},"Bopomofo Extended":function(r){return r>=12704&&r<=12735},"CJK Strokes":function(r){return r>=12736&&r<=12783},"Katakana Phonetic Extensions":function(r){return r>=12784&&r<=12799},"Enclosed CJK Letters and Months":function(r){return r>=12800&&r<=13055},"CJK Compatibility":function(r){return r>=13056&&r<=13311},"CJK Unified Ideographs Extension A":function(r){return r>=13312&&r<=19903},"Yijing Hexagram Symbols":function(r){return r>=19904&&r<=19967},"CJK Unified Ideographs":function(r){return r>=19968&&r<=40959},"Yi Syllables":function(r){return r>=40960&&r<=42127},"Yi Radicals":function(r){return r>=42128&&r<=42191},"Hangul Jamo Extended-A":function(r){return r>=43360&&r<=43391},"Hangul Syllables":function(r){return r>=44032&&r<=55215},"Hangul Jamo Extended-B":function(r){return r>=55216&&r<=55295},"Private Use Area":function(r){return r>=57344&&r<=63743},"CJK Compatibility Ideographs":function(r){return r>=63744&&r<=64255},"Arabic Presentation Forms-A":function(r){return r>=64336&&r<=65023},"Vertical Forms":function(r){return r>=65040&&r<=65055},"CJK Compatibility Forms":function(r){return r>=65072&&r<=65103},"Small Form Variants":function(r){return r>=65104&&r<=65135},"Arabic Presentation Forms-B":function(r){return r>=65136&&r<=65279},"Halfwidth and Fullwidth Forms":function(r){return r>=65280&&r<=65519}};function ns(r){for(var n=0,i=r;n<i.length;n+=1)if(nu(i[n].charCodeAt(0)))return!0;return!1}function nl(r){return!na.Arabic(r)&&!na["Arabic Supplement"](r)&&!na["Arabic Extended-A"](r)&&!na["Arabic Presentation Forms-A"](r)&&!na["Arabic Presentation Forms-B"](r)}function nu(r){return 746===r||747===r||!(r<4352)&&(!!na["Bopomofo Extended"](r)||!!na.Bopomofo(r)||!(!na["CJK Compatibility Forms"](r)||r>=65097&&r<=65103)||!!na["CJK Compatibility Ideographs"](r)||!!na["CJK Compatibility"](r)||!!na["CJK Radicals Supplement"](r)||!!na["CJK Strokes"](r)||!(!na["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||12336===r)||!!na["CJK Unified Ideographs Extension A"](r)||!!na["CJK Unified Ideographs"](r)||!!na["Enclosed CJK Letters and Months"](r)||!!na["Hangul Compatibility Jamo"](r)||!!na["Hangul Jamo Extended-A"](r)||!!na["Hangul Jamo Extended-B"](r)||!!na["Hangul Jamo"](r)||!!na["Hangul Syllables"](r)||!!na.Hiragana(r)||!!na["Ideographic Description Characters"](r)||!!na.Kanbun(r)||!!na["Kangxi Radicals"](r)||!!na["Katakana Phonetic Extensions"](r)||!(!na.Katakana(r)||12540===r)||!(!na["Halfwidth and Fullwidth Forms"](r)||65288===r||65289===r||65293===r||r>=65306&&r<=65310||65339===r||65341===r||65343===r||r>=65371&&r<=65503||65507===r||r>=65512&&r<=65519)||!(!na["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||!!na["Unified Canadian Aboriginal Syllabics"](r)||!!na["Unified Canadian Aboriginal Syllabics Extended"](r)||!!na["Vertical Forms"](r)||!!na["Yijing Hexagram Symbols"](r)||!!na["Yi Syllables"](r)||!!na["Yi Radicals"](r))}function nc(r){var n;return!(nu(r)||(n=r,!(!na["Latin-1 Supplement"](n)||167!==n&&169!==n&&174!==n&&177!==n&&188!==n&&189!==n&&190!==n&&215!==n&&247!==n)||!(!na["General Punctuation"](n)||8214!==n&&8224!==n&&8225!==n&&8240!==n&&8241!==n&&8251!==n&&8252!==n&&8258!==n&&8263!==n&&8264!==n&&8265!==n&&8273!==n)||na["Letterlike Symbols"](n)||na["Number Forms"](n)||!(!na["Miscellaneous Technical"](n)||!(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||9003===n||n>=9085&&n<=9114||n>=9150&&n<=9165||9167===n||n>=9169&&n<=9179||n>=9186&&n<=9215))||!(!na["Control Pictures"](n)||9251===n)||na["Optical Character Recognition"](n)||na["Enclosed Alphanumerics"](n)||na["Geometric Shapes"](n)||!(!na["Miscellaneous Symbols"](n)||n>=9754&&n<=9759)||!(!na["Miscellaneous Symbols and Arrows"](n)||!(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243))||na["CJK Symbols and Punctuation"](n)||na.Katakana(n)||na["Private Use Area"](n)||na["CJK Compatibility Forms"](n)||na["Small Form Variants"](n)||na["Halfwidth and Fullwidth Forms"](n)||8734===n||8756===n||8757===n||n>=9984&&n<=10087||n>=10102&&n<=10131||65532===n||65533===n))}function np(r){return r>=1424&&r<=2303||na["Arabic Presentation Forms-A"](r)||na["Arabic Presentation Forms-B"](r)}function nh(r,n){return!(!n&&np(r))&&!(r>=2304&&r<=3583||r>=3840&&r<=4255||na.Khmer(r))}function nd(r){for(var n=0,i=r;n<i.length;n+=1)if(np(i[n].charCodeAt(0)))return!0;return!1}var nf="deferred",nm="loading",ny="loaded",nv=null,ng="unavailable",n8=null,n$=function(r){nv&&nv(r)};function n_(){nx.fire(new tz("pluginStateChange",{pluginStatus:ng,pluginURL:n8}))}var nx=new t4,nb=function(){return ng},nw=function(){if(ng!==nf||!n8)throw Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ng=nm,n_(),n8&&t2({url:n8},function(r){r?n$(r):(ng=ny,n_())})},n0={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return ng===ny||null!=n0.applyArabicShaping},isLoading:function(){return ng===nm},setState:function(r){ng=r.pluginStatus,n8=r.pluginURL},isParsed:function(){return null!=n0.applyArabicShaping&&null!=n0.processBidirectionalText&&null!=n0.processStyledBidirectionalText},getPluginURL:function(){return n8}},nE=function(r,n){this.zoom=r,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new no,this.transition={})};nE.prototype.isSupportedScript=function(r){return function(r,n){for(var i=0,o=r;i<o.length;i+=1)if(!nh(o[i].charCodeAt(0),n))return!1;return!0}(r,n0.isLoaded())},nE.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},nE.prototype.getCrossfadeParameters=function(){var r=this.zoom,n=r-Math.floor(r),i=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*n}};var nT=function(r,n){this.property=r,this.value=n,this.expression=function(r,n){if(rc(r))return new rb(r,n);if(rg(r)){var i=rx(r,n);if("error"===i.result)throw Error(i.value.map(function(r){return r.key+": "+r.message}).join(", "));return i.value}var o=r;return"string"==typeof r&&"color"===n.type&&(o=et.parse(r)),{kind:"constant",evaluate:function(){return o}}}(void 0===n?r.specification.default:n,r.specification)};nT.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},nT.prototype.possiblyEvaluate=function(r,n){return this.property.possiblyEvaluate(this,r,n)};var nS=function(r){this.property=r,this.value=new nT(r,void 0)};nS.prototype.transitioned=function(r,n){return new nI(this.property,this.value,n,y({},r.transition,this.transition),r.now)},nS.prototype.untransitioned=function(){return new nI(this.property,this.value,null,{},0)};var nC=function(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)};nC.prototype.getValue=function(r){return T(this._values[r].value.value)},nC.prototype.setValue=function(r,n){this._values.hasOwnProperty(r)||(this._values[r]=new nS(this._values[r].property)),this._values[r].value=new nT(this._values[r].property,null===n?void 0:T(n))},nC.prototype.getTransition=function(r){return T(this._values[r].transition)},nC.prototype.setTransition=function(r,n){this._values.hasOwnProperty(r)||(this._values[r]=new nS(this._values[r].property)),this._values[r].transition=T(n)||void 0},nC.prototype.serialize=function(){for(var r={},n=0,i=Object.keys(this._values);n<i.length;n+=1){var o=i[n],a=this.getValue(o);void 0!==a&&(r[o]=a);var s=this.getTransition(o);void 0!==s&&(r[o+"-transition"]=s)}return r},nC.prototype.transitioned=function(r,n){for(var i=new nk(this._properties),o=0,a=Object.keys(this._values);o<a.length;o+=1){var s=a[o];i._values[s]=this._values[s].transitioned(r,n._values[s])}return i},nC.prototype.untransitioned=function(){for(var r=new nk(this._properties),n=0,i=Object.keys(this._values);n<i.length;n+=1){var o=i[n];r._values[o]=this._values[o].untransitioned()}return r};var nI=function(r,n,i,o,a){this.property=r,this.value=n,this.begin=a+o.delay||0,this.end=this.begin+o.duration||0,r.specification.transition&&(o.delay||o.duration)&&(this.prior=i)};nI.prototype.possiblyEvaluate=function(r,n){var i=r.now||0,o=this.value.possiblyEvaluate(r,n),a=this.prior;if(a){if(i>this.end||this.value.isDataDriven())return this.prior=null,o;if(i<this.begin)return a.possiblyEvaluate(r,n);var s=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(r,n),o,function(r){if(r<=0)return 0;if(r>=1)return 1;var n=r*r,i=n*r;return 4*(r<.5?i:3*(r-n)+i-.75)}(s))}return o};var nk=function(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)};nk.prototype.possiblyEvaluate=function(r,n){for(var i=new nA(this._properties),o=0,a=Object.keys(this._values);o<a.length;o+=1){var s=a[o];i._values[s]=this._values[s].possiblyEvaluate(r,n)}return i},nk.prototype.hasTransition=function(){for(var r=0,n=Object.keys(this._values);r<n.length;r+=1){var i=n[r];if(this._values[i].prior)return!0}return!1};var n1=function(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)};n1.prototype.getValue=function(r){return T(this._values[r].value)},n1.prototype.setValue=function(r,n){this._values[r]=new nT(this._values[r].property,null===n?void 0:T(n))},n1.prototype.serialize=function(){for(var r={},n=0,i=Object.keys(this._values);n<i.length;n+=1){var o=i[n],a=this.getValue(o);void 0!==a&&(r[o]=a)}return r},n1.prototype.possiblyEvaluate=function(r,n){for(var i=new nA(this._properties),o=0,a=Object.keys(this._values);o<a.length;o+=1){var s=a[o];i._values[s]=this._values[s].possiblyEvaluate(r,n)}return i};var n2=function(r,n,i){this.property=r,this.value=n,this.parameters=i};n2.prototype.isConstant=function(){return"constant"===this.value.kind},n2.prototype.constantOr=function(r){return"constant"===this.value.kind?this.value.value:r},n2.prototype.evaluate=function(r,n,i){return this.property.evaluate(this.value,this.parameters,r,n,i)};var nA=function(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)};nA.prototype.get=function(r){return this._values[r]};var nP=function(r){this.specification=r};nP.prototype.possiblyEvaluate=function(r,n){return r.expression.evaluate(n)},nP.prototype.interpolate=function(r,n,i){var o=eS[this.specification.type];return o?o(r,n,i):r};var nL=function(r,n){this.specification=r,this.overrides=n};nL.prototype.possiblyEvaluate=function(r,n,i){return"constant"===r.expression.kind||"camera"===r.expression.kind?new n2(this,{kind:"constant",value:r.expression.evaluate(n,null,{},i)},n):new n2(this,r.expression,n)},nL.prototype.interpolate=function(r,n,i){if("constant"!==r.value.kind||"constant"!==n.value.kind)return r;if(void 0===r.value.value||void 0===n.value.value)return new n2(this,{kind:"constant",value:void 0},r.parameters);var o=eS[this.specification.type];return o?new n2(this,{kind:"constant",value:o(r.value.value,n.value.value,i)},r.parameters):r},nL.prototype.evaluate=function(r,n,i,o,a){return"constant"===r.kind?r.value:r.evaluate(n,i,o,a)};var nD=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.possiblyEvaluate=function(r,n,i){if(void 0===r.value)return new n2(this,{kind:"constant",value:void 0},n);if("constant"===r.expression.kind){var o=r.expression.evaluate(n,null,{},i),a="resolvedImage"===r.property.specification.type&&"string"!=typeof o?o.name:o,s=this._calculate(a,a,a,n);return new n2(this,{kind:"constant",value:s},n)}if("camera"===r.expression.kind){var u=this._calculate(r.expression.evaluate({zoom:n.zoom-1}),r.expression.evaluate({zoom:n.zoom}),r.expression.evaluate({zoom:n.zoom+1}),n);return new n2(this,{kind:"constant",value:u},n)}return new n2(this,r.expression,n)},n.prototype.evaluate=function(r,n,i,o,a){if("source"===r.kind){var s=r.evaluate(n,i,o,a);return this._calculate(s,s,s,n)}return"composite"===r.kind?this._calculate(r.evaluate({zoom:Math.floor(n.zoom)-1},i,o),r.evaluate({zoom:Math.floor(n.zoom)},i,o),r.evaluate({zoom:Math.floor(n.zoom)+1},i,o),n):r.value},n.prototype._calculate=function(r,n,i,o){return o.zoom>o.zoomHistory.lastIntegerZoom?{from:r,to:n}:{from:i,to:n}},n.prototype.interpolate=function(r){return r},n}(nL),nz=function(r){this.specification=r};nz.prototype.possiblyEvaluate=function(r,n,i){if(void 0!==r.value){if("constant"===r.expression.kind){var o=r.expression.evaluate(n,null,{},i);return this._calculate(o,o,o,n)}return this._calculate(r.expression.evaluate(new nE(Math.floor(n.zoom-1),n)),r.expression.evaluate(new nE(Math.floor(n.zoom),n)),r.expression.evaluate(new nE(Math.floor(n.zoom+1),n)),n)}},nz.prototype._calculate=function(r,n,i,o){return o.zoom>o.zoomHistory.lastIntegerZoom?{from:r,to:n}:{from:i,to:n}},nz.prototype.interpolate=function(r){return r};var n3=function(r){this.specification=r};n3.prototype.possiblyEvaluate=function(r,n,i){return!!r.expression.evaluate(n,null,{},i)},n3.prototype.interpolate=function(){return!1};var n4=function(r){for(var n in this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],r){var i=r[n];i.specification.overridable&&this.overridableProperties.push(n);var o=this.defaultPropertyValues[n]=new nT(i,void 0),a=this.defaultTransitionablePropertyValues[n]=new nS(i);this.defaultTransitioningPropertyValues[n]=a.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=o.possiblyEvaluate({})}};r9("DataDrivenProperty",nL),r9("DataConstantProperty",nP),r9("CrossFadedDataDrivenProperty",nD),r9("CrossFadedProperty",nz),r9("ColorRampProperty",n3);var nM=function(r){function n(n,i){if(r.call(this),this.id=n.id,this.type=n.type,this._featureFilter=function(){return!0},"custom"!==n.type&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,"background"!==n.type&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),i.layout&&(this._unevaluatedLayout=new n1(i.layout)),i.paint)){for(var o in this._transitionablePaint=new nC(i.paint),n.paint)this.setPaintProperty(o,n.paint[o],{validate:!1});for(var a in n.layout)this.setLayoutProperty(a,n.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},n.prototype.getLayoutProperty=function(r){return"visibility"===r?this.visibility:this._unevaluatedLayout.getValue(r)},n.prototype.setLayoutProperty=function(r,n,i){if(void 0===i&&(i={}),null!=n){var o="layers."+this.id+".layout."+r;if(this._validate(rZ,o,r,n,i))return}"visibility"!==r?this._unevaluatedLayout.setValue(r,n):this.visibility=n},n.prototype.getPaintProperty=function(r){return b(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)},n.prototype.setPaintProperty=function(r,n,i){if(void 0===i&&(i={}),null!=n){var o="layers."+this.id+".paint."+r;if(this._validate(rG,o,r,n,i))return!1}if(b(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-11),n||void 0),!1;var a=this._transitionablePaint._values[r],s="cross-faded-data-driven"===a.property.specification["property-type"],u=a.value.isDataDriven(),c=a.value;this._transitionablePaint.setValue(r,n),this._handleSpecialPaintPropertyUpdate(r);var p=this._transitionablePaint._values[r].value;return p.isDataDriven()||u||s||this._handleOverridablePaintPropertyUpdate(r,c,p)},n.prototype._handleSpecialPaintPropertyUpdate=function(r){},n.prototype._handleOverridablePaintPropertyUpdate=function(r,n,i){return!1},n.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||"none"===this.visibility},n.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},n.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},n.prototype.recalculate=function(r,n){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,n)),this.paint=this._transitioningPaint.possiblyEvaluate(r,n)},n.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),E(r,function(r,n){return!(void 0===r||"layout"===n&&!Object.keys(r).length||"paint"===n&&!Object.keys(r).length)})},n.prototype._validate=function(r,n,i,o,a){return void 0===a&&(a={}),(!a||!1!==a.validate)&&rW(this,r.call(rj,{key:n,layerType:this.type,objectKey:i,value:o,styleSpec:tM,style:{glyphs:!0,sprite:!0}}))},n.prototype.is3D=function(){return!1},n.prototype.isTileClipped=function(){return!1},n.prototype.hasOffscreenPass=function(){return!1},n.prototype.resize=function(){},n.prototype.isStateDependent=function(){for(var r in this.paint._values){var n=this.paint.get(r);if(n instanceof n2&&ra(n.property.specification)&&("source"===n.value.kind||"composite"===n.value.kind)&&n.value.isStateDependent)return!0}return!1},n}(t4),nR={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},nB=function(r,n){this._structArray=r,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},nF=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function nO(r,n){void 0===n&&(n=1);var i=0,o=0;return{members:r.map(function(r){var a,s=nR[a=r.type].BYTES_PER_ELEMENT,u=i=n6(i,Math.max(n,s)),c=r.components||1;return o=Math.max(o,s),i+=s*c,{name:r.name,type:r.type,components:c,offset:u}}),size:n6(i,Math.max(o,n)),alignment:n}}function n6(r,n){return Math.ceil(r/n)*n}nF.serialize=function(r,n){return r._trim(),n&&(r.isTransferred=!0,n.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}},nF.deserialize=function(r){var n=Object.create(this.prototype);return n.arrayBuffer=r.arrayBuffer,n.length=r.length,n.capacity=r.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n},nF.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},nF.prototype.clear=function(){this.length=0},nF.prototype.resize=function(r){this.reserve(r),this.length=r},nF.prototype.reserve=function(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}},nF.prototype._refreshViews=function(){throw Error("_refreshViews() must be implemented by each concrete StructArray layout")};var n7=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n){var i=this.length;return this.resize(i+1),this.emplace(i,r,n)},n.prototype.emplace=function(r,n,i){var o=2*r;return this.int16[o+0]=n,this.int16[o+1]=i,r},n}(nF);n7.prototype.bytesPerElement=4,r9("StructArrayLayout2i4",n7);var n5=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,r,n,i,o)},n.prototype.emplace=function(r,n,i,o,a){var s=4*r;return this.int16[s+0]=n,this.int16[s+1]=i,this.int16[s+2]=o,this.int16[s+3]=a,r},n}(nF);n5.prototype.bytesPerElement=8,r9("StructArrayLayout4i8",n5);var nN=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,o,a,s){var u=this.length;return this.resize(u+1),this.emplace(u,r,n,i,o,a,s)},n.prototype.emplace=function(r,n,i,o,a,s,u){var c=6*r;return this.int16[c+0]=n,this.int16[c+1]=i,this.int16[c+2]=o,this.int16[c+3]=a,this.int16[c+4]=s,this.int16[c+5]=u,r},n}(nF);nN.prototype.bytesPerElement=12,r9("StructArrayLayout2i4i12",nN);var nU=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,o,a,s){var u=this.length;return this.resize(u+1),this.emplace(u,r,n,i,o,a,s)},n.prototype.emplace=function(r,n,i,o,a,s,u){var c=4*r,p=8*r;return this.int16[c+0]=n,this.int16[c+1]=i,this.uint8[p+4]=o,this.uint8[p+5]=a,this.uint8[p+6]=s,this.uint8[p+7]=u,r},n}(nF);nU.prototype.bytesPerElement=8,r9("StructArrayLayout2i4ub8",nU);var nV=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,o,a,s,u,c){var p=this.length;return this.resize(p+1),this.emplace(p,r,n,i,o,a,s,u,c)},n.prototype.emplace=function(r,n,i,o,a,s,u,c,p){var h=8*r;return this.uint16[h+0]=n,this.uint16[h+1]=i,this.uint16[h+2]=o,this.uint16[h+3]=a,this.uint16[h+4]=s,this.uint16[h+5]=u,this.uint16[h+6]=c,this.uint16[h+7]=p,r},n}(nF);nV.prototype.bytesPerElement=16,r9("StructArrayLayout8ui16",nV);var nq=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,o,a,s,u,c,p,h,d,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,n,i,o,a,s,u,c,p,h,d,f)},n.prototype.emplace=function(r,n,i,o,a,s,u,c,p,h,d,f,m){var y=12*r;return this.int16[y+0]=n,this.int16[y+1]=i,this.int16[y+2]=o,this.int16[y+3]=a,this.uint16[y+4]=s,this.uint16[y+5]=u,this.uint16[y+6]=c,this.uint16[y+7]=p,this.int16[y+8]=h,this.int16[y+9]=d,this.int16[y+10]=f,this.int16[y+11]=m,r},n}(nF);nq.prototype.bytesPerElement=24,r9("StructArrayLayout4i4ui4i24",nq);var nj=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i){var o=this.length;return this.resize(o+1),this.emplace(o,r,n,i)},n.prototype.emplace=function(r,n,i,o){var a=3*r;return this.float32[a+0]=n,this.float32[a+1]=i,this.float32[a+2]=o,r},n}(nF);nj.prototype.bytesPerElement=12,r9("StructArrayLayout3f12",nj);var nH=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r){var n=this.length;return this.resize(n+1),this.emplace(n,r)},n.prototype.emplace=function(r,n){var i=1*r;return this.uint32[i+0]=n,r},n}(nF);nH.prototype.bytesPerElement=4,r9("StructArrayLayout1ul4",nH);var nG=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,o,a,s,u,c,p,h,d){var f=this.length;return this.resize(f+1),this.emplace(f,r,n,i,o,a,s,u,c,p,h,d)},n.prototype.emplace=function(r,n,i,o,a,s,u,c,p,h,d,f){var m=12*r,y=6*r;return this.int16[m+0]=n,this.int16[m+1]=i,this.int16[m+2]=o,this.int16[m+3]=a,this.int16[m+4]=s,this.int16[m+5]=u,this.uint32[y+3]=c,this.uint16[m+8]=p,this.uint16[m+9]=h,this.int16[m+10]=d,this.int16[m+11]=f,r},n}(nF);nG.prototype.bytesPerElement=24,r9("StructArrayLayout6i1ul2ui2i24",nG);var nZ=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,o,a,s){var u=this.length;return this.resize(u+1),this.emplace(u,r,n,i,o,a,s)},n.prototype.emplace=function(r,n,i,o,a,s,u){var c=6*r;return this.int16[c+0]=n,this.int16[c+1]=i,this.int16[c+2]=o,this.int16[c+3]=a,this.int16[c+4]=s,this.int16[c+5]=u,r},n}(nF);nZ.prototype.bytesPerElement=12,r9("StructArrayLayout2i2i2i12",nZ);var nW=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,r,n,i,o)},n.prototype.emplace=function(r,n,i,o,a){var s=12*r,u=3*r;return this.uint8[s+0]=n,this.uint8[s+1]=i,this.float32[u+1]=o,this.float32[u+2]=a,r},n}(nF);nW.prototype.bytesPerElement=12,r9("StructArrayLayout2ub2f12",nW);var nX=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,o,a,s,u,c,p,h,d,f,m,y,v,g,$){var _=this.length;return this.resize(_+1),this.emplace(_,r,n,i,o,a,s,u,c,p,h,d,f,m,y,v,g,$)},n.prototype.emplace=function(r,n,i,o,a,s,u,c,p,h,d,f,m,y,v,g,$,_){var x=24*r,b=12*r,w=48*r;return this.int16[x+0]=n,this.int16[x+1]=i,this.uint16[x+2]=o,this.uint16[x+3]=a,this.uint32[b+2]=s,this.uint32[b+3]=u,this.uint32[b+4]=c,this.uint16[x+10]=p,this.uint16[x+11]=h,this.uint16[x+12]=d,this.float32[b+7]=f,this.float32[b+8]=m,this.uint8[w+36]=y,this.uint8[w+37]=v,this.uint8[w+38]=g,this.uint32[b+10]=$,this.int16[x+22]=_,r},n}(nF);nX.prototype.bytesPerElement=48,r9("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",nX);var nK=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,o,a,s,u,c,p,h,d,f,m,y,v,g,$,_,x,b,w,E,T,S,C,I){var k=this.length;return this.resize(k+1),this.emplace(k,r,n,i,o,a,s,u,c,p,h,d,f,m,y,v,g,$,_,x,b,w,E,T,S,C,I)},n.prototype.emplace=function(r,n,i,o,a,s,u,c,p,h,d,f,m,y,v,g,$,_,x,b,w,E,T,S,C,I,k){var A=30*r,P=15*r;return this.int16[A+0]=n,this.int16[A+1]=i,this.int16[A+2]=o,this.int16[A+3]=a,this.int16[A+4]=s,this.int16[A+5]=u,this.int16[A+6]=c,this.int16[A+7]=p,this.uint16[A+8]=h,this.uint16[A+9]=d,this.uint16[A+10]=f,this.uint16[A+11]=m,this.uint16[A+12]=y,this.uint16[A+13]=v,this.uint16[A+14]=g,this.uint16[A+15]=$,this.uint16[A+16]=_,this.uint16[A+17]=x,this.uint16[A+18]=b,this.uint16[A+19]=w,this.uint16[A+20]=E,this.uint16[A+21]=T,this.uint32[P+11]=S,this.float32[P+12]=C,this.float32[P+13]=I,this.float32[P+14]=k,r},n}(nF);nK.prototype.bytesPerElement=60,r9("StructArrayLayout8i14ui1ul3f60",nK);var nY=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r){var n=this.length;return this.resize(n+1),this.emplace(n,r)},n.prototype.emplace=function(r,n){var i=1*r;return this.float32[i+0]=n,r},n}(nF);nY.prototype.bytesPerElement=4,r9("StructArrayLayout1f4",nY);var nJ=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i){var o=this.length;return this.resize(o+1),this.emplace(o,r,n,i)},n.prototype.emplace=function(r,n,i,o){var a=3*r;return this.int16[a+0]=n,this.int16[a+1]=i,this.int16[a+2]=o,r},n}(nF);nJ.prototype.bytesPerElement=6,r9("StructArrayLayout3i6",nJ);var nQ=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i){var o=this.length;return this.resize(o+1),this.emplace(o,r,n,i)},n.prototype.emplace=function(r,n,i,o){var a=2*r,s=4*r;return this.uint32[a+0]=n,this.uint16[s+2]=i,this.uint16[s+3]=o,r},n}(nF);nQ.prototype.bytesPerElement=8,r9("StructArrayLayout1ul2ui8",nQ);var n9=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i){var o=this.length;return this.resize(o+1),this.emplace(o,r,n,i)},n.prototype.emplace=function(r,n,i,o){var a=3*r;return this.uint16[a+0]=n,this.uint16[a+1]=i,this.uint16[a+2]=o,r},n}(nF);n9.prototype.bytesPerElement=6,r9("StructArrayLayout3ui6",n9);var it=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n){var i=this.length;return this.resize(i+1),this.emplace(i,r,n)},n.prototype.emplace=function(r,n,i){var o=2*r;return this.uint16[o+0]=n,this.uint16[o+1]=i,r},n}(nF);it.prototype.bytesPerElement=4,r9("StructArrayLayout2ui4",it);var ie=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r){var n=this.length;return this.resize(n+1),this.emplace(n,r)},n.prototype.emplace=function(r,n){var i=1*r;return this.uint16[i+0]=n,r},n}(nF);ie.prototype.bytesPerElement=2,r9("StructArrayLayout1ui2",ie);var ir=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n){var i=this.length;return this.resize(i+1),this.emplace(i,r,n)},n.prototype.emplace=function(r,n,i){var o=2*r;return this.float32[o+0]=n,this.float32[o+1]=i,r},n}(nF);ir.prototype.bytesPerElement=8,r9("StructArrayLayout2f8",ir);var ii=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,r,n,i,o)},n.prototype.emplace=function(r,n,i,o,a){var s=4*r;return this.float32[s+0]=n,this.float32[s+1]=i,this.float32[s+2]=o,this.float32[s+3]=a,r},n}(nF);ii.prototype.bytesPerElement=16,r9("StructArrayLayout4f16",ii);var io=function(r){function n(){r.apply(this,arguments)}r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointX.set=function(r){this._structArray.int16[this._pos2+0]=r},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.anchorPointY.set=function(r){this._structArray.int16[this._pos2+1]=r},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.x1.set=function(r){this._structArray.int16[this._pos2+2]=r},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.y1.set=function(r){this._structArray.int16[this._pos2+3]=r},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.x2.set=function(r){this._structArray.int16[this._pos2+4]=r},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.y2.set=function(r){this._structArray.int16[this._pos2+5]=r},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.featureIndex.set=function(r){this._structArray.uint32[this._pos4+3]=r},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.sourceLayerIndex.set=function(r){this._structArray.uint16[this._pos2+8]=r},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.bucketIndex.set=function(r){this._structArray.uint16[this._pos2+9]=r},i.radius.get=function(){return this._structArray.int16[this._pos2+10]},i.radius.set=function(r){this._structArray.int16[this._pos2+10]=r},i.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},i.signedDistanceFromAnchor.set=function(r){this._structArray.int16[this._pos2+11]=r},i.anchorPoint.get=function(){return new c(this.anchorPointX,this.anchorPointY)},Object.defineProperties(n.prototype,i),n}(nB);io.prototype.size=24;var ia=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.get=function(r){return new io(this,r)},n}(nG);r9("CollisionBoxArray",ia);var is=function(r){function n(){r.apply(this,arguments)}r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorX.set=function(r){this._structArray.int16[this._pos2+0]=r},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.anchorY.set=function(r){this._structArray.int16[this._pos2+1]=r},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.glyphStartIndex.set=function(r){this._structArray.uint16[this._pos2+2]=r},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.numGlyphs.set=function(r){this._structArray.uint16[this._pos2+3]=r},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.vertexStartIndex.set=function(r){this._structArray.uint32[this._pos4+2]=r},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineStartIndex.set=function(r){this._structArray.uint32[this._pos4+3]=r},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.lineLength.set=function(r){this._structArray.uint32[this._pos4+4]=r},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.segment.set=function(r){this._structArray.uint16[this._pos2+10]=r},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.lowerSize.set=function(r){this._structArray.uint16[this._pos2+11]=r},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.upperSize.set=function(r){this._structArray.uint16[this._pos2+12]=r},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetX.set=function(r){this._structArray.float32[this._pos4+7]=r},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.lineOffsetY.set=function(r){this._structArray.float32[this._pos4+8]=r},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.writingMode.set=function(r){this._structArray.uint8[this._pos1+36]=r},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(r){this._structArray.uint8[this._pos1+37]=r},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(r){this._structArray.uint8[this._pos1+38]=r},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(r){this._structArray.uint32[this._pos4+10]=r},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},i.associatedIconIndex.set=function(r){this._structArray.int16[this._pos2+22]=r},Object.defineProperties(n.prototype,i),n}(nB);is.prototype.size=48;var il=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.get=function(r){return new is(this,r)},n}(nX);r9("PlacedSymbolArray",il);var iu=function(r){function n(){r.apply(this,arguments)}r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorX.set=function(r){this._structArray.int16[this._pos2+0]=r},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.anchorY.set=function(r){this._structArray.int16[this._pos2+1]=r},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.rightJustifiedTextSymbolIndex.set=function(r){this._structArray.int16[this._pos2+2]=r},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.centerJustifiedTextSymbolIndex.set=function(r){this._structArray.int16[this._pos2+3]=r},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.leftJustifiedTextSymbolIndex.set=function(r){this._structArray.int16[this._pos2+4]=r},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.verticalPlacedTextSymbolIndex.set=function(r){this._structArray.int16[this._pos2+5]=r},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.placedIconSymbolIndex.set=function(r){this._structArray.int16[this._pos2+6]=r},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.verticalPlacedIconSymbolIndex.set=function(r){this._structArray.int16[this._pos2+7]=r},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.key.set=function(r){this._structArray.uint16[this._pos2+8]=r},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxStartIndex.set=function(r){this._structArray.uint16[this._pos2+9]=r},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.textBoxEndIndex.set=function(r){this._structArray.uint16[this._pos2+10]=r},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxStartIndex.set=function(r){this._structArray.uint16[this._pos2+11]=r},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.verticalTextBoxEndIndex.set=function(r){this._structArray.uint16[this._pos2+12]=r},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxStartIndex.set=function(r){this._structArray.uint16[this._pos2+13]=r},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.iconBoxEndIndex.set=function(r){this._structArray.uint16[this._pos2+14]=r},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxStartIndex.set=function(r){this._structArray.uint16[this._pos2+15]=r},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.verticalIconBoxEndIndex.set=function(r){this._structArray.uint16[this._pos2+16]=r},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.featureIndex.set=function(r){this._structArray.uint16[this._pos2+17]=r},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numHorizontalGlyphVertices.set=function(r){this._structArray.uint16[this._pos2+18]=r},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numVerticalGlyphVertices.set=function(r){this._structArray.uint16[this._pos2+19]=r},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numIconVertices.set=function(r){this._structArray.uint16[this._pos2+20]=r},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.numVerticalIconVertices.set=function(r){this._structArray.uint16[this._pos2+21]=r},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+11]},i.crossTileID.set=function(r){this._structArray.uint32[this._pos4+11]=r},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+12]},i.textBoxScale.set=function(r){this._structArray.float32[this._pos4+12]=r},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.set=function(r){this._structArray.float32[this._pos4+13]=r},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.set=function(r){this._structArray.float32[this._pos4+14]=r},Object.defineProperties(n.prototype,i),n}(nB);iu.prototype.size=60;var ic=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.get=function(r){return new iu(this,r)},n}(nK);r9("SymbolInstanceArray",ic);var ip=function(r){function n(){r.apply(this,arguments)}r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n;var i={offsetX:{configurable:!0}};return i.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},i.offsetX.set=function(r){this._structArray.float32[this._pos4+0]=r},Object.defineProperties(n.prototype,i),n}(nB);ip.prototype.size=4;var ih=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getoffsetX=function(r){return this.float32[1*r+0]},n.prototype.get=function(r){return new ip(this,r)},n}(nY);r9("GlyphOffsetArray",ih);var id=function(r){function n(){r.apply(this,arguments)}r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n;var i={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return i.x.get=function(){return this._structArray.int16[this._pos2+0]},i.x.set=function(r){this._structArray.int16[this._pos2+0]=r},i.y.get=function(){return this._structArray.int16[this._pos2+1]},i.y.set=function(r){this._structArray.int16[this._pos2+1]=r},i.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},i.tileUnitDistanceFromAnchor.set=function(r){this._structArray.int16[this._pos2+2]=r},Object.defineProperties(n.prototype,i),n}(nB);id.prototype.size=6;var im=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getx=function(r){return this.int16[3*r+0]},n.prototype.gety=function(r){return this.int16[3*r+1]},n.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},n.prototype.get=function(r){return new id(this,r)},n}(nJ);r9("SymbolLineVertexArray",im);var iy=function(r){function n(){r.apply(this,arguments)}r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.featureIndex.set=function(r){this._structArray.uint32[this._pos4+0]=r},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.sourceLayerIndex.set=function(r){this._structArray.uint16[this._pos2+2]=r},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},i.bucketIndex.set=function(r){this._structArray.uint16[this._pos2+3]=r},Object.defineProperties(n.prototype,i),n}(nB);iy.prototype.size=8;var iv=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.get=function(r){return new iy(this,r)},n}(nQ);r9("FeatureIndexArray",iv);var ig=nO([{name:"a_pos",components:2,type:"Int16"}],4).members,i8=function(r){void 0===r&&(r=[]),this.segments=r};function i$(r,n){return 256*(r=f(Math.floor(r),0,255))+(n=f(Math.floor(n),0,255))}i8.prototype.prepareSegment=function(r,n,i,o){var a=this.segments[this.segments.length-1];return r>i8.MAX_VERTEX_ARRAY_LENGTH&&C("Max vertices per segment is "+i8.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+r),(!a||a.vertexLength+r>i8.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==o)&&(a={vertexOffset:n.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==o&&(a.sortKey=o),this.segments.push(a)),a},i8.prototype.get=function(){return this.segments},i8.prototype.destroy=function(){for(var r=0,n=this.segments;r<n.length;r+=1){var i=n[r];for(var o in i.vaos)i.vaos[o].destroy()}},i8.simpleSegment=function(r,n,i,o){return new i8([{vertexOffset:r,primitiveOffset:n,vertexLength:i,primitiveLength:o,vaos:{},sortKey:0}])},i8.MAX_VERTEX_ARRAY_LENGTH=65535,r9("SegmentVector",i8);var i_=n(function(r){r.exports=function(r,n){var i,o,a,s,u,c,p,h;for(i=3&r.length,o=r.length-i,a=n,u=3432918353,c=461845907,h=0;h<o;)p=255&r.charCodeAt(h)|(255&r.charCodeAt(++h))<<8|(255&r.charCodeAt(++h))<<16|(255&r.charCodeAt(++h))<<24,++h,a=27492+(65535&(s=5*(65535&(a=(a^=p=(65535&(p=(p=(65535&p)*u+(((p>>>16)*u&65535)<<16)&4294967295)<<15|p>>>17))*c+(((p>>>16)*c&65535)<<16)&4294967295)<<13|a>>>19))+((5*(a>>>16)&65535)<<16)&4294967295))+((58964+(s>>>16)&65535)<<16);switch(p=0,i){case 3:p^=(255&r.charCodeAt(h+2))<<16;case 2:p^=(255&r.charCodeAt(h+1))<<8;case 1:a^=p=(65535&(p=(p=(65535&(p^=255&r.charCodeAt(h)))*u+(((p>>>16)*u&65535)<<16)&4294967295)<<15|p>>>17))*c+(((p>>>16)*c&65535)<<16)&4294967295}return a^=r.length,a=2246822507*(65535&(a^=a>>>16))+((2246822507*(a>>>16)&65535)<<16)&4294967295,a=3266489909*(65535&(a^=a>>>13))+((3266489909*(a>>>16)&65535)<<16)&4294967295,(a^=a>>>16)>>>0}}),ix=n(function(r){r.exports=function(r,n){for(var i,o=r.length,a=n^o,s=0;o>=4;)i=1540483477*(65535&(i=255&r.charCodeAt(s)|(255&r.charCodeAt(++s))<<8|(255&r.charCodeAt(++s))<<16|(255&r.charCodeAt(++s))<<24))+((1540483477*(i>>>16)&65535)<<16),a=1540483477*(65535&a)+((1540483477*(a>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),o-=4,++s;switch(o){case 3:a^=(255&r.charCodeAt(s+2))<<16;case 2:a^=(255&r.charCodeAt(s+1))<<8;case 1:a=1540483477*(65535&(a^=255&r.charCodeAt(s)))+((1540483477*(a>>>16)&65535)<<16)}return a=1540483477*(65535&(a^=a>>>13))+((1540483477*(a>>>16)&65535)<<16),(a^=a>>>15)>>>0}}),ib=i_;ib.murmur3=i_,ib.murmur2=ix;var iw=function(){this.ids=[],this.positions=[],this.indexed=!1};iw.prototype.add=function(r,n,i,o){this.ids.push(i0(r)),this.positions.push(n,i,o)},iw.prototype.getPositions=function(r){for(var n=i0(r),i=0,o=this.ids.length-1;i<o;){var a=i+o>>1;this.ids[a]>=n?o=a:i=a+1}for(var s=[];this.ids[i]===n;){var u=this.positions[3*i],c=this.positions[3*i+1],p=this.positions[3*i+2];s.push({index:u,start:c,end:p}),i++}return s},iw.serialize=function(r,n){var i=new Float64Array(r.ids),o=new Uint32Array(r.positions);return function r(n,i,o,a){if(!(o>=a)){for(var s=n[o+a>>1],u=o-1,c=a+1;;){do u++;while(n[u]<s);do c--;while(n[c]>s);if(u>=c)break;iE(n,u,c),iE(i,3*u,3*c),iE(i,3*u+1,3*c+1),iE(i,3*u+2,3*c+2)}r(n,i,o,c),r(n,i,c+1,a)}}(i,o,0,i.length-1),n&&n.push(i.buffer,o.buffer),{ids:i,positions:o}},iw.deserialize=function(r){var n=new iw;return n.ids=r.ids,n.positions=r.positions,n.indexed=!0,n};function i0(r){var n=+r;return!isNaN(n)&&n<=9007199254740991?n:ib(String(r))}function iE(r,n,i){var o=r[n];r[n]=r[i],r[i]=o}r9("FeaturePositionMap",iw);var iT=function(r,n){this.gl=r.gl,this.location=n},iS=function(r){function n(n,i){r.call(this,n,i),this.current=0}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},n}(iT),iC=function(r){function n(n,i){r.call(this,n,i),this.current=0}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},n}(iT),iI=function(r){function n(n,i){r.call(this,n,i),this.current=[0,0]}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},n}(iT),ik=function(r){function n(n,i){r.call(this,n,i),this.current=[0,0,0]}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},n}(iT),i1=function(r){function n(n,i){r.call(this,n,i),this.current=[0,0,0,0]}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},n}(iT),i2=function(r){function n(n,i){r.call(this,n,i),this.current=et.transparent}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},n}(iT),iA=new Float32Array(16),iP=function(r){function n(n,i){r.call(this,n,i),this.current=iA}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var n=1;n<16;n++)if(r[n]!==this.current[n]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},n}(iT);function iL(r){return[i$(255*r.r,255*r.g),i$(255*r.b,255*r.a)]}var iD=function(r,n,i){this.value=r,this.names=n,this.uniformNames=this.names.map(function(r){return"u_"+r}),this.type=i,this.maxValue=-1/0};iD.prototype.defines=function(){return this.names.map(function(r){return"#define HAS_UNIFORM_u_"+r})},iD.prototype.setConstantPatternPositions=function(){},iD.prototype.populatePaintArray=function(){},iD.prototype.updatePaintArray=function(){},iD.prototype.upload=function(){},iD.prototype.destroy=function(){},iD.prototype.setUniforms=function(r,n,i,o){n.set(o.constantOr(this.value))},iD.prototype.getBinding=function(r,n){return"color"===this.type?new i2(r,n):new iC(r,n)},iD.serialize=function(r){var n=r.value,i=r.names,o=r.type;return{value:nn(n),names:i,type:o}},iD.deserialize=function(r){var n=r.value,i=r.names,o=r.type;return new iD(ni(n),i,o)};var iz=function(r,n,i){this.value=r,this.names=n,this.uniformNames=this.names.map(function(r){return"u_"+r}),this.type=i,this.maxValue=-1/0,this.patternPositions={patternTo:null,patternFrom:null}};iz.prototype.defines=function(){return this.names.map(function(r){return"#define HAS_UNIFORM_u_"+r})},iz.prototype.populatePaintArray=function(){},iz.prototype.updatePaintArray=function(){},iz.prototype.upload=function(){},iz.prototype.destroy=function(){},iz.prototype.setConstantPatternPositions=function(r,n){this.patternPositions.patternTo=r.tlbr,this.patternPositions.patternFrom=n.tlbr},iz.prototype.setUniforms=function(r,n,i,o,a){var s=this.patternPositions;"u_pattern_to"===a&&s.patternTo&&n.set(s.patternTo),"u_pattern_from"===a&&s.patternFrom&&n.set(s.patternFrom)},iz.prototype.getBinding=function(r,n){return new i1(r,n)};var i3=function(r,n,i,o){this.expression=r,this.names=n,this.type=i,this.uniformNames=this.names.map(function(r){return"a_"+r}),this.maxValue=-1/0,this.paintVertexAttributes=n.map(function(r){return{name:"a_"+r,type:"Float32",components:"color"===i?2:1,offset:0}}),this.paintVertexArray=new o};i3.prototype.defines=function(){return[]},i3.prototype.setConstantPatternPositions=function(){},i3.prototype.populatePaintArray=function(r,n,i,o){var a=this.paintVertexArray,s=a.length;a.reserve(r);var u=this.expression.evaluate(new nE(0),n,{},[],o);if("color"===this.type)for(var c=iL(u),p=s;p<r;p++)a.emplaceBack(c[0],c[1]);else{for(var h=s;h<r;h++)a.emplaceBack(u);this.maxValue=Math.max(this.maxValue,u)}},i3.prototype.updatePaintArray=function(r,n,i,o){var a=this.paintVertexArray,s=this.expression.evaluate({zoom:0},i,o);if("color"===this.type)for(var u=iL(s),c=r;c<n;c++)a.emplace(c,u[0],u[1]);else{for(var p=r;p<n;p++)a.emplace(p,s);this.maxValue=Math.max(this.maxValue,s)}},i3.prototype.upload=function(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},i3.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},i3.prototype.setUniforms=function(r,n){n.set(0)},i3.prototype.getBinding=function(r,n){return new iC(r,n)};var i4=function(r,n,i,o,a,s){this.expression=r,this.names=n,this.uniformNames=this.names.map(function(r){return"u_"+r+"_t"}),this.type=i,this.useIntegerZoom=o,this.zoom=a,this.maxValue=-1/0,this.paintVertexAttributes=n.map(function(r){return{name:"a_"+r,type:"Float32",components:"color"===i?4:2,offset:0}}),this.paintVertexArray=new s};i4.prototype.defines=function(){return[]},i4.prototype.setConstantPatternPositions=function(){},i4.prototype.populatePaintArray=function(r,n,i,o){var a=this.paintVertexArray,s=a.length;a.reserve(r);var u=this.expression.evaluate(new nE(this.zoom),n,{},[],o),c=this.expression.evaluate(new nE(this.zoom+1),n,{},[],o);if("color"===this.type)for(var p=iL(u),h=iL(c),d=s;d<r;d++)a.emplaceBack(p[0],p[1],h[0],h[1]);else{for(var f=s;f<r;f++)a.emplaceBack(u,c);this.maxValue=Math.max(this.maxValue,u,c)}},i4.prototype.updatePaintArray=function(r,n,i,o){var a=this.paintVertexArray,s=this.expression.evaluate({zoom:this.zoom},i,o),u=this.expression.evaluate({zoom:this.zoom+1},i,o);if("color"===this.type)for(var c=iL(s),p=iL(u),h=r;h<n;h++)a.emplace(h,c[0],c[1],p[0],p[1]);else{for(var d=r;d<n;d++)a.emplace(d,s,u);this.maxValue=Math.max(this.maxValue,s,u)}},i4.prototype.upload=function(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},i4.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},i4.prototype.interpolationFactor=function(r){return this.useIntegerZoom&&(r=Math.floor(r)),f(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1)},i4.prototype.setUniforms=function(r,n,i){n.set(this.interpolationFactor(i.zoom))},i4.prototype.getBinding=function(r,n){return new iC(r,n)};var iM=function(r,n,i,o,a,s,u){this.expression=r,this.names=n,this.type=i,this.uniformNames=this.names.map(function(r){return"u_"+r+"_t"}),this.useIntegerZoom=o,this.zoom=a,this.maxValue=-1/0,this.layerId=u,this.paintVertexAttributes=n.map(function(r){return{name:"a_"+r,type:"Uint16",components:4,offset:0}}),this.zoomInPaintVertexArray=new s,this.zoomOutPaintVertexArray=new s};iM.prototype.defines=function(){return[]},iM.prototype.setConstantPatternPositions=function(){},iM.prototype.populatePaintArray=function(r,n,i){var o=this.zoomInPaintVertexArray,a=this.zoomOutPaintVertexArray,s=this.layerId,u=o.length;if(o.reserve(r),a.reserve(r),i&&n.patterns&&n.patterns[s]){var c=n.patterns[s],p=c.min,h=c.mid,d=c.max,f=i[p],m=i[h],y=i[d];if(!f||!m||!y)return;for(var v=u;v<r;v++)o.emplaceBack(m.tl[0],m.tl[1],m.br[0],m.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1]),a.emplaceBack(m.tl[0],m.tl[1],m.br[0],m.br[1],y.tl[0],y.tl[1],y.br[0],y.br[1])}},iM.prototype.updatePaintArray=function(r,n,i,o,a){var s=this.zoomInPaintVertexArray,u=this.zoomOutPaintVertexArray,c=this.layerId;if(a&&i.patterns&&i.patterns[c]){var p=i.patterns[c],h=p.min,d=p.mid,f=p.max,m=a[h],y=a[d],v=a[f];if(!m||!y||!v)return;for(var g=r;g<n;g++)s.emplace(g,y.tl[0],y.tl[1],y.br[0],y.br[1],m.tl[0],m.tl[1],m.br[0],m.br[1]),u.emplace(g,y.tl[0],y.tl[1],y.br[0],y.br[1],v.tl[0],v.tl[1],v.br[0],v.br[1])}},iM.prototype.upload=function(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},iM.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},iM.prototype.setUniforms=function(r,n){n.set(0)},iM.prototype.getBinding=function(r,n){return new iC(r,n)};var iR=function(){this.binders={},this.cacheKey="",this._buffers=[]};iR.createDynamic=function(r,n,i){var o=new iR,a=[];for(var s in r.paint._values)if(i(s)){var u=r.paint.get(s);if(u instanceof n2&&ra(u.property.specification)){var c=iF(s,r.type),p=u.property.specification.type,h=u.property.useIntegerZoom;if("cross-faded"===u.property.specification["property-type"]||"cross-faded-data-driven"===u.property.specification["property-type"]){if("constant"===u.value.kind)o.binders[s]=new iz(u.value.value,c,p),a.push("/u_"+s);else{var d=iO(s,p,"source");o.binders[s]=new iM(u.value,c,p,h,n,d,r.id),a.push("/a_"+s)}}else if("constant"===u.value.kind)o.binders[s]=new iD(u.value.value,c,p),a.push("/u_"+s);else if("source"===u.value.kind){var f=iO(s,p,"source");o.binders[s]=new i3(u.value,c,p,f),a.push("/a_"+s)}else{var m=iO(s,p,"composite");o.binders[s]=new i4(u.value,c,p,h,n,m),a.push("/z_"+s)}}}return o.cacheKey=a.sort().join(""),o},iR.prototype.populatePaintArrays=function(r,n,i,o,a){for(var s in this.binders)this.binders[s].populatePaintArray(r,n,o,a)},iR.prototype.setConstantPatternPositions=function(r,n){for(var i in this.binders)this.binders[i].setConstantPatternPositions(r,n)},iR.prototype.updatePaintArrays=function(r,n,i,o,a){var s=!1;for(var u in r)for(var c=0,p=n.getPositions(u);c<p.length;c+=1){var h=p[c],d=i.feature(h.index);for(var f in this.binders){var m=this.binders[f];if(!(m instanceof iD||m instanceof iz)&&!0===m.expression.isStateDependent){var y=o.paint.get(f);m.expression=y.value,m.updatePaintArray(h.start,h.end,d,r[u],a),s=!0}}}return s},iR.prototype.defines=function(){var r=[];for(var n in this.binders)r.push.apply(r,this.binders[n].defines());return r},iR.prototype.getPaintVertexBuffers=function(){return this._buffers},iR.prototype.getUniforms=function(r,n){var i=[];for(var o in this.binders)for(var a=this.binders[o],s=0,u=a.uniformNames;s<u.length;s+=1){var c=u[s];if(n[c]){var p=a.getBinding(r,n[c]);i.push({name:c,property:o,binding:p})}}return i},iR.prototype.setUniforms=function(r,n,i,o){for(var a=0,s=n;a<s.length;a+=1){var u=s[a],c=u.name,p=u.property,h=u.binding;this.binders[p].setUniforms(r,h,o,i.get(p),c)}},iR.prototype.updatePatternPaintBuffers=function(r){var n=[];for(var i in this.binders){var o=this.binders[i];if(o instanceof iM){var a=2===r.fromScale?o.zoomInPaintVertexBuffer:o.zoomOutPaintVertexBuffer;a&&n.push(a)}else(o instanceof i3||o instanceof i4)&&o.paintVertexBuffer&&n.push(o.paintVertexBuffer)}this._buffers=n},iR.prototype.upload=function(r){for(var n in this.binders)this.binders[n].upload(r);var i=[];for(var o in this.binders){var a=this.binders[o];(a instanceof i3||a instanceof i4)&&a.paintVertexBuffer&&i.push(a.paintVertexBuffer)}this._buffers=i},iR.prototype.destroy=function(){for(var r in this.binders)this.binders[r].destroy()};var iB=function(r,n,i,o){void 0===o&&(o=function(){return!0}),this.programConfigurations={};for(var a=0,s=n;a<s.length;a+=1){var u=s[a];this.programConfigurations[u.id]=iR.createDynamic(u,i,o),this.programConfigurations[u.id].layoutAttributes=r}this.needsUpload=!1,this._featureMap=new iw,this._bufferOffset=0};function iF(r,n){return({"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]})[r]||[r.replace(n+"-","").replace(/-/g,"_")]}function iO(r,n,i){var o,a={"line-pattern":{source:nV,composite:nV},"fill-pattern":{source:nV,composite:nV},"fill-extrusion-pattern":{source:nV,composite:nV}}[o=r];return a&&a[i]||({color:{source:ir,composite:ii},number:{source:nY,composite:ir}})[n][i]}iB.prototype.populatePaintArrays=function(r,n,i,o,a){for(var s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(r,n,i,o,a);void 0!==n.id&&this._featureMap.add(n.id,i,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0},iB.prototype.updatePaintArrays=function(r,n,i,o){for(var a=0,s=i;a<s.length;a+=1){var u=s[a];this.needsUpload=this.programConfigurations[u.id].updatePaintArrays(r,this._featureMap,n,u,o)||this.needsUpload}},iB.prototype.get=function(r){return this.programConfigurations[r]},iB.prototype.upload=function(r){if(this.needsUpload){for(var n in this.programConfigurations)this.programConfigurations[n].upload(r);this.needsUpload=!1}},iB.prototype.destroy=function(){for(var r in this.programConfigurations)this.programConfigurations[r].destroy()},r9("ConstantBinder",iD),r9("CrossFadedConstantBinder",iz),r9("SourceExpressionBinder",i3),r9("CrossFadedCompositeBinder",iM),r9("CompositeExpressionBinder",i4),r9("ProgramConfiguration",iR,{omit:["_buffers"]}),r9("ProgramConfigurationSet",iB);var i6,i7={min:-1*Math.pow(2,(i6=15)-1),max:Math.pow(2,i6-1)-1};function i5(r){for(var n=8192/r.extent,i=r.loadGeometry(),o=0;o<i.length;o++)for(var a=i[o],s=0;s<a.length;s++){var u=a[s];u.x=Math.round(u.x*n),u.y=Math.round(u.y*n),(u.x<i7.min||u.x>i7.max||u.y<i7.min||u.y>i7.max)&&(C("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u.x=f(u.x,i7.min,i7.max),u.y=f(u.y,i7.min,i7.max))}return i}function iN(r,n,i,o,a){r.emplaceBack(2*n+(o+1)/2,2*i+(a+1)/2)}var iU=function(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new n7,this.indexArray=new n9,this.segments=new i8,this.programConfigurations=new iB(ig,r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function iV(r,n){for(var i=0;i<r.length;i++)if(iY(n,r[i]))return!0;for(var o=0;o<n.length;o++)if(iY(r,n[o]))return!0;return!!iG(r,n)}function iq(r,n,i){return!!iY(r,n)||!!iW(n,r,i)}function ij(r,n){if(1===r.length)return iK(n,r[0]);for(var i=0;i<n.length;i++)for(var o=n[i],a=0;a<o.length;a++)if(iY(r,o[a]))return!0;for(var s=0;s<r.length;s++)if(iK(n,r[s]))return!0;for(var u=0;u<n.length;u++)if(iG(r,n[u]))return!0;return!1}function iH(r,n,i){if(r.length>1){if(iG(r,n))return!0;for(var o=0;o<n.length;o++)if(iW(n[o],r,i))return!0}for(var a=0;a<r.length;a++)if(iW(r[a],n,i))return!0;return!1}function iG(r,n){if(0===r.length||0===n.length)return!1;for(var i=0;i<r.length-1;i++)for(var o=r[i],a=r[i+1],s=0;s<n.length-1;s++)if(iZ(o,a,n[s],n[s+1]))return!0;return!1}function iZ(r,n,i,o){return I(r,i,o)!==I(n,i,o)&&I(r,n,i)!==I(r,n,o)}function iW(r,n,i){var o=i*i;if(1===n.length)return r.distSqr(n[0])<o;for(var a=1;a<n.length;a++)if(iX(r,n[a-1],n[a])<o)return!0;return!1}function iX(r,n,i){var o=n.distSqr(i);if(0===o)return r.distSqr(n);var a=((r.x-n.x)*(i.x-n.x)+(r.y-n.y)*(i.y-n.y))/o;return a<0?r.distSqr(n):a>1?r.distSqr(i):r.distSqr(i.sub(n)._mult(a)._add(n))}function iK(r,n){for(var i,o,a,s=!1,u=0;u<r.length;u++)for(var c=0,p=(i=r[u]).length-1;c<i.length;p=c++)o=i[c],a=i[p],o.y>n.y!=a.y>n.y&&n.x<(a.x-o.x)*(n.y-o.y)/(a.y-o.y)+o.x&&(s=!s);return s}function iY(r,n){for(var i=!1,o=0,a=r.length-1;o<r.length;a=o++){var s=r[o],u=r[a];s.y>n.y!=u.y>n.y&&n.x<(u.x-s.x)*(n.y-s.y)/(u.y-s.y)+s.x&&(i=!i)}return i}function iJ(r,n,i){var o=i[0],a=i[2];if(r.x<o.x&&n.x<o.x||r.x>a.x&&n.x>a.x||r.y<o.y&&n.y<o.y||r.y>a.y&&n.y>a.y)return!1;var s=I(r,n,i[0]);return s!==I(r,n,i[1])||s!==I(r,n,i[2])||s!==I(r,n,i[3])}function iQ(r,n,i){var o=n.paint.get(r).value;return"constant"===o.kind?o.value:i.programConfigurations.get(n.id).binders[r].maxValue}function i9(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function ot(r,n,i,o,a){if(!n[0]&&!n[1])return r;var s=c.convert(n)._mult(a);"viewport"===i&&s._rotate(-o);for(var u=[],p=0;p<r.length;p++){var h=r[p];u.push(h.sub(s))}return u}iU.prototype.populate=function(r,n){var i=this.layers[0],o=[],a=null;"circle"===i.type&&(a=i.layout.get("circle-sort-key"));for(var s=0,u=r;s<u.length;s+=1){var c=u[s],p=c.feature,h=c.id,d=c.index,f=c.sourceLayerIndex;if(this.layers[0]._featureFilter(new nE(this.zoom),p)){var m=i5(p),y=a?a.evaluate(p,{}):void 0,v={id:h,properties:p.properties,type:p.type,sourceLayerIndex:f,index:d,geometry:m,patterns:{},sortKey:y};o.push(v)}}a&&o.sort(function(r,n){return r.sortKey-n.sortKey});for(var g=0,$=o;g<$.length;g+=1){var _=$[g],x=_,b=x.geometry,w=x.index,E=x.sourceLayerIndex,T=r[w].feature;this.addFeature(_,b,w),n.featureIndex.insert(T,b,w,E,this.index)}},iU.prototype.update=function(r,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,n,this.stateDependentLayers,i)},iU.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},iU.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},iU.prototype.upload=function(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,ig),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0},iU.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},iU.prototype.addFeature=function(r,n,i){for(var o=0,a=n;o<a.length;o+=1)for(var s=0,u=a[o];s<u.length;s+=1){var c=u[s],p=c.x,h=c.y;if(!(p<0||p>=8192||h<0||h>=8192)){var d=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),f=d.vertexLength;iN(this.layoutVertexArray,p,h,-1,-1),iN(this.layoutVertexArray,p,h,1,-1),iN(this.layoutVertexArray,p,h,1,1),iN(this.layoutVertexArray,p,h,-1,1),this.indexArray.emplaceBack(f,f+1,f+2),this.indexArray.emplaceBack(f,f+3,f+2),d.vertexLength+=4,d.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,i,{})},r9("CircleBucket",iU,{omit:["layers"]});var oe=new n4({"circle-sort-key":new nL(tM.layout_circle["circle-sort-key"])}),or={paint:new n4({"circle-radius":new nL(tM.paint_circle["circle-radius"]),"circle-color":new nL(tM.paint_circle["circle-color"]),"circle-blur":new nL(tM.paint_circle["circle-blur"]),"circle-opacity":new nL(tM.paint_circle["circle-opacity"]),"circle-translate":new nP(tM.paint_circle["circle-translate"]),"circle-translate-anchor":new nP(tM.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new nP(tM.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new nP(tM.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new nL(tM.paint_circle["circle-stroke-width"]),"circle-stroke-color":new nL(tM.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new nL(tM.paint_circle["circle-stroke-opacity"])}),layout:oe},on="undefined"!=typeof Float32Array?Float32Array:Array;function oi(r,n,i){var o=n[0],a=n[1],s=n[2],u=n[3];return r[0]=i[0]*o+i[4]*a+i[8]*s+i[12]*u,r[1]=i[1]*o+i[5]*a+i[9]*s+i[13]*u,r[2]=i[2]*o+i[6]*a+i[10]*s+i[14]*u,r[3]=i[3]*o+i[7]*a+i[11]*s+i[15]*u,r}Math.hypot||(Math.hypot=function(){for(var r=arguments,n=0,i=arguments.length;i--;)n+=r[i]*r[i];return Math.sqrt(n)}),o=new on(3),on!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),a=o,i=new on(4),on!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0);var oo=function(r){function n(n){r.call(this,n,or)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.createBucket=function(r){return new iU(r)},n.prototype.queryRadius=function(r){var n=r;return iQ("circle-radius",this,n)+iQ("circle-stroke-width",this,n)+i9(this.paint.get("circle-translate"))},n.prototype.queryIntersectsFeature=function(r,n,i,o,a,s,u,c){for(var p,h,d=ot(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),s.angle,u),f=this.paint.get("circle-radius").evaluate(n,i)+this.paint.get("circle-stroke-width").evaluate(n,i),m="map"===this.paint.get("circle-pitch-alignment"),y=m?d:(p=d,h=c,p.map(function(r){return oa(r,h)})),v=m?f*u:f,g=0,$=o;g<$.length;g+=1)for(var _=0,x=$[g];_<x.length;_+=1){var b=x[_],w=m?b:oa(b,c),E=v,T=oi([],[b.x,b.y,0,1],c);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?E*=T[3]/s.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(E*=s.cameraToCenterDistance/T[3]),iq(y,w,E))return!0}return!1},n}(nM);function oa(r,n){var i=oi([],[r.x,r.y,0,1],n);return new c(i[0]/i[3],i[1]/i[3])}var os=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n}(iU);function ol(r,n,i,o){var a=n.width,s=n.height;if(o){if(o instanceof Uint8ClampedArray)o=new Uint8Array(o.buffer);else if(o.length!==a*s*i)throw RangeError("mismatched image size")}else o=new Uint8Array(a*s*i);return r.width=a,r.height=s,r.data=o,r}function ou(r,n,i){var o=n.width,a=n.height;if(o!==r.width||a!==r.height){var s=ol({},{width:o,height:a},i);oc(r,s,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,o),height:Math.min(r.height,a)},i),r.width=o,r.height=a,r.data=s.data}}function oc(r,n,i,o,a,s){if(0===a.width||0===a.height)return n;if(a.width>r.width||a.height>r.height||i.x>r.width-a.width||i.y>r.height-a.height)throw RangeError("out of range source coordinates for image copy");if(a.width>n.width||a.height>n.height||o.x>n.width-a.width||o.y>n.height-a.height)throw RangeError("out of range destination coordinates for image copy");for(var u=r.data,c=n.data,p=0;p<a.height;p++)for(var h=((i.y+p)*r.width+i.x)*s,d=((o.y+p)*n.width+o.x)*s,f=0;f<a.width*s;f++)c[d+f]=u[h+f];return n}r9("HeatmapBucket",os,{omit:["layers"]});var op=function(r,n){ol(this,r,1,n)};op.prototype.resize=function(r){ou(this,r,1)},op.prototype.clone=function(){return new op({width:this.width,height:this.height},new Uint8Array(this.data))},op.copy=function(r,n,i,o,a){oc(r,n,i,o,a,1)};var oh=function(r,n){ol(this,r,4,n)};oh.prototype.resize=function(r){ou(this,r,4)},oh.prototype.replace=function(r,n){n?this.data.set(r):r instanceof Uint8ClampedArray?this.data=new Uint8Array(r.buffer):this.data=r},oh.prototype.clone=function(){return new oh({width:this.width,height:this.height},new Uint8Array(this.data))},oh.copy=function(r,n,i,o,a){oc(r,n,i,o,a,4)},r9("AlphaImage",op),r9("RGBAImage",oh);var od={paint:new n4({"heatmap-radius":new nL(tM.paint_heatmap["heatmap-radius"]),"heatmap-weight":new nL(tM.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new nP(tM.paint_heatmap["heatmap-intensity"]),"heatmap-color":new n3(tM.paint_heatmap["heatmap-color"]),"heatmap-opacity":new nP(tM.paint_heatmap["heatmap-opacity"])})};function of(r,n){for(var i=new Uint8Array(1024),o={},a=0,s=0;a<256;a++,s+=4){o[n]=a/255;var u=r.evaluate(o);i[s+0]=Math.floor(255*u.r/u.a),i[s+1]=Math.floor(255*u.g/u.a),i[s+2]=Math.floor(255*u.b/u.a),i[s+3]=Math.floor(255*u.a)}return new oh({width:256,height:1},i)}var om=function(r){function n(n){r.call(this,n,od),this._updateColorRamp()}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.createBucket=function(r){return new os(r)},n.prototype._handleSpecialPaintPropertyUpdate=function(r){"heatmap-color"===r&&this._updateColorRamp()},n.prototype._updateColorRamp=function(){var r=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=of(r,"heatmapDensity"),this.colorRampTexture=null},n.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},n.prototype.queryRadius=function(){return 0},n.prototype.queryIntersectsFeature=function(){return!1},n.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},n}(nM),oy={paint:new n4({"hillshade-illumination-direction":new nP(tM.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new nP(tM.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new nP(tM.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new nP(tM.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new nP(tM.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new nP(tM.paint_hillshade["hillshade-accent-color"])})},ov=function(r){function n(n){r.call(this,n,oy)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},n}(nM),og=nO([{name:"a_pos",components:2,type:"Int16"}],4).members,o8=o$;function o$(r,n,i){i=i||2;var o,a,s,u,c,p,h,d=n&&n.length,f=d?n[0]*i:r.length,m=o_(r,0,f,i,!0),y=[];if(!m||m.next===m.prev)return y;if(d&&(m=function(r,n,i,o){var a,s,u,c,p,h=[];for(a=0,s=n.length;a<s;a++)u=n[a]*o,c=a<s-1?n[a+1]*o:r.length,(p=o_(r,u,c,o,!1))===p.next&&(p.steiner=!0),h.push(o1(p));for(h.sort(oS),a=0;a<h.length;a++)oC(h[a],i),i=ox(i,i.next);return i}(r,n,m,i)),r.length>80*i){o=s=r[0],a=u=r[1];for(var v=i;v<f;v+=i)(c=r[v])<o&&(o=c),(p=r[v+1])<a&&(a=p),c>s&&(s=c),p>u&&(u=p);h=0!==(h=Math.max(s-o,u-a))?1/h:0}return ob(m,y,i,o,a,h),y}function o_(r,n,i,o,a){var s,u;if(a===oO(r,n,i,o)>0)for(s=n;s<i;s+=o)u=oR(s,r[s],r[s+1],u);else for(s=i-o;s>=n;s-=o)u=oR(s,r[s],r[s+1],u);return u&&oL(u,u.next)&&(oB(u),u=u.next),u}function ox(r,n){if(!r)return r;n||(n=r);var i,o=r;do if(i=!1,o.steiner||!oL(o,o.next)&&0!==oP(o.prev,o,o.next))o=o.next;else{if(oB(o),(o=n=o.prev)===o.next)break;i=!0}while(i||o!==n);return n}function ob(r,n,i,o,a,s,u){if(r){!u&&s&&function(r,n,i,o){var a=r;do null===a.z&&(a.z=ok(a.x,a.y,n,i,o)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==r);a.prevZ.nextZ=null,a.prevZ=null,function(r){var n,i,o,a,s,u,c,p,h=1;do{for(i=r,r=null,s=null,u=0;i;){for(u++,o=i,c=0,n=0;n<h&&(c++,o=o.nextZ);n++);for(p=h;c>0||p>0&&o;)0!==c&&(0===p||!o||i.z<=o.z)?(a=i,i=i.nextZ,c--):(a=o,o=o.nextZ,p--),s?s.nextZ=a:r=a,a.prevZ=s,s=a;i=o}s.nextZ=null,h*=2}while(u>1)}(a)}(r,o,a,s);for(var c,p,h=r;r.prev!==r.next;)if(c=r.prev,p=r.next,s?o0(r,o,a,s):ow(r))n.push(c.i/i),n.push(r.i/i),n.push(p.i/i),oB(r),r=p.next,h=p.next;else if((r=p)===h){u?1===u?ob(r=oE(ox(r),n,i),n,i,o,a,s,2):2===u&&oT(r,n,i,o,a,s):ob(ox(r),n,i,o,a,s,1);break}}}function ow(r){var n=r.prev,i=r,o=r.next;if(oP(n,i,o)>=0)return!1;for(var a=r.next.next;a!==r.prev;){if(o2(n.x,n.y,i.x,i.y,o.x,o.y,a.x,a.y)&&oP(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function o0(r,n,i,o){var a=r.prev,s=r,u=r.next;if(oP(a,s,u)>=0)return!1;for(var c=a.x<s.x?a.x<u.x?a.x:u.x:s.x<u.x?s.x:u.x,p=a.y<s.y?a.y<u.y?a.y:u.y:s.y<u.y?s.y:u.y,h=a.x>s.x?a.x>u.x?a.x:u.x:s.x>u.x?s.x:u.x,d=a.y>s.y?a.y>u.y?a.y:u.y:s.y>u.y?s.y:u.y,f=ok(c,p,n,i,o),m=ok(h,d,n,i,o),y=r.prevZ,v=r.nextZ;y&&y.z>=f&&v&&v.z<=m;){if(y!==r.prev&&y!==r.next&&o2(a.x,a.y,s.x,s.y,u.x,u.y,y.x,y.y)&&oP(y.prev,y,y.next)>=0||(y=y.prevZ,v!==r.prev&&v!==r.next&&o2(a.x,a.y,s.x,s.y,u.x,u.y,v.x,v.y)&&oP(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;y&&y.z>=f;){if(y!==r.prev&&y!==r.next&&o2(a.x,a.y,s.x,s.y,u.x,u.y,y.x,y.y)&&oP(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;v&&v.z<=m;){if(v!==r.prev&&v!==r.next&&o2(a.x,a.y,s.x,s.y,u.x,u.y,v.x,v.y)&&oP(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function oE(r,n,i){var o=r;do{var a=o.prev,s=o.next.next;!oL(a,s)&&oD(a,o,o.next,s)&&o4(a,s)&&o4(s,a)&&(n.push(a.i/i),n.push(o.i/i),n.push(s.i/i),oB(o),oB(o.next),o=r=s),o=o.next}while(o!==r);return ox(o)}function oT(r,n,i,o,a,s){var u=r;do{for(var c=u.next.next;c!==u.prev;){if(u.i!==c.i&&oA(u,c)){var p=oM(u,c);return u=ox(u,u.next),p=ox(p,p.next),ob(u,n,i,o,a,s),void ob(p,n,i,o,a,s)}c=c.next}u=u.next}while(u!==r)}function oS(r,n){return r.x-n.x}function oC(r,n){if(n=function(r,n){var i,o=n,a=r.x,s=r.y,u=-1/0;do{if(s<=o.y&&s>=o.next.y&&o.next.y!==o.y){var c=o.x+(s-o.y)*(o.next.x-o.x)/(o.next.y-o.y);if(c<=a&&c>u){if(u=c,c===a){if(s===o.y)return o;if(s===o.next.y)return o.next}i=o.x<o.next.x?o:o.next}}o=o.next}while(o!==n);if(!i)return null;if(a===u)return i;var p,h=i,d=i.x,f=i.y,m=1/0;o=i;do a>=o.x&&o.x>=d&&a!==o.x&&o2(s<f?a:u,s,d,f,s<f?u:a,s,o.x,o.y)&&(p=Math.abs(s-o.y)/(a-o.x),o4(o,r)&&(p<m||p===m&&(o.x>i.x||o.x===i.x&&oI(i,o)))&&(i=o,m=p)),o=o.next;while(o!==h);return i}(r,n)){var i=oM(n,r);ox(n,n.next),ox(i,i.next)}}function oI(r,n){return 0>oP(r.prev,r,n.prev)&&0>oP(n.next,r,r.next)}function ok(r,n,i,o,a){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-i)*a)|r<<8))|r<<4))|r<<2))|r<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-o)*a)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function o1(r){var n=r,i=r;do(n.x<i.x||n.x===i.x&&n.y<i.y)&&(i=n),n=n.next;while(n!==r);return i}function o2(r,n,i,o,a,s,u,c){return(a-u)*(n-c)-(r-u)*(s-c)>=0&&(r-u)*(o-c)-(i-u)*(n-c)>=0&&(i-u)*(s-c)-(a-u)*(o-c)>=0}function oA(r,n){return r.next.i!==n.i&&r.prev.i!==n.i&&!function(r,n){var i=r;do{if(i.i!==r.i&&i.next.i!==r.i&&i.i!==n.i&&i.next.i!==n.i&&oD(i,i.next,r,n))return!0;i=i.next}while(i!==r);return!1}(r,n)&&(o4(r,n)&&o4(n,r)&&function(r,n){var i=r,o=!1,a=(r.x+n.x)/2,s=(r.y+n.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&a<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(o=!o),i=i.next;while(i!==r);return o}(r,n)&&(oP(r.prev,r,n.prev)||oP(r,n.prev,n))||oL(r,n)&&oP(r.prev,r,r.next)>0&&oP(n.prev,n,n.next)>0)}function oP(r,n,i){return(n.y-r.y)*(i.x-n.x)-(n.x-r.x)*(i.y-n.y)}function oL(r,n){return r.x===n.x&&r.y===n.y}function oD(r,n,i,o){var a=o3(oP(r,n,i)),s=o3(oP(r,n,o)),u=o3(oP(i,o,r)),c=o3(oP(i,o,n));return a!==s&&u!==c||!(0!==a||!oz(r,i,n))||!(0!==s||!oz(r,o,n))||!(0!==u||!oz(i,r,o))||!(0!==c||!oz(i,n,o))}function oz(r,n,i){return n.x<=Math.max(r.x,i.x)&&n.x>=Math.min(r.x,i.x)&&n.y<=Math.max(r.y,i.y)&&n.y>=Math.min(r.y,i.y)}function o3(r){return r>0?1:r<0?-1:0}function o4(r,n){return 0>oP(r.prev,r,r.next)?oP(r,n,r.next)>=0&&oP(r,r.prev,n)>=0:0>oP(r,n,r.prev)||0>oP(r,r.next,n)}function oM(r,n){var i=new oF(r.i,r.x,r.y),o=new oF(n.i,n.x,n.y),a=r.next,s=n.prev;return r.next=n,n.prev=r,i.next=a,a.prev=i,o.next=i,i.prev=o,s.next=o,o.prev=s,o}function oR(r,n,i,o){var a=new oF(r,n,i);return o?(a.next=o.next,a.prev=o,o.next.prev=a,o.next=a):(a.prev=a,a.next=a),a}function oB(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function oF(r,n,i){this.i=r,this.x=n,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function oO(r,n,i,o){for(var a=0,s=n,u=i-o;s<i;s+=o)a+=(r[u]-r[s])*(r[s+1]+r[u+1]),u=s;return a}function o6(r,n,i,o,a){!function r(n,i,o,a,s){for(;a>o;){if(a-o>600){var u=a-o+1,c=i-o+1,p=Math.log(u),h=.5*Math.exp(2*p/3),d=.5*Math.sqrt(p*h*(u-h)/u)*(c-u/2<0?-1:1),f=Math.max(o,Math.floor(i-c*h/u+d)),m=Math.min(a,Math.floor(i+(u-c)*h/u+d));r(n,i,f,m,s)}var y=n[i],v=o,g=a;for(o7(n,o,i),s(n[a],y)>0&&o7(n,o,a);v<g;){for(o7(n,v,g),v++,g--;0>s(n[v],y);)v++;for(;s(n[g],y)>0;)g--}0===s(n[o],y)?o7(n,o,g):o7(n,++g,a),g<=i&&(o=g+1),i<=g&&(a=g-1)}}(r,n,i||0,o||r.length-1,a||o5)}function o7(r,n,i){var o=r[n];r[n]=r[i],r[i]=o}function o5(r,n){return r<n?-1:r>n?1:0}function oN(r,n){var i=r.length;if(i<=1)return[r];for(var o,a,s=[],u=0;u<i;u++){var c=k(r[u]);0!==c&&(r[u].area=Math.abs(c),void 0===a&&(a=c<0),a===c<0?(o&&s.push(o),o=[r[u]]):o.push(r[u]))}if(o&&s.push(o),n>1)for(var p=0;p<s.length;p++)s[p].length<=n||(o6(s[p],n,1,s[p].length-1,oU),s[p]=s[p].slice(0,n));return s}function oU(r,n){return n.area-r.area}function oV(r,n,i){for(var o=i.patternDependencies,a=!1,s=0,u=n;s<u.length;s+=1){var c=u[s].paint.get(r+"-pattern");c.isConstant()||(a=!0);var p=c.constantOr(null);p&&(a=!0,o[p.to]=!0,o[p.from]=!0)}return a}function oq(r,n,i,o,a){for(var s=a.patternDependencies,u=0,c=n;u<c.length;u+=1){var p=c[u],h=p.paint.get(r+"-pattern").value;if("constant"!==h.kind){var d=h.evaluate({zoom:o-1},i,{},a.availableImages),f=h.evaluate({zoom:o},i,{},a.availableImages),m=h.evaluate({zoom:o+1},i,{},a.availableImages);d=d&&d.name?d.name:d,f=f&&f.name?f.name:f,m=m&&m.name?m.name:m,s[d]=!0,s[f]=!0,s[m]=!0,i.patterns[p.id]={min:d,mid:f,max:m}}}return i}o$.deviation=function(r,n,i,o){var a=n&&n.length,s=a?n[0]*i:r.length,u=Math.abs(oO(r,0,s,i));if(a)for(var c=0,p=n.length;c<p;c++){var h=n[c]*i,d=c<p-1?n[c+1]*i:r.length;u-=Math.abs(oO(r,h,d,i))}var f=0;for(c=0;c<o.length;c+=3){var m=o[c]*i,y=o[c+1]*i,v=o[c+2]*i;f+=Math.abs((r[m]-r[v])*(r[y+1]-r[m+1])-(r[m]-r[y])*(r[v+1]-r[m+1]))}return 0===u&&0===f?0:Math.abs((f-u)/u)},o$.flatten=function(r){for(var n=r[0][0].length,i={vertices:[],holes:[],dimensions:n},o=0,a=0;a<r.length;a++){for(var s=0;s<r[a].length;s++)for(var u=0;u<n;u++)i.vertices.push(r[a][s][u]);a>0&&(o+=r[a-1].length,i.holes.push(o))}return i},o8.default=o$;var oj=function(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new n7,this.indexArray=new n9,this.indexArray2=new it,this.programConfigurations=new iB(og,r.layers,r.zoom),this.segments=new i8,this.segments2=new i8,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};oj.prototype.populate=function(r,n){this.hasPattern=oV("fill",this.layers,n);for(var i=this.layers[0].layout.get("fill-sort-key"),o=[],a=0,s=r;a<s.length;a+=1){var u=s[a],c=u.feature,p=u.id,h=u.index,d=u.sourceLayerIndex;if(this.layers[0]._featureFilter(new nE(this.zoom),c)){var f=i5(c),m=i?i.evaluate(c,{},n.availableImages):void 0,y={id:p,properties:c.properties,type:c.type,sourceLayerIndex:d,index:h,geometry:f,patterns:{},sortKey:m};o.push(y)}}i&&o.sort(function(r,n){return r.sortKey-n.sortKey});for(var v=0,g=o;v<g.length;v+=1){var $=g[v],_=$,x=_.geometry,b=_.index,w=_.sourceLayerIndex;if(this.hasPattern){var E=oq("fill",this.layers,$,this.zoom,n);this.patternFeatures.push(E)}else this.addFeature($,x,b,{});var T=r[b].feature;n.featureIndex.insert(T,x,b,w,this.index)}},oj.prototype.update=function(r,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,n,this.stateDependentLayers,i)},oj.prototype.addFeatures=function(r,n){for(var i=0,o=this.patternFeatures;i<o.length;i+=1){var a=o[i];this.addFeature(a,a.geometry,a.index,n)}},oj.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},oj.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},oj.prototype.upload=function(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,og),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0},oj.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},oj.prototype.addFeature=function(r,n,i,o){for(var a=0,s=oN(n,500);a<s.length;a+=1){for(var u=s[a],c=0,p=0,h=u;p<h.length;p+=1)c+=h[p].length;for(var d=this.segments.prepareSegment(c,this.layoutVertexArray,this.indexArray),f=d.vertexLength,m=[],y=[],v=0,g=u;v<g.length;v+=1){var $=g[v];if(0!==$.length){$!==u[0]&&y.push(m.length/2);var _=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),x=_.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(x+$.length-1,x),m.push($[0].x),m.push($[0].y);for(var b=1;b<$.length;b++)this.layoutVertexArray.emplaceBack($[b].x,$[b].y),this.indexArray2.emplaceBack(x+b-1,x+b),m.push($[b].x),m.push($[b].y);_.vertexLength+=$.length,_.primitiveLength+=$.length}}for(var w=o8(m,y),E=0;E<w.length;E+=3)this.indexArray.emplaceBack(f+w[E],f+w[E+1],f+w[E+2]);d.vertexLength+=c,d.primitiveLength+=w.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,i,o)},r9("FillBucket",oj,{omit:["layers","patternFeatures"]});var oH=new n4({"fill-sort-key":new nL(tM.layout_fill["fill-sort-key"])}),oG={paint:new n4({"fill-antialias":new nP(tM.paint_fill["fill-antialias"]),"fill-opacity":new nL(tM.paint_fill["fill-opacity"]),"fill-color":new nL(tM.paint_fill["fill-color"]),"fill-outline-color":new nL(tM.paint_fill["fill-outline-color"]),"fill-translate":new nP(tM.paint_fill["fill-translate"]),"fill-translate-anchor":new nP(tM.paint_fill["fill-translate-anchor"]),"fill-pattern":new nD(tM.paint_fill["fill-pattern"])}),layout:oH},oZ=function(r){function n(n){r.call(this,n,oG)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.recalculate=function(n,i){r.prototype.recalculate.call(this,n,i);var o=this.paint._values["fill-outline-color"];"constant"===o.value.kind&&void 0===o.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},n.prototype.createBucket=function(r){return new oj(r)},n.prototype.queryRadius=function(){return i9(this.paint.get("fill-translate"))},n.prototype.queryIntersectsFeature=function(r,n,i,o,a,s,u){return ij(ot(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),s.angle,u),o)},n.prototype.isTileClipped=function(){return!0},n}(nM),oW=nO([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,oX=oK;function oK(r,n,i,o,a){this.properties={},this.extent=i,this.type=0,this._pbf=r,this._geometry=-1,this._keys=o,this._values=a,r.readFields(oY,this,n)}function oY(r,n,i){1==r?n.id=i.readVarint():2==r?function(r,n){for(var i=r.readVarint()+r.pos;r.pos<i;){var o=n._keys[r.readVarint()],a=n._values[r.readVarint()];n.properties[o]=a}}(i,n):3==r?n.type=i.readVarint():4==r&&(n._geometry=i.pos)}function oJ(r){for(var n,i,o=0,a=0,s=r.length,u=s-1;a<s;u=a++)n=r[a],o+=((i=r[u]).x-n.x)*(n.y+i.y);return o}oK.types=["Unknown","Point","LineString","Polygon"],oK.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var n,i=r.readVarint()+r.pos,o=1,a=0,s=0,u=0,p=[];r.pos<i;){if(a<=0){var h=r.readVarint();o=7&h,a=h>>3}if(a--,1===o||2===o)s+=r.readSVarint(),u+=r.readSVarint(),1===o&&(n&&p.push(n),n=[]),n.push(new c(s,u));else{if(7!==o)throw Error("unknown command "+o);n&&n.push(n[0].clone())}}return n&&p.push(n),p},oK.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var n=r.readVarint()+r.pos,i=1,o=0,a=0,s=0,u=1/0,c=-1/0,p=1/0,h=-1/0;r.pos<n;){if(o<=0){var d=r.readVarint();i=7&d,o=d>>3}if(o--,1===i||2===i)(a+=r.readSVarint())<u&&(u=a),a>c&&(c=a),(s+=r.readSVarint())<p&&(p=s),s>h&&(h=s);else if(7!==i)throw Error("unknown command "+i)}return[u,p,c,h]},oK.prototype.toGeoJSON=function(r,n,i){var o,a,s=this.extent*Math.pow(2,i),u=this.extent*r,c=this.extent*n,p=this.loadGeometry(),h=oK.types[this.type];function d(r){for(var n=0;n<r.length;n++){var i=r[n],o=180-360*(i.y+c)/s;r[n]=[360*(i.x+u)/s-180,360/Math.PI*Math.atan(Math.exp(o*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(o=0;o<p.length;o++)f[o]=p[o][0];d(p=f);break;case 2:for(o=0;o<p.length;o++)d(p[o]);break;case 3:for(p=function(r){var n=r.length;if(n<=1)return[r];for(var i,o,a=[],s=0;s<n;s++){var u=oJ(r[s]);0!==u&&(void 0===o&&(o=u<0),o===u<0?(i&&a.push(i),i=[r[s]]):i.push(r[s]))}return i&&a.push(i),a}(p),o=0;o<p.length;o++)for(a=0;a<p[o].length;a++)d(p[o][a])}1===p.length?p=p[0]:h="Multi"+h;var m={type:"Feature",geometry:{type:h,coordinates:p},properties:this.properties};return"id"in this&&(m.id=this.id),m};var oQ=o9;function o9(r,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(at,this,n),this.length=this._features.length}function at(r,n,i){15===r?n.version=i.readVarint():1===r?n.name=i.readString():5===r?n.extent=i.readVarint():2===r?n._features.push(i.pos):3===r?n._keys.push(i.readString()):4===r&&n._values.push(function(r){for(var n=null,i=r.readVarint()+r.pos;r.pos<i;){var o=r.readVarint()>>3;n=1===o?r.readString():2===o?r.readFloat():3===o?r.readDouble():4===o?r.readVarint64():5===o?r.readVarint():6===o?r.readSVarint():7===o?r.readBoolean():null}return n}(i))}function ae(r,n,i){if(3===r){var o=new oQ(i,i.readVarint()+i.pos);o.length&&(n[o.name]=o)}}o9.prototype.feature=function(r){if(r<0||r>=this._features.length)throw Error("feature index out of bounds");this._pbf.pos=this._features[r];var n=this._pbf.readVarint()+this._pbf.pos;return new oX(this._pbf,n,this.extent,this._keys,this._values)};var ar={VectorTile:function(r,n){this.layers=r.readFields(ae,{},n)},VectorTileFeature:oX,VectorTileLayer:oQ},an=ar.VectorTileFeature.types;function ai(r,n,i,o,a,s,u,c){r.emplaceBack(n,i,2*Math.floor(8192*o)+u,16384*a,16384*s,Math.round(c))}var ao=function(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new nN,this.indexArray=new n9,this.programConfigurations=new iB(oW,r.layers,r.zoom),this.segments=new i8,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function aa(r,n){return r.x===n.x&&(r.x<0||r.x>8192)||r.y===n.y&&(r.y<0||r.y>8192)}function as(r){return r.every(function(r){return r.x<0})||r.every(function(r){return r.x>8192})||r.every(function(r){return r.y<0})||r.every(function(r){return r.y>8192})}ao.prototype.populate=function(r,n){this.features=[],this.hasPattern=oV("fill-extrusion",this.layers,n);for(var i=0,o=r;i<o.length;i+=1){var a=o[i],s=a.feature,u=a.id,c=a.index,p=a.sourceLayerIndex;if(this.layers[0]._featureFilter(new nE(this.zoom),s)){var h=i5(s),d={id:u,sourceLayerIndex:p,index:c,geometry:h,properties:s.properties,type:s.type,patterns:{}};void 0!==s.id&&(d.id=s.id),this.hasPattern?this.features.push(oq("fill-extrusion",this.layers,d,this.zoom,n)):this.addFeature(d,h,c,{}),n.featureIndex.insert(s,h,c,p,this.index,!0)}}},ao.prototype.addFeatures=function(r,n){for(var i=0,o=this.features;i<o.length;i+=1){var a=o[i],s=a.geometry;this.addFeature(a,s,a.index,n)}},ao.prototype.update=function(r,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,n,this.stateDependentLayers,i)},ao.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ao.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ao.prototype.upload=function(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,oW),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0},ao.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ao.prototype.addFeature=function(r,n,i,o){for(var a=0,s=oN(n,500);a<s.length;a+=1){for(var u=s[a],c=0,p=0,h=u;p<h.length;p+=1)c+=h[p].length;for(var d=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),f=0,m=u;f<m.length;f+=1){var y=m[f];if(0!==y.length&&!as(y))for(var v=0,g=0;g<y.length;g++){var $=y[g];if(g>=1){var _=y[g-1];if(!aa($,_)){d.vertexLength+4>i8.MAX_VERTEX_ARRAY_LENGTH&&(d=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var x=$.sub(_)._perp()._unit(),b=_.dist($);v+b>32768&&(v=0),ai(this.layoutVertexArray,$.x,$.y,x.x,x.y,0,0,v),ai(this.layoutVertexArray,$.x,$.y,x.x,x.y,0,1,v),v+=b,ai(this.layoutVertexArray,_.x,_.y,x.x,x.y,0,0,v),ai(this.layoutVertexArray,_.x,_.y,x.x,x.y,0,1,v);var w=d.vertexLength;this.indexArray.emplaceBack(w,w+2,w+1),this.indexArray.emplaceBack(w+1,w+2,w+3),d.vertexLength+=4,d.primitiveLength+=2}}}}if(d.vertexLength+c>i8.MAX_VERTEX_ARRAY_LENGTH&&(d=this.segments.prepareSegment(c,this.layoutVertexArray,this.indexArray)),"Polygon"===an[r.type]){for(var E=[],T=[],S=d.vertexLength,C=0,I=u;C<I.length;C+=1){var k=I[C];if(0!==k.length){k!==u[0]&&T.push(E.length/2);for(var A=0;A<k.length;A++){var P=k[A];ai(this.layoutVertexArray,P.x,P.y,0,0,1,1,0),E.push(P.x),E.push(P.y)}}}for(var L=o8(E,T),D=0;D<L.length;D+=3)this.indexArray.emplaceBack(S+L[D],S+L[D+2],S+L[D+1]);d.primitiveLength+=L.length/3,d.vertexLength+=c}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,i,o)},r9("FillExtrusionBucket",ao,{omit:["layers","features"]});var al={paint:new n4({"fill-extrusion-opacity":new nP(tM["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new nL(tM["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new nP(tM["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new nP(tM["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new nD(tM["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new nL(tM["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new nL(tM["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new nP(tM["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},au=function(r){function n(n){r.call(this,n,al)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.createBucket=function(r){return new ao(r)},n.prototype.queryRadius=function(){return i9(this.paint.get("fill-extrusion-translate"))},n.prototype.is3D=function(){return!0},n.prototype.queryIntersectsFeature=function(r,n,i,o,a,s,u,p){var h=ot(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),s.angle,u),d=this.paint.get("fill-extrusion-height").evaluate(n,i),f=this.paint.get("fill-extrusion-base").evaluate(n,i),m=function(r,n,i,o){for(var a=[],s=0,u=r;s<u.length;s+=1){var p=u[s],h=[p.x,p.y,0,1];oi(h,h,n),a.push(new c(h[0]/h[3],h[1]/h[3]))}return a}(h,p,0,0),y=function(r,n,i,o){for(var a=[],s=[],u=o[8]*n,p=o[9]*n,h=o[10]*n,d=o[11]*n,f=o[8]*i,m=o[9]*i,y=o[10]*i,v=o[11]*i,g=0,$=r;g<$.length;g+=1){for(var _=$[g],x=[],b=[],w=0,E=_;w<E.length;w+=1){var T=E[w],S=T.x,C=T.y,I=o[0]*S+o[4]*C+o[12],k=o[1]*S+o[5]*C+o[13],A=o[2]*S+o[6]*C+o[14],P=o[3]*S+o[7]*C+o[15],L=A+h,D=P+d,z=I+f,M=k+m,R=A+y,B=P+v,F=new c((I+u)/D,(k+p)/D);F.z=L/D,x.push(F);var O=new c(z/B,M/B);O.z=R/B,b.push(O)}a.push(x),s.push(b)}return[a,s]}(o,f,d,p);return function(r,n,i){var o=1/0;ij(i,n)&&(o=ap(i,n[0]));for(var a=0;a<n.length;a++)for(var s=n[a],u=r[a],c=0;c<s.length-1;c++){var p=s[c],h=s[c+1],d=u[c],f=[p,h,u[c+1],d,p];iV(i,f)&&(o=Math.min(o,ap(i,f)))}return o!==1/0&&o}(y[0],y[1],m)},n}(nM);function ac(r,n){return r.x*n.x+r.y*n.y}function ap(r,n){if(1===r.length){for(var i,o,a=0,s=n[a++];!i||s.equals(i);)if(!(i=n[a++]))return 1/0;for(;!o||s.equals(o)||i.equals(o);)if(!(o=n[a++]))return 1/0;var u=r[0],c=i.sub(s),p=o.sub(s),h=u.sub(s),d=ac(c,c),f=ac(c,p),m=ac(p,p),y=ac(h,c),v=ac(h,p),g=d*m-f*f,$=(m*y-f*v)/g,_=(d*v-f*y)/g;return s.z*(1-$-_)+i.z*$+o.z*_}for(var x=1/0,b=0,w=n;b<w.length;b+=1)x=Math.min(x,w[b].z);return x}var ah=nO([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,ad=ar.VectorTileFeature.types,af=Math.cos(Math.PI/180*37.5),am=function(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new nU,this.indexArray=new n9,this.programConfigurations=new iB(ah,r.layers,r.zoom),this.segments=new i8,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};am.prototype.populate=function(r,n){this.hasPattern=oV("line",this.layers,n);for(var i=this.layers[0].layout.get("line-sort-key"),o=[],a=0,s=r;a<s.length;a+=1){var u=s[a],c=u.feature,p=u.id,h=u.index,d=u.sourceLayerIndex;if(this.layers[0]._featureFilter(new nE(this.zoom),c)){var f=i5(c),m=i?i.evaluate(c,{}):void 0,y={id:p,properties:c.properties,type:c.type,sourceLayerIndex:d,index:h,geometry:f,patterns:{},sortKey:m};o.push(y)}}i&&o.sort(function(r,n){return r.sortKey-n.sortKey});for(var v=0,g=o;v<g.length;v+=1){var $=g[v],_=$,x=_.geometry,b=_.index,w=_.sourceLayerIndex;if(this.hasPattern){var E=oq("line",this.layers,$,this.zoom,n);this.patternFeatures.push(E)}else this.addFeature($,x,b,{});var T=r[b].feature;n.featureIndex.insert(T,x,b,w,this.index)}},am.prototype.update=function(r,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,n,this.stateDependentLayers,i)},am.prototype.addFeatures=function(r,n){for(var i=0,o=this.patternFeatures;i<o.length;i+=1){var a=o[i];this.addFeature(a,a.geometry,a.index,n)}},am.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},am.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},am.prototype.upload=function(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,ah),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0},am.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},am.prototype.addFeature=function(r,n,i,o){for(var a=this.layers[0].layout,s=a.get("line-join").evaluate(r,{}),u=a.get("line-cap"),c=a.get("line-miter-limit"),p=a.get("line-round-limit"),h=0,d=n;h<d.length;h+=1){var f=d[h];this.addLine(f,r,s,u,c,p,i,o)}},am.prototype.addLine=function(r,n,i,o,a,s,u,c){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+n.properties.mapbox_clip_start,this.clipEnd=+n.properties.mapbox_clip_end;for(var p=0;p<r.length-1;p++)this.totalDistance+=r[p].dist(r[p+1])}for(var h="Polygon"===ad[n.type],d=r.length;d>=2&&r[d-1].equals(r[d-2]);)d--;for(var f=0;f<d-1&&r[f].equals(r[f+1]);)f++;if(!(d<(h?3:2))){"bevel"===i&&(a=1.05);var m,y=this.overscaling<=16?122880/(512*this.overscaling):0,v=this.segments.prepareSegment(10*d,this.layoutVertexArray,this.indexArray),g=void 0,$=void 0,_=void 0,x=void 0;this.e1=this.e2=-1,h&&(m=r[d-2],x=r[f].sub(m)._unit()._perp());for(var b=f;b<d;b++)if(!($=h&&b===d-1?r[f+1]:r[b+1])||!r[b].equals($)){x&&(_=x),m&&(g=m),m=r[b],x=$?$.sub(m)._unit()._perp():_;var w=(_=_||x).add(x);0===w.x&&0===w.y||w._unit();var E=_.x*x.x+_.y*x.y,T=w.x*x.x+w.y*x.y,S=0!==T?1/T:1/0,C=2*Math.sqrt(2-2*T),I=T<af&&g&&$,k=_.x*x.y-_.y*x.x>0;if(I&&b>f){var A=m.dist(g);if(A>2*y){var P=m.sub(m.sub(g)._mult(y/A)._round());this.updateDistance(g,P),this.addCurrentVertex(P,_,0,0,v),g=P}}var L=g&&$,D=L?i:h?"butt":o;if(L&&"round"===D&&(S<s?D="miter":S<=2&&(D="fakeround")),"miter"===D&&S>a&&(D="bevel"),"bevel"===D&&(S>2&&(D="flipbevel"),S<a&&(D="miter")),g&&this.updateDistance(g,m),"miter"===D)w._mult(S),this.addCurrentVertex(m,w,0,0,v);else if("flipbevel"===D){if(S>100)w=x.mult(-1);else{var z=S*_.add(x).mag()/_.sub(x).mag();w._perp()._mult(z*(k?-1:1))}this.addCurrentVertex(m,w,0,0,v),this.addCurrentVertex(m,w.mult(-1),0,0,v)}else if("bevel"===D||"fakeround"===D){var M=-Math.sqrt(S*S-1),R=k?M:0,B=k?0:M;if(g&&this.addCurrentVertex(m,_,R,B,v),"fakeround"===D)for(var F=Math.round(180*C/Math.PI/20),O=1;O<F;O++){var N=O/F;if(.5!==N){var U=N-.5;N+=N*U*(N-1)*((1.0904+E*(E*(3.55645-1.43519*E)-3.2452))*U*U+(.848013+E*(.215638*E-1.06021)))}var V=x.sub(_)._mult(N)._add(_)._unit()._mult(k?-1:1);this.addHalfVertex(m,V.x,V.y,!1,k,0,v)}$&&this.addCurrentVertex(m,x,-R,-B,v)}else if("butt"===D)this.addCurrentVertex(m,w,0,0,v);else if("square"===D){var q=g?1:-1;this.addCurrentVertex(m,w,q,q,v)}else"round"===D&&(g&&(this.addCurrentVertex(m,_,0,0,v),this.addCurrentVertex(m,_,1,1,v,!0)),$&&(this.addCurrentVertex(m,x,-1,-1,v,!0),this.addCurrentVertex(m,x,0,0,v)));if(I&&b<d-1){var j=m.dist($);if(j>2*y){var H=m.add($.sub(m)._mult(y/j)._round());this.updateDistance(m,H),this.addCurrentVertex(H,x,0,0,v),m=H}}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,c)}},am.prototype.addCurrentVertex=function(r,n,i,o,a,s){void 0===s&&(s=!1);var u=n.x+n.y*i,c=n.y-n.x*i,p=-n.x+n.y*o,h=-n.y-n.x*o;this.addHalfVertex(r,u,c,s,!1,i,a),this.addHalfVertex(r,p,h,s,!0,-o,a),this.distance>16384&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(r,n,i,o,a,s))},am.prototype.addHalfVertex=function(r,n,i,o,a,s,u){var c=r.x,p=r.y,h=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((c<<1)+(o?1:0),(p<<1)+(a?1:0),Math.round(63*n)+128,Math.round(63*i)+128,1+(0===s?0:s<0?-1:1)|(63&h)<<2,h>>6);var d=u.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,d),u.primitiveLength++),a?this.e2=d:this.e1=d},am.prototype.updateDistance=function(r,n){this.distance+=r.dist(n),this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*32767:this.distance},r9("LineBucket",am,{omit:["layers","patternFeatures"]});var ay=new n4({"line-cap":new nP(tM.layout_line["line-cap"]),"line-join":new nL(tM.layout_line["line-join"]),"line-miter-limit":new nP(tM.layout_line["line-miter-limit"]),"line-round-limit":new nP(tM.layout_line["line-round-limit"]),"line-sort-key":new nL(tM.layout_line["line-sort-key"])}),av={paint:new n4({"line-opacity":new nL(tM.paint_line["line-opacity"]),"line-color":new nL(tM.paint_line["line-color"]),"line-translate":new nP(tM.paint_line["line-translate"]),"line-translate-anchor":new nP(tM.paint_line["line-translate-anchor"]),"line-width":new nL(tM.paint_line["line-width"]),"line-gap-width":new nL(tM.paint_line["line-gap-width"]),"line-offset":new nL(tM.paint_line["line-offset"]),"line-blur":new nL(tM.paint_line["line-blur"]),"line-dasharray":new nz(tM.paint_line["line-dasharray"]),"line-pattern":new nD(tM.paint_line["line-pattern"]),"line-gradient":new n3(tM.paint_line["line-gradient"])}),layout:ay},ag=new(function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.possiblyEvaluate=function(n,i){return i=new nE(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),r.prototype.possiblyEvaluate.call(this,n,i)},n.prototype.evaluate=function(n,i,o,a){return i=y({},i,{zoom:Math.floor(i.zoom)}),r.prototype.evaluate.call(this,n,i,o,a)},n}(nL))(av.paint.properties["line-width"].specification);ag.useIntegerZoom=!0;var a8=function(r){function n(n){r.call(this,n,av)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._handleSpecialPaintPropertyUpdate=function(r){"line-gradient"===r&&this._updateGradient()},n.prototype._updateGradient=function(){var r=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=of(r,"lineProgress"),this.gradientTexture=null},n.prototype.recalculate=function(n,i){r.prototype.recalculate.call(this,n,i),this.paint._values["line-floorwidth"]=ag.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)},n.prototype.createBucket=function(r){return new am(r)},n.prototype.queryRadius=function(r){var n=r,i=a$(iQ("line-width",this,n),iQ("line-gap-width",this,n)),o=iQ("line-offset",this,n);return i/2+Math.abs(o)+i9(this.paint.get("line-translate"))},n.prototype.queryIntersectsFeature=function(r,n,i,o,a,s,u){var p=ot(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),s.angle,u),h=u/2*a$(this.paint.get("line-width").evaluate(n,i),this.paint.get("line-gap-width").evaluate(n,i)),d=this.paint.get("line-offset").evaluate(n,i);return d&&(o=function(r,n){for(var i=[],o=new c(0,0),a=0;a<r.length;a++){for(var s=r[a],u=[],p=0;p<s.length;p++){var h=s[p-1],d=s[p],f=s[p+1],m=0===p?o:d.sub(h)._unit()._perp(),y=p===s.length-1?o:f.sub(d)._unit()._perp(),v=m._add(y)._unit(),g=v.x*y.x+v.y*y.y;v._mult(1/g),u.push(v._mult(n)._add(d))}i.push(u)}return i}(o,d*u)),function(r,n,i){for(var o=0;o<n.length;o++){var a=n[o];if(r.length>=3){for(var s=0;s<a.length;s++)if(iY(r,a[s]))return!0}if(iH(r,a,i))return!0}return!1}(p,o,h)},n.prototype.isTileClipped=function(){return!0},n}(nM);function a$(r,n){return n>0?n+2*r:r}var a_=nO([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ax=nO([{name:"a_projected_pos",components:3,type:"Float32"}],4),ab=(nO([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),nO([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),aw=(nO([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),nO([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),a0=nO([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);function aE(r,n,i){return r.sections.forEach(function(r){var o,a,s,u;r.text=(o=r.text,a=n,s=i,"uppercase"===(u=a.layout.get("text-transform").evaluate(s,{}))?o=o.toLocaleUpperCase():"lowercase"===u&&(o=o.toLocaleLowerCase()),n0.applyArabicShaping&&(o=n0.applyArabicShaping(o)),o)}),r}nO([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),nO([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"}]),nO([{type:"Float32",name:"offsetX"}]),nO([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var aT={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","\xa2":"￠","\xa3":"￡","\xa5":"￥","\xa6":"￤","\xac":"￢","\xaf":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},aS=function(r,n,i,o,a){var s,u,c=8*a-o-1,p=(1<<c)-1,h=p>>1,d=-7,f=i?a-1:0,m=i?-1:1,y=r[n+f];for(f+=m,s=y&(1<<-d)-1,y>>=-d,d+=c;d>0;s=256*s+r[n+f],f+=m,d-=8);for(u=s&(1<<-d)-1,s>>=-d,d+=o;d>0;u=256*u+r[n+f],f+=m,d-=8);if(0===s)s=1-h;else{if(s===p)return u?NaN:1/0*(y?-1:1);u+=Math.pow(2,o),s-=h}return(y?-1:1)*u*Math.pow(2,s-o)},aC=function(r,n,i,o,a,s){var u,c,p,h=8*s-a-1,d=(1<<h)-1,f=d>>1,m=23===a?5960464477539062e-23:0,y=o?0:s-1,v=o?1:-1,g=n<0||0===n&&1/n<0?1:0;for(isNaN(n=Math.abs(n))||n===1/0?(c=isNaN(n)?1:0,u=d):(u=Math.floor(Math.log(n)/Math.LN2),n*(p=Math.pow(2,-u))<1&&(u--,p*=2),(n+=u+f>=1?m/p:m*Math.pow(2,1-f))*p>=2&&(u++,p/=2),u+f>=d?(c=0,u=d):u+f>=1?(c=(n*p-1)*Math.pow(2,a),u+=f):(c=n*Math.pow(2,f-1)*Math.pow(2,a),u=0));a>=8;r[i+y]=255&c,y+=v,c/=256,a-=8);for(u=u<<a|c,h+=a;h>0;r[i+y]=255&u,y+=v,u/=256,h-=8);r[i+y-v]|=128*g},aI=ak;function ak(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}ak.Varint=0,ak.Fixed64=1,ak.Bytes=2,ak.Fixed32=5;var a1="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function a2(r){return r.type===ak.Bytes?r.readVarint()+r.pos:r.pos+1}function aA(r,n,i){var o=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));i.realloc(o);for(var a=i.pos-1;a>=r;a--)i.buf[a+o]=i.buf[a]}function aP(r,n){for(var i=0;i<r.length;i++)n.writeVarint(r[i])}function aL(r,n){for(var i=0;i<r.length;i++)n.writeSVarint(r[i])}function aD(r,n){for(var i=0;i<r.length;i++)n.writeFloat(r[i])}function az(r,n){for(var i=0;i<r.length;i++)n.writeDouble(r[i])}function a3(r,n){for(var i=0;i<r.length;i++)n.writeBoolean(r[i])}function a4(r,n){for(var i=0;i<r.length;i++)n.writeFixed32(r[i])}function aM(r,n){for(var i=0;i<r.length;i++)n.writeSFixed32(r[i])}function aR(r,n){for(var i=0;i<r.length;i++)n.writeFixed64(r[i])}function aB(r,n){for(var i=0;i<r.length;i++)n.writeSFixed64(r[i])}function aF(r,n){return(r[n]|r[n+1]<<8|r[n+2]<<16)+16777216*r[n+3]}function aO(r,n,i){r[i]=n,r[i+1]=n>>>8,r[i+2]=n>>>16,r[i+3]=n>>>24}function a6(r,n){return(r[n]|r[n+1]<<8|r[n+2]<<16)+(r[n+3]<<24)}function a7(r,n,i){1===r&&i.readMessage(a5,n)}function a5(r,n,i){if(3===r){var o=i.readMessage(aN,{}),a=o.id,s=o.bitmap,u=o.width,c=o.height,p=o.left,h=o.top,d=o.advance;n.push({id:a,bitmap:new op({width:u+6,height:c+6},s),metrics:{width:u,height:c,left:p,top:h,advance:d}})}}function aN(r,n,i){1===r?n.id=i.readVarint():2===r?n.bitmap=i.readBytes():3===r?n.width=i.readVarint():4===r?n.height=i.readVarint():5===r?n.left=i.readSVarint():6===r?n.top=i.readSVarint():7===r&&(n.advance=i.readVarint())}function aU(r){for(var n=0,i=0,o=0,a=r;o<a.length;o+=1){var s=a[o];n+=s.w*s.h,i=Math.max(i,s.w)}r.sort(function(r,n){return n.h-r.h});for(var u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),i),h:1/0}],c=0,p=0,h=0,d=r;h<d.length;h+=1)for(var f=d[h],m=u.length-1;m>=0;m--){var y=u[m];if(!(f.w>y.w||f.h>y.h)){if(f.x=y.x,f.y=y.y,p=Math.max(p,f.y+f.h),c=Math.max(c,f.x+f.w),f.w===y.w&&f.h===y.h){var v=u.pop();m<u.length&&(u[m]=v)}else f.h===y.h?(y.x+=f.w,y.w-=f.w):f.w===y.w?(y.y+=f.h,y.h-=f.h):(u.push({x:y.x+f.w,y:y.y,w:y.w-f.w,h:f.h}),y.y+=f.h,y.h-=f.h);break}}return{w:c,h:p,fill:n/(c*p)||0}}ak.prototype={destroy:function(){this.buf=null},readFields:function(r,n,i){for(i=i||this.length;this.pos<i;){var o=this.readVarint(),a=o>>3,s=this.pos;this.type=7&o,r(a,n,this),this.pos===s&&this.skip(o)}return n},readMessage:function(r,n){return this.readFields(r,n,this.readVarint()+this.pos)},readFixed32:function(){var r=aF(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=a6(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=aF(this.buf,this.pos)+4294967296*aF(this.buf,this.pos+4);return this.pos+=8,r},readSFixed64:function(){var r=aF(this.buf,this.pos)+4294967296*a6(this.buf,this.pos+4);return this.pos+=8,r},readFloat:function(){var r=aS(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=aS(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var n,i,o=this.buf;return n=127&(i=o[this.pos++]),i<128?n:(n|=(127&(i=o[this.pos++]))<<7,i<128?n:(n|=(127&(i=o[this.pos++]))<<14,i<128?n:(n|=(127&(i=o[this.pos++]))<<21,i<128?n:function(r,n,i){var o,a,s,u,c,p=i.buf;if(u=(112&(c=p[i.pos++]))>>4,c<128||(u|=(127&(c=p[i.pos++]))<<3,c<128)||(u|=(127&(c=p[i.pos++]))<<10,c<128)||(u|=(127&(c=p[i.pos++]))<<17,c<128)||(u|=(127&(c=p[i.pos++]))<<24,c<128)||(u|=(1&(c=p[i.pos++]))<<31,c<128)){return o=r,a=u,s=n,s?4294967296*a+(o>>>0):4294967296*(a>>>0)+(o>>>0)}throw Error("Expected varint not more than 10 bytes")}(n|=(15&(i=o[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?-((r+1)/2):r/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var r,n,i,o=this.readVarint()+this.pos,a=this.pos;return this.pos=o,o-a>=12&&a1?(r=this.buf,n=a,i=o,a1.decode(r.subarray(n,i))):function(r,n,i){for(var o="",a=n;a<i;){var s,u,c,p=r[a],h=null,d=p>239?4:p>223?3:p>191?2:1;if(a+d>i)break;1===d?p<128&&(h=p):2===d?128==(192&(s=r[a+1]))&&(h=(31&p)<<6|63&s)<=127&&(h=null):3===d?(s=r[a+1],u=r[a+2],128==(192&s)&&128==(192&u)&&((h=(15&p)<<12|(63&s)<<6|63&u)<=2047||h>=55296&&h<=57343)&&(h=null)):4===d&&(s=r[a+1],u=r[a+2],c=r[a+3],128==(192&s)&&128==(192&u)&&128==(192&c)&&((h=(15&p)<<18|(63&s)<<12|(63&u)<<6|63&c)<=65535||h>=1114112)&&(h=null)),null===h?(h=65533,d=1):h>65535&&(h-=65536,o+=String.fromCharCode(h>>>10&1023|55296),h=56320|1023&h),o+=String.fromCharCode(h),a+=d}return o}(this.buf,a,o)},readBytes:function(){var r=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,r);return this.pos=r,n},readPackedVarint:function(r,n){if(this.type!==ak.Bytes)return r.push(this.readVarint(n));var i=a2(this);for(r=r||[];this.pos<i;)r.push(this.readVarint(n));return r},readPackedSVarint:function(r){if(this.type!==ak.Bytes)return r.push(this.readSVarint());var n=a2(this);for(r=r||[];this.pos<n;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==ak.Bytes)return r.push(this.readBoolean());var n=a2(this);for(r=r||[];this.pos<n;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==ak.Bytes)return r.push(this.readFloat());var n=a2(this);for(r=r||[];this.pos<n;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==ak.Bytes)return r.push(this.readDouble());var n=a2(this);for(r=r||[];this.pos<n;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==ak.Bytes)return r.push(this.readFixed32());var n=a2(this);for(r=r||[];this.pos<n;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==ak.Bytes)return r.push(this.readSFixed32());var n=a2(this);for(r=r||[];this.pos<n;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==ak.Bytes)return r.push(this.readFixed64());var n=a2(this);for(r=r||[];this.pos<n;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==ak.Bytes)return r.push(this.readSFixed64());var n=a2(this);for(r=r||[];this.pos<n;)r.push(this.readSFixed64());return r},skip:function(r){var n=7&r;if(n===ak.Varint)for(;this.buf[this.pos++]>127;);else if(n===ak.Bytes)this.pos=this.readVarint()+this.pos;else if(n===ak.Fixed32)this.pos+=4;else{if(n!==ak.Fixed64)throw Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(r,n){this.writeVarint(r<<3|n)},realloc:function(r){for(var n=this.length||16;n<this.pos+r;)n*=2;if(n!==this.length){var i=new Uint8Array(n);i.set(this.buf),this.buf=i,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),aO(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),aO(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),aO(this.buf,-1&r,this.pos),aO(this.buf,Math.floor(r*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),aO(this.buf,-1&r,this.pos),aO(this.buf,Math.floor(r*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(r,n){var i,o,a,s,u,c,p;if(r>=0?(i=r%4294967296|0,o=r/4294967296|0):(o=~(-r/4294967296),4294967295^(i=~(-r%4294967296))?i=i+1|0:(i=0,o=o+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw Error("Given varint doesn't fit into 10 bytes");n.realloc(10),a=i,(s=n).buf[s.pos++]=127&a|128,a>>>=7,s.buf[s.pos++]=127&a|128,a>>>=7,s.buf[s.pos++]=127&a|128,a>>>=7,s.buf[s.pos++]=127&a|128,a>>>=7,s.buf[s.pos]=127&a,u=o,c=n,p=(7&u)<<4,c.buf[c.pos++]|=p|((u>>>=3)?128:0),u&&(c.buf[c.pos++]=127&u|((u>>>=7)?128:0),u)&&(c.buf[c.pos++]=127&u|((u>>>=7)?128:0),u)&&(c.buf[c.pos++]=127&u|((u>>>=7)?128:0),u)&&(c.buf[c.pos++]=127&u|((u>>>=7)?128:0),u&&(c.buf[c.pos++]=127&u))}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?-(2*r)-1:2*r)},writeBoolean:function(r){this.writeVarint(Boolean(r))},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var n=this.pos;this.pos=function(r,n,i){for(var o,a,s=0;s<n.length;s++){if((o=n.charCodeAt(s))>55295&&o<57344){if(!a){o>56319||s+1===n.length?(r[i++]=239,r[i++]=191,r[i++]=189):a=o;continue}if(o<56320){r[i++]=239,r[i++]=191,r[i++]=189,a=o;continue}o=a-55296<<10|o-56320|65536,a=null}else a&&(r[i++]=239,r[i++]=191,r[i++]=189,a=null);o<128?r[i++]=o:(o<2048?r[i++]=o>>6|192:(o<65536?r[i++]=o>>12|224:(r[i++]=o>>18|240,r[i++]=o>>12&63|128),r[i++]=o>>6&63|128),r[i++]=63&o|128)}return i}(this.buf,r,this.pos);var i=this.pos-n;i>=128&&aA(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeFloat:function(r){this.realloc(4),aC(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),aC(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var n=r.length;this.writeVarint(n),this.realloc(n);for(var i=0;i<n;i++)this.buf[this.pos++]=r[i]},writeRawMessage:function(r,n){this.pos++;var i=this.pos;r(n,this);var o=this.pos-i;o>=128&&aA(i,o,this),this.pos=i-1,this.writeVarint(o),this.pos+=o},writeMessage:function(r,n,i){this.writeTag(r,ak.Bytes),this.writeRawMessage(n,i)},writePackedVarint:function(r,n){n.length&&this.writeMessage(r,aP,n)},writePackedSVarint:function(r,n){n.length&&this.writeMessage(r,aL,n)},writePackedBoolean:function(r,n){n.length&&this.writeMessage(r,a3,n)},writePackedFloat:function(r,n){n.length&&this.writeMessage(r,aD,n)},writePackedDouble:function(r,n){n.length&&this.writeMessage(r,az,n)},writePackedFixed32:function(r,n){n.length&&this.writeMessage(r,a4,n)},writePackedSFixed32:function(r,n){n.length&&this.writeMessage(r,aM,n)},writePackedFixed64:function(r,n){n.length&&this.writeMessage(r,aR,n)},writePackedSFixed64:function(r,n){n.length&&this.writeMessage(r,aB,n)},writeBytesField:function(r,n){this.writeTag(r,ak.Bytes),this.writeBytes(n)},writeFixed32Field:function(r,n){this.writeTag(r,ak.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(r,n){this.writeTag(r,ak.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(r,n){this.writeTag(r,ak.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(r,n){this.writeTag(r,ak.Fixed64),this.writeSFixed64(n)},writeVarintField:function(r,n){this.writeTag(r,ak.Varint),this.writeVarint(n)},writeSVarintField:function(r,n){this.writeTag(r,ak.Varint),this.writeSVarint(n)},writeStringField:function(r,n){this.writeTag(r,ak.Bytes),this.writeString(n)},writeFloatField:function(r,n){this.writeTag(r,ak.Fixed32),this.writeFloat(n)},writeDoubleField:function(r,n){this.writeTag(r,ak.Fixed64),this.writeDouble(n)},writeBooleanField:function(r,n){this.writeVarintField(r,Boolean(n))}};var aV=function(r,n){var i=n.pixelRatio,o=n.version,a=n.stretchX,s=n.stretchY,u=n.content;this.paddedRect=r,this.pixelRatio=i,this.stretchX=a,this.stretchY=s,this.content=u,this.version=o},aq={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};aq.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},aq.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},aq.tlbr.get=function(){return this.tl.concat(this.br)},aq.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(aV.prototype,aq);var aj=function(r,n){var i={},o={};this.haveRenderCallbacks=[];var a=[];this.addImages(r,i,a),this.addImages(n,o,a);var s=aU(a),u=s.w,c=s.h,p=new oh({width:u||1,height:c||1});for(var h in r){var d=r[h],f=i[h].paddedRect;oh.copy(d.data,p,{x:0,y:0},{x:f.x+1,y:f.y+1},d.data)}for(var m in n){var y=n[m],v=o[m].paddedRect,g=v.x+1,$=v.y+1,_=y.data.width,x=y.data.height;oh.copy(y.data,p,{x:0,y:0},{x:g,y:$},y.data),oh.copy(y.data,p,{x:0,y:x-1},{x:g,y:$-1},{width:_,height:1}),oh.copy(y.data,p,{x:0,y:0},{x:g,y:$+x},{width:_,height:1}),oh.copy(y.data,p,{x:_-1,y:0},{x:g-1,y:$},{width:1,height:x}),oh.copy(y.data,p,{x:0,y:0},{x:g+_,y:$},{width:1,height:x})}this.image=p,this.iconPositions=i,this.patternPositions=o};aj.prototype.addImages=function(r,n,i){for(var o in r){var a=r[o],s={x:0,y:0,w:a.data.width+2,h:a.data.height+2};i.push(s),n[o]=new aV(s,a),a.hasRenderCallback&&this.haveRenderCallbacks.push(o)}},aj.prototype.patchUpdatedImages=function(r,n){for(var i in r.dispatchRenderCallbacks(this.haveRenderCallbacks),r.updatedImages)this.patchUpdatedImage(this.iconPositions[i],r.getImage(i),n),this.patchUpdatedImage(this.patternPositions[i],r.getImage(i),n)},aj.prototype.patchUpdatedImage=function(r,n,i){if(r&&n&&r.version!==n.version){r.version=n.version;var o=r.tl,a=o[0],s=o[1];i.update(n.data,void 0,{x:a,y:s})}},r9("ImagePosition",aV),r9("ImageAtlas",aj);var aH={horizontal:1,vertical:2,horizontalOnly:3},aG=function(){this.scale=1,this.fontStack="",this.imageName=null};aG.forText=function(r,n){var i=new aG;return i.scale=r||1,i.fontStack=n,i},aG.forImage=function(r){var n=new aG;return n.imageName=r,n};var aZ=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function aW(r,n,i,o,a,s,u,c,p,h,d,f,m,y,v,g){var $,_=aZ.fromFeature(r,a);f===aH.vertical&&_.verticalizePunctuation();var x=n0.processBidirectionalText,b=n0.processStyledBidirectionalText;if(x&&1===_.sections.length){$=[];for(var w=0,E=x(_.toString(),st(_,h,s,n,o,y,v));w<E.length;w+=1){var T=E[w],S=new aZ;S.text=T,S.sections=_.sections;for(var C=0;C<T.length;C++)S.sectionIndex.push(0);$.push(S)}}else if(b){$=[];for(var I=0,k=b(_.text,_.sectionIndex,st(_,h,s,n,o,y,v));I<k.length;I+=1){var A=k[I],P=new aZ;P.text=A[0],P.sectionIndex=A[1],P.sections=_.sections,$.push(P)}}else $=function(r,n){for(var i=[],o=r.text,a=0,s=0,u=n;s<u.length;s+=1){var c=u[s];i.push(r.substring(a,c)),a=c}return a<o.length&&i.push(r.substring(a,o.length)),i}(_,st(_,h,s,n,o,y,v));var L=[],D={positionedLines:L,text:_.toString(),top:d[1],bottom:d[1],left:d[0],right:d[0],writingMode:f,iconsInText:!1,verticalizable:!1};return function(r,n,i,o,a,s,u,c,p,h,d,f){for(var m,y=0,v=-17,g=0,$=0,_="right"===c?1:"left"===c?0:.5,x=0,b=0,w=a;b<w.length;b+=1){var E=w[b];E.trim();var T=E.getMaxScale(),S=(T-1)*24,C={positionedGlyphs:[],lineOffset:0};r.positionedLines[x]=C;var I=C.positionedGlyphs,k=0;if(E.length()){for(var A=0;A<E.length();A++){var P=E.getSection(A),L=E.getSectionIndex(A),D=E.getCharCode(A),z=0,M=null,R=null,B=null,F=24,O=!(p===aH.horizontal||!d&&!nu(D)||d&&(aX[D]||(m=D,na.Arabic(m)||na["Arabic Supplement"](m)||na["Arabic Extended-A"](m)||na["Arabic Presentation Forms-A"](m)||na["Arabic Presentation Forms-B"](m))));if(P.imageName){var N=o[P.imageName];if(!N)continue;B=P.imageName,r.iconsInText=r.iconsInText||!0,R=N.paddedRect;var U=N.displaySize;P.scale=24*P.scale/f,M={width:U[0],height:U[1],left:1,top:-3,advance:O?U[1]:U[0]},z=S+(24-U[1]*P.scale),F=M.advance;var V=O?U[0]*P.scale-24*T:U[1]*P.scale-24*T;V>0&&V>k&&(k=V)}else{var q=i[P.fontStack],j=q&&q[D];if(j&&j.rect)R=j.rect,M=j.metrics;else{var H=n[P.fontStack],G=H&&H[D];if(!G)continue;M=G.metrics}z=(T-P.scale)*24}O?(r.verticalizable=!0,I.push({glyph:D,imageName:B,x:y,y:v+z,vertical:O,scale:P.scale,fontStack:P.fontStack,sectionIndex:L,metrics:M,rect:R}),y+=F*P.scale+h):(I.push({glyph:D,imageName:B,x:y,y:v+z,vertical:O,scale:P.scale,fontStack:P.fontStack,sectionIndex:L,metrics:M,rect:R}),y+=M.advance*P.scale+h)}0!==I.length&&(g=Math.max(y-h,g),sr(I,0,I.length-1,_,k)),y=0;var Z=s*T+k;C.lineOffset=Math.max(k,S),v+=Z,$=Math.max(Z,$),++x}else v+=s,++x}var W=v- -17,X=se(u),K=X.horizontalAlign,Y=X.verticalAlign;(function(r,n,i,o,a,s,u,c,p){var h=(n-i)*a,d=0;d=s!==u?-c*o- -17:(-o*p+.5)*u;for(var f=0,m=r;f<m.length;f+=1)for(var y=m[f],v=0,g=y.positionedGlyphs;v<g.length;v+=1){var $=g[v];$.x+=h,$.y+=d}})(r.positionedLines,_,K,Y,g,$,s,W,a.length),r.top+=-Y*W,r.bottom=r.top+W,r.left+=-K*g,r.right=r.left+g}(D,n,i,o,$,u,c,p,f,h,m,g),!function(r){for(var n=0,i=r;n<i.length;n+=1)if(0!==i[n].positionedGlyphs.length)return!1;return!0}(L)&&D}aZ.fromFeature=function(r,n){for(var i=new aZ,o=0;o<r.sections.length;o++){var a=r.sections[o];a.image?i.addImageSection(a):i.addTextSection(a,n)}return i},aZ.prototype.length=function(){return this.text.length},aZ.prototype.getSection=function(r){return this.sections[this.sectionIndex[r]]},aZ.prototype.getSectionIndex=function(r){return this.sectionIndex[r]},aZ.prototype.getCharCode=function(r){return this.text.charCodeAt(r)},aZ.prototype.verticalizePunctuation=function(){this.text=function(r){for(var n="",i=0;i<r.length;i++){var o=r.charCodeAt(i+1)||null,a=r.charCodeAt(i-1)||null;o&&nc(o)&&!aT[r[i+1]]||a&&nc(a)&&!aT[r[i-1]]||!aT[r[i]]?n+=r[i]:n+=aT[r[i]]}return n}(this.text)},aZ.prototype.trim=function(){for(var r=0,n=0;n<this.text.length&&aX[this.text.charCodeAt(n)];n++)r++;for(var i=this.text.length,o=this.text.length-1;o>=0&&o>=r&&aX[this.text.charCodeAt(o)];o--)i--;this.text=this.text.substring(r,i),this.sectionIndex=this.sectionIndex.slice(r,i)},aZ.prototype.substring=function(r,n){var i=new aZ;return i.text=this.text.substring(r,n),i.sectionIndex=this.sectionIndex.slice(r,n),i.sections=this.sections,i},aZ.prototype.toString=function(){return this.text},aZ.prototype.getMaxScale=function(){var r=this;return this.sectionIndex.reduce(function(n,i){return Math.max(n,r.sections[i].scale)},0)},aZ.prototype.addTextSection=function(r,n){this.text+=r.text,this.sections.push(aG.forText(r.scale,r.fontStack||n));for(var i=this.sections.length-1,o=0;o<r.text.length;++o)this.sectionIndex.push(i)},aZ.prototype.addImageSection=function(r){var n=r.image?r.image.name:"";if(0!==n.length){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(aG.forImage(n)),this.sectionIndex.push(this.sections.length-1)):C("Reached maximum number of images 6401")}else C("Can't add FormattedSection with an empty image.")},aZ.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var aX={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},aK={};function aY(r,n,i,o,a,s){if(n.imageName){var u=o[n.imageName];return u?u.displaySize[0]*n.scale*24/s+a:0}var c=i[n.fontStack],p=c&&c[r];return p?p.metrics.advance*n.scale+a:0}function aJ(r,n,i,o){var a=Math.pow(r-n,2);return o?r<n?a/2:2*a:a+Math.abs(i)*i}function aQ(r,n,i){var o=0;return 10===r&&(o-=1e4),i&&(o+=150),40!==r&&65288!==r||(o+=50),41!==n&&65289!==n||(o+=50),o}function a9(r,n,i,o,a,s){for(var u=null,c=aJ(n,i,a,s),p=0,h=o;p<h.length;p+=1){var d=h[p],f=aJ(n-d.x,i,a,s)+d.badness;f<=c&&(u=d,c=f)}return{index:r,x:n,priorBreak:u,badness:c}}function st(r,n,i,o,a,s,u){if("point"!==s||!r)return[];for(var c,p=[],h=function(r,n,i,o,a,s){for(var u=0,c=0;c<r.length();c++){var p=r.getSection(c);u+=aY(r.getCharCode(c),p,o,a,n,s)}return u/Math.max(1,Math.ceil(u/i))}(r,n,i,o,a,u),d=r.text.indexOf("​")>=0,f=0,m=0;m<r.length();m++){var y=r.getSection(m),v=r.getCharCode(m);if(aX[v]||(f+=aY(v,y,o,a,n,u)),m<r.length()-1){var g=!!(!((c=v)<11904)&&(na["Bopomofo Extended"](c)||na.Bopomofo(c)||na["CJK Compatibility Forms"](c)||na["CJK Compatibility Ideographs"](c)||na["CJK Compatibility"](c)||na["CJK Radicals Supplement"](c)||na["CJK Strokes"](c)||na["CJK Symbols and Punctuation"](c)||na["CJK Unified Ideographs Extension A"](c)||na["CJK Unified Ideographs"](c)||na["Enclosed CJK Letters and Months"](c)||na["Halfwidth and Fullwidth Forms"](c)||na.Hiragana(c)||na["Ideographic Description Characters"](c)||na["Kangxi Radicals"](c)||na["Katakana Phonetic Extensions"](c)||na.Katakana(c)||na["Vertical Forms"](c)||na["Yi Radicals"](c)||na["Yi Syllables"](c)));(aK[v]||g||y.imageName)&&p.push(a9(m+1,f,h,p,aQ(v,r.getCharCode(m+1),g&&d),!1))}}return function r(n){return n?r(n.priorBreak).concat(n.index):[]}(a9(r.length(),f,h,p,0,!0))}function se(r){var n=.5,i=.5;switch(r){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:n,verticalAlign:i}}function sr(r,n,i,o,a){if(o||a)for(var s=r[i],u=s.metrics.advance*s.scale,c=(r[i].x+u)*o,p=n;p<=i;p++)r[p].x-=c,r[p].y+=a}function sn(r,n,i,o,a,s){var u,c=r.image;if(c.content){var p=c.content,h=c.pixelRatio||1;u=[p[0]/h,p[1]/h,c.displaySize[0]-p[2]/h,c.displaySize[1]-p[3]/h]}var d,f,m,y,v=n.left*s,g=n.right*s;"width"===i||"both"===i?(y=a[0]+v-o[3],f=a[0]+g+o[1]):f=(y=a[0]+(v+g-c.displaySize[0])/2)+c.displaySize[0];var $=n.top*s,_=n.bottom*s;return"height"===i||"both"===i?(d=a[1]+$-o[0],m=a[1]+_+o[2]):m=(d=a[1]+($+_-c.displaySize[1])/2)+c.displaySize[1],{image:c,top:d,right:f,bottom:m,left:y,collisionPadding:u}}aK[10]=!0,aK[32]=!0,aK[38]=!0,aK[40]=!0,aK[41]=!0,aK[43]=!0,aK[45]=!0,aK[47]=!0,aK[173]=!0,aK[183]=!0,aK[8203]=!0,aK[8208]=!0,aK[8211]=!0,aK[8231]=!0;var si=function(r){function n(n,i,o,a){r.call(this,n,i),this.angle=o,void 0!==a&&(this.segment=a)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.clone=function(){return new n(this.x,this.y,this.angle,this.segment)},n}(c);function so(r,n){var i=n.expression;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new nE(r+1))};if("source"===i.kind)return{kind:"source"};for(var o=i.zoomStops,a=i.interpolationType,s=0;s<o.length&&o[s]<=r;)s++;for(var u=s=Math.max(0,s-1);u<o.length&&o[u]<r+1;)u++;u=Math.min(o.length-1,u);var c=o[s],p=o[u];return"composite"===i.kind?{kind:"composite",minZoom:c,maxZoom:p,interpolationType:a}:{kind:"camera",minZoom:c,maxZoom:p,minSize:i.evaluate(new nE(c)),maxSize:i.evaluate(new nE(p)),interpolationType:a}}function sa(r,n,i){var o=n.uSize,a=n.uSizeT,s=i.lowerSize,u=i.upperSize;return"source"===r.kind?s/128:"composite"===r.kind?eT(s/128,u/128,a):o}function ss(r,n){var i=0,o=0;if("constant"===r.kind)o=r.layoutSize;else if("source"!==r.kind){var a=r.interpolationType,s=r.minZoom,u=r.maxZoom,c=a?f(eF.interpolationFactor(a,n,s,u),0,1):0;"camera"===r.kind?o=eT(r.minSize,r.maxSize,c):i=c}return{uSizeT:i,uSize:o}}r9("Anchor",si);var sl=Object.freeze({__proto__:null,getSizeData:so,evaluateSizeForFeature:sa,evaluateSizeForZoom:ss,SIZE_PACK_FACTOR:128});function su(r,n,i,o,a){if(void 0===n.segment)return!0;for(var s=n,u=n.segment+1,c=0;c>-i/2;){if(--u<0)return!1;c-=r[u].dist(s),s=r[u]}c+=r[u].dist(r[u+1]),u++;for(var p=[],h=0;c<i/2;){var d=r[u-1],f=r[u],m=r[u+1];if(!m)return!1;var y=d.angleTo(f)-f.angleTo(m);for(y=Math.abs((y+3*Math.PI)%(2*Math.PI)-Math.PI),p.push({distance:c,angleDelta:y}),h+=y;c-p[0].distance>o;)h-=p.shift().angleDelta;if(h>a)return!1;u++,c+=f.dist(m)}return!0}function sc(r){for(var n=0,i=0;i<r.length-1;i++)n+=r[i].dist(r[i+1]);return n}function sp(r,n,i){return r?.6*n*i:0}function sh(r,n){return Math.max(r?r.right-r.left:0,n?n.right-n.left:0)}function sd(r,n,i,o,a,s){for(var u=sp(i,a,s),c=sh(i,o)*s,p=0,h=sc(r)/2,d=0;d<r.length-1;d++){var f=r[d],m=r[d+1],y=f.dist(m);if(p+y>h){var v=(h-p)/y,g=eT(f.x,m.x,v),$=eT(f.y,m.y,v),_=new si(g,$,m.angleTo(f),d);return _._round(),!u||su(r,_,c,u,n)?_:void 0}p+=y}}function sf(r,n,i,o,a,s,u,c,p){var h=sp(o,s,u),d=sh(o,a),f=d*u,m=0===r[0].x||r[0].x===p||0===r[0].y||r[0].y===p;return n-f<n/4&&(n=f+n/4),function r(n,i,o,a,s,u,c,p,h){for(var d=u/2,f=sc(n),m=0,y=i-o,v=[],g=0;g<n.length-1;g++){for(var $=n[g],_=n[g+1],x=$.dist(_),b=_.angleTo($);y+o<m+x;){var w=((y+=o)-m)/x,E=eT($.x,_.x,w),T=eT($.y,_.y,w);if(E>=0&&E<h&&T>=0&&T<h&&y-d>=0&&y+d<=f){var S=new si(E,T,b,g);S._round(),a&&!su(n,S,u,a,s)||v.push(S)}}m+=x}return p||v.length||c||(v=r(n,m/2,o,a,s,u,c,!0,h)),v}(r,m?n/2*c%n:(d/2+2*s)*u*c%n,n,h,i,f,m,!1,p)}function sm(r,n,i,o){var a=[],s=r.image,u=s.pixelRatio,p=s.paddedRect.w-2,h=s.paddedRect.h-2,d=r.right-r.left,f=r.bottom-r.top,m=s.stretchX||[[0,p]],y=s.stretchY||[[0,h]],v=function(r,n){return r+n[1]-n[0]},g=m.reduce(v,0),$=y.reduce(v,0),_=p-g,x=h-$,b=0,w=g,E=0,T=$,S=0,C=_,I=0,k=x;if(s.content&&o){var A=s.content;b=sy(m,0,A[0]),E=sy(y,0,A[1]),w=sy(m,A[0],A[2]),T=sy(y,A[1],A[3]),S=A[0]-b,I=A[1]-E,C=A[2]-A[0]-w,k=A[3]-A[1]-T}var P=function(o,a,p,h){var m,y,v,_,x,A,P,L,D,z,M,R,B,F,O,N,U,V,q,j,H,G,Z,W,X,K,Y,J,Q,tt,te,tr,tn=(m=o.stretch-b,y=w,v=d,_=r.left,m/y*v+_),ti=(x=o.fixed-S,A=C,P=o.stretch,L=g,x-A*P/L),to=(D=a.stretch-E,z=T,M=f,R=r.top,D/z*M+R),ta=(B=a.fixed-I,F=k,O=a.stretch,N=$,B-F*O/N),ts=(U=p.stretch-b,V=w,q=d,j=r.left,U/V*q+j),tl=(H=p.fixed-S,G=C,Z=p.stretch,W=g,H-G*Z/W),tu=(X=h.stretch-E,K=T,Y=f,J=r.top,X/K*Y+J),tc=(Q=h.fixed-I,tt=k,te=h.stretch,tr=$,Q-tt*te/tr),tp=new c(tn,to),th=new c(ts,to),td=new c(ts,tu),tf=new c(tn,tu),tm=new c(ti/u,ta/u),ty=new c(tl/u,tc/u),tv=n*Math.PI/180;if(tv){var tg=Math.sin(tv),t8=Math.cos(tv),t$=[t8,-tg,tg,t8];tp._matMult(t$),th._matMult(t$),tf._matMult(t$),td._matMult(t$)}var t_=o.stretch+o.fixed,tx=p.stretch+p.fixed,tb=a.stretch+a.fixed,tw=h.stretch+h.fixed;return{tl:tp,tr:th,bl:tf,br:td,tex:{x:s.paddedRect.x+1+t_,y:s.paddedRect.y+1+tb,w:tx-t_,h:tw-tb},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:tm,pixelOffsetBR:ty,minFontScaleX:C/u/d,minFontScaleY:k/u/f,isSDF:i}};if(o&&(s.stretchX||s.stretchY))for(var L=sv(m,_,g),D=sv(y,x,$),z=0;z<L.length-1;z++)for(var M=L[z],R=L[z+1],B=0;B<D.length-1;B++){var F=D[B],O=D[B+1];a.push(P(M,F,R,O))}else a.push(P({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:p+1},{fixed:0,stretch:h+1}));return a}function sy(r,n,i){for(var o=0,a=0,s=r;a<s.length;a+=1){var u=s[a];o+=Math.max(n,Math.min(i,u[1]))-Math.max(n,Math.min(i,u[0]))}return o}function sv(r,n,i){for(var o=[{fixed:-1,stretch:0}],a=0,s=r;a<s.length;a+=1){var u=s[a],c=u[0],p=u[1],h=o[o.length-1];o.push({fixed:c-h.stretch,stretch:h.stretch}),o.push({fixed:c-h.stretch,stretch:h.stretch+(p-c)})}return o.push({fixed:n+1,stretch:i}),o}function sg(r,n,i,o){return r/n*i+o}function s8(r,n,i,o){return r-n*i/o}var s$=function(r,n,i,o,a,s,u,p,h,d,f,m){var y=u.top*p-h,v=u.bottom*p+h,g=u.left*p-h,$=u.right*p+h,_=u.collisionPadding;if(_&&(g-=_[0]*p,y-=_[1]*p,$+=_[2]*p,v+=_[3]*p),this.boxStartIndex=r.length,d){var x=v-y,b=$-g;x>0&&(x=Math.max(10*p,x),this._addLineCollisionCircles(r,n,i,i.segment,b,x,o,a,s,f))}else{if(m){var w=new c(g,y),E=new c($,y),T=new c(g,v),S=new c($,v),C=m*Math.PI/180;w._rotate(C),E._rotate(C),T._rotate(C),S._rotate(C),g=Math.min(w.x,E.x,T.x,S.x),$=Math.max(w.x,E.x,T.x,S.x),y=Math.min(w.y,E.y,T.y,S.y),v=Math.max(w.y,E.y,T.y,S.y)}r.emplaceBack(i.x,i.y,g,y,$,v,o,a,s,0,0)}this.boxEndIndex=r.length};s$.prototype._addLineCollisionCircles=function(r,n,i,o,a,s,u,c,p,h){var d=s/2,f=Math.floor(a/d)||1,m=Math.floor(f*(1+.4*Math.log(h)/Math.LN2)/2),y=-s/2,v=i,g=o+1,$=y,_=-a/2,x=_-a/4;do{if(--g<0){if($>_)return;g=0;break}$-=n[g].dist(v),v=n[g]}while($>x);for(var b=n[g].dist(n[g+1]),w=-m;w<f+m;w++){var E=w*d,T=_+E;if(E<0&&(T+=E),E>a&&(T+=E-a),!(T<$)){for(;$+b<T;){if($+=b,++g+1>=n.length)return;b=n[g].dist(n[g+1])}var S=T-$,C=n[g],I=n[g+1].sub(C)._unit()._mult(S)._add(C)._round(),k=Math.abs(T-y)<d?0:.8*(T-y);r.emplaceBack(I.x,I.y,-s/2,-s/2,s/2,s/2,u,c,p,s/2,k)}}};var s_=function(r,n){if(void 0===r&&(r=[]),void 0===n&&(n=sx),this.data=r,this.length=this.data.length,this.compare=n,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function sx(r,n){return r<n?-1:r>n?1:0}function sb(r,n,i){void 0===n&&(n=1),void 0===i&&(i=!1);for(var o=1/0,a=1/0,s=-1/0,u=-1/0,p=r[0],h=0;h<p.length;h++){var d=p[h];(!h||d.x<o)&&(o=d.x),(!h||d.y<a)&&(a=d.y),(!h||d.x>s)&&(s=d.x),(!h||d.y>u)&&(u=d.y)}var f=Math.min(s-o,u-a),m=f/2,y=new s_([],sw);if(0===f)return new c(o,a);for(var v=o;v<s;v+=f)for(var g=a;g<u;g+=f)y.push(new s0(v+m,g+m,m,r));for(var $=function(r){for(var n=0,i=0,o=0,a=r[0],s=0,u=a.length,c=u-1;s<u;c=s++){var p=a[s],h=a[c],d=p.x*h.y-h.x*p.y;i+=(p.x+h.x)*d,o+=(p.y+h.y)*d,n+=3*d}return new s0(i/n,o/n,0,r)}(r),_=y.length;y.length;){var x=y.pop();(x.d>$.d||!$.d)&&($=x,i&&console.log("found best %d after %d probes",Math.round(1e4*x.d)/1e4,_)),x.max-$.d<=n||(m=x.h/2,y.push(new s0(x.p.x-m,x.p.y-m,m,r)),y.push(new s0(x.p.x+m,x.p.y-m,m,r)),y.push(new s0(x.p.x-m,x.p.y+m,m,r)),y.push(new s0(x.p.x+m,x.p.y+m,m,r)),_+=4)}return i&&(console.log("num probes: "+_),console.log("best distance: "+$.d)),$.p}function sw(r,n){return n.max-r.max}function s0(r,n,i,o){this.p=new c(r,n),this.h=i,this.d=function(r,n){for(var i=!1,o=1/0,a=0;a<n.length;a++)for(var s=n[a],u=0,c=s.length,p=c-1;u<c;p=u++){var h=s[u],d=s[p];h.y>r.y!=d.y>r.y&&r.x<(d.x-h.x)*(r.y-h.y)/(d.y-h.y)+h.x&&(i=!i),o=Math.min(o,iX(r,h,d))}return(i?1:-1)*Math.sqrt(o)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}s_.prototype.push=function(r){this.data.push(r),this.length++,this._up(this.length-1)},s_.prototype.pop=function(){if(0!==this.length){var r=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),r}},s_.prototype.peek=function(){return this.data[0]},s_.prototype._up=function(r){for(var n=this.data,i=this.compare,o=n[r];r>0;){var a=r-1>>1,s=n[a];if(i(o,s)>=0)break;n[r]=s,r=a}n[r]=o},s_.prototype._down=function(r){for(var n=this.data,i=this.compare,o=this.length>>1,a=n[r];r<o;){var s=1+(r<<1),u=n[s],c=s+1;if(c<this.length&&0>i(n[c],u)&&(s=c,u=n[c]),i(u,a)>=0)break;n[r]=u,r=s}n[r]=a};var sE=Number.POSITIVE_INFINITY;function sT(r,n){return n[1]!==sE?function(r,n,i){var o=0,a=0;switch(n=Math.abs(n),i=Math.abs(i),r){case"top-right":case"top-left":case"top":a=i-7;break;case"bottom-right":case"bottom-left":case"bottom":a=-i+7}switch(r){case"top-right":case"bottom-right":case"right":o=-n;break;case"top-left":case"bottom-left":case"left":o=n}return[o,a]}(r,n[0],n[1]):function(r,n){var i=0,o=0;n<0&&(n=0);var a=n/Math.sqrt(2);switch(r){case"top-right":case"top-left":o=a-7;break;case"bottom-right":case"bottom-left":o=-a+7;break;case"bottom":o=-n+7;break;case"top":o=n-7}switch(r){case"top-right":case"bottom-right":i=-a;break;case"top-left":case"bottom-left":i=a;break;case"left":i=n;break;case"right":i=-n}return[i,o]}(r,n[0])}function sS(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function sC(r,n,i,o,a,s,u,p,h,d,f,m,y,v){var g=function(r,n,i,o,a,s,u,p){for(var h=o.layout.get("text-rotate").evaluate(s,{})*Math.PI/180,d=[],f=0,m=n.positionedLines;f<m.length;f+=1)for(var y=m[f],v=0,g=y.positionedGlyphs;v<g.length;v+=1){var $=g[v];if($.rect){var _=$.rect||{},x=4,b=!0,w=1,E=0,T=(a||p)&&$.vertical,S=$.metrics.advance*$.scale/2;if(p&&n.verticalizable){var C=($.scale-1)*24,I=(24-$.metrics.width*$.scale)/2;E=y.lineOffset/2-($.imageName?-I:C)}if($.imageName){var k=u[$.imageName];b=k.sdf,x=1/(w=k.pixelRatio)}var A=a?[$.x+S,$.y]:[0,0],P=a?[0,0]:[$.x+S+i[0],$.y+i[1]-E],L=[0,0];T&&(L=P,P=[0,0]);var D=($.metrics.left-x)*$.scale-S+P[0],z=(-$.metrics.top-x)*$.scale+P[1],M=D+_.w*$.scale/w,R=z+_.h*$.scale/w,B=new c(D,z),F=new c(M,z),O=new c(D,R),N=new c(M,R);if(T){var U=new c(-S,S- -17),V=-Math.PI/2,q=12-S,j=$.imageName?q:0,H=new c(22-q,-j),G=new(Function.prototype.bind.apply(c,[null].concat(L)));B._rotateAround(V,U)._add(H)._add(G),F._rotateAround(V,U)._add(H)._add(G),O._rotateAround(V,U)._add(H)._add(G),N._rotateAround(V,U)._add(H)._add(G)}if(h){var Z=Math.sin(h),W=Math.cos(h),X=[W,-Z,Z,W];B._matMult(X),F._matMult(X),O._matMult(X),N._matMult(X)}var K=new c(0,0),Y=new c(0,0);d.push({tl:B,tr:F,bl:O,br:N,tex:_,writingMode:n.writingMode,glyphOffset:A,sectionIndex:$.sectionIndex,isSDF:b,pixelOffsetTL:K,pixelOffsetBR:Y,minFontScaleX:0,minFontScaleY:0})}}return d}(0,i,p,a,s,u,o,r.allowVerticalPlacement),$=r.textSizeData,_=null;"source"===$.kind?(_=[128*a.layout.get("text-size").evaluate(u,{})])[0]>32640&&C(r.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===$.kind&&((_=[128*v.compositeTextSizes[0].evaluate(u,{}),128*v.compositeTextSizes[1].evaluate(u,{})])[0]>32640||_[1]>32640)&&C(r.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),r.addSymbols(r.text,g,_,p,s,u,d,n,h.lineStartIndex,h.lineLength,y);for(var x=0,b=f;x<b.length;x+=1)m[b[x]]=r.text.placedSymbolArray.length-1;return 4*g.length}function sI(r){for(var n in r)return r[n];return null}function sk(r,n,i,o){var a=r.compareText;if(n in a){for(var s=a[n],u=s.length-1;u>=0;u--)if(o.dist(s[u])<i)return!0}else a[n]=[];return a[n].push(o),!1}var s1=ar.VectorTileFeature.types,s2=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function sA(r,n,i,o,a,s,u,c,p,h,d,f,m){var y=c?Math.min(32640,Math.round(c[0])):0,v=c?Math.min(32640,Math.round(c[1])):0;r.emplaceBack(n,i,Math.round(32*o),Math.round(32*a),s,u,(y<<1)+(p?1:0),v,16*h,16*d,256*f,256*m)}function sP(r,n,i){r.emplaceBack(n.x,n.y,i),r.emplaceBack(n.x,n.y,i),r.emplaceBack(n.x,n.y,i),r.emplaceBack(n.x,n.y,i)}function sL(r){for(var n=0,i=r.sections;n<i.length;n+=1)if(nd(i[n].text))return!0;return!1}var sD=function(r){this.layoutVertexArray=new nq,this.indexArray=new n9,this.programConfigurations=r,this.segments=new i8,this.dynamicLayoutVertexArray=new nj,this.opacityVertexArray=new nH,this.placedSymbolArray=new il};sD.prototype.upload=function(r,n,i,o){i&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,a_.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,ax.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,s2,!0),this.opacityVertexBuffer.itemSize=1),(i||o)&&this.programConfigurations.upload(r)},sD.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},r9("SymbolBuffers",sD);var sz=function(r,n,i){this.layoutVertexArray=new r,this.layoutAttributes=n,this.indexArray=new i,this.segments=new i8,this.collisionVertexArray=new nW};sz.prototype.upload=function(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,ab.members,!0)},sz.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},r9("CollisionBuffers",sz);var s3=function(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasPaintOverrides=!1,this.hasRTLText=!1,this.sortKeyRanges=[];var n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=so(this.zoom,n["text-size"]),this.iconSizeData=so(this.zoom,n["icon-size"]);var i=this.layers[0].layout,o=i.get("symbol-sort-key"),a=i.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==a&&void 0!==o.constantOr(1);var s="viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey;this.sortFeaturesByY=s&&(i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement")),"point"===i.get("symbol-placement")&&(this.writingModes=i.get("text-writing-mode").map(function(r){return aH[r]})),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id}),this.sourceID=r.sourceID};s3.prototype.createArrays=function(){var r=this.layers[0].layout;this.hasPaintOverrides=sB.hasPaintOverrides(r),this.text=new sD(new iB(a_.members,this.layers,this.zoom,function(r){return/^text/.test(r)})),this.icon=new sD(new iB(a_.members,this.layers,this.zoom,function(r){return/^icon/.test(r)})),this.textCollisionBox=new sz(nZ,aw.members,it),this.iconCollisionBox=new sz(nZ,aw.members,it),this.textCollisionCircle=new sz(nZ,a0.members,n9),this.iconCollisionCircle=new sz(nZ,a0.members,n9),this.glyphOffsetArray=new ih,this.lineVertexArray=new im,this.symbolInstances=new ic},s3.prototype.calculateGlyphDependencies=function(r,n,i,o,a){for(var s=0;s<r.length;s++)if(n[r.charCodeAt(s)]=!0,(i||o)&&a){var u=aT[r.charAt(s)];u&&(n[u.charCodeAt(0)]=!0)}},s3.prototype.populate=function(r,n){var i=this.layers[0],o=i.layout,a=o.get("text-font"),s=o.get("text-field"),u=o.get("icon-image"),c=("constant"!==s.value.kind||s.value.value instanceof en&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),p=("constant"!==u.value.kind||!!u.value.value)&&Object.keys(u.parameters).length>0,h=o.get("symbol-sort-key");if(this.features=[],c||p){for(var d=n.iconDependencies,f=n.glyphDependencies,m=n.availableImages,y=new nE(this.zoom),v=0,g=r;v<g.length;v+=1){var $=g[v],_=$.feature,x=$.id,b=$.index,w=$.sourceLayerIndex;if(i._featureFilter(y,_)){var E=void 0;if(c){var T=i.getValueAndResolveTokens("text-field",_,m),S=en.factory(T);sL(S)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===nb()||this.hasRTLText&&n0.isParsed())&&(E=aE(S,i,_))}var C=void 0;if(p){var I=i.getValueAndResolveTokens("icon-image",_,m);C=I instanceof ei?I:ei.fromString(I)}if(E||C){var k=this.sortFeaturesByKey?h.evaluate(_,{}):void 0,A={id:x,text:E,icon:C,index:b,sourceLayerIndex:w,geometry:i5(_),properties:_.properties,type:s1[_.type],sortKey:k};if(this.features.push(A),C&&(d[C.name]=!0),E){var P=a.evaluate(_,{}).join(","),L="map"===o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(aH.vertical)>=0;for(var D=0,z=E.sections;D<z.length;D+=1){var M=z[D];if(M.image)d[M.image.name]=!0;else{var R=ns(E.toString()),B=M.fontStack||P,F=f[B]=f[B]||{};this.calculateGlyphDependencies(M.text,F,L,this.allowVerticalPlacement,R)}}}}}}"line"===o.get("symbol-placement")&&(this.features=function(r){var n={},i={},o=[],a=0;function s(n){o.push(r[n]),a++}function u(r,n,a){var s=i[r];return delete i[r],i[n]=s,o[s].geometry[0].pop(),o[s].geometry[0]=o[s].geometry[0].concat(a[0]),s}function c(r,i,a){var s=n[i];return delete n[i],n[r]=s,o[s].geometry[0].shift(),o[s].geometry[0]=a[0].concat(o[s].geometry[0]),s}function p(r,n,i){var o=i?n[0][n[0].length-1]:n[0][0];return r+":"+o.x+":"+o.y}for(var h=0;h<r.length;h++){var d=r[h],f=d.geometry,m=d.text?d.text.toString():null;if(m){var y=p(m,f),v=p(m,f,!0);if(y in i&&v in n&&i[y]!==n[v]){var g=c(y,v,f),$=u(y,v,o[g].geometry);delete n[y],delete i[v],i[p(m,o[$].geometry,!0)]=$,o[g].geometry=null}else y in i?u(y,v,f):v in n?c(y,v,f):(s(h),n[y]=a-1,i[v]=a-1)}else s(h)}return o.filter(function(r){return r.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(r,n){return r.sortKey-n.sortKey})}},s3.prototype.update=function(r,n,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,n,this.layers,i),this.icon.programConfigurations.updatePaintArrays(r,n,this.layers,i))},s3.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},s3.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},s3.prototype.upload=function(r){this.uploaded||(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r),this.textCollisionCircle.upload(r),this.iconCollisionCircle.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},s3.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.textCollisionBox.destroy(),this.iconCollisionBox.destroy(),this.textCollisionCircle.destroy(),this.iconCollisionCircle.destroy()},s3.prototype.addToLineVertexArray=function(r,n){var i=this.lineVertexArray.length;if(void 0!==r.segment){for(var o=r.dist(n[r.segment+1]),a=r.dist(n[r.segment]),s={},u=r.segment+1;u<n.length;u++)s[u]={x:n[u].x,y:n[u].y,tileUnitDistanceFromAnchor:o},u<n.length-1&&(o+=n[u+1].dist(n[u]));for(var c=r.segment||0;c>=0;c--)s[c]={x:n[c].x,y:n[c].y,tileUnitDistanceFromAnchor:a},c>0&&(a+=n[c-1].dist(n[c]));for(var p=0;p<n.length;p++){var h=s[p];this.lineVertexArray.emplaceBack(h.x,h.y,h.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},s3.prototype.addSymbols=function(r,n,i,o,a,s,u,c,p,h,d){var f=this,m=r.indexArray,y=r.layoutVertexArray,v=r.dynamicLayoutVertexArray,g=r.segments.prepareSegment(4*n.length,r.layoutVertexArray,r.indexArray,s.sortKey),$=this.glyphOffsetArray.length,_=g.vertexLength,x=this.allowVerticalPlacement&&u===aH.vertical?Math.PI/2:0,b=function(r){var n=r.tl,o=r.tr,a=r.bl,s=r.br,u=r.tex,p=r.pixelOffsetTL,h=r.pixelOffsetBR,d=r.minFontScaleX,$=r.minFontScaleY,_=g.vertexLength,b=r.glyphOffset[1];sA(y,c.x,c.y,n.x,b+n.y,u.x,u.y,i,r.isSDF,p.x,p.y,d,$),sA(y,c.x,c.y,o.x,b+o.y,u.x+u.w,u.y,i,r.isSDF,h.x,p.y,d,$),sA(y,c.x,c.y,a.x,b+a.y,u.x,u.y+u.h,i,r.isSDF,p.x,h.y,d,$),sA(y,c.x,c.y,s.x,b+s.y,u.x+u.w,u.y+u.h,i,r.isSDF,h.x,h.y,d,$),sP(v,c,x),m.emplaceBack(_,_+1,_+2),m.emplaceBack(_+1,_+2,_+3),g.vertexLength+=4,g.primitiveLength+=2,f.glyphOffsetArray.emplaceBack(r.glyphOffset[0])};if(s.text&&s.text.sections){var w=s.text.sections;if(this.hasPaintOverrides){for(var E,T=function(n,i){void 0!==E&&(E!==n||i)&&r.programConfigurations.populatePaintArrays(r.layoutVertexArray.length,s,s.index,{},w[E]),E=n},S=0,C=n;S<C.length;S+=1){var I=C[S];T(I.sectionIndex,!1),b(I)}T(E,!0)}else{for(var k=0,A=n;k<A.length;k+=1)b(A[k]);r.programConfigurations.populatePaintArrays(r.layoutVertexArray.length,s,s.index,{},w[0])}}else{for(var P=0,L=n;P<L.length;P+=1)b(L[P]);r.programConfigurations.populatePaintArrays(r.layoutVertexArray.length,s,s.index,{})}r.placedSymbolArray.emplaceBack(c.x,c.y,$,this.glyphOffsetArray.length-$,_,p,h,c.segment,i?i[0]:0,i?i[1]:0,o[0],o[1],u,0,!1,0,d)},s3.prototype._addCollisionDebugVertex=function(r,n,i,o,a,s){return n.emplaceBack(0,0),r.emplaceBack(i.x,i.y,o,a,Math.round(s.x),Math.round(s.y))},s3.prototype.addCollisionDebugVertices=function(r,n,i,o,a,s,u,p){var h=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),d=h.vertexLength,f=a.layoutVertexArray,m=a.collisionVertexArray,y=u.anchorX,v=u.anchorY;if(this._addCollisionDebugVertex(f,m,s,y,v,new c(r,n)),this._addCollisionDebugVertex(f,m,s,y,v,new c(i,n)),this._addCollisionDebugVertex(f,m,s,y,v,new c(i,o)),this._addCollisionDebugVertex(f,m,s,y,v,new c(r,o)),h.vertexLength+=4,p){var g=a.indexArray;g.emplaceBack(d,d+1,d+2),g.emplaceBack(d,d+2,d+3),h.primitiveLength+=2}else{var $=a.indexArray;$.emplaceBack(d,d+1),$.emplaceBack(d+1,d+2),$.emplaceBack(d+2,d+3),$.emplaceBack(d+3,d),h.primitiveLength+=4}},s3.prototype.addDebugCollisionBoxes=function(r,n,i,o){for(var a=r;a<n;a++){var s=this.collisionBoxArray.get(a),u=s.x1,c=s.y1,p=s.x2,h=s.y2,d=s.radius>0;this.addCollisionDebugVertices(u,c,p,h,d?o?this.textCollisionCircle:this.iconCollisionCircle:o?this.textCollisionBox:this.iconCollisionBox,s.anchorPoint,i,d)}},s3.prototype.generateCollisionDebugBuffers=function(){for(var r=0;r<this.symbolInstances.length;r++){var n=this.symbolInstances.get(r);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}},s3.prototype._deserializeCollisionBoxesForSymbol=function(r,n,i,o,a,s,u,c,p){for(var h={},d=n;d<i;d++){var f=r.get(d);if(0===f.radius){h.textBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},h.textFeatureIndex=f.featureIndex;break}h.textCircles||(h.textCircles=[],h.textFeatureIndex=f.featureIndex),h.textCircles.push(f.anchorPointX,f.anchorPointY,f.radius,f.signedDistanceFromAnchor,1)}for(var m=o;m<a;m++){var y=r.get(m);if(0===y.radius){h.verticalTextBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY},h.verticalTextFeatureIndex=y.featureIndex;break}}for(var v=s;v<u;v++){var g=r.get(v);if(0===g.radius){h.iconBox={x1:g.x1,y1:g.y1,x2:g.x2,y2:g.y2,anchorPointX:g.anchorPointX,anchorPointY:g.anchorPointY},h.iconFeatureIndex=g.featureIndex;break}}for(var $=c;$<p;$++){var _=r.get($);if(0===_.radius){h.verticalIconBox={x1:_.x1,y1:_.y1,x2:_.x2,y2:_.y2,anchorPointX:_.anchorPointX,anchorPointY:_.anchorPointY},h.verticalIconFeatureIndex=_.featureIndex;break}}return h},s3.prototype.deserializeCollisionBoxes=function(r){this.collisionArrays=[];for(var n=0;n<this.symbolInstances.length;n++){var i=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},s3.prototype.hasTextData=function(){return this.text.segments.get().length>0},s3.prototype.hasIconData=function(){return this.icon.segments.get().length>0},s3.prototype.hasTextCollisionBoxData=function(){return this.textCollisionBox.segments.get().length>0},s3.prototype.hasIconCollisionBoxData=function(){return this.iconCollisionBox.segments.get().length>0},s3.prototype.hasTextCollisionCircleData=function(){return this.textCollisionCircle.segments.get().length>0},s3.prototype.hasIconCollisionCircleData=function(){return this.iconCollisionCircle.segments.get().length>0},s3.prototype.addIndicesForPlacedSymbol=function(r,n){for(var i=r.placedSymbolArray.get(n),o=i.vertexStartIndex+4*i.numGlyphs,a=i.vertexStartIndex;a<o;a+=4)r.indexArray.emplaceBack(a,a+1,a+2),r.indexArray.emplaceBack(a+1,a+2,a+3)},s3.prototype.getSortedSymbolIndexes=function(r){if(this.sortedAngle===r&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var n=Math.sin(r),i=Math.cos(r),o=[],a=[],s=[],u=0;u<this.symbolInstances.length;++u){s.push(u);var c=this.symbolInstances.get(u);o.push(0|Math.round(n*c.anchorX+i*c.anchorY)),a.push(c.featureIndex)}return s.sort(function(r,n){return o[r]-o[n]||a[n]-a[r]}),s},s3.prototype.addToSortKeyRanges=function(r,n){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===n?i.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:r,symbolInstanceEnd:r+1})},s3.prototype.sortFeatures=function(r){var n=this;if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,o=this.symbolInstanceIndexes;i<o.length;i+=1){var a=o[i],s=this.symbolInstances.get(a);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach(function(r,i,o){r>=0&&o.indexOf(r)===i&&n.addIndicesForPlacedSymbol(n.text,r)}),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},r9("SymbolBucket",s3,{omit:["layers","collisionBoxArray","features","compareText"]}),s3.MAX_GLYPHS=65535,s3.addDynamicAttributes=sP;var s4=new n4({"symbol-placement":new nP(tM.layout_symbol["symbol-placement"]),"symbol-spacing":new nP(tM.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new nP(tM.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new nL(tM.layout_symbol["symbol-sort-key"]),"symbol-z-order":new nP(tM.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new nP(tM.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new nP(tM.layout_symbol["icon-ignore-placement"]),"icon-optional":new nP(tM.layout_symbol["icon-optional"]),"icon-rotation-alignment":new nP(tM.layout_symbol["icon-rotation-alignment"]),"icon-size":new nL(tM.layout_symbol["icon-size"]),"icon-text-fit":new nP(tM.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new nP(tM.layout_symbol["icon-text-fit-padding"]),"icon-image":new nL(tM.layout_symbol["icon-image"]),"icon-rotate":new nL(tM.layout_symbol["icon-rotate"]),"icon-padding":new nP(tM.layout_symbol["icon-padding"]),"icon-keep-upright":new nP(tM.layout_symbol["icon-keep-upright"]),"icon-offset":new nL(tM.layout_symbol["icon-offset"]),"icon-anchor":new nL(tM.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new nP(tM.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new nP(tM.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new nP(tM.layout_symbol["text-rotation-alignment"]),"text-field":new nL(tM.layout_symbol["text-field"]),"text-font":new nL(tM.layout_symbol["text-font"]),"text-size":new nL(tM.layout_symbol["text-size"]),"text-max-width":new nL(tM.layout_symbol["text-max-width"]),"text-line-height":new nP(tM.layout_symbol["text-line-height"]),"text-letter-spacing":new nL(tM.layout_symbol["text-letter-spacing"]),"text-justify":new nL(tM.layout_symbol["text-justify"]),"text-radial-offset":new nL(tM.layout_symbol["text-radial-offset"]),"text-variable-anchor":new nP(tM.layout_symbol["text-variable-anchor"]),"text-anchor":new nL(tM.layout_symbol["text-anchor"]),"text-max-angle":new nP(tM.layout_symbol["text-max-angle"]),"text-writing-mode":new nP(tM.layout_symbol["text-writing-mode"]),"text-rotate":new nL(tM.layout_symbol["text-rotate"]),"text-padding":new nP(tM.layout_symbol["text-padding"]),"text-keep-upright":new nP(tM.layout_symbol["text-keep-upright"]),"text-transform":new nL(tM.layout_symbol["text-transform"]),"text-offset":new nL(tM.layout_symbol["text-offset"]),"text-allow-overlap":new nP(tM.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new nP(tM.layout_symbol["text-ignore-placement"]),"text-optional":new nP(tM.layout_symbol["text-optional"])}),sM={paint:new n4({"icon-opacity":new nL(tM.paint_symbol["icon-opacity"]),"icon-color":new nL(tM.paint_symbol["icon-color"]),"icon-halo-color":new nL(tM.paint_symbol["icon-halo-color"]),"icon-halo-width":new nL(tM.paint_symbol["icon-halo-width"]),"icon-halo-blur":new nL(tM.paint_symbol["icon-halo-blur"]),"icon-translate":new nP(tM.paint_symbol["icon-translate"]),"icon-translate-anchor":new nP(tM.paint_symbol["icon-translate-anchor"]),"text-opacity":new nL(tM.paint_symbol["text-opacity"]),"text-color":new nL(tM.paint_symbol["text-color"],{runtimeType:tj,getOverride:function(r){return r.textColor},hasOverride:function(r){return!!r.textColor}}),"text-halo-color":new nL(tM.paint_symbol["text-halo-color"]),"text-halo-width":new nL(tM.paint_symbol["text-halo-width"]),"text-halo-blur":new nL(tM.paint_symbol["text-halo-blur"]),"text-translate":new nP(tM.paint_symbol["text-translate"]),"text-translate-anchor":new nP(tM.paint_symbol["text-translate-anchor"])}),layout:s4},sR=function(r){this.type=r.property.overrides?r.property.overrides.runtimeType:tN,this.defaultValue=r};sR.prototype.evaluate=function(r){if(r.formattedSection){var n=this.defaultValue.property.overrides;if(n&&n.hasOverride(r.formattedSection))return n.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default},sR.prototype.eachChild=function(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)},sR.prototype.possibleOutputs=function(){return[void 0]},sR.prototype.serialize=function(){return null},r9("FormatSectionOverride",sR,{omit:["defaultValue"]});var sB=function(r){function n(n){r.call(this,n,sM)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.recalculate=function(n,i){if(r.prototype.recalculate.call(this,n,i),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var o=this.layout.get("text-writing-mode");if(o){for(var a=[],s=0,u=o;s<u.length;s+=1){var c=u[s];0>a.indexOf(c)&&a.push(c)}this.layout._values["text-writing-mode"]=a}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},n.prototype.getValueAndResolveTokens=function(r,n,i){var o,a,s=this.layout.get(r).evaluate(n,{},i),u=this._unevaluatedLayout._values[r];return u.isDataDriven()||rg(u.value)||!s?s:(o=n.properties,(a=s).replace(/{([^{}]+)}/g,function(r,n){return n in o?String(o[n]):""}))},n.prototype.createBucket=function(r){return new s3(r)},n.prototype.queryRadius=function(){return 0},n.prototype.queryIntersectsFeature=function(){return!1},n.prototype._setPaintOverrides=function(){for(var r=0,i=sM.paint.overridableProperties;r<i.length;r+=1){var o=i[r];if(n.hasPaintOverride(this.layout,o)){var a=this.paint.get(o),s=new sR(a),u=new rv(s,a.property.specification),c=null;c="constant"===a.value.kind||"source"===a.value.kind?new r$("source",u):new r_("composite",u,a.value.zoomStops,a.value._interpolationType),this.paint._values[o]=new n2(a.property,c,a.parameters)}}},n.prototype._handleOverridablePaintPropertyUpdate=function(r,i,o){return!(!this.layout||i.isDataDriven()||o.isDataDriven())&&n.hasPaintOverride(this.layout,r)},n.hasPaintOverride=function(r,n){var i=r.get("text-field"),o=sM.paint.properties[n],a=!1,s=function(r){for(var n=0,i=r;n<i.length;n+=1){var s=i[n];if(o.overrides&&o.overrides.hasOverride(s))return void(a=!0)}};if("constant"===i.value.kind&&i.value.value instanceof en)s(i.value.value.sections);else if("source"===i.value.kind){var u=function(r){!a&&(r instanceof el&&ea(r.value)===tW?s(r.value.sections):r instanceof eh?s(r.sections):r.eachChild(u))},c=i.value;c._styleExpression&&u(c._styleExpression.expression)}return a},n.hasPaintOverrides=function(r){for(var i=0,o=sM.paint.overridableProperties;i<o.length;i+=1){var a=o[i];if(n.hasPaintOverride(r,a))return!0}return!1},n}(nM),sF={paint:new n4({"background-color":new nP(tM.paint_background["background-color"]),"background-pattern":new nz(tM.paint_background["background-pattern"]),"background-opacity":new nP(tM.paint_background["background-opacity"])})},sO=function(r){function n(n){r.call(this,n,sF)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n}(nM),s6={paint:new n4({"raster-opacity":new nP(tM.paint_raster["raster-opacity"]),"raster-hue-rotate":new nP(tM.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new nP(tM.paint_raster["raster-brightness-min"]),"raster-brightness-max":new nP(tM.paint_raster["raster-brightness-max"]),"raster-saturation":new nP(tM.paint_raster["raster-saturation"]),"raster-contrast":new nP(tM.paint_raster["raster-contrast"]),"raster-resampling":new nP(tM.paint_raster["raster-resampling"]),"raster-fade-duration":new nP(tM.paint_raster["raster-fade-duration"])})},s7=function(r){function n(n){r.call(this,n,s6)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n}(nM),s5=function(r){function n(n){r.call(this,n,{}),this.implementation=n}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},n.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},n.prototype.recalculate=function(){},n.prototype.updateTransitions=function(){},n.prototype.hasTransition=function(){},n.prototype.serialize=function(){},n.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},n.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},n}(nM),sN={circle:oo,heatmap:om,hillshade:ov,fill:oZ,"fill-extrusion":au,line:a8,symbol:sB,background:sO,raster:s7},sU=self.HTMLImageElement,sV=self.HTMLCanvasElement,sq=self.HTMLVideoElement,sj=self.ImageData,sH=self.ImageBitmap,sG=function(r,n,i,o){this.context=r,this.format=i,this.texture=r.gl.createTexture(),this.update(n,o)};sG.prototype.update=function(r,n,i){var o=r.width,a=r.height,s=!(this.size&&this.size[0]===o&&this.size[1]===a||i),u=this.context,c=u.gl;if(this.useMipmap=Boolean(n&&n.useMipmap),c.bindTexture(c.TEXTURE_2D,this.texture),u.pixelStoreUnpackFlipY.set(!1),u.pixelStoreUnpack.set(1),u.pixelStoreUnpackPremultiplyAlpha.set(this.format===c.RGBA&&(!n||!1!==n.premultiply)),s)this.size=[o,a],r instanceof sU||r instanceof sV||r instanceof sq||r instanceof sj||sH&&r instanceof sH?c.texImage2D(c.TEXTURE_2D,0,this.format,this.format,c.UNSIGNED_BYTE,r):c.texImage2D(c.TEXTURE_2D,0,this.format,o,a,0,this.format,c.UNSIGNED_BYTE,r.data);else{var p=i||{x:0,y:0},h=p.x,d=p.y;r instanceof sU||r instanceof sV||r instanceof sq||r instanceof sj||sH&&r instanceof sH?c.texSubImage2D(c.TEXTURE_2D,0,h,d,c.RGBA,c.UNSIGNED_BYTE,r):c.texSubImage2D(c.TEXTURE_2D,0,h,d,o,a,c.RGBA,c.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&c.generateMipmap(c.TEXTURE_2D)},sG.prototype.bind=function(r,n,i){var o=this.context.gl;o.bindTexture(o.TEXTURE_2D,this.texture),i!==o.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=o.LINEAR),r!==this.filter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,r),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,i||r),this.filter=r),n!==this.wrap&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,n),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,n),this.wrap=n)},sG.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},sG.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var sZ=function(r){var n=this;this._callback=r,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){n._triggered=!1,n._callback()})};sZ.prototype.trigger=function(){var r=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){r._triggered=!1,r._callback()},0))},sZ.prototype.remove=function(){delete this._channel,this._callback=function(){}};var sW=function(r,n,i){this.target=r,this.parent=n,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},x(["receive","process"],this),this.invoker=new sZ(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=A()?r:self};function sX(r,n,i){var o=2*Math.PI*6378137/256/Math.pow(2,i);return[r*o-2*Math.PI*6378137/2,n*o-2*Math.PI*6378137/2]}sW.prototype.send=function(r,n,i,o,a){var s=this;void 0===a&&(a=!1);var u=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[u]=i);var c=D(this.globalScope)?void 0:[];return this.target.postMessage({id:u,type:r,hasCallback:!!i,targetMapId:o,mustQueue:a,sourceMapId:this.mapId,data:nn(n,c)},c),{cancel:function(){i&&delete s.callbacks[u],s.target.postMessage({id:u,type:"<cancel>",targetMapId:o,sourceMapId:s.mapId})}}},sW.prototype.receive=function(r){var n=r.data,i=n.id;if(i&&(!n.targetMapId||this.mapId===n.targetMapId)){if("<cancel>"===n.type){delete this.tasks[i];var o=this.cancelCallbacks[i];delete this.cancelCallbacks[i],o&&o()}else A()||n.mustQueue?(this.tasks[i]=n,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,n)}},sW.prototype.process=function(){if(this.taskQueue.length){var r=this.taskQueue.shift(),n=this.tasks[r];delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),n&&this.processTask(r,n)}},sW.prototype.processTask=function(r,n){var i=this;if("<response>"===n.type){var o=this.callbacks[r];delete this.callbacks[r],o&&(n.error?o(ni(n.error)):o(null,ni(n.data)))}else{var a=!1,s=D(this.globalScope)?void 0:[],u=n.hasCallback?function(n,o){a=!0,delete i.cancelCallbacks[r],i.target.postMessage({id:r,type:"<response>",sourceMapId:i.mapId,error:n?nn(n):null,data:nn(o,s)},s)}:function(r){a=!0},c=null,p=ni(n.data);if(this.parent[n.type])c=this.parent[n.type](n.sourceMapId,p,u);else if(this.parent.getWorkerSource){var h=n.type.split(".");c=this.parent.getWorkerSource(n.sourceMapId,h[0],p.source)[h[1]](p,u)}else u(Error("Could not find function "+n.type));!a&&c&&c.cancel&&(this.cancelCallbacks[r]=c.cancel)}},sW.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var sK=function(r,n){r&&(n?this.setSouthWest(r).setNorthEast(n):4===r.length?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))};sK.prototype.setNorthEast=function(r){return this._ne=r instanceof sY?new sY(r.lng,r.lat):sY.convert(r),this},sK.prototype.setSouthWest=function(r){return this._sw=r instanceof sY?new sY(r.lng,r.lat):sY.convert(r),this},sK.prototype.extend=function(r){var n,i,o=this._sw,a=this._ne;if(r instanceof sY)n=r,i=r;else{if(!(r instanceof sK))return Array.isArray(r)?r.every(Array.isArray)?this.extend(sK.convert(r)):this.extend(sY.convert(r)):this;if(n=r._sw,i=r._ne,!n||!i)return this}return o||a?(o.lng=Math.min(n.lng,o.lng),o.lat=Math.min(n.lat,o.lat),a.lng=Math.max(i.lng,a.lng),a.lat=Math.max(i.lat,a.lat)):(this._sw=new sY(n.lng,n.lat),this._ne=new sY(i.lng,i.lat)),this},sK.prototype.getCenter=function(){return new sY((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},sK.prototype.getSouthWest=function(){return this._sw},sK.prototype.getNorthEast=function(){return this._ne},sK.prototype.getNorthWest=function(){return new sY(this.getWest(),this.getNorth())},sK.prototype.getSouthEast=function(){return new sY(this.getEast(),this.getSouth())},sK.prototype.getWest=function(){return this._sw.lng},sK.prototype.getSouth=function(){return this._sw.lat},sK.prototype.getEast=function(){return this._ne.lng},sK.prototype.getNorth=function(){return this._ne.lat},sK.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},sK.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},sK.prototype.isEmpty=function(){return!(this._sw&&this._ne)},sK.prototype.contains=function(r){var n=sY.convert(r),i=n.lng,o=n.lat,a=this._sw.lat<=o&&o<=this._ne.lat,s=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(s=this._sw.lng>=i&&i>=this._ne.lng),a&&s},sK.convert=function(r){return!r||r instanceof sK?r:new sK(r)};var sY=function(r,n){if(isNaN(r)||isNaN(n))throw Error("Invalid LngLat object: ("+r+", "+n+")");if(this.lng=+r,this.lat=+n,this.lat>90||this.lat<-90)throw Error("Invalid LngLat latitude value: must be between -90 and 90")};sY.prototype.wrap=function(){return new sY(m(this.lng,-180,180),this.lat)},sY.prototype.toArray=function(){return[this.lng,this.lat]},sY.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},sY.prototype.toBounds=function(r){void 0===r&&(r=0);var n=360*r/40075017,i=n/Math.cos(Math.PI/180*this.lat);return new sK(new sY(this.lng-i,this.lat-n),new sY(this.lng+i,this.lat+n))},sY.convert=function(r){if(r instanceof sY)return r;if(Array.isArray(r)&&(2===r.length||3===r.length))return new sY(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&"object"==typeof r&&null!==r)return new sY(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var sJ=2*Math.PI*6378137;function sQ(r){return sJ*Math.cos(r*Math.PI/180)}function s9(r){return(180+r)/360}function lt(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function le(r,n){return r/sQ(n)}function lr(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}var ln=function(r,n,i){void 0===i&&(i=0),this.x=+r,this.y=+n,this.z=+i};ln.fromLngLat=function(r,n){void 0===n&&(n=0);var i,o,a=sY.convert(r);return new ln(s9(a.lng),lt(a.lat),(i=n,i/sQ(o=a.lat)))},ln.prototype.toLngLat=function(){return new sY(360*this.x-180,lr(this.y))},ln.prototype.toAltitude=function(){var r,n;return(r=this.z)*sQ(lr(n=this.y))},ln.prototype.meterInMercatorCoordinateUnits=function(){var r;return 1/sJ*(1/Math.cos((r=lr(this.y))*Math.PI/180))};var li=function(r,n,i){this.z=r,this.x=n,this.y=i,this.key=ls(0,r,r,n,i)};li.prototype.equals=function(r){return this.z===r.z&&this.x===r.x&&this.y===r.y},li.prototype.url=function(r,n){var i,o,a,s,u,c=(i=this.x,o=this.y,s=sX(256*i,256*(o=Math.pow(2,a=this.z)-o-1),a),u=sX(256*(i+1),256*(o+1),a),s[0]+","+s[1]+","+u[0]+","+u[1]),p=function(r,n,i){for(var o,a="",s=r;s>0;s--)a+=(n&(o=1<<s-1)?1:0)+(i&o?2:0);return a}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",c)},li.prototype.getTilePoint=function(r){var n=Math.pow(2,this.z);return new c((r.x*n-this.x)*8192,(r.y*n-this.y)*8192)},li.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var lo=function(r,n){this.wrap=r,this.canonical=n,this.key=ls(r,n.z,n.z,n.x,n.y)},la=function(r,n,i,o,a){this.overscaledZ=r,this.wrap=n,this.canonical=new li(i,+o,+a),this.key=ls(n,r,i,o,a)};function ls(r,n,i,o,a){(r*=2)<0&&(r=-1*r-1);var s=1<<i;return(s*s*r+s*a+o).toString(36)+i.toString(36)+n.toString(36)}la.prototype.equals=function(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)},la.prototype.scaledTo=function(r){var n=this.canonical.z-r;return r>this.canonical.z?new la(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new la(r,this.wrap,r,this.canonical.x>>n,this.canonical.y>>n)},la.prototype.calculateScaledKey=function(r,n){var i=this.canonical.z-r;return r>this.canonical.z?ls(this.wrap*+n,r,this.canonical.z,this.canonical.x,this.canonical.y):ls(this.wrap*+n,r,r,this.canonical.x>>i,this.canonical.y>>i)},la.prototype.isChildOf=function(r){if(r.wrap!==this.wrap)return!1;var n=this.canonical.z-r.canonical.z;return 0===r.overscaledZ||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>n&&r.canonical.y===this.canonical.y>>n},la.prototype.children=function(r){if(this.overscaledZ>=r)return[new la(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var n=this.canonical.z+1,i=2*this.canonical.x,o=2*this.canonical.y;return[new la(n,this.wrap,n,i,o),new la(n,this.wrap,n,i+1,o),new la(n,this.wrap,n,i,o+1),new la(n,this.wrap,n,i+1,o+1)]},la.prototype.isLessThan=function(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))},la.prototype.wrapped=function(){return new la(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},la.prototype.unwrapTo=function(r){return new la(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)},la.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},la.prototype.toUnwrapped=function(){return new lo(this.wrap,this.canonical)},la.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},la.prototype.getTilePoint=function(r){return this.canonical.getTilePoint(new ln(r.x-this.wrap,r.y))},r9("CanonicalTileID",li),r9("OverscaledTileID",la,{omit:["posMatrix"]});var ll=function(r,n,i){if(this.uid=r,n.height!==n.width)throw RangeError("DEM tiles must be square");if(i&&"mapbox"!==i&&"terrarium"!==i)return C('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=n.height;var o=this.dim=n.height-2;this.data=new Uint32Array(n.data.buffer),this.encoding=i||"mapbox";for(var a=0;a<o;a++)this.data[this._idx(-1,a)]=this.data[this._idx(0,a)],this.data[this._idx(o,a)]=this.data[this._idx(o-1,a)],this.data[this._idx(a,-1)]=this.data[this._idx(a,0)],this.data[this._idx(a,o)]=this.data[this._idx(a,o-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(o,-1)]=this.data[this._idx(o-1,0)],this.data[this._idx(-1,o)]=this.data[this._idx(0,o-1)],this.data[this._idx(o,o)]=this.data[this._idx(o-1,o-1)]};ll.prototype.get=function(r,n){var i=new Uint8Array(this.data.buffer),o=4*this._idx(r,n);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(i[o],i[o+1],i[o+2])},ll.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},ll.prototype._idx=function(r,n){if(r<-1||r>=this.dim+1||n<-1||n>=this.dim+1)throw RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(r+1)},ll.prototype._unpackMapbox=function(r,n,i){return(256*r*256+256*n+i)/10-1e4},ll.prototype._unpackTerrarium=function(r,n,i){return 256*r+n+i/256-32768},ll.prototype.getPixels=function(){return new oh({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},ll.prototype.backfillBorder=function(r,n,i){if(this.dim!==r.dim)throw Error("dem dimension mismatch");var o=n*this.dim,a=n*this.dim+this.dim,s=i*this.dim,u=i*this.dim+this.dim;switch(n){case -1:o=a-1;break;case 1:a=o+1}switch(i){case -1:s=u-1;break;case 1:u=s+1}for(var c=-n*this.dim,p=-i*this.dim,h=s;h<u;h++)for(var d=o;d<a;d++)this.data[this._idx(d,h)]=r.data[this._idx(d+c,h+p)]},r9("DEMData",ll);var lu=function(r){this._stringToNumber={},this._numberToString=[];for(var n=0;n<r.length;n++){var i=r[n];this._stringToNumber[i]=n,this._numberToString[n]=i}};lu.prototype.encode=function(r){return this._stringToNumber[r]},lu.prototype.decode=function(r){return this._numberToString[r]};var lc=function(r,n,i,o,a){this.type="Feature",this._vectorTileFeature=r,r._z=n,r._x=i,r._y=o,this.properties=r.properties,this.id=a},lp={geometry:{configurable:!0}};lp.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},lp.geometry.set=function(r){this._geometry=r},lc.prototype.toJSON=function(){var r={geometry:this.geometry};for(var n in this)"_geometry"!==n&&"_vectorTileFeature"!==n&&(r[n]=this[n]);return r},Object.defineProperties(lc.prototype,lp);var lh=function(){this.state={},this.stateChanges={},this.deletedStates={}};lh.prototype.updateState=function(r,n,i){var o=String(n);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][o]=this.stateChanges[r][o]||{},y(this.stateChanges[r][o],i),null===this.deletedStates[r])for(var a in this.deletedStates[r]={},this.state[r])a!==o&&(this.deletedStates[r][a]=null);else if(this.deletedStates[r]&&null===this.deletedStates[r][o])for(var s in this.deletedStates[r][o]={},this.state[r][o])i[s]||(this.deletedStates[r][o][s]=null);else for(var u in i)this.deletedStates[r]&&this.deletedStates[r][o]&&null===this.deletedStates[r][o][u]&&delete this.deletedStates[r][o][u]},lh.prototype.removeFeatureState=function(r,n,i){if(null!==this.deletedStates[r]){var o=String(n);if(this.deletedStates[r]=this.deletedStates[r]||{},i&&void 0!==n)null!==this.deletedStates[r][o]&&(this.deletedStates[r][o]=this.deletedStates[r][o]||{},this.deletedStates[r][o][i]=null);else if(void 0!==n){if(this.stateChanges[r]&&this.stateChanges[r][o])for(i in this.deletedStates[r][o]={},this.stateChanges[r][o])this.deletedStates[r][o][i]=null;else this.deletedStates[r][o]=null}else this.deletedStates[r]=null}},lh.prototype.getState=function(r,n){var i=String(n),o=this.state[r]||{},a=this.stateChanges[r]||{},s=y({},o[i],a[i]);if(null===this.deletedStates[r])return{};if(this.deletedStates[r]){var u=this.deletedStates[r][n];if(null===u)return{};for(var c in u)delete s[c]}return s},lh.prototype.initializeTileState=function(r,n){r.setFeatureState(this.state,n)},lh.prototype.coalesceChanges=function(r,n){var i={};for(var o in this.stateChanges){this.state[o]=this.state[o]||{};var a={};for(var s in this.stateChanges[o])this.state[o][s]||(this.state[o][s]={}),y(this.state[o][s],this.stateChanges[o][s]),a[s]=this.state[o][s];i[o]=a}for(var u in this.deletedStates){this.state[u]=this.state[u]||{};var c={};if(null===this.deletedStates[u])for(var p in this.state[u])c[p]={},this.state[u][p]={};else for(var h in this.deletedStates[u]){if(null===this.deletedStates[u][h])this.state[u][h]={};else for(var d=0,f=Object.keys(this.deletedStates[u][h]);d<f.length;d+=1){var m=f[d];delete this.state[u][h][m]}c[h]=this.state[u][h]}i[u]=i[u]||{},y(i[u],c)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(var v in r)r[v].setFeatureState(i,n)};var ld=function(r,n){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new rX(8192,16,0),this.grid3D=new rX(8192,16,0),this.featureIndexArray=new iv,this.promoteId=n};function lf(r){for(var n=1/0,i=1/0,o=-1/0,a=-1/0,s=0,u=r;s<u.length;s+=1){var c=u[s];n=Math.min(n,c.x),i=Math.min(i,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y)}return{minX:n,minY:i,maxX:o,maxY:a}}function lm(r,n){return n-r}ld.prototype.insert=function(r,n,i,o,a,s){var u=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,o,a);for(var c=s?this.grid3D:this.grid,p=0;p<n.length;p++){for(var h=n[p],d=[1/0,1/0,-1/0,-1/0],f=0;f<h.length;f++){var m=h[f];d[0]=Math.min(d[0],m.x),d[1]=Math.min(d[1],m.y),d[2]=Math.max(d[2],m.x),d[3]=Math.max(d[3],m.y)}d[0]<8192&&d[1]<8192&&d[2]>=0&&d[3]>=0&&c.insert(u,d[0],d[1],d[2],d[3])}},ld.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ar.VectorTile(new aI(this.rawTileData)).layers,this.sourceLayerCoder=new lu(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},ld.prototype.query=function(r,n,i){var o=this;this.loadVTLayers();for(var a=r.params||{},s=8192/r.tileSize/r.scale,u=r1(a.filter),p=r.queryGeometry,h=r.queryPadding*s,d=lf(p),f=this.grid.query(d.minX-h,d.minY-h,d.maxX+h,d.maxY+h),m=lf(r.cameraQueryGeometry),y=this.grid3D.query(m.minX-h,m.minY-h,m.maxX+h,m.maxY+h,function(n,i,o,a){return function(r,n,i,o,a){for(var s=0,u=r;s<u.length;s+=1){var p=u[s];if(n<=p.x&&i<=p.y&&o>=p.x&&a>=p.y)return!0}var h=[new c(n,i),new c(n,a),new c(o,a),new c(o,i)];if(r.length>2){for(var d=0,f=h;d<f.length;d+=1)if(iY(r,f[d]))return!0}for(var m=0;m<r.length-1;m++)if(iJ(r[m],r[m+1],h))return!0;return!1}(r.cameraQueryGeometry,n-h,i-h,o+h,a+h)}),v=0,g=y;v<g.length;v+=1){var $=g[v];f.push($)}f.sort(lm);for(var _,x={},b=0;b<f.length;b++)(function(c){var h=f[c];if(h!==_){_=h;var d=o.featureIndexArray.get(h),m=null;o.loadMatchingFeature(x,d.bucketIndex,d.sourceLayerIndex,d.featureIndex,u,a.layers,n,function(n,a,u){m||(m=i5(n));var c={};return void 0!==u&&(c=i.getState(a.sourceLayer||"_geojsonTileLayer",u)),a.queryIntersectsFeature(p,n,c,m,o.z,r.transform,s,r.pixelPosMatrix)})}})(b);return x},ld.prototype.loadMatchingFeature=function(r,n,i,o,a,s,u,c){var p=this.bucketLayerIDs[n];if(!s||function(r,n){for(var i=0;i<r.length;i++)if(n.indexOf(r[i])>=0)return!0;return!1}(s,p)){var h=this.sourceLayerCoder.decode(i),d=this.vtLayers[h].feature(o);if(a(new nE(this.tileID.overscaledZ),d))for(var f=this.getId(d,h),m=0;m<p.length;m++){var y=p[m];if(!(s&&0>s.indexOf(y))){var v=u[y];if(v){var g=!c||c(d,v,f);if(g){var $=new lc(d,this.z,this.x,this.y,f);$.layer=v.serialize();var _=r[y];void 0===_&&(_=r[y]=[]),_.push({featureIndex:o,feature:$,intersectionZ:g})}}}}}},ld.prototype.lookupSymbolFeatures=function(r,n,i,o,a,s){var u={};this.loadVTLayers();for(var c=r1(o),p=0,h=r;p<h.length;p+=1){var d=h[p];this.loadMatchingFeature(u,n,i,d,c,a,s)}return u},ld.prototype.hasLayer=function(r){for(var n=0,i=this.bucketLayerIDs;n<i.length;n+=1)for(var o=0,a=i[n];o<a.length;o+=1)if(r===a[o])return!0;return!1},ld.prototype.getId=function(r,n){var i=r.id;if(this.promoteId){var o="string"==typeof this.promoteId?this.promoteId:this.promoteId[n];"boolean"==typeof(i=r.properties[o])&&(i=Number(i))}return i},r9("FeatureIndex",ld,{omit:["rawTileData","sourceLayerCoder"]});var ly=function(r,n){this.tileID=r,this.uid=g(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};ly.prototype.registerFadeDuration=function(r){var n=r+this.timeAdded;n<N.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)},ly.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},ly.prototype.loadVectorData=function(r,n,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){for(var o in r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(r,n){var i={};if(!n)return i;for(var o=function(){var r=s[a],o=r.layerIds.map(function(r){return n.getLayer(r)}).filter(Boolean);if(0!==o.length){r.layers=o,r.stateDependentLayerIds&&(r.stateDependentLayers=r.stateDependentLayerIds.map(function(r){return o.filter(function(n){return n.id===r})[0]}));for(var u=0,c=o;u<c.length;u+=1){var p=c[u];i[p.id]=r}}},a=0,s=r;a<s.length;a+=1)o();return i}(r.buckets,n.style),this.hasSymbolBuckets=!1,this.buckets){var a=this.buckets[o];if(a instanceof s3){if(this.hasSymbolBuckets=!0,!i)break;a.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var s in this.buckets){var u=this.buckets[s];if(u instanceof s3&&u.hasRTLText){this.hasRTLText=!0,n0.isLoading()||n0.isLoaded()||"deferred"!==nb()||nw();break}}for(var c in this.queryPadding=0,this.buckets){var p=this.buckets[c];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(c).queryRadius(p))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new ia},ly.prototype.unloadVectorData=function(){for(var r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},ly.prototype.getBucket=function(r){return this.buckets[r.id]},ly.prototype.upload=function(r){for(var n in this.buckets){var i=this.buckets[n];i.uploadPending()&&i.upload(r)}var o=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new sG(r,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new sG(r,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)},ly.prototype.prepare=function(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)},ly.prototype.queryRenderedFeatures=function(r,n,i,o,a,s,u,c,p){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:i,cameraQueryGeometry:o,scale:a,tileSize:this.tileSize,pixelPosMatrix:p,transform:u,params:s,queryPadding:this.queryPadding*c},r,n):{}},ly.prototype.querySourceFeatures=function(r,n){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var o=i.loadVTLayers(),a=n?n.sourceLayer:"",s=o._geojsonTileLayer||o[a];if(s)for(var u=r1(n&&n.filter),c=this.tileID.canonical,p=c.z,h=c.x,d=c.y,f={z:p,x:h,y:d},m=0;m<s.length;m++){var y=s.feature(m);if(u(new nE(this.tileID.overscaledZ),y)){var v=i.getId(y,a),g=new lc(y,p,h,d,v);g.tile=f,r.push(g)}}}},ly.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},ly.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},ly.prototype.setExpiryData=function(r){var n=this.expirationTime;if(r.cacheControl){var i=P(r.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){var o=Date.now(),a=!1;if(this.expirationTime>o)a=!1;else if(n){if(this.expirationTime<n)a=!0;else{var s=this.expirationTime-n;s?this.expirationTime=o+Math.max(s,3e4):a=!0}}else a=!0;a?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},ly.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),2147483647)},ly.prototype.setFeatureState=function(r,n){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(r).length){var i=this.latestFeatureIndex.loadVTLayers();for(var o in this.buckets){var a=this.buckets[o],s=a.layers[0].sourceLayer||"_geojsonTileLayer",u=i[s],c=r[s];u&&c&&0!==Object.keys(c).length&&(a.update(c,u,this.imageAtlas&&this.imageAtlas.patternPositions||{}),n&&n.style&&(this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(o).queryRadius(a))))}}},ly.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},ly.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<N.now()},ly.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},ly.prototype.setHoldDuration=function(r){this.symbolFadeHoldUntil=N.now()+r},ly.prototype.setDependencies=function(r,n){for(var i={},o=0,a=n;o<a.length;o+=1)i[a[o]]=!0;this.dependencies[r]=i},ly.prototype.hasDependency=function(r,n){for(var i=0,o=r;i<o.length;i+=1){var a=o[i],s=this.dependencies[a];if(s){for(var u=0,c=n;u<c.length;u+=1)if(s[c[u]])return!0}}return!1};var lv=self.performance,lg=function(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},lv.mark(this._marks.start)};lg.prototype.finish=function(){lv.mark(this._marks.end);var r=lv.getEntriesByName(this._marks.measure);return 0===r.length&&(lv.measure(this._marks.measure,this._marks.start,this._marks.end),r=lv.getEntriesByName(this._marks.measure),lv.clearMarks(this._marks.start),lv.clearMarks(this._marks.end),lv.clearMeasures(this._marks.measure)),r},r.Actor=sW,r.AlphaImage=op,r.CanonicalTileID=li,r.CollisionBoxArray=ia,r.Color=et,r.DEMData=ll,r.DataConstantProperty=nP,r.DictionaryCoder=lu,r.EXTENT=8192,r.ErrorEvent=t3,r.EvaluationParameters=nE,r.Event=tz,r.Evented=t4,r.FeatureIndex=ld,r.FillBucket=oj,r.FillExtrusionBucket=ao,r.ImageAtlas=aj,r.ImagePosition=aV,r.LineBucket=am,r.LngLat=sY,r.LngLatBounds=sK,r.MercatorCoordinate=ln,r.ONE_EM=24,r.OverscaledTileID=la,r.Point=c,r.Point$1=c,r.ProgramConfiguration=iR,r.Properties=n4,r.Protobuf=aI,r.RGBAImage=oh,r.RequestManager=tr,r.RequestPerformance=lg,r.ResourceType=tE,r.SegmentVector=i8,r.SourceFeatureState=lh,r.StructArrayLayout1ui2=ie,r.StructArrayLayout2i4=n7,r.StructArrayLayout2ui4=it,r.StructArrayLayout3ui6=n9,r.StructArrayLayout4i8=n5,r.SymbolBucket=s3,r.Texture=sG,r.Tile=ly,r.Transitionable=nC,r.Uniform1f=iC,r.Uniform1i=iS,r.Uniform2f=iI,r.Uniform3f=ik,r.Uniform4f=i1,r.UniformColor=i2,r.UniformMatrix4f=iP,r.UnwrappedTileID=lo,r.ValidationError=tR,r.WritingMode=aH,r.ZoomHistory=no,r.addDynamicAttributes=sP,r.asyncAll=function(r,n,i){if(!r.length)return i(null,[]);var o=r.length,a=Array(r.length),s=null;r.forEach(function(r,u){n(r,function(r,n){r&&(s=r),a[u]=n,0==--o&&i(s,a)})})},r.bezier=h,r.bindAll=x,r.browser=N,r.cacheEntryPossiblyAdded=function(r){++tw>t$&&(r.getActor().send("enforceCacheSizeLimit",t8),tw=0)},r.clamp=f,r.clearTileCache=function(r){var n=self.caches.delete(tg);r&&n.catch(r).then(function(){return r()})},r.clone=function(r){var n=new on(16);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],n},r.clone$1=T,r.commonjsRequire=function(){throw Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")},r.config=Y,r.create=function(){var r=new on(16);return on!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},r.create$1=function(){var r=new on(9);return on!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r},r.create$2=function(){var r=new on(4);return on!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r},r.createCommonjsModule=n,r.createExpression=r8,r.createLayout=nO,r.createStyleLayer=function(r){return"custom"===r.type?new s5(r):new sN[r.type](r)},r.deepEqual=function r(n,i){if(Array.isArray(n)){if(!Array.isArray(i)||n.length!==i.length)return!1;for(var o=0;o<n.length;o++)if(!r(n[o],i[o]))return!1;return!0}if("object"==typeof n&&null!==n&&null!==i){if("object"!=typeof i||Object.keys(n).length!==Object.keys(i).length)return!1;for(var a in n)if(!r(n[a],i[a]))return!1;return!0}return n===i},r.ease=d,r.emitValidationErrors=rW,r.encodeURL=H,r.endsWith=b,r.enforceCacheSizeLimit=function(r){t_(),tp&&tp.then(function(n){n.keys().then(function(i){for(var o=0;o<i.length-r;o++)n.delete(i[o])})})},r.evaluateSizeForFeature=sa,r.evaluateSizeForZoom=ss,r.evaluateVariableOffset=sT,r.evented=nx,r.extend=y,r.featureFilter=r1,r.filterObject=E,r.fromRotation=function(r,n){var i=Math.sin(n),o=Math.cos(n);return r[0]=o,r[1]=i,r[2]=0,r[3]=-i,r[4]=o,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},r.getAnchorAlignment=se,r.getAnchorJustification=sS,r.getArrayBuffer=t2,r.getImage=tP,r.getJSON=function(r,n){return t1(y(r,{type:"json"}),n)},r.getRTLTextPluginStatus=nb,r.getReferrer=tI,r.getVideo=function(r,n){var i,o,a=self.document.createElement("video");a.muted=!0,a.onloadstart=function(){n(null,a)};for(var s=0;s<r.length;s++){var u=self.document.createElement("source");i=r[s],o=void 0,(o=self.document.createElement("a")).href=i,(o.protocol!==self.document.location.protocol||o.host!==self.document.location.host)&&(a.crossOrigin="Anonymous"),u.src=r[s],a.appendChild(u)}return{cancel:function(){}}},r.identity=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},r.invert=function(r,n){var i=n[0],o=n[1],a=n[2],s=n[3],u=n[4],c=n[5],p=n[6],h=n[7],d=n[8],f=n[9],m=n[10],y=n[11],v=n[12],g=n[13],$=n[14],_=n[15],x=i*c-o*u,b=i*p-a*u,w=i*h-s*u,E=o*p-a*c,T=o*h-s*c,S=a*h-s*p,C=d*g-f*v,I=d*$-m*v,k=d*_-y*v,A=f*$-m*g,P=f*_-y*g,L=m*_-y*$,D=x*L-b*P+w*A+E*k-T*I+S*C;return D?(D=1/D,r[0]=(c*L-p*P+h*A)*D,r[1]=(a*P-o*L-s*A)*D,r[2]=(g*S-$*T+_*E)*D,r[3]=(m*T-f*S-y*E)*D,r[4]=(p*k-u*L-h*I)*D,r[5]=(i*L-a*k+s*I)*D,r[6]=($*w-v*S-_*b)*D,r[7]=(d*S-m*w+y*b)*D,r[8]=(u*P-c*k+h*C)*D,r[9]=(o*k-i*P-s*C)*D,r[10]=(v*T-g*w+_*x)*D,r[11]=(f*w-d*T-y*x)*D,r[12]=(c*I-u*A-p*C)*D,r[13]=(i*A-o*I+a*C)*D,r[14]=(g*b-v*E-$*x)*D,r[15]=(d*E-f*b+m*x)*D,r):null},r.isChar=na,r.isMapboxURL=tn,r.keysDifference=function(r,n){var i=[];for(var o in r)o in n||i.push(o);return i},r.makeRequest=t1,r.mapObject=w,r.mercatorXfromLng=s9,r.mercatorYfromLat=lt,r.mercatorZfromAltitude=le,r.multiply=function(r,n,i){var o=n[0],a=n[1],s=n[2],u=n[3],c=n[4],p=n[5],h=n[6],d=n[7],f=n[8],m=n[9],y=n[10],v=n[11],g=n[12],$=n[13],_=n[14],x=n[15],b=i[0],w=i[1],E=i[2],T=i[3];return r[0]=b*o+w*c+E*f+T*g,r[1]=b*a+w*p+E*m+T*$,r[2]=b*s+w*h+E*y+T*_,r[3]=b*u+w*d+E*v+T*x,b=i[4],w=i[5],E=i[6],T=i[7],r[4]=b*o+w*c+E*f+T*g,r[5]=b*a+w*p+E*m+T*$,r[6]=b*s+w*h+E*y+T*_,r[7]=b*u+w*d+E*v+T*x,b=i[8],w=i[9],E=i[10],T=i[11],r[8]=b*o+w*c+E*f+T*g,r[9]=b*a+w*p+E*m+T*$,r[10]=b*s+w*h+E*y+T*_,r[11]=b*u+w*d+E*v+T*x,b=i[12],w=i[13],E=i[14],T=i[15],r[12]=b*o+w*c+E*f+T*g,r[13]=b*a+w*p+E*m+T*$,r[14]=b*s+w*h+E*y+T*_,r[15]=b*u+w*d+E*v+T*x,r},r.mvt=ar,r.number=eT,r.offscreenCanvasSupported=t0,r.ortho=function(r,n,i,o,a,s,u){var c=1/(n-i),p=1/(o-a),h=1/(s-u);return r[0]=-2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*p,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*h,r[11]=0,r[12]=(n+i)*c,r[13]=(a+o)*p,r[14]=(u+s)*h,r[15]=1,r},r.parseGlyphPBF=function(r){return new aI(r).readFields(a7,[])},r.pbf=aI,r.performSymbolLayout=function(r,n,i,o,a,s){r.createArrays();var u=512*r.overscaling;r.tilePixelRatio=8192/u,r.compareText={},r.iconsNeedLinear=!1;var p=r.layers[0].layout,h=r.layers[0]._unevaluatedLayout._values,d={};if("composite"===r.textSizeData.kind){var f=r.textSizeData,m=f.minZoom,y=f.maxZoom;d.compositeTextSizes=[h["text-size"].possiblyEvaluate(new nE(m)),h["text-size"].possiblyEvaluate(new nE(y))]}if("composite"===r.iconSizeData.kind){var v=r.iconSizeData,g=v.minZoom,$=v.maxZoom;d.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new nE(g)),h["icon-size"].possiblyEvaluate(new nE($))]}d.layoutTextSize=h["text-size"].possiblyEvaluate(new nE(r.zoom+1)),d.layoutIconSize=h["icon-size"].possiblyEvaluate(new nE(r.zoom+1)),d.textMaxSize=h["text-size"].possiblyEvaluate(new nE(18));for(var _=24*p.get("text-line-height"),x="map"===p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),b=p.get("text-keep-upright"),w=p.get("text-size"),E=0,T=r.features;E<T.length;E+=1)(function(){var s=T[E],u=p.get("text-font").evaluate(s,{}).join(","),h=w.evaluate(s,{}),f=d.layoutTextSize.evaluate(s,{}),m=d.layoutIconSize.evaluate(s,{}),y={horizontal:{},vertical:void 0},v=s.text,g=[0,0];if(v){var $=v.toString(),S=24*p.get("text-letter-spacing").evaluate(s,{}),I=!function(r){for(var n=0,i=r;n<i.length;n+=1)if(!nl(i[n].charCodeAt(0)))return!1;return!0}($)?0:S,k=p.get("text-anchor").evaluate(s,{}),A=p.get("text-variable-anchor");if(!A){var P=p.get("text-radial-offset").evaluate(s,{});g=P?sT(k,[24*P,sE]):p.get("text-offset").evaluate(s,{}).map(function(r){return 24*r})}var L=x?"center":p.get("text-justify").evaluate(s,{}),D=p.get("symbol-placement"),z="point"===D?24*p.get("text-max-width").evaluate(s,{}):0,M=function(){r.allowVerticalPlacement&&ns($)&&(y.vertical=aW(v,n,i,a,u,z,_,k,"left",I,g,aH.vertical,!0,D,f,h))};if(!x&&A){for(var R="auto"===L?A.map(function(r){return sS(r)}):[L],B=!1,F=0;F<R.length;F++){var O=R[F];if(!y.horizontal[O]){if(B)y.horizontal[O]=y.horizontal[0];else{var N=aW(v,n,i,a,u,z,_,"center",O,I,g,aH.horizontal,!1,D,f,h);N&&(y.horizontal[O]=N,B=1===N.positionedLines.length)}}}M()}else{"auto"===L&&(L=sS(k));var U=aW(v,n,i,a,u,z,_,k,L,I,g,aH.horizontal,!1,D,f,h);U&&(y.horizontal[L]=U),M(),ns($)&&x&&b&&(y.vertical=aW(v,n,i,a,u,z,_,k,L,I,g,aH.vertical,!1,D,f,h))}}var V=void 0,q=!1;if(s.icon&&s.icon.name){var j,H,G,Z,W,X,K,Y,J,Q,tt,te=o[s.icon.name];te&&(V=(j=a[s.icon.name],H=p.get("icon-offset").evaluate(s,{}),G=p.get("icon-anchor").evaluate(s,{}),W=(Z=se(G)).horizontalAlign,X=Z.verticalAlign,K=H[0],Y=H[1],Q=(J=K-j.displaySize[0]*W)+j.displaySize[0],tt=Y-j.displaySize[1]*X,{image:j,top:tt,bottom:tt+j.displaySize[1],left:J,right:Q}),q=te.sdf,void 0===r.sdfIcons?r.sdfIcons=te.sdf:r.sdfIcons!==te.sdf&&C("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),te.pixelRatio!==r.pixelRatio?r.iconsNeedLinear=!0:0!==p.get("icon-rotate").constantOr(1)&&(r.iconsNeedLinear=!0))}var tr=sI(y.horizontal)||y.vertical;r.iconsInText=!!tr&&tr.iconsInText,(tr||V)&&function(r,n,i,o,a,s,u,p,h,d){var f=s.textMaxSize.evaluate(n,{});void 0===f&&(f=u);var m,y=r.layers[0].layout,v=y.get("icon-offset").evaluate(n,{}),g=sI(i.horizontal),$=u/24,_=r.tilePixelRatio*$,x=r.tilePixelRatio*f/24,b=r.tilePixelRatio*p,w=r.tilePixelRatio*y.get("symbol-spacing"),E=y.get("text-padding")*r.tilePixelRatio,T=y.get("icon-padding")*r.tilePixelRatio,S=y.get("text-max-angle")/180*Math.PI,I="map"===y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement"),k="map"===y.get("icon-rotation-alignment")&&"point"!==y.get("symbol-placement"),A=y.get("symbol-placement"),P=w/2,L=y.get("icon-text-fit");o&&"none"!==L&&(r.allowVerticalPlacement&&i.vertical&&(m=sn(o,i.vertical,L,y.get("icon-text-fit-padding"),v,$)),g&&(o=sn(o,g,L,y.get("icon-text-fit-padding"),v,$)));var D=function(u,c){c.x<0||c.x>=8192||c.y<0||c.y>=8192||function(r,n,i,o,a,s,u,c,p,h,d,f,m,y,v,g,$,_,x,b,w,E,T){var S,I,k,A,P,L=r.addToLineVertexArray(n,i),D=0,z=0,M=0,R=0,B=-1,F=-1,O={},N=ib(""),U=0,V=0;if(void 0===c._unevaluatedLayout.getValue("text-radial-offset")?(U=(S=c.layout.get("text-offset").evaluate(w,{}).map(function(r){return 24*r}))[0],V=S[1]):(U=24*c.layout.get("text-radial-offset").evaluate(w,{}),V=sE),r.allowVerticalPlacement&&o.vertical){var q=c.layout.get("text-rotate").evaluate(w,{})+90,j=o.vertical;A=new s$(p,i,n,h,d,f,j,m,y,v,r.overscaling,q),u&&(P=new s$(p,i,n,h,d,f,u,$,_,v,r.overscaling,q))}if(a){var H=c.layout.get("icon-rotate").evaluate(w,{}),G="none"!==c.layout.get("icon-text-fit"),Z=sm(a,H,T,G),W=u?sm(u,H,T,G):void 0;k=new s$(p,i,n,h,d,f,a,$,_,!1,r.overscaling,H),D=4*Z.length;var X=r.iconSizeData,K=null;"source"===X.kind?(K=[128*c.layout.get("icon-size").evaluate(w,{})])[0]>32640&&C(r.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===X.kind&&((K=[128*E.compositeIconSizes[0].evaluate(w,{}),128*E.compositeIconSizes[1].evaluate(w,{})])[0]>32640||K[1]>32640)&&C(r.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),r.addSymbols(r.icon,Z,K,b,x,w,!1,n,L.lineStartIndex,L.lineLength,-1),B=r.icon.placedSymbolArray.length-1,W&&(z=4*W.length,r.addSymbols(r.icon,W,K,b,x,w,aH.vertical,n,L.lineStartIndex,L.lineLength,-1),F=r.icon.placedSymbolArray.length-1)}for(var Y in o.horizontal){var J=o.horizontal[Y];if(!I){N=ib(J.text);var Q=c.layout.get("text-rotate").evaluate(w,{});I=new s$(p,i,n,h,d,f,J,m,y,v,r.overscaling,Q)}var tt=1===J.positionedLines.length;if(M+=sC(r,n,J,s,c,v,w,g,L,o.vertical?aH.horizontal:aH.horizontalOnly,tt?Object.keys(o.horizontal):[Y],O,B,E),tt)break}o.vertical&&(R+=sC(r,n,o.vertical,s,c,v,w,g,L,aH.vertical,["vertical"],O,F,E));var te=I?I.boxStartIndex:r.collisionBoxArray.length,tr=I?I.boxEndIndex:r.collisionBoxArray.length,tn=A?A.boxStartIndex:r.collisionBoxArray.length,ti=A?A.boxEndIndex:r.collisionBoxArray.length,to=k?k.boxStartIndex:r.collisionBoxArray.length,ta=k?k.boxEndIndex:r.collisionBoxArray.length,ts=P?P.boxStartIndex:r.collisionBoxArray.length,tl=P?P.boxEndIndex:r.collisionBoxArray.length;r.glyphOffsetArray.length>=s3.MAX_GLYPHS&&C("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==w.sortKey&&r.addToSortKeyRanges(r.symbolInstances.length,w.sortKey),r.symbolInstances.emplaceBack(n.x,n.y,O.right>=0?O.right:-1,O.center>=0?O.center:-1,O.left>=0?O.left:-1,O.vertical||-1,B,F,N,te,tr,tn,ti,to,ta,ts,tl,h,M,R,D,z,0,m,U,V)}(r,c,u,i,o,a,m,r.layers[0],r.collisionBoxArray,n.index,n.sourceLayerIndex,r.index,_,E,I,h,b,T,k,v,n,s,d)};if("line"===A)for(var z=0,M=function(r,n,i,o,a){for(var s=[],u=0;u<r.length;u++)for(var p=r[u],h=void 0,d=0;d<p.length-1;d++){var f=p[d],m=p[d+1];f.x<n&&m.x<n||(f.x<n?f=new c(n,f.y+(m.y-f.y)*((n-f.x)/(m.x-f.x)))._round():m.x<n&&(m=new c(n,f.y+(m.y-f.y)*((n-f.x)/(m.x-f.x)))._round()),f.y<i&&m.y<i||(f.y<i?f=new c(f.x+(m.x-f.x)*((i-f.y)/(m.y-f.y)),i)._round():m.y<i&&(m=new c(f.x+(m.x-f.x)*((i-f.y)/(m.y-f.y)),i)._round()),f.x>=o&&m.x>=o||(f.x>=o?f=new c(o,f.y+(m.y-f.y)*((o-f.x)/(m.x-f.x)))._round():m.x>=o&&(m=new c(o,f.y+(m.y-f.y)*((o-f.x)/(m.x-f.x)))._round()),f.y>=a&&m.y>=a||(f.y>=a?f=new c(f.x+(m.x-f.x)*((a-f.y)/(m.y-f.y)),a)._round():m.y>=a&&(m=new c(f.x+(m.x-f.x)*((a-f.y)/(m.y-f.y)),a)._round()),h&&f.equals(h[h.length-1])||(h=[f],s.push(h)),h.push(m)))))}return s}(n.geometry,0,0,8192,8192);z<M.length;z+=1)for(var R=M[z],B=sf(R,w,S,i.vertical||g,o,24,x,r.overscaling,8192),F=0,O=B;F<O.length;F+=1){var N=O[F],U=g;U&&sk(r,U.text,P,N)||D(R,N)}else if("line-center"===A)for(var V=0,q=n.geometry;V<q.length;V+=1){var j=q[V];if(j.length>1){var H=sd(j,S,i.vertical||g,o,24,x);H&&D(j,H)}}else if("Polygon"===n.type)for(var G=0,Z=oN(n.geometry,0);G<Z.length;G+=1){var W=Z[G],X=sb(W,16);D(W[0],new si(X.x,X.y,0))}else if("LineString"===n.type)for(var K=0,Y=n.geometry;K<Y.length;K+=1){var J=Y[K];D(J,new si(J[0].x,J[0].y,0))}else if("Point"===n.type)for(var Q=0,tt=n.geometry;Q<tt.length;Q+=1)for(var te=tt[Q],tr=0,tn=te;tr<tn.length;tr+=1){var ti=tn[tr];D([ti],new si(ti.x,ti.y,0))}}(r,s,y,V,o,d,f,m,g,q)})();s&&r.generateCollisionDebugBuffers()},r.perspective=function(r,n,i,o,a){var s,u=1/Math.tan(n/2);return r[0]=u/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=u,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,null!=a&&a!==1/0?(s=1/(o-a),r[10]=(a+o)*s,r[14]=2*a*o*s):(r[10]=-1,r[14]=-2*o),r},r.pick=function(r,n){for(var i={},o=0;o<n.length;o++){var a=n[o];a in r&&(i[a]=r[a])}return i},r.plugin=n0,r.polygonIntersectsPolygon=iV,r.postMapLoadEvent=tv,r.postTurnstileEvent=tm,r.potpack=aU,r.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.register=r9,r.registerForPluginStateChange=function(r){return r({pluginStatus:ng,pluginURL:n8}),nx.on("pluginStateChange",r),r},r.rotate=function(r,n,i){var o=n[0],a=n[1],s=n[2],u=n[3],c=Math.sin(i),p=Math.cos(i);return r[0]=o*p+s*c,r[1]=a*p+u*c,r[2]=-(o*c)+s*p,r[3]=-(a*c)+u*p,r},r.rotateX=function(r,n,i){var o=Math.sin(i),a=Math.cos(i),s=n[4],u=n[5],c=n[6],p=n[7],h=n[8],d=n[9],f=n[10],m=n[11];return n!==r&&(r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[4]=s*a+h*o,r[5]=u*a+d*o,r[6]=c*a+f*o,r[7]=p*a+m*o,r[8]=h*a-s*o,r[9]=d*a-u*o,r[10]=f*a-c*o,r[11]=m*a-p*o,r},r.rotateZ=function(r,n,i){var o=Math.sin(i),a=Math.cos(i),s=n[0],u=n[1],c=n[2],p=n[3],h=n[4],d=n[5],f=n[6],m=n[7];return n!==r&&(r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[0]=s*a+h*o,r[1]=u*a+d*o,r[2]=c*a+f*o,r[3]=p*a+m*o,r[4]=h*a-s*o,r[5]=d*a-u*o,r[6]=f*a-c*o,r[7]=m*a-p*o,r},r.scale=function(r,n,i){var o=i[0],a=i[1],s=i[2];return r[0]=n[0]*o,r[1]=n[1]*o,r[2]=n[2]*o,r[3]=n[3]*o,r[4]=n[4]*a,r[5]=n[5]*a,r[6]=n[6]*a,r[7]=n[7]*a,r[8]=n[8]*s,r[9]=n[9]*s,r[10]=n[10]*s,r[11]=n[11]*s,r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],r},r.setCacheLimits=function(r,n){t8=r,t$=n},r.setRTLTextPlugin=function(r,n,i){if(void 0===i&&(i=!1),ng===nf||ng===nm||ng===ny)throw Error("setRTLTextPlugin cannot be called multiple times.");n8=N.resolveURL(r),ng=nf,nv=n,n_(),i||nw()},r.sphericalToCartesian=function(r){var n=r[0],i=r[1],o=r[2];return i+=90,{x:n*Math.cos(i*=Math.PI/180)*Math.sin(o*=Math.PI/180),y:n*Math.sin(i)*Math.sin(o),z:n*Math.cos(o)}},r.styleSpec=tM,r.symbolSize=sl,r.transformMat3=function(r,n,i){var o=n[0],a=n[1],s=n[2];return r[0]=o*i[0]+a*i[3]+s*i[6],r[1]=o*i[1]+a*i[4]+s*i[7],r[2]=o*i[2]+a*i[5]+s*i[8],r},r.transformMat4=oi,r.translate=function(r,n,i){var o,a,s,u,c,p,h,d,f,m,y,v,g=i[0],$=i[1],_=i[2];return n===r?(r[12]=n[0]*g+n[4]*$+n[8]*_+n[12],r[13]=n[1]*g+n[5]*$+n[9]*_+n[13],r[14]=n[2]*g+n[6]*$+n[10]*_+n[14],r[15]=n[3]*g+n[7]*$+n[11]*_+n[15]):(o=n[0],a=n[1],s=n[2],u=n[3],c=n[4],p=n[5],h=n[6],d=n[7],f=n[8],m=n[9],y=n[10],v=n[11],r[0]=o,r[1]=a,r[2]=s,r[3]=u,r[4]=c,r[5]=p,r[6]=h,r[7]=d,r[8]=f,r[9]=m,r[10]=y,r[11]=v,r[12]=o*g+c*$+f*_+n[12],r[13]=a*g+p*$+m*_+n[13],r[14]=s*g+h*$+y*_+n[14],r[15]=u*g+d*$+v*_+n[15]),r},r.triggerPluginCompletionEvent=n$,r.uniqueId=g,r.unwrapExports=function(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r},r.validateCustomStyleLayer=function(r){var n=[],i=r.id;return void 0===i&&n.push({message:"layers."+i+': missing required property "id"'}),void 0===r.render&&n.push({message:"layers."+i+': missing required method "render"'}),r.renderingMode&&"2d"!==r.renderingMode&&"3d"!==r.renderingMode&&n.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),n},r.validateLight=rH,r.validateStyle=rj,r.values=function(r){var n=[];for(var i in r)n.push(r[i]);return n},r.vectorTile=ar,r.version="1.8.0-dev",r.warnOnce=C,r.webpSupported=J,r.window=self,r.wrap=m}),o(["./shared"],function(r){function n(r){var i=typeof r;if("number"===i||"boolean"===i||"string"===i||null==r)return JSON.stringify(r);if(Array.isArray(r)){for(var o="[",a=0,s=r;a<s.length;a+=1)o+=n(s[a])+",";return o+"]"}for(var u=Object.keys(r).sort(),c="{",p=0;p<u.length;p++)c+=JSON.stringify(u[p])+":"+n(r[u[p]])+",";return c+"}"}function i(i){for(var o="",a=0,s=r.refProperties;a<s.length;a+=1)o+="/"+n(i[s[a]]);return o}var o=function(r){this.keyCache={},r&&this.replace(r)};o.prototype.replace=function(r){this._layerConfigs={},this._layers={},this.update(r,[])},o.prototype.update=function(n,o){for(var a=this,s=0,u=n;s<u.length;s+=1){var c=u[s];this._layerConfigs[c.id]=c;var p=this._layers[c.id]=r.createStyleLayer(c);p._featureFilter=r.featureFilter(p.filter),this.keyCache[c.id]&&delete this.keyCache[c.id]}for(var h=0,d=o;h<d.length;h+=1){var f=d[h];delete this.keyCache[f],delete this._layerConfigs[f],delete this._layers[f]}this.familiesBySource={};for(var m=0,y=function(r,n){for(var o={},a=0;a<r.length;a++){var s=n&&n[r[a].id]||i(r[a]);n&&(n[r[a].id]=s);var u=o[s];u||(u=o[s]=[]),u.push(r[a])}var c=[];for(var p in o)c.push(o[p]);return c}(r.values(this._layerConfigs),this.keyCache);m<y.length;m+=1){var v=y[m].map(function(r){return a._layers[r.id]}),g=v[0];if("none"!==g.visibility){var $=g.source||"",_=this.familiesBySource[$];_||(_=this.familiesBySource[$]={});var x=g.sourceLayer||"_geojsonTileLayer",b=_[x];b||(b=_[x]=[]),b.push(v)}}};var a=function(n){var i={},o=[];for(var a in n){var s=n[a],u=i[a]={};for(var c in s){var p=s[+c];if(p&&0!==p.bitmap.width&&0!==p.bitmap.height){var h={x:0,y:0,w:p.bitmap.width+2,h:p.bitmap.height+2};o.push(h),u[c]={rect:h,metrics:p.metrics}}}}var d=r.potpack(o),f=d.w,m=d.h,y=new r.AlphaImage({width:f||1,height:m||1});for(var v in n){var g=n[v];for(var $ in g){var _=g[+$];if(_&&0!==_.bitmap.width&&0!==_.bitmap.height){var x=i[v][$].rect;r.AlphaImage.copy(_.bitmap,y,{x:0,y:0},{x:x.x+1,y:x.y+1},_.bitmap)}}}this.image=y,this.positions=i};r.register("GlyphAtlas",a);var s=function(n){this.tileID=new r.OverscaledTileID(n.tileID.overscaledZ,n.tileID.wrap,n.tileID.canonical.z,n.tileID.canonical.x,n.tileID.canonical.y),this.uid=n.uid,this.zoom=n.zoom,this.pixelRatio=n.pixelRatio,this.tileSize=n.tileSize,this.source=n.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=n.showCollisionBoxes,this.collectResourceTiming=!!n.collectResourceTiming,this.returnDependencies=!!n.returnDependencies,this.promoteId=n.promoteId};function u(n,i,o){for(var a=new r.EvaluationParameters(i),s=0,u=n;s<u.length;s+=1)u[s].recalculate(a,o)}function c(n,i){var o=r.getArrayBuffer(n.request,function(n,o,a,s){n?i(n):o&&i(null,{vectorTile:new r.vectorTile.VectorTile(new r.pbf(o)),rawData:o,cacheControl:a,expires:s})});return function(){o.cancel(),i()}}s.prototype.parse=function(n,i,o,s,c){var p=this;this.status="parsing",this.data=n,this.collisionBoxArray=new r.CollisionBoxArray;var h=new r.DictionaryCoder(Object.keys(n.layers).sort()),d=new r.FeatureIndex(this.tileID,this.promoteId);d.bucketLayerIDs=[];var f,m,y,v,g={},$={featureIndex:d,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:o},_=i.familiesBySource[this.source];for(var x in _){var b=n.layers[x];if(b){1===b.version&&r.warnOnce('Vector tile source "'+this.source+'" layer "'+x+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var w=h.encode(x),E=[],T=0;T<b.length;T++){var S=b.feature(T),C=d.getId(S,x);E.push({feature:S,id:C,index:T,sourceLayerIndex:w})}for(var I=0,k=_[x];I<k.length;I+=1){var A=k[I],P=A[0];P.minzoom&&this.zoom<Math.floor(P.minzoom)||P.maxzoom&&this.zoom>=P.maxzoom||"none"===P.visibility||(u(A,this.zoom,o),(g[P.id]=P.createBucket({index:d.bucketLayerIDs.length,layers:A,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:w,sourceID:this.source})).populate(E,$),d.bucketLayerIDs.push(A.map(function(r){return r.id})))}}}var L=r.mapObject($.glyphDependencies,function(r){return Object.keys(r).map(Number)});Object.keys(L).length?s.send("getGlyphs",{uid:this.uid,stacks:L},function(r,n){f||(f=r,m=n,M.call(p))}):m={};var D=Object.keys($.iconDependencies);D.length?s.send("getImages",{icons:D,source:this.source,tileID:this.tileID,type:"icons"},function(r,n){f||(f=r,y=n,M.call(p))}):y={};var z=Object.keys($.patternDependencies);function M(){if(f)return c(f);if(m&&y&&v){var n=new a(m),i=new r.ImageAtlas(y,v);for(var s in g){var p=g[s];p instanceof r.SymbolBucket?(u(p.layers,this.zoom,o),r.performSymbolLayout(p,m,n.positions,y,i.iconPositions,this.showCollisionBoxes)):p.hasPattern&&(p instanceof r.LineBucket||p instanceof r.FillBucket||p instanceof r.FillExtrusionBucket)&&(u(p.layers,this.zoom,o),p.addFeatures($,i.patternPositions))}this.status="done",c(null,{buckets:r.values(g).filter(function(r){return!r.isEmpty()}),featureIndex:d,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:n.image,imageAtlas:i,glyphMap:this.returnDependencies?m:null,iconMap:this.returnDependencies?y:null,glyphPositions:this.returnDependencies?n.positions:null})}}z.length?s.send("getImages",{icons:z,source:this.source,tileID:this.tileID,type:"patterns"},function(r,n){f||(f=r,v=n,M.call(p))}):v={},M.call(this)};var p=function(r,n,i,o){this.actor=r,this.layerIndex=n,this.availableImages=i,this.loadVectorData=o||c,this.loading={},this.loaded={}};p.prototype.loadTile=function(n,i){var o=this,a=n.uid;this.loading||(this.loading={});var u=!!(n&&n.request&&n.request.collectResourceTiming)&&new r.RequestPerformance(n.request),c=this.loading[a]=new s(n);c.abort=this.loadVectorData(n,function(n,s){if(delete o.loading[a],n||!s)return c.status="done",o.loaded[a]=c,i(n);var p=s.rawData,h={};s.expires&&(h.expires=s.expires),s.cacheControl&&(h.cacheControl=s.cacheControl);var d={};if(u){var f=u.finish();f&&(d.resourceTiming=JSON.parse(JSON.stringify(f)))}c.vectorTile=s.vectorTile,c.parse(s.vectorTile,o.layerIndex,o.availableImages,o.actor,function(n,o){if(n||!o)return i(n);i(null,r.extend({rawTileData:p.slice(0)},o,h,d))}),o.loaded=o.loaded||{},o.loaded[a]=c})},p.prototype.reloadTile=function(r,n){var i=this,o=this.loaded,a=r.uid,s=this;if(o&&o[a]){var u=o[a];u.showCollisionBoxes=r.showCollisionBoxes;var c=function(r,o){var a=u.reloadCallback;a&&(delete u.reloadCallback,u.parse(u.vectorTile,s.layerIndex,i.availableImages,s.actor,a)),n(r,o)};"parsing"===u.status?u.reloadCallback=c:"done"===u.status&&(u.vectorTile?u.parse(u.vectorTile,this.layerIndex,this.availableImages,this.actor,c):c())}},p.prototype.abortTile=function(r,n){var i=this.loading,o=r.uid;i&&i[o]&&i[o].abort&&(i[o].abort(),delete i[o]),n()},p.prototype.removeTile=function(r,n){var i=this.loaded,o=r.uid;i&&i[o]&&delete i[o],n()};var h=r.window.ImageBitmap,d=function(){this.loaded={}};d.prototype.loadTile=function(n,i){var o=n.uid,a=n.encoding,s=n.rawImageData,u=h&&s instanceof h?this.getImageData(s):s,c=new r.DEMData(o,u,a);this.loaded=this.loaded||{},this.loaded[o]=c,i(null,c)},d.prototype.getImageData=function(n){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(n.width,n.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=n.width,this.offscreenCanvas.height=n.height,this.offscreenCanvasContext.drawImage(n,0,0,n.width,n.height);var i=this.offscreenCanvasContext.getImageData(-1,-1,n.width+2,n.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new r.RGBAImage({width:i.width,height:i.height},i.data)},d.prototype.removeTile=function(r){var n=this.loaded,i=r.uid;n&&n[i]&&delete n[i]};var f={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142};function m(r){var n=0;if(r&&r.length>0){n+=Math.abs(y(r[0]));for(var i=1;i<r.length;i++)n-=Math.abs(y(r[i]))}return n}function y(r){var n,i,o,a,s,u,c=0,p=r.length;if(p>2){for(u=0;u<p;u++)u===p-2?(o=p-2,a=p-1,s=0):u===p-1?(o=p-1,a=0,s=1):(o=u,a=u+1,s=u+2),n=r[o],i=r[a],c+=(v(r[s][0])-v(n[0]))*Math.sin(v(i[1]));c=c*f.RADIUS*f.RADIUS/2}return c}function v(r){return r*Math.PI/180}var g={geometry:function r(n){var i,o=0;switch(n.type){case"Polygon":return m(n.coordinates);case"MultiPolygon":for(i=0;i<n.coordinates.length;i++)o+=m(n.coordinates[i]);return o;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(i=0;i<n.geometries.length;i++)o+=r(n.geometries[i]);return o}},ring:y},$=function r(n,i){switch(n&&n.type||null){case"FeatureCollection":return n.features=n.features.map(_(r,i)),n;case"GeometryCollection":return n.geometries=n.geometries.map(_(r,i)),n;case"Feature":return n.geometry=r(n.geometry,i),n;case"Polygon":case"MultiPolygon":var o,a;return o=n,a=i,"Polygon"===o.type?o.coordinates=x(o.coordinates,a):"MultiPolygon"===o.type&&(o.coordinates=o.coordinates.map(_(x,a))),o;default:return n}};function _(r,n){return function(i){return r(i,n)}}function x(r,n){n=!!n,r[0]=b(r[0],n);for(var i=1;i<r.length;i++)r[i]=b(r[i],!n);return r}function b(r,n){var i;return(i=r,g.ring(i)>=0===n)?r:r.reverse()}var w=r.vectorTile.VectorTileFeature.prototype.toGeoJSON,E=function(n){this._feature=n,this.extent=r.EXTENT,this.type=n.type,this.properties=n.tags,"id"in n&&!isNaN(n.id)&&(this.id=parseInt(n.id,10))};E.prototype.loadGeometry=function(){if(1===this._feature.type){for(var n=[],i=0,o=this._feature.geometry;i<o.length;i+=1){var a=o[i];n.push([new r.Point$1(a[0],a[1])])}return n}for(var s=[],u=0,c=this._feature.geometry;u<c.length;u+=1){for(var p=[],h=0,d=c[u];h<d.length;h+=1){var f=d[h];p.push(new r.Point$1(f[0],f[1]))}s.push(p)}return s},E.prototype.toGeoJSON=function(r,n,i){return w.call(this,r,n,i)};var T=function(n){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.EXTENT,this.length=n.length,this._features=n};T.prototype.feature=function(r){return new E(this._features[r])};var S=r.vectorTile.VectorTileFeature,C=I;function I(r,n){this.options=n||{},this.features=r,this.length=r.length}function k(r,n){this.id="number"==typeof r.id?r.id:void 0,this.type=r.type,this.rawGeometry=1===r.type?[r.geometry]:r.geometry,this.properties=r.tags,this.extent=n||4096}I.prototype.feature=function(r){return new k(this.features[r],this.options.extent)},k.prototype.loadGeometry=function(){var n=this.rawGeometry;this.geometry=[];for(var i=0;i<n.length;i++){for(var o=n[i],a=[],s=0;s<o.length;s++)a.push(new r.Point$1(o[s][0],o[s][1]));this.geometry.push(a)}return this.geometry},k.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var r=this.geometry,n=1/0,i=-1/0,o=1/0,a=-1/0,s=0;s<r.length;s++)for(var u=r[s],c=0;c<u.length;c++){var p=u[c];n=Math.min(n,p.x),i=Math.max(i,p.x),o=Math.min(o,p.y),a=Math.max(a,p.y)}return[n,o,i,a]},k.prototype.toGeoJSON=S.prototype.toGeoJSON;var A=L,P=function(r,n){n=n||{};var i={};for(var o in r)i[o]=new C(r[o].features,n),i[o].name=o,i[o].version=n.version,i[o].extent=n.extent;return L({layers:i})};function L(n){var i=new r.pbf;return function(r,n){for(var i in r.layers)n.writeMessage(3,D,r.layers[i])}(n,i),i.finish()}function D(r,n){n.writeVarintField(15,r.version||1),n.writeStringField(1,r.name||""),n.writeVarintField(5,r.extent||4096);var i,o={keys:[],values:[],keycache:{},valuecache:{}};for(i=0;i<r.length;i++)o.feature=r.feature(i),n.writeMessage(2,z,o);var a=o.keys;for(i=0;i<a.length;i++)n.writeStringField(3,a[i]);var s=o.values;for(i=0;i<s.length;i++)n.writeMessage(4,O,s[i])}function z(r,n){var i=r.feature;void 0!==i.id&&n.writeVarintField(1,i.id),n.writeMessage(2,M,r),n.writeVarintField(3,i.type),n.writeMessage(4,F,i)}function M(r,n){var i=r.feature,o=r.keys,a=r.values,s=r.keycache,u=r.valuecache;for(var c in i.properties){var p=s[c];void 0===p&&(o.push(c),p=o.length-1,s[c]=p),n.writeVarint(p);var h=i.properties[c],d=typeof h;"string"!==d&&"boolean"!==d&&"number"!==d&&(h=JSON.stringify(h));var f=d+":"+h,m=u[f];void 0===m&&(a.push(h),m=a.length-1,u[f]=m),n.writeVarint(m)}}function R(r,n){return(n<<3)+(7&r)}function B(r){return r<<1^r>>31}function F(r,n){for(var i=r.loadGeometry(),o=r.type,a=0,s=0,u=i.length,c=0;c<u;c++){var p=i[c],h=1;1===o&&(h=p.length),n.writeVarint(R(1,h));for(var d=3===o?p.length-1:p.length,f=0;f<d;f++){1===f&&1!==o&&n.writeVarint(R(2,d-1));var m=p[f].x-a,y=p[f].y-s;n.writeVarint(B(m)),n.writeVarint(B(y)),a+=m,s+=y}3===o&&n.writeVarint(R(7,1))}}function O(r,n){var i=typeof r;"string"===i?n.writeStringField(1,r):"boolean"===i?n.writeBooleanField(7,r):"number"===i&&(r%1!=0?n.writeDoubleField(3,r):r<0?n.writeSVarintField(6,r):n.writeVarintField(5,r))}function N(r,n,i,o){U(r,i,o),U(n,2*i,2*o),U(n,2*i+1,2*o+1)}function U(r,n,i){var o=r[n];r[n]=r[i],r[i]=o}function V(r,n,i,o){var a=r-i,s=n-o;return a*a+s*s}A.fromVectorTileJs=L,A.fromGeojsonVt=P,A.GeoJSONWrapper=C;var q=function(r){return r[0]},j=function(r){return r[1]},H=function(r,n,i,o,a){void 0===n&&(n=q),void 0===i&&(i=j),void 0===o&&(o=64),void 0===a&&(a=Float64Array),this.nodeSize=o,this.points=r;for(var s=r.length<65536?Uint16Array:Uint32Array,u=this.ids=new s(r.length),c=this.coords=new a(2*r.length),p=0;p<r.length;p++)u[p]=p,c[2*p]=n(r[p]),c[2*p+1]=i(r[p]);!function r(n,i,o,a,s,u){if(!(s-a<=o)){var c=a+s>>1;(function r(n,i,o,a,s,u){for(;s>a;){if(s-a>600){var c=s-a+1,p=o-a+1,h=Math.log(c),d=.5*Math.exp(2*h/3),f=.5*Math.sqrt(h*d*(c-d)/c)*(p-c/2<0?-1:1),m=Math.max(a,Math.floor(o-p*d/c+f)),y=Math.min(s,Math.floor(o+(c-p)*d/c+f));r(n,i,o,m,y,u)}var v=i[2*o+u],g=a,$=s;for(N(n,i,a,o),i[2*s+u]>v&&N(n,i,a,s);g<$;){for(N(n,i,g,$),g++,$--;i[2*g+u]<v;)g++;for(;i[2*$+u]>v;)$--}i[2*a+u]===v?N(n,i,a,$):N(n,i,++$,s),$<=o&&(a=$+1),o<=$&&(s=$-1)}})(n,i,c,a,s,u%2),r(n,i,o,a,c-1,u+1),r(n,i,o,c+1,s,u+1)}}(u,c,o,0,u.length-1,0)};H.prototype.range=function(r,n,i,o){return function(r,n,i,o,a,s,u){for(var c,p,h=[0,r.length-1,0],d=[];h.length;){var f=h.pop(),m=h.pop(),y=h.pop();if(m-y<=u)for(var v=y;v<=m;v++)c=n[2*v],p=n[2*v+1],c>=i&&c<=a&&p>=o&&p<=s&&d.push(r[v]);else{var g=Math.floor((y+m)/2);c=n[2*g],p=n[2*g+1],c>=i&&c<=a&&p>=o&&p<=s&&d.push(r[g]);var $=(f+1)%2;(0===f?i<=c:o<=p)&&(h.push(y),h.push(g-1),h.push($)),(0===f?a>=c:s>=p)&&(h.push(g+1),h.push(m),h.push($))}}return d}(this.ids,this.coords,r,n,i,o,this.nodeSize)},H.prototype.within=function(r,n,i){return function(r,n,i,o,a,s){for(var u=[0,r.length-1,0],c=[],p=a*a;u.length;){var h=u.pop(),d=u.pop(),f=u.pop();if(d-f<=s)for(var m=f;m<=d;m++)V(n[2*m],n[2*m+1],i,o)<=p&&c.push(r[m]);else{var y=Math.floor((f+d)/2),v=n[2*y],g=n[2*y+1];V(v,g,i,o)<=p&&c.push(r[y]);var $=(h+1)%2;(0===h?i-a<=v:o-a<=g)&&(u.push(f),u.push(y-1),u.push($)),(0===h?i+a>=v:o+a>=g)&&(u.push(y+1),u.push(d),u.push($))}}return c}(this.ids,this.coords,r,n,i,this.nodeSize)};var G={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(r){return r}},Z=function(r){this.options=tt(Object.create(G),r),this.trees=Array(this.options.maxZoom+1)};function W(r,n,i,o,a){return{x:r,y:n,zoom:1/0,id:i,parentId:-1,numPoints:o,properties:a}}function X(r,n){var i=r.geometry.coordinates,o=i[0],a=i[1];return{x:J(o),y:Q(a),zoom:1/0,index:n,parentId:-1}}function K(r){var n,i,o;return{type:"Feature",id:r.id,properties:Y(r),geometry:{type:"Point",coordinates:[360*((o=r.x)-.5),360*Math.atan(Math.exp(i=(180-360*(n=r.y))*Math.PI/180))/Math.PI-90]}}}function Y(r){var n=r.numPoints,i=n>=1e4?Math.round(n/1e3)+"k":n>=1e3?Math.round(n/100)/10+"k":n;return tt(tt({},r.properties),{cluster:!0,cluster_id:r.id,point_count:n,point_count_abbreviated:i})}function J(r){return r/360+.5}function Q(r){var n=Math.sin(r*Math.PI/180),i=.5-.25*Math.log((1+n)/(1-n))/Math.PI;return i<0?0:i>1?1:i}function tt(r,n){for(var i in n)r[i]=n[i];return r}function te(r){return r.x}function tr(r){return r.y}function tn(r,n,i,o,a,s){var u=a-i,c=s-o;if(0!==u||0!==c){var p=((r-i)*u+(n-o)*c)/(u*u+c*c);p>1?(i=a,o=s):p>0&&(i+=u*p,o+=c*p)}return(u=r-i)*u+(c=n-o)*c}function ti(r,n,i,o){var a={id:void 0===r?null:r,type:n,geometry:i,tags:o,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(r){var n=r.geometry,i=r.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)to(r,n);else if("Polygon"===i||"MultiLineString"===i)for(var o=0;o<n.length;o++)to(r,n[o]);else if("MultiPolygon"===i)for(o=0;o<n.length;o++)for(var a=0;a<n[o].length;a++)to(r,n[o][a])}(a),a}function to(r,n){for(var i=0;i<n.length;i+=3)r.minX=Math.min(r.minX,n[i]),r.minY=Math.min(r.minY,n[i+1]),r.maxX=Math.max(r.maxX,n[i]),r.maxY=Math.max(r.maxY,n[i+1])}function ta(r,n,i,o){if(n.geometry){var a=n.geometry.coordinates,s=n.geometry.type,u=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),c=[],p=n.id;if(i.promoteId?p=n.properties[i.promoteId]:i.generateId&&(p=o||0),"Point"===s)ts(a,c);else if("MultiPoint"===s)for(var h=0;h<a.length;h++)ts(a[h],c);else if("LineString"===s)tl(a,c,u,!1);else if("MultiLineString"===s){if(i.lineMetrics){for(h=0;h<a.length;h++)c=[],tl(a[h],c,u,!1),r.push(ti(p,"LineString",c,n.properties));return}tu(a,c,u,!1)}else if("Polygon"===s)tu(a,c,u,!0);else{if("MultiPolygon"!==s){if("GeometryCollection"===s){for(h=0;h<n.geometry.geometries.length;h++)ta(r,{id:p,geometry:n.geometry.geometries[h],properties:n.properties},i,o);return}throw Error("Input data is not a valid GeoJSON object.")}for(h=0;h<a.length;h++){var d=[];tu(a[h],d,u,!0),c.push(d)}}r.push(ti(p,s,c,n.properties))}}function ts(r,n){n.push(tc(r[0])),n.push(tp(r[1])),n.push(0)}function tl(r,n,i,o){for(var a,s,u=0,c=0;c<r.length;c++){var p=tc(r[c][0]),h=tp(r[c][1]);n.push(p),n.push(h),n.push(0),c>0&&(u+=o?(a*h-p*s)/2:Math.sqrt(Math.pow(p-a,2)+Math.pow(h-s,2))),a=p,s=h}var d=n.length-3;n[2]=1,function r(n,i,o,a){for(var s,u=a,c=o-i>>1,p=o-i,h=n[i],d=n[i+1],f=n[o],m=n[o+1],y=i+3;y<o;y+=3){var v=tn(n[y],n[y+1],h,d,f,m);if(v>u)s=y,u=v;else if(v===u){var g=Math.abs(y-c);g<p&&(s=y,p=g)}}u>a&&(s-i>3&&r(n,i,s,a),n[s+2]=u,o-s>3&&r(n,s,o,a))}(n,0,d,i),n[d+2]=1,n.size=Math.abs(u),n.start=0,n.end=n.size}function tu(r,n,i,o){for(var a=0;a<r.length;a++){var s=[];tl(r[a],s,i,o),n.push(s)}}function tc(r){return r/360+.5}function tp(r){var n=Math.sin(r*Math.PI/180),i=.5-.25*Math.log((1+n)/(1-n))/Math.PI;return i<0?0:i>1?1:i}function th(r,n,i,o,a,s,u,c){if(o/=n,s>=(i/=n)&&u<o)return r;if(u<i||s>=o)return null;for(var p=[],h=0;h<r.length;h++){var d=r[h],f=d.geometry,m=d.type,y=0===a?d.minX:d.minY,v=0===a?d.maxX:d.maxY;if(y>=i&&v<o)p.push(d);else if(!(v<i||y>=o)){var g=[];if("Point"===m||"MultiPoint"===m)td(f,g,i,o,a);else if("LineString"===m)tf(f,g,i,o,a,!1,c.lineMetrics);else if("MultiLineString"===m)ty(f,g,i,o,a,!1);else if("Polygon"===m)ty(f,g,i,o,a,!0);else if("MultiPolygon"===m)for(var $=0;$<f.length;$++){var _=[];ty(f[$],_,i,o,a,!0),_.length&&g.push(_)}if(g.length){if(c.lineMetrics&&"LineString"===m){for($=0;$<g.length;$++)p.push(ti(d.id,m,g[$],d.tags));continue}"LineString"!==m&&"MultiLineString"!==m||(1===g.length?(m="LineString",g=g[0]):m="MultiLineString"),"Point"!==m&&"MultiPoint"!==m||(m=3===g.length?"Point":"MultiPoint"),p.push(ti(d.id,m,g,d.tags))}}}return p.length?p:null}function td(r,n,i,o,a){for(var s=0;s<r.length;s+=3){var u=r[s+a];u>=i&&u<=o&&(n.push(r[s]),n.push(r[s+1]),n.push(r[s+2]))}}function tf(r,n,i,o,a,s,u){for(var c,p,h=tm(r),d=0===a?tg:t8,f=r.start,m=0;m<r.length-3;m+=3){var y=r[m],v=r[m+1],g=r[m+2],$=r[m+3],_=r[m+4],x=0===a?y:v,b=0===a?$:_,w=!1;u&&(c=Math.sqrt(Math.pow(y-$,2)+Math.pow(v-_,2))),x<i?b>i&&(p=d(h,y,v,$,_,i),u&&(h.start=f+c*p)):x>o?b<o&&(p=d(h,y,v,$,_,o),u&&(h.start=f+c*p)):tv(h,y,v,g),b<i&&x>=i&&(p=d(h,y,v,$,_,i),w=!0),b>o&&x<=o&&(p=d(h,y,v,$,_,o),w=!0),!s&&w&&(u&&(h.end=f+c*p),n.push(h),h=tm(r)),u&&(f+=c)}var E=r.length-3;y=r[E],v=r[E+1],g=r[E+2],(x=0===a?y:v)>=i&&x<=o&&tv(h,y,v,g),E=h.length-3,s&&E>=3&&(h[E]!==h[0]||h[E+1]!==h[1])&&tv(h,h[0],h[1],h[2]),h.length&&n.push(h)}function tm(r){var n=[];return n.size=r.size,n.start=r.start,n.end=r.end,n}function ty(r,n,i,o,a,s){for(var u=0;u<r.length;u++)tf(r[u],n,i,o,a,s,!1)}function tv(r,n,i,o){r.push(n),r.push(i),r.push(o)}function tg(r,n,i,o,a,s){var u=(s-n)/(o-n);return r.push(s),r.push(i+(a-i)*u),r.push(1),u}function t8(r,n,i,o,a,s){var u=(s-i)/(a-i);return r.push(n+(o-n)*u),r.push(s),r.push(1),u}function t$(r,n){for(var i=[],o=0;o<r.length;o++){var a,s=r[o],u=s.type;if("Point"===u||"MultiPoint"===u||"LineString"===u)a=t_(s.geometry,n);else if("MultiLineString"===u||"Polygon"===u){a=[];for(var c=0;c<s.geometry.length;c++)a.push(t_(s.geometry[c],n))}else if("MultiPolygon"===u)for(a=[],c=0;c<s.geometry.length;c++){for(var p=[],h=0;h<s.geometry[c].length;h++)p.push(t_(s.geometry[c][h],n));a.push(p)}i.push(ti(s.id,u,a,s.tags))}return i}function t_(r,n){var i=[];i.size=r.size,void 0!==r.start&&(i.start=r.start,i.end=r.end);for(var o=0;o<r.length;o+=3)i.push(r[o]+n,r[o+1],r[o+2]);return i}function tx(r,n){if(r.transformed)return r;var i,o,a,s=1<<r.z,u=r.x,c=r.y;for(i=0;i<r.features.length;i++){var p=r.features[i],h=p.geometry,d=p.type;if(p.geometry=[],1===d)for(o=0;o<h.length;o+=2)p.geometry.push(tb(h[o],h[o+1],n,s,u,c));else for(o=0;o<h.length;o++){var f=[];for(a=0;a<h[o].length;a+=2)f.push(tb(h[o][a],h[o][a+1],n,s,u,c));p.geometry.push(f)}}return r.transformed=!0,r}function tb(r,n,i,o,a,s){return[Math.round(i*(r*o-a)),Math.round(i*(n*o-s))]}function tw(r,n,i,o,a){for(var s=n===a.maxZoom?0:a.tolerance/((1<<n)*a.extent),u={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:o,z:n,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},c=0;c<r.length;c++){u.numFeatures++,t0(u,r[c],s,a);var p=r[c].minX,h=r[c].minY,d=r[c].maxX,f=r[c].maxY;p<u.minX&&(u.minX=p),h<u.minY&&(u.minY=h),d>u.maxX&&(u.maxX=d),f>u.maxY&&(u.maxY=f)}return u}function t0(r,n,i,o){var a=n.geometry,s=n.type,u=[];if("Point"===s||"MultiPoint"===s)for(var c=0;c<a.length;c+=3)u.push(a[c]),u.push(a[c+1]),r.numPoints++,r.numSimplified++;else if("LineString"===s)tE(u,a,r,i,!1,!1);else if("MultiLineString"===s||"Polygon"===s)for(c=0;c<a.length;c++)tE(u,a[c],r,i,"Polygon"===s,0===c);else if("MultiPolygon"===s)for(var p=0;p<a.length;p++){var h=a[p];for(c=0;c<h.length;c++)tE(u,h[c],r,i,!0,0===c)}if(u.length){var d=n.tags||null;if("LineString"===s&&o.lineMetrics){for(var f in d={},n.tags)d[f]=n.tags[f];d.mapbox_clip_start=a.start/a.size,d.mapbox_clip_end=a.end/a.size}var m={geometry:u,type:"Polygon"===s||"MultiPolygon"===s?3:"LineString"===s||"MultiLineString"===s?2:1,tags:d};null!==n.id&&(m.id=n.id),r.features.push(m)}}function tE(r,n,i,o,a,s){var u=o*o;if(o>0&&n.size<(a?u:o))i.numPoints+=n.length/3;else{for(var c=[],p=0;p<n.length;p+=3)(0===o||n[p+2]>u)&&(i.numSimplified++,c.push(n[p]),c.push(n[p+1])),i.numPoints++;a&&function(r,n){for(var i=0,o=0,a=r.length,s=a-2;o<a;s=o,o+=2)i+=(r[o]-r[s])*(r[o+1]+r[s+1]);if(i>0===n)for(o=0,a=r.length;o<a/2;o+=2){var u=r[o],c=r[o+1];r[o]=r[a-2-o],r[o+1]=r[a-1-o],r[a-2-o]=u,r[a-1-o]=c}}(c,s),r.push(c)}}function tT(r,n){var i=(n=this.options=function(r,n){for(var i in n)r[i]=n[i];return r}(Object.create(this.options),n)).debug;if(i&&console.time("preprocess data"),n.maxZoom<0||n.maxZoom>24)throw Error("maxZoom should be in the 0-24 range");if(n.promoteId&&n.generateId)throw Error("promoteId and generateId cannot be used together.");var o,a,s,u,c,p,h=function(r,n){var i=[];if("FeatureCollection"===r.type)for(var o=0;o<r.features.length;o++)ta(i,r.features[o],n,o);else"Feature"===r.type?ta(i,r,n):ta(i,{geometry:r},n);return i}(r,n);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",n.indexMaxZoom,n.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(h=(o=h,s=(a=n).buffer/a.extent,u=o,c=th(o,1,-1-s,s,0,-1,2,a),p=th(o,1,1-s,2+s,0,-1,2,a),(c||p)&&(u=th(o,1,-s,1+s,0,-1,2,a)||[],c&&(u=t$(c,1).concat(u)),p&&(u=u.concat(t$(p,-1)))),u)).length&&this.splitTile(h,0,0,0),i&&(h.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function tS(r,n,i){return 32*((1<<r)*i+n)+r}function tC(r,n){var i=r.tileID.canonical;if(!this._geoJSONIndex)return n(null,null);var o=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!o)return n(null,null);var a=new T(o.features),s=A(a);0===s.byteOffset&&s.byteLength===s.buffer.byteLength||(s=new Uint8Array(s)),n(null,{vectorTile:a,rawData:s.buffer})}Z.prototype.load=function(r){var n=this.options,i=n.log,o=n.minZoom,a=n.maxZoom,s=n.nodeSize;i&&console.time("total time");var u="prepare "+r.length+" points";i&&console.time(u),this.points=r;for(var c=[],p=0;p<r.length;p++)r[p].geometry&&c.push(X(r[p],p));this.trees[a+1]=new H(c,te,tr,s,Float32Array),i&&console.timeEnd(u);for(var h=a;h>=o;h--){var d=+Date.now();c=this._cluster(c,h),this.trees[h]=new H(c,te,tr,s,Float32Array),i&&console.log("z%d: %d clusters in %dms",h,c.length,+Date.now()-d)}return i&&console.timeEnd("total time"),this},Z.prototype.getClusters=function(r,n){var i=((r[0]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,r[1])),a=180===r[2]?180:((r[2]+180)%360+360)%360-180,s=Math.max(-90,Math.min(90,r[3]));if(r[2]-r[0]>=360)i=-180,a=180;else if(i>a){var u=this.getClusters([i,o,180,s],n),c=this.getClusters([-180,o,a,s],n);return u.concat(c)}for(var p=this.trees[this._limitZoom(n)],h=[],d=0,f=p.range(J(i),Q(s),J(a),Q(o));d<f.length;d+=1){var m=f[d],y=p.points[m];h.push(y.numPoints?K(y):this.points[y.index])}return h},Z.prototype.getChildren=function(r){var n=this._getOriginId(r),i=this._getOriginZoom(r),o="No cluster with the specified id.",a=this.trees[i];if(!a)throw Error(o);var s=a.points[n];if(!s)throw Error(o);for(var u=this.options.radius/(this.options.extent*Math.pow(2,i-1)),c=[],p=0,h=a.within(s.x,s.y,u);p<h.length;p+=1){var d=h[p],f=a.points[d];f.parentId===r&&c.push(f.numPoints?K(f):this.points[f.index])}if(0===c.length)throw Error(o);return c},Z.prototype.getLeaves=function(r,n,i){n=n||10,i=i||0;var o=[];return this._appendLeaves(o,r,n,i,0),o},Z.prototype.getTile=function(r,n,i){var o=this.trees[this._limitZoom(r)],a=Math.pow(2,r),s=this.options,u=s.extent,c=s.radius/u,p=(i-c)/a,h=(i+1+c)/a,d={features:[]};return this._addTileFeatures(o.range((n-c)/a,p,(n+1+c)/a,h),o.points,n,i,a,d),0===n&&this._addTileFeatures(o.range(1-c/a,p,1,h),o.points,a,i,a,d),n===a-1&&this._addTileFeatures(o.range(0,p,c/a,h),o.points,-1,i,a,d),d.features.length?d:null},Z.prototype.getClusterExpansionZoom=function(r){for(var n=this._getOriginZoom(r)-1;n<=this.options.maxZoom;){var i=this.getChildren(r);if(n++,1!==i.length)break;r=i[0].properties.cluster_id}return n},Z.prototype._appendLeaves=function(r,n,i,o,a){for(var s=0,u=this.getChildren(n);s<u.length;s+=1){var c=u[s],p=c.properties;if(p&&p.cluster?a+p.point_count<=o?a+=p.point_count:a=this._appendLeaves(r,p.cluster_id,i,o,a):a<o?a++:r.push(c),r.length===i)break}return a},Z.prototype._addTileFeatures=function(r,n,i,o,a,s){for(var u=0,c=r;u<c.length;u+=1){var p=n[c[u]],h=p.numPoints,d={type:1,geometry:[[Math.round(this.options.extent*(p.x*a-i)),Math.round(this.options.extent*(p.y*a-o))]],tags:h?Y(p):this.points[p.index].properties},f=void 0;h?f=p.id:this.options.generateId?f=p.index:this.points[p.index].id&&(f=this.points[p.index].id),void 0!==f&&(d.id=f),s.features.push(d)}},Z.prototype._limitZoom=function(r){return Math.max(this.options.minZoom,Math.min(r,this.options.maxZoom+1))},Z.prototype._cluster=function(r,n){for(var i=[],o=this.options,a=o.radius,s=o.extent,u=o.reduce,c=a/(s*Math.pow(2,n)),p=0;p<r.length;p++){var h=r[p];if(!(h.zoom<=n)){h.zoom=n;for(var d=this.trees[n+1],f=d.within(h.x,h.y,c),m=h.numPoints||1,y=h.x*m,v=h.y*m,g=u&&m>1?this._map(h,!0):null,$=(p<<5)+(n+1)+this.points.length,_=0,x=f;_<x.length;_+=1){var b=x[_],w=d.points[b];if(!(w.zoom<=n)){w.zoom=n;var E=w.numPoints||1;y+=w.x*E,v+=w.y*E,m+=E,w.parentId=$,u&&(g||(g=this._map(h,!0)),u(g,this._map(w)))}}1===m?i.push(h):(h.parentId=$,i.push(W(y/m,v/m,$,m,g)))}}return i},Z.prototype._getOriginId=function(r){return r-this.points.length>>5},Z.prototype._getOriginZoom=function(r){return(r-this.points.length)%32},Z.prototype._map=function(r,n){if(r.numPoints)return n?tt({},r.properties):r.properties;var i=this.points[r.index].properties,o=this.options.map(i);return n&&o===i?tt({},o):o},tT.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},tT.prototype.splitTile=function(r,n,i,o,a,s,u){for(var c=[r,n,i,o],p=this.options,h=p.debug;c.length;){o=c.pop(),i=c.pop(),n=c.pop(),r=c.pop();var d=1<<n,f=tS(n,i,o),m=this.tiles[f];if(!m&&(h>1&&console.time("creation"),m=this.tiles[f]=tw(r,n,i,o,p),this.tileCoords.push({z:n,x:i,y:o}),h)){h>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",n,i,o,m.numFeatures,m.numPoints,m.numSimplified),console.timeEnd("creation"));var y="z"+n;this.stats[y]=(this.stats[y]||0)+1,this.total++}if(m.source=r,a){if(n===p.maxZoom||n===a)continue;var v=1<<a-n;if(i!==Math.floor(s/v)||o!==Math.floor(u/v))continue}else if(n===p.indexMaxZoom||m.numPoints<=p.indexMaxPoints)continue;if(m.source=null,0!==r.length){h>1&&console.time("clipping");var g,$,_,x,b,w,E=.5*p.buffer/p.extent,T=.5-E,S=.5+E,C=1+E;g=$=_=x=null,b=th(r,d,i-E,i+S,0,m.minX,m.maxX,p),w=th(r,d,i+T,i+C,0,m.minX,m.maxX,p),r=null,b&&(g=th(b,d,o-E,o+S,1,m.minY,m.maxY,p),$=th(b,d,o+T,o+C,1,m.minY,m.maxY,p),b=null),w&&(_=th(w,d,o-E,o+S,1,m.minY,m.maxY,p),x=th(w,d,o+T,o+C,1,m.minY,m.maxY,p),w=null),h>1&&console.timeEnd("clipping"),c.push(g||[],n+1,2*i,2*o),c.push($||[],n+1,2*i,2*o+1),c.push(_||[],n+1,2*i+1,2*o),c.push(x||[],n+1,2*i+1,2*o+1)}}},tT.prototype.getTile=function(r,n,i){var o=this.options,a=o.extent,s=o.debug;if(r<0||r>24)return null;var u=1<<r,c=tS(r,n=(n%u+u)%u,i);if(this.tiles[c])return tx(this.tiles[c],a);s>1&&console.log("drilling down to z%d-%d-%d",r,n,i);for(var p,h=r,d=n,f=i;!p&&h>0;)h--,d=Math.floor(d/2),f=Math.floor(f/2),p=this.tiles[tS(h,d,f)];return p&&p.source?(s>1&&console.log("found parent tile z%d-%d-%d",h,d,f),s>1&&console.time("drilling down"),this.splitTile(p.source,h,d,f,r,n,i),s>1&&console.timeEnd("drilling down"),this.tiles[c]?tx(this.tiles[c],a):null):null};var tI=function(n){function i(r,i,o,a){n.call(this,r,i,o,tC),a&&(this.loadGeoJSON=a)}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.loadData=function(r,n){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=n,this._pendingLoadDataParams=r,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},i.prototype._loadData=function(){var n=this;if(this._pendingCallback&&this._pendingLoadDataParams){var i=this._pendingCallback,o=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var a=!!(o&&o.request&&o.request.collectResourceTiming)&&new r.RequestPerformance(o.request);this.loadGeoJSON(o,function(s,u){if(s||!u)return i(s);if("object"!=typeof u)return i(Error("Input data given to '"+o.source+"' is not a valid GeoJSON object."));$(u,!0);try{var c,p;n._geoJSONIndex=o.cluster?new Z(function(n){var i=n.superclusterOptions,o=n.clusterProperties;if(!o||!i)return i;for(var a={},s={},u={accumulated:null,zoom:0},c={properties:null},p=Object.keys(o),h=0,d=p;h<d.length;h+=1){var f=d[h],m=o[f],y=m[0],v=m[1],g=r.createExpression(v),$=r.createExpression("string"==typeof y?[y,["accumulated"],["get",f]]:y);a[f]=g.value,s[f]=$.value}return i.map=function(r){c.properties=r;for(var n={},i=0,o=p;i<o.length;i+=1){var s=o[i];n[s]=a[s].evaluate(u,c)}return n},i.reduce=function(r,n){c.properties=n;for(var i=0,o=p;i<o.length;i+=1){var a=o[i];u.accumulated=r[a],r[a]=s[a].evaluate(u,c)}},i}(o)).load(u.features):(c=u,p=o.geojsonVtOptions,new tT(c,p))}catch(h){return i(h)}n.loaded={};var d={};if(a){var f=a.finish();f&&(d.resourceTiming={},d.resourceTiming[o.source]=JSON.parse(JSON.stringify(f)))}i(null,d)})}},i.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},i.prototype.reloadTile=function(r,i){var o=this.loaded,a=r.uid;return o&&o[a]?n.prototype.reloadTile.call(this,r,i):this.loadTile(r,i)},i.prototype.loadGeoJSON=function(n,i){if(n.request)r.getJSON(n.request,i);else{if("string"!=typeof n.data)return i(Error("Input data given to '"+n.source+"' is not a valid GeoJSON object."));try{return i(null,JSON.parse(n.data))}catch(o){return i(Error("Input data given to '"+n.source+"' is not a valid GeoJSON object."))}}},i.prototype.removeSource=function(r,n){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),n()},i.prototype.getClusterExpansionZoom=function(r,n){n(null,this._geoJSONIndex.getClusterExpansionZoom(r.clusterId))},i.prototype.getClusterChildren=function(r,n){n(null,this._geoJSONIndex.getChildren(r.clusterId))},i.prototype.getClusterLeaves=function(r,n){n(null,this._geoJSONIndex.getLeaves(r.clusterId,r.limit,r.offset))},i}(p),tk=function(n){var i=this;this.self=n,this.actor=new r.Actor(n,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:p,geojson:tI},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(r,n){if(i.workerSourceTypes[r])throw Error('Worker source with name "'+r+'" already registered.');i.workerSourceTypes[r]=n},this.self.registerRTLTextPlugin=function(n){if(r.plugin.isParsed())throw Error("RTL text plugin already registered.");r.plugin.applyArabicShaping=n.applyArabicShaping,r.plugin.processBidirectionalText=n.processBidirectionalText,r.plugin.processStyledBidirectionalText=n.processStyledBidirectionalText}};return tk.prototype.getToken=function(){return this.token},tk.prototype.setToken=function(r,n){this.token=n},tk.prototype.setReferrer=function(r,n){this.referrer=n},tk.prototype.setImages=function(r,n,i){this.availableImages[r]=n,i()},tk.prototype.setLayers=function(r,n,i){this.getLayerIndex(r).replace(n),i()},tk.prototype.updateLayers=function(r,n,i){this.getLayerIndex(r).update(n.layers,n.removedIds),i()},tk.prototype.loadTile=function(r,n,i){this.getWorkerSource(r,n.type,n.source).loadTile(n,i)},tk.prototype.loadDEMTile=function(r,n,i){this.getDEMWorkerSource(r,n.source).loadTile(n,i)},tk.prototype.reloadTile=function(r,n,i){this.getWorkerSource(r,n.type,n.source).reloadTile(n,i)},tk.prototype.abortTile=function(r,n,i){this.getWorkerSource(r,n.type,n.source).abortTile(n,i)},tk.prototype.removeTile=function(r,n,i){this.getWorkerSource(r,n.type,n.source).removeTile(n,i)},tk.prototype.removeDEMTile=function(r,n){this.getDEMWorkerSource(r,n.source).removeTile(n)},tk.prototype.removeSource=function(r,n,i){if(this.workerSources[r]&&this.workerSources[r][n.type]&&this.workerSources[r][n.type][n.source]){var o=this.workerSources[r][n.type][n.source];delete this.workerSources[r][n.type][n.source],void 0!==o.removeSource?o.removeSource(n,i):i()}},tk.prototype.loadWorkerSource=function(r,n,i){try{this.self.importScripts(n.url),i()}catch(o){i(o.toString())}},tk.prototype.syncRTLPluginState=function(n,i,o){try{r.plugin.setState(i);var a=r.plugin.getPluginURL();if(r.plugin.isLoaded()&&!r.plugin.isParsed()&&null!=a){this.self.importScripts(a);var s=r.plugin.isParsed();o(s?void 0:Error("RTL Text Plugin failed to import scripts from "+a),s)}}catch(u){o(u.toString())}},tk.prototype.getAvailableImages=function(r){var n=this.availableImages[r];return n||(n=[]),n},tk.prototype.getLayerIndex=function(r){var n=this.layerIndexes[r];return n||(n=this.layerIndexes[r]=new o),n},tk.prototype.getWorkerSource=function(r,n,i){var o=this;return this.workerSources[r]||(this.workerSources[r]={}),this.workerSources[r][n]||(this.workerSources[r][n]={}),this.workerSources[r][n][i]||(this.workerSources[r][n][i]=new this.workerSourceTypes[n]({send:function(n,i,a){o.actor.send(n,i,a,r)}},this.getLayerIndex(r),this.getAvailableImages(r))),this.workerSources[r][n][i]},tk.prototype.getDEMWorkerSource=function(r,n){return this.demWorkerSources[r]||(this.demWorkerSources[r]={}),this.demWorkerSources[r][n]||(this.demWorkerSources[r][n]=new d),this.demWorkerSources[r][n]},tk.prototype.enforceCacheSizeLimit=function(n,i){r.enforceCacheSizeLimit(i)},"undefined"!=typeof WorkerGlobalScope&&void 0!==r.window&&r.window instanceof WorkerGlobalScope&&(r.window.worker=new tk(r.window)),tk}),o(["./shared"],function(r){var n=r.createCommonjsModule(function(r){function n(r){var o,a,s,u;return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var r,n,i=new Blob([""],{type:"text/javascript"}),o=URL.createObjectURL(i);try{n=new Worker(o),r=!0}catch(a){r=!1}return n&&n.terminate(),URL.revokeObjectURL(o),r}()&&"Uint8ClampedArray"in window&&ArrayBuffer.isView&&(void 0===i[o=r&&r.failIfMajorPerformanceCaveat]&&(i[o]=(a=o,s=document.createElement("canvas"),(u=Object.create(n.webGLContextAttributes)).failIfMajorPerformanceCaveat=a,s.probablySupportsContext?s.probablySupportsContext("webgl",u)||s.probablySupportsContext("experimental-webgl",u):s.supportsContext?s.supportsContext("webgl",u)||s.supportsContext("experimental-webgl",u):s.getContext("webgl",u)||s.getContext("experimental-webgl",u))),i[o]))}r.exports?r.exports=n:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=n);var i={};n.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),o={create:function(n,i,o){var a=r.window.document.createElement(n);return void 0!==i&&(a.className=i),o&&o.appendChild(a),a},createNS:function(n,i){return r.window.document.createElementNS(n,i)}},a=r.window.document.documentElement.style;function s(r){if(!a)return r[0];for(var n=0;n<r.length;n++)if(r[n]in a)return r[n];return r[0]}var u,c=s(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);o.disableDrag=function(){a&&c&&(u=a[c],a[c]="none")},o.enableDrag=function(){a&&c&&(a[c]=u)};var p=s(["transform","WebkitTransform"]);o.setTransform=function(r,n){r.style[p]=n};var h=!1;try{var d=Object.defineProperty({},"passive",{get:function(){h=!0}});r.window.addEventListener("test",d,d),r.window.removeEventListener("test",d,d)}catch(f){h=!1}o.addEventListener=function(r,n,i,o){void 0===o&&(o={}),"passive"in o&&h?r.addEventListener(n,i,o):r.addEventListener(n,i,o.capture)},o.removeEventListener=function(r,n,i,o){void 0===o&&(o={}),"passive"in o&&h?r.removeEventListener(n,i,o):r.removeEventListener(n,i,o.capture)};var m=function(n){n.preventDefault(),n.stopPropagation(),r.window.removeEventListener("click",m,!0)};function y(r){var n=r.userImage;return!!(n&&n.render&&n.render())&&(r.data.replace(new Uint8Array(n.data.buffer)),!0)}o.suppressClick=function(){r.window.addEventListener("click",m,!0),r.window.setTimeout(function(){r.window.removeEventListener("click",m,!0)},0)},o.mousePos=function(n,i){var o=n.getBoundingClientRect(),a=r.window.TouchEvent&&i instanceof r.window.TouchEvent?i.touches[0]:i;return new r.Point(a.clientX-o.left-n.clientLeft,a.clientY-o.top-n.clientTop)},o.touchPos=function(n,i){for(var o=n.getBoundingClientRect(),a=[],s="touchend"===i.type?i.changedTouches:i.touches,u=0;u<s.length;u++)a.push(new r.Point(s[u].clientX-o.left-n.clientLeft,s[u].clientY-o.top-n.clientTop));return a},o.mouseButton=function(n){return void 0!==r.window.InstallTrigger&&2===n.button&&n.ctrlKey&&r.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},o.remove=function(r){r.parentNode&&r.parentNode.removeChild(r)};var v=function(n){function i(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new r.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.isLoaded=function(){return this.loaded},i.prototype.setLoaded=function(r){if(this.loaded!==r&&(this.loaded=r,r)){for(var n=0,i=this.requestors;n<i.length;n+=1){var o=i[n],a=o.ids,s=o.callback;this._notify(a,s)}this.requestors=[]}},i.prototype.getImage=function(r){return this.images[r]},i.prototype.addImage=function(r,n){this._validate(r,n)&&(this.images[r]=n)},i.prototype._validate=function(n,i){var o=!0;return this._validateStretch(i.stretchX,i.data&&i.data.width)||(this.fire(new r.ErrorEvent(Error('Image "'+n+'" has invalid "stretchX" value'))),o=!1),this._validateStretch(i.stretchY,i.data&&i.data.height)||(this.fire(new r.ErrorEvent(Error('Image "'+n+'" has invalid "stretchY" value'))),o=!1),this._validateContent(i.content,i)||(this.fire(new r.ErrorEvent(Error('Image "'+n+'" has invalid "content" value'))),o=!1),o},i.prototype._validateStretch=function(r,n){if(!r)return!0;for(var i=0,o=0,a=r;o<a.length;o+=1){var s=a[o];if(s[0]<i||s[1]<s[0]||n<s[1])return!1;i=s[1]}return!0},i.prototype._validateContent=function(r,n){return!r||4===r.length&&!(r[0]<0||n.data.width<r[0])&&!(r[1]<0||n.data.height<r[1])&&!(r[2]<0||n.data.width<r[2])&&!(r[3]<0||n.data.height<r[3])&&!(r[2]<r[0])&&!(r[3]<r[1])},i.prototype.updateImage=function(r,n){var i=this.images[r];n.version=i.version+1,this.images[r]=n,this.updatedImages[r]=!0},i.prototype.removeImage=function(r){var n=this.images[r];delete this.images[r],delete this.patterns[r],n.userImage&&n.userImage.onRemove&&n.userImage.onRemove()},i.prototype.listImages=function(){return Object.keys(this.images)},i.prototype.getImages=function(r,n){var i=!0;if(!this.isLoaded())for(var o=0,a=r;o<a.length;o+=1){var s=a[o];this.images[s]||(i=!1)}this.isLoaded()||i?this._notify(r,n):this.requestors.push({ids:r,callback:n})},i.prototype._notify=function(n,i){for(var o={},a=0,s=n;a<s.length;a+=1){var u=s[a];this.images[u]||this.fire(new r.Event("styleimagemissing",{id:u}));var c=this.images[u];c?o[u]={data:c.data.clone(),pixelRatio:c.pixelRatio,sdf:c.sdf,version:c.version,stretchX:c.stretchX,stretchY:c.stretchY,content:c.content,hasRenderCallback:Boolean(c.userImage&&c.userImage.render)}:r.warnOnce('Image "'+u+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}i(null,o)},i.prototype.getPixelSize=function(){var r=this.atlasImage;return{width:r.width,height:r.height}},i.prototype.getPattern=function(n){var i=this.patterns[n],o=this.getImage(n);if(!o)return null;if(i&&i.position.version===o.version)return i.position;if(i)i.position.version=o.version;else{var a={w:o.data.width+2,h:o.data.height+2,x:0,y:0},s=new r.ImagePosition(a,o);this.patterns[n]={bin:a,position:s}}return this._updatePatternAtlas(),this.patterns[n].position},i.prototype.bind=function(n){var i=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new r.Texture(n,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)},i.prototype._updatePatternAtlas=function(){var n=[];for(var i in this.patterns)n.push(this.patterns[i].bin);var o=r.potpack(n),a=o.w,s=o.h,u=this.atlasImage;for(var c in u.resize({width:a||1,height:s||1}),this.patterns){var p=this.patterns[c].bin,h=p.x+1,d=p.y+1,f=this.images[c].data,m=f.width,y=f.height;r.RGBAImage.copy(f,u,{x:0,y:0},{x:h,y:d},{width:m,height:y}),r.RGBAImage.copy(f,u,{x:0,y:y-1},{x:h,y:d-1},{width:m,height:1}),r.RGBAImage.copy(f,u,{x:0,y:0},{x:h,y:d+y},{width:m,height:1}),r.RGBAImage.copy(f,u,{x:m-1,y:0},{x:h-1,y:d},{width:1,height:y}),r.RGBAImage.copy(f,u,{x:0,y:0},{x:h+m,y:d},{width:1,height:y})}this.dirty=!0},i.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},i.prototype.dispatchRenderCallbacks=function(r){for(var n=0,i=r;n<i.length;n+=1){var o=i[n];if(!this.callbackDispatchedThisFrame[o]){this.callbackDispatchedThisFrame[o]=!0;var a=this.images[o];y(a)&&this.updateImage(o,a)}}},i}(r.Evented),g=$;function $(r,n,i,o,a,s){this.fontSize=r||24,this.buffer=void 0===n?3:n,this.cutoff=o||.25,this.fontFamily=a||"sans-serif",this.fontWeight=s||"normal",this.radius=i||8;var u=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=u,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(u*u),this.gridInner=new Float64Array(u*u),this.f=new Float64Array(u),this.d=new Float64Array(u),this.z=new Float64Array(u+1),this.v=new Int16Array(u),this.middle=Math.round(u/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function _(r,n,i,o,a,s,u){for(var c=0;c<n;c++){for(var p=0;p<i;p++)o[p]=r[p*n+c];for(x(o,a,s,u,i),p=0;p<i;p++)r[p*n+c]=a[p]}for(p=0;p<i;p++){for(c=0;c<n;c++)o[c]=r[p*n+c];for(x(o,a,s,u,n),c=0;c<n;c++)r[p*n+c]=Math.sqrt(a[c])}}function x(r,n,i,o,a){i[0]=0,o[0]=-1e20,o[1]=1e20;for(var s=1,u=0;s<a;s++){for(var c=(r[s]+s*s-(r[i[u]]+i[u]*i[u]))/(2*s-2*i[u]);c<=o[u];)u--,c=(r[s]+s*s-(r[i[u]]+i[u]*i[u]))/(2*s-2*i[u]);i[++u]=s,o[u]=c,o[u+1]=1e20}for(s=0,u=0;s<a;s++){for(;o[u+1]<s;)u++;n[s]=(s-i[u])*(s-i[u])+r[i[u]]}}$.prototype.draw=function(r){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(r,this.buffer,this.middle);for(var n=this.ctx.getImageData(0,0,this.size,this.size),i=new Uint8ClampedArray(this.size*this.size),o=0;o<this.size*this.size;o++){var a=n.data[4*o+3]/255;this.gridOuter[o]=1===a?0:0===a?1e20:Math.pow(Math.max(0,.5-a),2),this.gridInner[o]=1===a?1e20:0===a?0:Math.pow(Math.max(0,a-.5),2)}for(_(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),_(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),o=0;o<this.size*this.size;o++){var s=this.gridOuter[o]-this.gridInner[o];i[o]=Math.max(0,Math.min(255,Math.round(255-255*(s/this.radius+this.cutoff))))}return i},g.default=$;var b=function(r,n){this.requestManager=r,this.localIdeographFontFamily=n,this.entries={}};b.prototype.setURL=function(r){this.url=r},b.prototype.getGlyphs=function(n,i){var o=this,a=[];for(var s in n)for(var u=0,c=n[s];u<c.length;u+=1){var p=c[u];a.push({stack:s,id:p})}r.asyncAll(a,function(r,n){var i=r.stack,a=r.id,s=o.entries[i];s||(s=o.entries[i]={glyphs:{},requests:{}});var u=s.glyphs[a];if(void 0===u){if(u=o._tinySDF(s,i,a))return s.glyphs[a]=u,void n(null,{stack:i,id:a,glyph:u});var c=Math.floor(a/256);if(256*c>65535)n(Error("glyphs > 65535 not supported"));else{var p=s.requests[c];p||(p=s.requests[c]=[],b.loadGlyphRange(i,c,o.url,o.requestManager,function(r,n){if(n)for(var i in n)o._doesCharSupportLocalGlyph(+i)||(s.glyphs[+i]=n[+i]);for(var a=0,u=p;a<u.length;a+=1)(0,u[a])(r,n);delete s.requests[c]})),p.push(function(r,o){r?n(r):o&&n(null,{stack:i,id:a,glyph:o[a]||null})})}}else n(null,{stack:i,id:a,glyph:u})},function(r,n){if(r)i(r);else if(n){for(var o={},a=0,s=n;a<s.length;a+=1){var u=s[a],c=u.stack,p=u.id,h=u.glyph;(o[c]||(o[c]={}))[p]=h&&{id:h.id,bitmap:h.bitmap.clone(),metrics:h.metrics}}i(null,o)}})},b.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(r.isChar["CJK Unified Ideographs"](n)||r.isChar["Hangul Syllables"](n)||r.isChar.Hiragana(n)||r.isChar.Katakana(n))},b.prototype._tinySDF=function(n,i,o){var a=this.localIdeographFontFamily;if(a&&this._doesCharSupportLocalGlyph(o)){var s=n.tinySDF;if(!s){var u="400";/bold/i.test(i)?u="900":/medium/i.test(i)?u="500":/light/i.test(i)&&(u="200"),s=n.tinySDF=new b.TinySDF(24,3,8,.25,a,u)}return{id:o,bitmap:new r.AlphaImage({width:30,height:30},s.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},b.loadGlyphRange=function(n,i,o,a,s){var u=256*i,c=a.transformRequest(a.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",u+"-"+(u+255)),r.ResourceType.Glyphs);r.getArrayBuffer(c,function(n,i){if(n)s(n);else if(i){for(var o={},a=0,u=r.parseGlyphPBF(i);a<u.length;a+=1){var c=u[a];o[c.id]=c}s(null,o)}})},b.TinySDF=g;var w=function(){this.specification=r.styleSpec.light.position};w.prototype.possiblyEvaluate=function(n,i){return r.sphericalToCartesian(n.expression.evaluate(i))},w.prototype.interpolate=function(n,i,o){return{x:r.number(n.x,i.x,o),y:r.number(n.y,i.y,o),z:r.number(n.z,i.z,o)}};var E=new r.Properties({anchor:new r.DataConstantProperty(r.styleSpec.light.anchor),position:new w,color:new r.DataConstantProperty(r.styleSpec.light.color),intensity:new r.DataConstantProperty(r.styleSpec.light.intensity)}),T=function(n){function i(i){n.call(this),this._transitionable=new r.Transitionable(E),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.getLight=function(){return this._transitionable.serialize()},i.prototype.setLight=function(n,i){if(void 0===i&&(i={}),!this._validate(r.validateLight,n,i))for(var o in n){var a=n[o];r.endsWith(o,"-transition")?this._transitionable.setTransition(o.slice(0,-11),a):this._transitionable.setValue(o,a)}},i.prototype.updateTransitions=function(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)},i.prototype.hasTransition=function(){return this._transitioning.hasTransition()},i.prototype.recalculate=function(r){this.properties=this._transitioning.possiblyEvaluate(r)},i.prototype._validate=function(n,i,o){return(!o||!1!==o.validate)&&r.emitValidationErrors(this,n.call(r.validateStyle,r.extend({value:i,style:{glyphs:!0,sprite:!0},styleSpec:r.styleSpec})))},i}(r.Evented),S=function(r,n){this.width=r,this.height=n,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};S.prototype.getDash=function(r,n){var i=r.join(",")+String(n);return this.positions[i]||(this.positions[i]=this.addDash(r,n)),this.positions[i]},S.prototype.addDash=function(n,i){var o=i?7:0,a=2*o+1;if(this.nextRow+a>this.height)return r.warnOnce("LineAtlas out of space"),null;for(var s=0,u=0;u<n.length;u++)s+=n[u];for(var c=this.width/s,p=c/2,h=n.length%2==1,d=-o;d<=o;d++)for(var f=this.nextRow+o+d,m=this.width*f,y=h?-n[n.length-1]:0,v=n[0],g=1,$=0;$<this.width;$++){for(;v<$/c;)y=v,v+=n[g],h&&g===n.length-1&&(v+=n[0]),g++;var _=Math.min(Math.abs($-y*c),Math.abs($-v*c)),x=g%2==1,b=void 0;if(i){var w=o?d/o*(p+1):0;if(x){var E=p-Math.abs(w);b=Math.sqrt(_*_+E*E)}else b=p-Math.sqrt(_*_+w*w)}else b=(x?1:-1)*_;this.data[3+4*(m+$)]=Math.max(0,Math.min(255,b+128))}var T={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:s};return this.nextRow+=a,this.dirty=!0,T},S.prototype.bind=function(r){var n=r.gl;this.texture?(n.bindTexture(n.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width,this.height,n.RGBA,n.UNSIGNED_BYTE,this.data))):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,this.data))};var C=function n(i,o){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=r.uniqueId();for(var a=this.workerPool.acquire(this.id),s=0;s<a.length;s++){var u=a[s],c=new n.Actor(u,o,this.id);c.name="Worker "+s,this.actors.push(c)}};function I(n,i,o){var a=function(a,s){if(a)return o(a);if(s){var u=r.pick(r.extend(s,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);s.vector_layers&&(u.vectorLayers=s.vector_layers,u.vectorLayerIds=u.vectorLayers.map(function(r){return r.id})),n.url&&(u.tiles=i.canonicalizeTileset(u,n.url)),o(null,u)}};return n.url?r.getJSON(i.transformRequest(i.normalizeSourceURL(n.url),r.ResourceType.Source),a):r.browser.frame(function(){return a(null,n)})}C.prototype.broadcast=function(n,i,o){o=o||function(){},r.asyncAll(this.actors,function(r,o){r.send(n,i,o)},o)},C.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},C.prototype.remove=function(){this.actors.forEach(function(r){r.remove()}),this.actors=[],this.workerPool.release(this.id)},C.Actor=r.Actor;var k=function(n,i,o){this.bounds=r.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=i||0,this.maxzoom=o||24};k.prototype.validateBounds=function(r){return Array.isArray(r)&&4===r.length?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]},k.prototype.contains=function(n){var i=Math.pow(2,n.z),o=Math.floor(r.mercatorXfromLng(this.bounds.getWest())*i),a=Math.floor(r.mercatorYfromLat(this.bounds.getNorth())*i),s=Math.ceil(r.mercatorXfromLng(this.bounds.getEast())*i),u=Math.ceil(r.mercatorYfromLat(this.bounds.getSouth())*i);return n.x>=o&&n.x<s&&n.y>=a&&n.y<u};var A=function(n){function i(i,o,a,s){if(n.call(this),this.id=i,this.dispatcher=a,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.extend(this,r.pick(o,["url","scheme","tileSize","promoteId"])),this._options=r.extend({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,512!==this.tileSize)throw Error("vector tile sources must have a tileSize of 512");this.setEventedParent(s)}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=I(this._options,this.map._requestManager,function(i,o){n._tileJSONRequest=null,n._loaded=!0,i?n.fire(new r.ErrorEvent(i)):o&&(r.extend(n,o),o.bounds&&(n.tileBounds=new k(o.bounds,n.minzoom,n.maxzoom)),r.postTurnstileEvent(o.tiles,n.map._requestManager._customAccessToken),r.postMapLoadEvent(o.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})))})},i.prototype.loaded=function(){return this._loaded},i.prototype.hasTile=function(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)},i.prototype.onAdd=function(r){this.map=r,this.load()},i.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},i.prototype.serialize=function(){return r.extend({},this._options)},i.prototype.loadTile=function(n,i){var o=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.url,null),a={request:this.map._requestManager.transformRequest(o,r.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:r.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function s(o,a){return delete n.request,n.aborted?i(null):o&&404!==o.status?i(o):(a&&a.resourceTiming&&(n.resourceTiming=a.resourceTiming),this.map._refreshExpiredTiles&&a&&n.setExpiryData(a),n.loadVectorData(a,this.map.painter),r.cacheEntryPossiblyAdded(this.dispatcher),i(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}a.request.collectResourceTiming=this._collectResourceTiming,n.actor&&"expired"!==n.state?"loading"===n.state?n.reloadCallback=i:n.request=n.actor.send("reloadTile",a,s.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",a,s.bind(this)))},i.prototype.abortTile=function(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id},void 0)},i.prototype.unloadTile=function(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id},void 0)},i.prototype.hasTransition=function(){return!1},i}(r.Evented),P=function(n){function i(i,o,a,s){n.call(this),this.id=i,this.dispatcher=a,this.setEventedParent(s),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.extend({type:"raster"},o),r.extend(this,r.pick(o,["url","scheme","tileSize"]))}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=I(this._options,this.map._requestManager,function(i,o){n._tileJSONRequest=null,n._loaded=!0,i?n.fire(new r.ErrorEvent(i)):o&&(r.extend(n,o),o.bounds&&(n.tileBounds=new k(o.bounds,n.minzoom,n.maxzoom)),r.postTurnstileEvent(o.tiles),r.postMapLoadEvent(o.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})))})},i.prototype.loaded=function(){return this._loaded},i.prototype.onAdd=function(r){this.map=r,this.load()},i.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},i.prototype.serialize=function(){return r.extend({},this._options)},i.prototype.hasTile=function(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)},i.prototype.loadTile=function(n,i){var o=this,a=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);n.request=r.getImage(this.map._requestManager.transformRequest(a,r.ResourceType.Tile),function(a,s){if(delete n.request,n.aborted)n.state="unloaded",i(null);else if(a)n.state="errored",i(a);else if(s){o.map._refreshExpiredTiles&&n.setExpiryData(s),delete s.cacheControl,delete s.expires;var u=o.map.painter.context,c=u.gl;n.texture=o.map.painter.getTileTexture(s.width),n.texture?n.texture.update(s,{useMipmap:!0}):(n.texture=new r.Texture(u,s,c.RGBA,{useMipmap:!0}),n.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE,c.LINEAR_MIPMAP_NEAREST),u.extTextureFilterAnisotropic&&c.texParameterf(c.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax)),n.state="loaded",r.cacheEntryPossiblyAdded(o.dispatcher),i(null)}})},i.prototype.abortTile=function(r,n){r.request&&(r.request.cancel(),delete r.request),n()},i.prototype.unloadTile=function(r,n){r.texture&&this.map.painter.saveTileTexture(r.texture),n()},i.prototype.hasTransition=function(){return!1},i}(r.Evented),L=function(n){function i(i,o,a,s){n.call(this,i,o,a,s),this.type="raster-dem",this.maxzoom=22,this._options=r.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},i.prototype.loadTile=function(n,i){var o=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);function a(r,o){r&&(n.state="errored",i(r)),o&&(n.dem=o,n.needsHillshadePrepare=!0,n.state="loaded",i(null))}n.request=r.getImage(this.map._requestManager.transformRequest(o,r.ResourceType.Tile),(function(o,s){if(delete n.request,n.aborted)n.state="unloaded",i(null);else if(o)n.state="errored",i(o);else if(s){this.map._refreshExpiredTiles&&n.setExpiryData(s),delete s.cacheControl,delete s.expires;var u=r.window.ImageBitmap&&s instanceof r.window.ImageBitmap&&r.offscreenCanvasSupported()?s:r.browser.getImageData(s,1),c={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:u,encoding:this.encoding};n.actor&&"expired"!==n.state||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",c,a.bind(this)))}}).bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},i.prototype._getNeighboringTiles=function(n){var i=n.canonical,o=Math.pow(2,i.z),a=(i.x-1+o)%o,s=0===i.x?n.wrap-1:n.wrap,u=(i.x+1+o)%o,c=i.x+1===o?n.wrap+1:n.wrap,p={};return p[new r.OverscaledTileID(n.overscaledZ,s,i.z,a,i.y).key]={backfilled:!1},p[new r.OverscaledTileID(n.overscaledZ,c,i.z,u,i.y).key]={backfilled:!1},i.y>0&&(p[new r.OverscaledTileID(n.overscaledZ,s,i.z,a,i.y-1).key]={backfilled:!1},p[new r.OverscaledTileID(n.overscaledZ,n.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},p[new r.OverscaledTileID(n.overscaledZ,c,i.z,u,i.y-1).key]={backfilled:!1}),i.y+1<o&&(p[new r.OverscaledTileID(n.overscaledZ,s,i.z,a,i.y+1).key]={backfilled:!1},p[new r.OverscaledTileID(n.overscaledZ,n.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},p[new r.OverscaledTileID(n.overscaledZ,c,i.z,u,i.y+1).key]={backfilled:!1}),p},i.prototype.unloadTile=function(r){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&r.actor.send("removeDEMTile",{uid:r.uid,source:this.id})},i}(P),D=function(n){function i(i,o,a,s){n.call(this),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=a.getActor(),this.setEventedParent(s),this._data=o.data,this._options=r.extend({},o),this._collectResourceTiming=o.collectResourceTiming,this._resourceTiming=[],void 0!==o.maxzoom&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;var u=r.EXTENT/this.tileSize;this.workerOptions=r.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(void 0!==o.buffer?o.buffer:128)*u,tolerance:(void 0!==o.tolerance?o.tolerance:.375)*u,extent:r.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:void 0!==o.clusterMaxZoom?Math.min(o.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:r.EXTENT,radius:(o.clusterRadius||50)*u,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties},o.workerOptions)}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.load=function(){var n=this;this.fire(new r.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(i){if(i)n.fire(new r.ErrorEvent(i));else{var o={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(o.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new r.Event("data",o))}})},i.prototype.onAdd=function(r){this.map=r,this.load()},i.prototype.setData=function(n){var i=this;return this._data=n,this.fire(new r.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(n){if(n)i.fire(new r.ErrorEvent(n));else{var o={dataType:"source",sourceDataType:"content"};i._collectResourceTiming&&i._resourceTiming&&i._resourceTiming.length>0&&(o.resourceTiming=i._resourceTiming,i._resourceTiming=[]),i.fire(new r.Event("data",o))}}),this},i.prototype.getClusterExpansionZoom=function(r,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:r,source:this.id},n),this},i.prototype.getClusterChildren=function(r,n){return this.actor.send("geojson.getClusterChildren",{clusterId:r,source:this.id},n),this},i.prototype.getClusterLeaves=function(r,n,i,o){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:r,limit:n,offset:i},o),this},i.prototype._updateWorkerData=function(n){var i=this;this._loaded=!1;var o=r.extend({},this.workerOptions),a=this._data;"string"==typeof a?(o.request=this.map._requestManager.transformRequest(r.browser.resolveURL(a),r.ResourceType.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(a),this.actor.send(this.type+".loadData",o,function(r,a){i._removed||a&&a.abandoned||(i._loaded=!0,a&&a.resourceTiming&&a.resourceTiming[i.id]&&(i._resourceTiming=a.resourceTiming[i.id].slice(0)),i.actor.send(i.type+".coalesce",{source:o.source},null),n(r))})},i.prototype.loaded=function(){return this._loaded},i.prototype.loadTile=function(n,i){var o=this,a=n.actor?"reloadTile":"loadTile";n.actor=this.actor;var s={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:r.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.request=this.actor.send(a,s,function(r,s){return delete n.request,n.unloadVectorData(),n.aborted?i(null):r?i(r):(n.loadVectorData(s,o.map.painter,"reloadTile"===a),i(null))})},i.prototype.abortTile=function(r){r.request&&(r.request.cancel(),delete r.request),r.aborted=!0},i.prototype.unloadTile=function(r){r.unloadVectorData(),this.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})},i.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},i.prototype.serialize=function(){return r.extend({},this._options,{type:this.type,data:this._data})},i.prototype.hasTransition=function(){return!1},i}(r.Evented),z=r.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),M=function(n){function i(r,i,o,a){n.call(this),this.id=r,this.dispatcher=o,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(a),this.options=i}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.load=function(n,i){var o=this;this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this.url=this.options.url,r.getImage(this.map._requestManager.transformRequest(this.url,r.ResourceType.Image),function(a,s){o._loaded=!0,a?o.fire(new r.ErrorEvent(a)):s&&(o.image=s,n&&(o.coordinates=n),i&&i(),o._finishLoading())})},i.prototype.loaded=function(){return this._loaded},i.prototype.updateImage=function(r){var n=this;return this.image&&r.url&&(this.options.url=r.url,this.load(r.coordinates,function(){n.texture=null})),this},i.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})))},i.prototype.onAdd=function(r){this.map=r,this.load()},i.prototype.setCoordinates=function(n){var i=this;this.coordinates=n;var o=n.map(r.MercatorCoordinate.fromLngLat);this.tileID=function(n){for(var i=1/0,o=1/0,a=-1/0,s=-1/0,u=0,c=n;u<c.length;u+=1){var p=c[u];i=Math.min(i,p.x),o=Math.min(o,p.y),a=Math.max(a,p.x),s=Math.max(s,p.y)}var h=Math.max(0,Math.floor(-Math.log(Math.max(a-i,s-o))/Math.LN2)),d=Math.pow(2,h);return new r.CanonicalTileID(h,Math.floor((i+a)/2*d),Math.floor((o+s)/2*d))}(o),this.minzoom=this.maxzoom=this.tileID.z;var a=o.map(function(r){return i.tileID.getTilePoint(r)._round()});return this._boundsArray=new r.StructArrayLayout4i8,this._boundsArray.emplaceBack(a[0].x,a[0].y,0,0),this._boundsArray.emplaceBack(a[1].x,a[1].y,r.EXTENT,0),this._boundsArray.emplaceBack(a[3].x,a[3].y,0,r.EXTENT),this._boundsArray.emplaceBack(a[2].x,a[2].y,r.EXTENT,r.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})),this},i.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var n=this.map.painter.context,i=n.gl;for(var o in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,z.members)),this.boundsSegments||(this.boundsSegments=r.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new r.Texture(n,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE)),this.tiles){var a=this.tiles[o];"loaded"!==a.state&&(a.state="loaded",a.texture=this.texture)}}},i.prototype.loadTile=function(r,n){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},n(null)):(r.state="errored",n(null))},i.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},i.prototype.hasTransition=function(){return!1},i}(r.Evented),R=function(n){function i(r,i,o,a){n.call(this,r,i,o,a),this.roundZoom=!0,this.type="video",this.options=i}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1;var i=this.options;this.urls=[];for(var o=0,a=i.urls;o<a.length;o+=1){var s=a[o];this.urls.push(this.map._requestManager.transformRequest(s,r.ResourceType.Source).url)}r.getVideo(this.urls,function(i,o){n._loaded=!0,i?n.fire(new r.ErrorEvent(i)):o&&(n.video=o,n.video.loop=!0,n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},i.prototype.pause=function(){this.video&&this.video.pause()},i.prototype.play=function(){this.video&&this.video.play()},i.prototype.seek=function(n){if(this.video){var i=this.video.seekable;n<i.start(0)||n>i.end(0)?this.fire(new r.ErrorEvent(new r.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+i.start(0)+" and "+i.end(0)+"-second mark."))):this.video.currentTime=n}},i.prototype.getVideo=function(){return this.video},i.prototype.onAdd=function(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},i.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var n=this.map.painter.context,i=n.gl;for(var o in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,z.members)),this.boundsSegments||(this.boundsSegments=r.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new r.Texture(n,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE)),this.tiles){var a=this.tiles[o];"loaded"!==a.state&&(a.state="loaded",a.texture=this.texture)}}},i.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},i.prototype.hasTransition=function(){return this.video&&!this.video.paused},i}(M),B=function(n){function i(i,o,a,s){n.call(this,i,o,a,s),o.coordinates?Array.isArray(o.coordinates)&&4===o.coordinates.length&&!o.coordinates.some(function(r){return!Array.isArray(r)||2!==r.length||r.some(function(r){return"number"!=typeof r})})||this.fire(new r.ErrorEvent(new r.ValidationError("sources."+i,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.ErrorEvent(new r.ValidationError("sources."+i,null,'missing required property "coordinates"'))),o.animate&&"boolean"!=typeof o.animate&&this.fire(new r.ErrorEvent(new r.ValidationError("sources."+i,null,'optional "animate" property must be a boolean value'))),o.canvas?"string"==typeof o.canvas||o.canvas instanceof r.window.HTMLCanvasElement||this.fire(new r.ErrorEvent(new r.ValidationError("sources."+i,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.ErrorEvent(new r.ValidationError("sources."+i,null,'missing required property "canvas"'))),this.options=o,this.animate=void 0===o.animate||o.animate}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof r.window.HTMLCanvasElement?this.options.canvas:r.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.ErrorEvent(Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},i.prototype.getCanvas=function(){return this.canvas},i.prototype.onAdd=function(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()},i.prototype.onRemove=function(){this.pause()},i.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var i=this.map.painter.context,o=i.gl;for(var a in this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,z.members)),this.boundsSegments||(this.boundsSegments=r.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.Texture(i,this.canvas,o.RGBA,{premultiply:!0}),this.tiles){var s=this.tiles[a];"loaded"!==s.state&&(s.state="loaded",s.texture=this.texture)}}},i.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},i.prototype.hasTransition=function(){return this._playing},i.prototype._hasInvalidDimensions=function(){for(var r=0,n=[this.canvas.width,this.canvas.height];r<n.length;r+=1){var i=n[r];if(isNaN(i)||i<=0)return!0}return!1},i}(M),F={vector:A,raster:P,"raster-dem":L,geojson:D,video:R,image:M,canvas:B},O=function(n,i,o,a){var s=new F[i.type](n,i,o,a);if(s.id!==n)throw Error("Expected Source id to be "+n+" instead of "+s.id);return r.bindAll(["load","abort","unload","serialize","prepare"],s),s};function N(n,i){var o=r.identity([]);return r.translate(o,o,[1,1,0]),r.scale(o,o,[.5*n.width,.5*n.height,1]),r.multiply(o,o,n.calculatePosMatrix(i.toUnwrapped()))}function U(r,n,i,o,a){var s=function(r,n,i){if(r)for(var o=0,a=r;o<a.length;o+=1){var s=n[a[o]];if(s&&s.source===i&&"fill-extrusion"===s.type)return!0}else for(var u in n){var c=n[u];if(c.source===i&&"fill-extrusion"===c.type)return!0}return!1}(o&&o.layers,n,r.id),u=a.maxPitchScaleFactor(),c=r.tilesIn(i,u,s);c.sort(V);for(var p=[],h=0,d=c;h<d.length;h+=1){var f=d[h];p.push({wrappedTileID:f.tileID.wrapped().key,queryResults:f.tile.queryRenderedFeatures(n,r._state,f.queryGeometry,f.cameraQueryGeometry,f.scale,o,a,u,N(r.transform,f.tileID))})}var m=function(r){for(var n={},i={},o=0,a=r;o<a.length;o+=1){var s=a[o],u=s.queryResults,c=s.wrappedTileID,p=i[c]=i[c]||{};for(var h in u)for(var d=u[h],f=p[h]=p[h]||{},m=n[h]=n[h]||[],y=0,v=d;y<v.length;y+=1){var g=v[y];f[g.featureIndex]||(f[g.featureIndex]=!0,m.push(g))}}return n}(p);for(var y in m)m[y].forEach(function(n){var i=n.feature,o=r.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=o});return m}function V(r,n){var i=r.tileID,o=n.tileID;return i.overscaledZ-o.overscaledZ||i.canonical.y-o.canonical.y||i.wrap-o.wrap||i.canonical.x-o.canonical.x}var q=function(r,n){this.max=r,this.onRemove=n,this.reset()};q.prototype.reset=function(){for(var r in this.data)for(var n=0,i=this.data[r];n<i.length;n+=1){var o=i[n];o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value)}return this.data={},this.order=[],this},q.prototype.add=function(r,n,i){var o=this,a=r.wrapped().key;void 0===this.data[a]&&(this.data[a]=[]);var s={value:n,timeout:void 0};if(void 0!==i&&(s.timeout=setTimeout(function(){o.remove(r,s)},i)),this.data[a].push(s),this.order.push(a),this.order.length>this.max){var u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this},q.prototype.has=function(r){return r.wrapped().key in this.data},q.prototype.getAndRemove=function(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null},q.prototype._getAndRemoveByKey=function(r){var n=this.data[r].shift();return n.timeout&&clearTimeout(n.timeout),0===this.data[r].length&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),n.value},q.prototype.getByKey=function(r){var n=this.data[r];return n?n[0].value:null},q.prototype.get=function(r){return this.has(r)?this.data[r.wrapped().key][0].value:null},q.prototype.remove=function(r,n){if(!this.has(r))return this;var i=r.wrapped().key,o=void 0===n?0:this.data[i].indexOf(n),a=this.data[i][o];return this.data[i].splice(o,1),a.timeout&&clearTimeout(a.timeout),0===this.data[i].length&&delete this.data[i],this.onRemove(a.value),this.order.splice(this.order.indexOf(i),1),this},q.prototype.setMaxSize=function(r){for(this.max=r;this.order.length>this.max;){var n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this},q.prototype.filter=function(r){var n=[];for(var i in this.data)for(var o=0,a=this.data[i];o<a.length;o+=1){var s=a[o];r(s.value)||n.push(s)}for(var u=0,c=n;u<c.length;u+=1){var p=c[u];this.remove(p.value.tileID,p)}};var j=function(r,n,i){this.context=r;var o=r.gl;this.buffer=o.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),o.bufferData(o.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?o.DYNAMIC_DRAW:o.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};j.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},j.prototype.updateData=function(r){var n=this.context.gl;this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)},j.prototype.destroy=function(){var r=this.context.gl;this.buffer&&(r.deleteBuffer(this.buffer),delete this.buffer)};var H={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},G=function(r,n,i,o){this.length=n.length,this.attributes=i,this.itemSize=n.bytesPerElement,this.dynamicDraw=o,this.context=r;var a=r.gl;this.buffer=a.createBuffer(),r.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};G.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},G.prototype.updateData=function(r){var n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,r.arrayBuffer)},G.prototype.enableAttributes=function(r,n){for(var i=0;i<this.attributes.length;i++){var o=this.attributes[i],a=n.attributes[o.name];void 0!==a&&r.enableVertexAttribArray(a)}},G.prototype.setVertexAttribPointers=function(r,n,i){for(var o=0;o<this.attributes.length;o++){var a=this.attributes[o],s=n.attributes[a.name];void 0!==s&&r.vertexAttribPointer(s,a.components,r[H[a.type]],!1,this.itemSize,a.offset+this.itemSize*(i||0))}},G.prototype.destroy=function(){var r=this.context.gl;this.buffer&&(r.deleteBuffer(this.buffer),delete this.buffer)};var Z=function(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Z.prototype.get=function(){return this.current},Z.prototype.set=function(r){},Z.prototype.getDefault=function(){return this.default},Z.prototype.setDefault=function(){this.set(this.default)};var W=function(n){function i(){n.apply(this,arguments)}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.getDefault=function(){return r.Color.transparent},i.prototype.set=function(r){var n=this.current;(r.r!==n.r||r.g!==n.g||r.b!==n.b||r.a!==n.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)},i}(Z),X=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return 1},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)},n}(Z),K=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return 0},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)},n}(Z),Y=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return[!0,!0,!0,!0]},n.prototype.set=function(r){var n=this.current;(r[0]!==n[0]||r[1]!==n[1]||r[2]!==n[2]||r[3]!==n[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)},n}(Z),J=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return!0},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)},n}(Z),Q=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return 255},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)},n}(Z),tt=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},n.prototype.set=function(r){var n=this.current;(r.func!==n.func||r.ref!==n.ref||r.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)},n}(Z),te=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){var r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]},n.prototype.set=function(r){var n=this.current;(r[0]!==n[0]||r[1]!==n[1]||r[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)},n}(Z),tr=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return!1},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;r?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=r,this.dirty=!1}},n}(Z),tn=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return[0,1]},n.prototype.set=function(r){var n=this.current;(r[0]!==n[0]||r[1]!==n[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)},n}(Z),ti=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return!1},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;r?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=r,this.dirty=!1}},n}(Z),to=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return this.gl.LESS},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)},n}(Z),ta=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return!1},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;r?n.enable(n.BLEND):n.disable(n.BLEND),this.current=r,this.dirty=!1}},n}(Z),ts=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){var r=this.gl;return[r.ONE,r.ZERO]},n.prototype.set=function(r){var n=this.current;(r[0]!==n[0]||r[1]!==n[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)},n}(Z),tl=function(n){function i(){n.apply(this,arguments)}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.getDefault=function(){return r.Color.transparent},i.prototype.set=function(r){var n=this.current;(r.r!==n.r||r.g!==n.g||r.b!==n.b||r.a!==n.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)},i}(Z),tu=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return this.gl.FUNC_ADD},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)},n}(Z),tc=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return!1},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;r?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=r,this.dirty=!1}},n}(Z),tp=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return this.gl.BACK},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)},n}(Z),th=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return this.gl.CCW},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)},n}(Z),td=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)},n}(Z),tf=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return this.gl.TEXTURE0},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)},n}(Z),tm=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){var r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]},n.prototype.set=function(r){var n=this.current;(r[0]!==n[0]||r[1]!==n[1]||r[2]!==n[2]||r[3]!==n[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)},n}(Z),ty=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,r),this.current=r,this.dirty=!1}},n}(Z),tv=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,r),this.current=r,this.dirty=!1}},n}(Z),tg=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;n.bindTexture(n.TEXTURE_2D,r),this.current=r,this.dirty=!1}},n}(Z),t8=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}},n}(Z),t$=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n.prototype.set=function(r){var n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1},n}(Z),t_=function(r){function n(n){r.call(this,n),this.vao=n.extVertexArrayObject}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n.prototype.set=function(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)},n}(Z),tx=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return 4},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}},n}(Z),tb=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return!1},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}},n}(Z),tw=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return!1},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}},n}(Z),t0=function(r){function n(n,i){r.call(this,n),this.context=n,this.parent=i}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n}(Z),tE=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.setDirty=function(){this.dirty=!0},n.prototype.set=function(r){if(r!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}},n}(t0),tT=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){if(r!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,r),this.current=r,this.dirty=!1}},n}(t0),tS=function(r,n,i){this.context=r,this.width=n,this.height=i;var o=r.gl,a=this.framebuffer=o.createFramebuffer();this.colorAttachment=new tE(r,a),this.depthAttachment=new tT(r,a)};tS.prototype.destroy=function(){var r=this.context.gl,n=this.colorAttachment.get();n&&r.deleteTexture(n);var i=this.depthAttachment.get();i&&r.deleteRenderbuffer(i),r.deleteFramebuffer(this.framebuffer)};var tC=function(r,n,i){this.func=r,this.mask=n,this.range=i};tC.ReadOnly=!1,tC.ReadWrite=!0,tC.disabled=new tC(519,tC.ReadOnly,[0,1]);var tI=function(r,n,i,o,a,s){this.test=r,this.ref=n,this.mask=i,this.fail=o,this.depthFail=a,this.pass=s};tI.disabled=new tI({func:519,mask:0},0,0,7680,7680,7680);var tk=function(r,n,i){this.blendFunction=r,this.blendColor=n,this.mask=i};tk.Replace=[1,0],tk.disabled=new tk(tk.Replace,r.Color.transparent,[!1,!1,!1,!1]),tk.unblended=new tk(tk.Replace,r.Color.transparent,[!0,!0,!0,!0]),tk.alphaBlended=new tk([1,771],r.Color.transparent,[!0,!0,!0,!0]);var t1=function(r,n,i){this.enable=r,this.mode=n,this.frontFace=i};t1.disabled=new t1(!1,1029,2305),t1.backCCW=new t1(!0,1029,2305);var t2=function(r){this.gl=r,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new W(this),this.clearDepth=new X(this),this.clearStencil=new K(this),this.colorMask=new Y(this),this.depthMask=new J(this),this.stencilMask=new Q(this),this.stencilFunc=new tt(this),this.stencilOp=new te(this),this.stencilTest=new tr(this),this.depthRange=new tn(this),this.depthTest=new ti(this),this.depthFunc=new to(this),this.blend=new ta(this),this.blendFunc=new ts(this),this.blendColor=new tl(this),this.blendEquation=new tu(this),this.cullFace=new tc(this),this.cullFaceSide=new tp(this),this.frontFace=new th(this),this.program=new td(this),this.activeTexture=new tf(this),this.viewport=new tm(this),this.bindFramebuffer=new ty(this),this.bindRenderbuffer=new tv(this),this.bindTexture=new tg(this),this.bindVertexBuffer=new t8(this),this.bindElementBuffer=new t$(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new t_(this),this.pixelStoreUnpack=new tx(this),this.pixelStoreUnpackPremultiplyAlpha=new tb(this),this.pixelStoreUnpackFlipY=new tw(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=r.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&r.getExtension("OES_texture_half_float_linear"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query")};t2.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},t2.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},t2.prototype.createIndexBuffer=function(r,n){return new j(this,r,n)},t2.prototype.createVertexBuffer=function(r,n,i){return new G(this,r,n,i)},t2.prototype.createRenderbuffer=function(r,n,i){var o=this.gl,a=o.createRenderbuffer();return this.bindRenderbuffer.set(a),o.renderbufferStorage(o.RENDERBUFFER,r,n,i),this.bindRenderbuffer.set(null),a},t2.prototype.createFramebuffer=function(r,n){return new tS(this,r,n)},t2.prototype.clear=function(r){var n=r.color,i=r.depth,o=this.gl,a=0;n&&(a|=o.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),void 0!==i&&(a|=o.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),o.clear(a)},t2.prototype.setCullFace=function(r){!1===r.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))},t2.prototype.setDepthMode=function(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)},t2.prototype.setStencilMode=function(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)},t2.prototype.setColorMode=function(n){r.deepEqual(n.blendFunction,tk.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},t2.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var tA=function(n){function i(i,o,a){var s=this;n.call(this),this.id=i,this.dispatcher=a,this.on("data",function(r){"source"===r.dataType&&"metadata"===r.sourceDataType&&(s._sourceLoaded=!0),s._sourceLoaded&&!s._paused&&"source"===r.dataType&&"content"===r.sourceDataType&&(s.reload(),s.transform&&s.update(s.transform))}),this.on("error",function(){s._sourceErrored=!0}),this._source=O(i,o,a,this),this._tiles={},this._cache=new q(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new r.SourceFeatureState}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.onAdd=function(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(r)},i.prototype.onRemove=function(r){this._source&&this._source.onRemove&&this._source.onRemove(r)},i.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var r in this._tiles){var n=this._tiles[r];if("loaded"!==n.state&&"errored"!==n.state)return!1}return!0},i.prototype.getSource=function(){return this._source},i.prototype.pause=function(){this._paused=!0},i.prototype.resume=function(){if(this._paused){var r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}},i.prototype._loadTile=function(r,n){return this._source.loadTile(r,n)},i.prototype._unloadTile=function(r){if(this._source.unloadTile)return this._source.unloadTile(r,function(){})},i.prototype._abortTile=function(r){if(this._source.abortTile)return this._source.abortTile(r,function(){})},i.prototype.serialize=function(){return this._source.serialize()},i.prototype.prepare=function(r){for(var n in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var i=this._tiles[n];i.upload(r),i.prepare(this.map.style.imageManager)}},i.prototype.getIds=function(){return r.values(this._tiles).map(function(r){return r.tileID}).sort(tP).map(function(r){return r.key})},i.prototype.getRenderableIds=function(n){var i=this,o=[];for(var a in this._tiles)this._isIdRenderable(a,n)&&o.push(this._tiles[a]);return n?o.sort(function(n,o){var a=n.tileID,s=o.tileID,u=new r.Point(a.canonical.x,a.canonical.y)._rotate(i.transform.angle),c=new r.Point(s.canonical.x,s.canonical.y)._rotate(i.transform.angle);return a.overscaledZ-s.overscaledZ||c.y-u.y||c.x-u.x}).map(function(r){return r.tileID.key}):o.map(function(r){return r.tileID}).sort(tP).map(function(r){return r.key})},i.prototype.hasRenderableParent=function(r){var n=this.findLoadedParent(r,0);return!!n&&this._isIdRenderable(n.tileID.key)},i.prototype._isIdRenderable=function(r,n){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(n||!this._tiles[r].holdingForFade())},i.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var r in this._cache.reset(),this._tiles)"errored"!==this._tiles[r].state&&this._reloadTile(r,"reloading")},i.prototype._reloadTile=function(r,n){var i=this._tiles[r];i&&("loading"!==i.state&&(i.state=n),this._loadTile(i,this._tileLoaded.bind(this,i,r,n)))},i.prototype._tileLoaded=function(n,i,o,a){if(a)return n.state="errored",void(404!==a.status?this._source.fire(new r.ErrorEvent(a,{tile:n})):this.update(this.transform));n.timeAdded=r.browser.now(),"expired"===o&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(i,n),"raster-dem"===this.getSource().type&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new r.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},i.prototype._backfillDEM=function(r){for(var n=this.getRenderableIds(),i=0;i<n.length;i++){var o=n[i];if(r.neighboringTiles&&r.neighboringTiles[o]){var a=this.getTileByID(o);s(r,a),s(a,r)}}function s(r,n){r.needsHillshadePrepare=!0;var i=n.tileID.canonical.x-r.tileID.canonical.x,o=n.tileID.canonical.y-r.tileID.canonical.y,a=Math.pow(2,r.tileID.canonical.z),s=n.tileID.key;0===i&&0===o||Math.abs(o)>1||(Math.abs(i)>1&&(1===Math.abs(i+a)?i+=a:1===Math.abs(i-a)&&(i-=a)),n.dem&&r.dem&&(r.dem.backfillBorder(n.dem,i,o),r.neighboringTiles&&r.neighboringTiles[s]&&(r.neighboringTiles[s].backfilled=!0)))}},i.prototype.getTile=function(r){return this.getTileByID(r.key)},i.prototype.getTileByID=function(r){return this._tiles[r]},i.prototype._retainLoadedChildren=function(r,n,i,o){for(var a in this._tiles){var s=this._tiles[a];if(!(o[a]||!s.hasData()||s.tileID.overscaledZ<=n||s.tileID.overscaledZ>i)){for(var u=s.tileID;s&&s.tileID.overscaledZ>n+1;){var c=s.tileID.scaledTo(s.tileID.overscaledZ-1);(s=this._tiles[c.key])&&s.hasData()&&(u=c)}for(var p=u;p.overscaledZ>n;)if(r[(p=p.scaledTo(p.overscaledZ-1)).key]){o[u.key]=u;break}}}},i.prototype.findLoadedParent=function(r,n){if(r.key in this._loadedParentTiles){var i=this._loadedParentTiles[r.key];return i&&i.tileID.overscaledZ>=n?i:null}for(var o=r.overscaledZ-1;o>=n;o--){var a=r.scaledTo(o),s=this._getLoadedTile(a);if(s)return s}},i.prototype._getLoadedTile=function(r){var n=this._tiles[r.key];return n&&n.hasData()?n:this._cache.getByKey(r.wrapped().key)},i.prototype.updateCacheSize=function(r){var n=Math.floor(5*((Math.ceil(r.width/this._source.tileSize)+1)*(Math.ceil(r.height/this._source.tileSize)+1))),i="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,n):n;this._cache.setMaxSize(i)},i.prototype.handleWrapJump=function(r){var n=Math.round((r-(void 0===this._prevLng?r:this._prevLng))/360);if(this._prevLng=r,n){var i={};for(var o in this._tiles){var a=this._tiles[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+n),i[a.tileID.key]=a}for(var s in this._tiles=i,this._timers)clearTimeout(this._timers[s]),delete this._timers[s];for(var u in this._tiles){var c=this._tiles[u];this._setTileReloadTimer(u,c)}}},i.prototype.update=function(n){var o=this;if(this.transform=n,this._sourceLoaded&&!this._paused){this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?a=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(n){return new r.OverscaledTileID(n.canonical.z,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y)}):(a=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(a=a.filter(function(r){return o._source.hasTile(r)}))):a=[];var a,s=n.coveringZoomLevel(this._source),u=Math.max(s-i.maxOverzooming,this._source.minzoom),c=Math.max(s+i.maxUnderzooming,this._source.minzoom),p=this._updateRetainedTiles(a,s);if(tL(this._source.type)){for(var h={},d={},f=0,m=Object.keys(p);f<m.length;f+=1){var y=m[f],v=p[y],g=this._tiles[y];if(g&&!(g.fadeEndTime&&g.fadeEndTime<=r.browser.now())){var $=this.findLoadedParent(v,u);$&&(this._addTile($.tileID),h[$.tileID.key]=$.tileID),d[y]=v}}for(var _ in this._retainLoadedChildren(d,s,c,p),h)p[_]||(this._coveredTiles[_]=!0,p[_]=h[_])}for(var x in p)this._tiles[x].clearFadeHold();for(var b=0,w=r.keysDifference(this._tiles,p);b<w.length;b+=1){var E=w[b],T=this._tiles[E];T.hasSymbolBuckets&&!T.holdingForFade()?T.setHoldDuration(this.map._fadeDuration):T.hasSymbolBuckets&&!T.symbolFadeFinished()||this._removeTile(E)}this._updateLoadedParentTileCache()}},i.prototype.releaseSymbolFadeTiles=function(){for(var r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)},i.prototype._updateRetainedTiles=function(r,n){for(var o={},a={},s=Math.max(n-i.maxOverzooming,this._source.minzoom),u=Math.max(n+i.maxUnderzooming,this._source.minzoom),c={},p=0,h=r;p<h.length;p+=1){var d=h[p],f=this._addTile(d);o[d.key]=d,f.hasData()||n<this._source.maxzoom&&(c[d.key]=d)}this._retainLoadedChildren(c,n,u,o);for(var m=0,y=r;m<y.length;m+=1){var v=y[m],g=this._tiles[v.key];if(!g.hasData()){if(n+1>this._source.maxzoom){var $=v.children(this._source.maxzoom)[0],_=this.getTile($);if(_&&_.hasData()){o[$.key]=$;continue}}else{var x=v.children(this._source.maxzoom);if(o[x[0].key]&&o[x[1].key]&&o[x[2].key]&&o[x[3].key])continue}for(var b=g.wasRequested(),w=v.overscaledZ-1;w>=s;--w){var E=v.scaledTo(w);if(a[E.key]||(a[E.key]=!0,(g=this.getTile(E))||!b||(g=this._addTile(E)),g&&(o[E.key]=E,b=g.wasRequested(),g.hasData())))break}}}return o},i.prototype._updateLoadedParentTileCache=function(){for(var r in this._loadedParentTiles={},this._tiles){for(var n=[],i=void 0,o=this._tiles[r].tileID;o.overscaledZ>0;){if(o.key in this._loadedParentTiles){i=this._loadedParentTiles[o.key];break}n.push(o.key);var a=o.scaledTo(o.overscaledZ-1);if(i=this._getLoadedTile(a))break;o=a}for(var s=0,u=n;s<u.length;s+=1){var c=u[s];this._loadedParentTiles[c]=i}}},i.prototype._addTile=function(n){var i=this._tiles[n.key];if(i)return i;(i=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,i),i.tileID=n,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,i)));var o=Boolean(i);return o||(i=new r.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(i,this._tileLoaded.bind(this,i,n.key,i.state))),i?(i.uses++,this._tiles[n.key]=i,o||this._source.fire(new r.Event("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null},i.prototype._setTileReloadTimer=function(r,n){var i=this;r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);var o=n.getExpiryTimeout();o&&(this._timers[r]=setTimeout(function(){i._reloadTile(r,"expired"),delete i._timers[r]},o))},i.prototype._removeTile=function(r){var n=this._tiles[r];n&&(n.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),n.uses>0||(n.hasData()&&"reloading"!==n.state?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))},i.prototype.clearTiles=function(){for(var r in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(r);this._cache.reset()},i.prototype.tilesIn=function(n,i,o){var a=this,s=[],u=this.transform;if(!u)return s;for(var c=o?u.getCameraQueryGeometry(n):n,p=n.map(function(r){return u.pointCoordinate(r)}),h=c.map(function(r){return u.pointCoordinate(r)}),d=this.getIds(),f=1/0,m=1/0,y=-1/0,v=-1/0,g=0,$=h;g<$.length;g+=1){var _=$[g];f=Math.min(f,_.x),m=Math.min(m,_.y),y=Math.max(y,_.x),v=Math.max(v,_.y)}for(var x=0;x<d.length;x++)(function(n){var o=a._tiles[d[n]];if(!o.holdingForFade()){var c=o.tileID,g=Math.pow(2,u.zoom-o.tileID.overscaledZ),$=i*o.queryPadding*r.EXTENT/o.tileSize/g,_=[c.getTilePoint(new r.MercatorCoordinate(f,m)),c.getTilePoint(new r.MercatorCoordinate(y,v))];if(_[0].x-$<r.EXTENT&&_[0].y-$<r.EXTENT&&_[1].x+$>=0&&_[1].y+$>=0){var x=p.map(function(r){return c.getTilePoint(r)}),b=h.map(function(r){return c.getTilePoint(r)});s.push({tile:o,tileID:c,queryGeometry:x,cameraQueryGeometry:b,scale:g})}}})(x);return s},i.prototype.getVisibleCoordinates=function(r){for(var n=this,i=this.getRenderableIds(r).map(function(r){return n._tiles[r].tileID}),o=0,a=i;o<a.length;o+=1){var s=a[o];s.posMatrix=this.transform.calculatePosMatrix(s.toUnwrapped())}return i},i.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(tL(this._source.type))for(var n in this._tiles){var i=this._tiles[n];if(void 0!==i.fadeEndTime&&i.fadeEndTime>=r.browser.now())return!0}return!1},i.prototype.setFeatureState=function(r,n,i){r=r||"_geojsonTileLayer",this._state.updateState(r,n,i)},i.prototype.removeFeatureState=function(r,n,i){r=r||"_geojsonTileLayer",this._state.removeFeatureState(r,n,i)},i.prototype.getFeatureState=function(r,n){return r=r||"_geojsonTileLayer",this._state.getState(r,n)},i.prototype.setDependencies=function(r,n,i){var o=this._tiles[r];o&&o.setDependencies(n,i)},i.prototype.reloadTilesForDependencies=function(r,n){for(var i in this._tiles)this._tiles[i].hasDependency(r,n)&&this._reloadTile(i,"reloading");this._cache.filter(function(i){return!i.hasDependency(r,n)})},i}(r.Evented);function tP(r,n){var i=Math.abs(2*r.wrap)-+(r.wrap<0),o=Math.abs(2*n.wrap)-+(n.wrap<0);return r.overscaledZ-n.overscaledZ||o-i||n.canonical.y-r.canonical.y||n.canonical.x-r.canonical.x}function tL(r){return"raster"===r||"image"===r||"video"===r}function tD(){return new r.window.Worker(ih.workerUrl)}tA.maxOverzooming=10,tA.maxUnderzooming=3;var tz=function(){this.active={}};tz.prototype.acquire=function(r){if(!this.workers)for(this.workers=[];this.workers.length<tz.workerCount;)this.workers.push(new tD);return this.active[r]=!0,this.workers.slice()},tz.prototype.release=function(r){delete this.active[r],0===Object.keys(this.active).length&&(this.workers.forEach(function(r){r.terminate()}),this.workers=null)};var t3,t4=Math.floor(r.browser.hardwareConcurrency/2);function tM(n,i){var o={};for(var a in n)"ref"!==a&&(o[a]=n[a]);return r.refProperties.forEach(function(r){r in i&&(o[r]=i[r])}),o}function tR(r){r=r.slice();for(var n=Object.create(null),i=0;i<r.length;i++)n[r[i].id]=r[i];for(var o=0;o<r.length;o++)"ref"in r[o]&&(r[o]=tM(r[o],n[r[o].ref]));return r}tz.workerCount=Math.max(Math.min(t4,6),1);var tB={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function tF(r,n,i){i.push({command:tB.addSource,args:[r,n[r]]})}function tO(r,n,i){n.push({command:tB.removeSource,args:[r]}),i[r]=!0}function t6(r,n,i,o){tO(r,i,o),tF(r,n,i)}function t7(n,i,o){var a;for(a in n[o])if(n[o].hasOwnProperty(a)&&"data"!==a&&!r.deepEqual(n[o][a],i[o][a]))return!1;for(a in i[o])if(i[o].hasOwnProperty(a)&&"data"!==a&&!r.deepEqual(n[o][a],i[o][a]))return!1;return!0}function t5(n,i,o,a,s,u){var c;for(c in i=i||{},n=n||{})n.hasOwnProperty(c)&&(r.deepEqual(n[c],i[c])||o.push({command:u,args:[a,c,i[c],s]}));for(c in i)i.hasOwnProperty(c)&&!n.hasOwnProperty(c)&&(r.deepEqual(n[c],i[c])||o.push({command:u,args:[a,c,i[c],s]}))}function tN(r){return r.id}function tU(r,n){return r[n.id]=n,r}var tV=function(r,n,i){var o=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(r/i),this.yCellCount=Math.ceil(n/i);for(var s=0;s<this.xCellCount*this.yCellCount;s++)o.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=n,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0};function tq(n,i,o,a,s){var u=r.create();return i?(r.scale(u,u,[1/s,1/s,1]),o||r.rotateZ(u,u,a.angle)):r.multiply(u,a.labelPlaneMatrix,n),u}function tj(n,i,o,a,s){if(i){var u=r.clone(n);return r.scale(u,u,[s,s,1]),o||r.rotateZ(u,u,-a.angle),u}return a.glCoordMatrix}function tH(n,i){var o=[n.x,n.y,0,1];et(o,o,i);var a=o[3];return{point:new r.Point(o[0]/a,o[1]/a),signedDistanceFromCamera:a}}function tG(r,n){var i=r[0]/r[3],o=r[1]/r[3];return i>=-n[0]&&i<=n[0]&&o>=-n[1]&&o<=n[1]}function tZ(n,i,o,a,s,u,c,p){var h=a?n.textSizeData:n.iconSizeData,d=r.evaluateSizeForZoom(h,o.transform.zoom),f=[256/o.width*2+1,256/o.height*2+1],m=a?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;m.clear();for(var y=n.lineVertexArray,v=a?n.text.placedSymbolArray:n.icon.placedSymbolArray,g=o.transform.width/o.transform.height,$=!1,_=0;_<v.length;_++){var x=v.get(_);if(x.hidden||x.writingMode===r.WritingMode.vertical&&!$)t9(x.numGlyphs,m);else{$=!1;var b=[x.anchorX,x.anchorY,0,1];if(r.transformMat4(b,b,i),tG(b,f)){var w=.5+b[3]/o.transform.cameraToCenterDistance*.5,E=r.evaluateSizeForFeature(h,d,x),T=c?E*w:E/w,S=new r.Point(x.anchorX,x.anchorY),C=tH(S,s).point,I={},k=tK(x,T,!1,p,i,s,u,n.glyphOffsetArray,y,m,C,S,I,g);$=k.useVertical,(k.notEnoughRoom||$||k.needsFlipping&&tK(x,T,!0,p,i,s,u,n.glyphOffsetArray,y,m,C,S,I,g).notEnoughRoom)&&t9(x.numGlyphs,m)}else t9(x.numGlyphs,m)}}a?n.text.dynamicLayoutVertexBuffer.updateData(m):n.icon.dynamicLayoutVertexBuffer.updateData(m)}function tW(r,n,i,o,a,s,u,c,p,h,d,f){var m=c.glyphStartIndex+c.numGlyphs,y=c.lineStartIndex,v=c.lineStartIndex+c.lineLength,g=n.getoffsetX(c.glyphStartIndex),$=n.getoffsetX(m-1),_=tJ(r*g,i,o,a,s,u,c.segment,y,v,p,h,d,f);if(!_)return null;var x=tJ(r*$,i,o,a,s,u,c.segment,y,v,p,h,d,f);return x?{first:_,last:x}:null}function tX(n,i,o,a){return n===r.WritingMode.horizontal&&Math.abs(o.y-i.y)>Math.abs(o.x-i.x)*a?{useVertical:!0}:(n===r.WritingMode.vertical?i.y<o.y:i.x>o.x)?{needsFlipping:!0}:null}function tK(n,i,o,a,s,u,c,p,h,d,f,m,y,v){var g,$=i/24,_=n.lineOffsetX*$,x=n.lineOffsetY*$;if(n.numGlyphs>1){var b=n.glyphStartIndex+n.numGlyphs,w=n.lineStartIndex,E=n.lineStartIndex+n.lineLength,T=tW($,p,_,x,o,f,m,n,h,u,y,!1);if(!T)return{notEnoughRoom:!0};var S=tH(T.first.point,c).point,C=tH(T.last.point,c).point;if(a&&!o){var I=tX(n.writingMode,S,C,v);if(I)return I}g=[T.first];for(var k=n.glyphStartIndex+1;k<b-1;k++)g.push(tJ($*p.getoffsetX(k),_,x,o,f,m,n.segment,w,E,h,u,y,!1));g.push(T.last)}else{if(a&&!o){var A=tH(m,s).point,P=n.lineStartIndex+n.segment+1,L=new r.Point(h.getx(P),h.gety(P)),D=tH(L,s),z=D.signedDistanceFromCamera>0?D.point:tY(m,L,A,1,s),M=tX(n.writingMode,A,z,v);if(M)return M}var R=tJ($*p.getoffsetX(n.glyphStartIndex),_,x,o,f,m,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,h,u,y,!1);if(!R)return{notEnoughRoom:!0};g=[R]}for(var B=0,F=g;B<F.length;B+=1){var O=F[B];r.addDynamicAttributes(d,O.point,O.angle)}return{}}function tY(r,n,i,o,a){var s=tH(r.add(r.sub(n)._unit()),a).point,u=i.sub(s);return i.add(u._mult(o/u.mag()))}function tJ(n,i,o,a,s,u,c,p,h,d,f,m,y){var v=a?n-i:n+i,g=v>0?1:-1,$=0;a&&(g*=-1,$=Math.PI),g<0&&($+=Math.PI);for(var _=g>0?p+c:p+c+1,x=_,b=s,w=s,E=0,T=0,S=Math.abs(v);E+T<=S;){if((_+=g)<p||_>=h)return null;if(w=b,void 0===(b=m[_])){var C=new r.Point(d.getx(_),d.gety(_)),I=tH(C,f);if(I.signedDistanceFromCamera>0)b=m[_]=I.point;else{var k=_-g;b=tY(0===E?u:new r.Point(d.getx(k),d.gety(k)),C,w,S-E+1,f)}}E+=T,T=w.dist(b)}var A=(S-E)/T,P=b.sub(w),L=P.mult(A)._add(w);return L._add(P._unit()._perp()._mult(o*g)),{point:L,angle:$+Math.atan2(b.y-w.y,b.x-w.x),tileDistance:y?{prevTileDistance:_-g===x?0:d.gettileUnitDistanceFromAnchor(_-g),lastSegmentViewportDistance:S-E}:null}}tV.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},tV.prototype.insert=function(r,n,i,o,a){this._forEachCell(n,i,o,a,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(o),this.bboxes.push(a)},tV.prototype.insertCircle=function(r,n,i,o){this._forEachCell(n-o,i-o,n+o,i+o,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(n),this.circles.push(i),this.circles.push(o)},tV.prototype._insertBoxCell=function(r,n,i,o,a,s){this.boxCells[a].push(s)},tV.prototype._insertCircleCell=function(r,n,i,o,a,s){this.circleCells[a].push(s)},tV.prototype._query=function(r,n,i,o,a,s){if(i<0||r>this.width||o<0||n>this.height)return!a&&[];var u=[];if(r<=0&&n<=0&&this.width<=i&&this.height<=o){if(a)return!0;for(var c=0;c<this.boxKeys.length;c++)u.push({key:this.boxKeys[c],x1:this.bboxes[4*c],y1:this.bboxes[4*c+1],x2:this.bboxes[4*c+2],y2:this.bboxes[4*c+3]});for(var p=0;p<this.circleKeys.length;p++){var h=this.circles[3*p],d=this.circles[3*p+1],f=this.circles[3*p+2];u.push({key:this.circleKeys[p],x1:h-f,y1:d-f,x2:h+f,y2:d+f})}return s?u.filter(s):u}return this._forEachCell(r,n,i,o,this._queryCell,u,{hitTest:a,seenUids:{box:{},circle:{}}},s),a?u.length>0:u},tV.prototype._queryCircle=function(r,n,i,o,a){var s=r-i,u=r+i,c=n-i,p=n+i;if(u<0||s>this.width||p<0||c>this.height)return!o&&[];var h=[];return this._forEachCell(s,c,u,p,this._queryCellCircle,h,{hitTest:o,circle:{x:r,y:n,radius:i},seenUids:{box:{},circle:{}}},a),o?h.length>0:h},tV.prototype.query=function(r,n,i,o,a){return this._query(r,n,i,o,!1,a)},tV.prototype.hitTest=function(r,n,i,o,a){return this._query(r,n,i,o,!0,a)},tV.prototype.hitTestCircle=function(r,n,i,o){return this._queryCircle(r,n,i,!0,o)},tV.prototype._queryCell=function(r,n,i,o,a,s,u,c){var p=u.seenUids,h=this.boxCells[a];if(null!==h)for(var d=this.bboxes,f=0,m=h;f<m.length;f+=1){var y=m[f];if(!p.box[y]){p.box[y]=!0;var v=4*y;if(r<=d[v+2]&&n<=d[v+3]&&i>=d[v+0]&&o>=d[v+1]&&(!c||c(this.boxKeys[y]))){if(u.hitTest)return s.push(!0),!0;s.push({key:this.boxKeys[y],x1:d[v],y1:d[v+1],x2:d[v+2],y2:d[v+3]})}}}var g=this.circleCells[a];if(null!==g)for(var $=this.circles,_=0,x=g;_<x.length;_+=1){var b=x[_];if(!p.circle[b]){p.circle[b]=!0;var w=3*b;if(this._circleAndRectCollide($[w],$[w+1],$[w+2],r,n,i,o)&&(!c||c(this.circleKeys[b]))){if(u.hitTest)return s.push(!0),!0;var E=$[w],T=$[w+1],S=$[w+2];s.push({key:this.circleKeys[b],x1:E-S,y1:T-S,x2:E+S,y2:T+S})}}}},tV.prototype._queryCellCircle=function(r,n,i,o,a,s,u,c){var p=u.circle,h=u.seenUids,d=this.boxCells[a];if(null!==d)for(var f=this.bboxes,m=0,y=d;m<y.length;m+=1){var v=y[m];if(!h.box[v]){h.box[v]=!0;var g=4*v;if(this._circleAndRectCollide(p.x,p.y,p.radius,f[g+0],f[g+1],f[g+2],f[g+3])&&(!c||c(this.boxKeys[v])))return s.push(!0),!0}}var $=this.circleCells[a];if(null!==$)for(var _=this.circles,x=0,b=$;x<b.length;x+=1){var w=b[x];if(!h.circle[w]){h.circle[w]=!0;var E=3*w;if(this._circlesCollide(_[E],_[E+1],_[E+2],p.x,p.y,p.radius)&&(!c||c(this.circleKeys[w])))return s.push(!0),!0}}},tV.prototype._forEachCell=function(r,n,i,o,a,s,u,c){for(var p=this._convertToXCellCoord(r),h=this._convertToYCellCoord(n),d=this._convertToXCellCoord(i),f=this._convertToYCellCoord(o),m=p;m<=d;m++)for(var y=h;y<=f;y++){var v=this.xCellCount*y+m;if(a.call(this,r,n,i,o,v,s,u,c))return}},tV.prototype._convertToXCellCoord=function(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))},tV.prototype._convertToYCellCoord=function(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))},tV.prototype._circlesCollide=function(r,n,i,o,a,s){var u=o-r,c=a-n,p=i+s;return p*p>u*u+c*c},tV.prototype._circleAndRectCollide=function(r,n,i,o,a,s,u){var c=(s-o)/2,p=Math.abs(r-(o+c));if(p>c+i)return!1;var h=(u-a)/2,d=Math.abs(n-(a+h));if(d>h+i)return!1;if(p<=c||d<=h)return!0;var f=p-c,m=d-h;return f*f+m*m<=i*i};var tQ=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function t9(r,n){for(var i=0;i<r;i++){var o=n.length;n.resize(o+4),n.float32.set(tQ,3*o)}}function et(r,n,i){var o=n[0],a=n[1];return r[0]=i[0]*o+i[4]*a+i[12],r[1]=i[1]*o+i[5]*a+i[13],r[3]=i[3]*o+i[7]*a+i[15],r}var ee=function(r,n,i){void 0===n&&(n=new tV(r.width+200,r.height+200,25)),void 0===i&&(i=new tV(r.width+200,r.height+200,25)),this.transform=r,this.grid=n,this.ignoredGrid=i,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+100,this.screenBottomBoundary=r.height+100,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200};function er(r,n,i){r[n+4]=i?1:0}function en(n,i,o){return i*(r.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}ee.prototype.placeCollisionBox=function(r,n,i,o,a){var s=this.projectAndGetPerspectiveRatio(o,r.anchorPointX,r.anchorPointY),u=i*s.perspectiveRatio,c=r.x1*u+s.point.x,p=r.y1*u+s.point.y,h=r.x2*u+s.point.x,d=r.y2*u+s.point.y;return!this.isInsideGrid(c,p,h,d)||!n&&this.grid.hitTest(c,p,h,d,a)?{box:[],offscreen:!1}:{box:[c,p,h,d],offscreen:this.isOffscreen(c,p,h,d)}},ee.prototype.approximateTileDistance=function(r,n,i,o,a){var s=a?1:o/this.pitchfactor,u=r.lastSegmentViewportDistance*i;return r.prevTileDistance+u+(s-1)*u*Math.abs(Math.sin(n))},ee.prototype.placeCollisionCircles=function(n,i,o,a,s,u,c,p,h,d,f,m,y){var v=[],g=this.projectAnchor(h,s.anchorX,s.anchorY),$=s.lineOffsetX*p,_=s.lineOffsetY*p,x=new r.Point(s.anchorX,s.anchorY),b=tW(p/24,c,$,_,!1,tH(x,d).point,x,s,u,d,{},!0),w=!1,E=!1,T=!0,S=g.perspectiveRatio*a,C=1/(a*o),I=0,k=0;b&&(I=this.approximateTileDistance(b.first.tileDistance,b.first.angle,C,g.cameraDistance,m),k=this.approximateTileDistance(b.last.tileDistance,b.last.angle,C,g.cameraDistance,m));for(var A=0;A<n.length;A+=5){var P=n[A],L=n[A+1],D=n[A+2],z=n[A+3];if(!b||z<-I||z>k)er(n,A,!1);else{var M=this.projectPoint(h,P,L),R=D*S;if(v.length>0){var B=M.x-v[v.length-4],F=M.y-v[v.length-3];if(R*R*2>B*B+F*F&&A+8<n.length){var O=n[A+8];if(O>-I&&O<k){er(n,A,!1);continue}}}var N=A/5;v.push(M.x,M.y,R,N),er(n,A,!0);var U=M.x-R,V=M.y-R,q=M.x+R,j=M.y+R;if(T=T&&this.isOffscreen(U,V,q,j),E=E||this.isInsideGrid(U,V,q,j),!i&&this.grid.hitTestCircle(M.x,M.y,R,y)){if(!f)return{circles:[],offscreen:!1};w=!0}}}return{circles:w||!E?[]:v,offscreen:T}},ee.prototype.queryRenderedSymbols=function(n){if(0===n.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var i=[],o=1/0,a=1/0,s=-1/0,u=-1/0,c=0,p=n;c<p.length;c+=1){var h=p[c],d=new r.Point(h.x+100,h.y+100);o=Math.min(o,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),u=Math.max(u,d.y),i.push(d)}for(var f={},m={},y=0,v=this.grid.query(o,a,s,u).concat(this.ignoredGrid.query(o,a,s,u));y<v.length;y+=1){var g=v[y],$=g.key;if(void 0===f[$.bucketInstanceId]&&(f[$.bucketInstanceId]={}),!f[$.bucketInstanceId][$.featureIndex]){var _=[new r.Point(g.x1,g.y1),new r.Point(g.x2,g.y1),new r.Point(g.x2,g.y2),new r.Point(g.x1,g.y2)];r.polygonIntersectsPolygon(i,_)&&(f[$.bucketInstanceId][$.featureIndex]=!0,void 0===m[$.bucketInstanceId]&&(m[$.bucketInstanceId]=[]),m[$.bucketInstanceId].push($.featureIndex))}}return m},ee.prototype.insertCollisionBox=function(r,n,i,o,a){(n?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:o,collisionGroupID:a},r[0],r[1],r[2],r[3])},ee.prototype.insertCollisionCircles=function(r,n,i,o,a){for(var s=n?this.ignoredGrid:this.grid,u={bucketInstanceId:i,featureIndex:o,collisionGroupID:a},c=0;c<r.length;c+=4)s.insertCircle(u,r[c],r[c+1],r[c+2])},ee.prototype.projectAnchor=function(r,n,i){var o=[n,i,0,1];return et(o,o,r),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/o[3]*.5,cameraDistance:o[3]}},ee.prototype.projectPoint=function(n,i,o){var a=[i,o,0,1];return et(a,a,n),new r.Point((a[0]/a[3]+1)/2*this.transform.width+100,(-a[1]/a[3]+1)/2*this.transform.height+100)},ee.prototype.projectAndGetPerspectiveRatio=function(n,i,o){var a=[i,o,0,1];return et(a,a,n),{point:new r.Point((a[0]/a[3]+1)/2*this.transform.width+100,(-a[1]/a[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/a[3]*.5}},ee.prototype.isOffscreen=function(r,n,i,o){return i<100||r>=this.screenRightBoundary||o<100||n>this.screenBottomBoundary},ee.prototype.isInsideGrid=function(r,n,i,o){return i>=0&&r<this.gridRightBoundary&&o>=0&&n<this.gridBottomBoundary};var ei=function(r,n,i,o){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?n:-n))):o&&i?1:0,this.placed=i};ei.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var eo=function(r,n,i,o,a){this.text=new ei(r?r.text:null,n,i,a),this.icon=new ei(r?r.icon:null,n,o,a)};eo.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ea=function(r,n,i){this.text=r,this.icon=n,this.skipFade=i},es=function(r,n,i,o,a){this.bucketInstanceId=r,this.featureIndex=n,this.sourceLayerIndex=i,this.bucketIndex=o,this.tileID=a},el=function(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}};function eu(n,i,o,a,s){var u=r.getAnchorAlignment(n),c=-(u.horizontalAlign-.5)*i,p=-(u.verticalAlign-.5)*o,h=r.evaluateVariableOffset(n,a);return new r.Point(c+h[0]*s,p+h[1]*s)}function ec(n,i,o,a,s,u){var c=n.x1,p=n.x2,h=n.y1,d=n.y2,f=n.anchorPointX,m=n.anchorPointY,y=new r.Point(i,o);return a&&y._rotate(s?u:-u),{x1:c+y.x,y1:h+y.y,x2:p+y.x,y2:d+y.y,anchorPointX:f,anchorPointY:m}}el.prototype.get=function(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){var n=++this.maxGroupID;this.collisionGroups[r]={ID:n,predicate:function(r){return r.collisionGroupID===n}}}return this.collisionGroups[r]};var ep=function(r,n,i,o){this.transform=r.clone(),this.collisionIndex=new ee(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new el(i),this.prevPlacement=o,o&&(o.prevPlacement=void 0),this.placedOrientations={}};function eh(r,n,i,o,a){r.emplaceBack(n?1:0,i?1:0,o||0,a||0),r.emplaceBack(n?1:0,i?1:0,o||0,a||0),r.emplaceBack(n?1:0,i?1:0,o||0,a||0),r.emplaceBack(n?1:0,i?1:0,o||0,a||0)}function ed(r){if(0===r.opacity&&!r.placed)return 0;if(1===r.opacity&&r.placed)return 4294967295;var n=r.placed?1:0,i=Math.floor(127*r.opacity);return 33554432*i+16777216*n+131072*i+65536*n+512*i+256*n+2*i+n}ep.prototype.getBucketParts=function(n,i,o,a){var s=o.getBucket(i),u=o.latestFeatureIndex;if(s&&u&&i.id===s.layerIds[0]){var c=o.collisionBoxArray,p=s.layers[0].layout,h=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),d=o.tileSize/r.EXTENT,f=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),m=tq(f,"map"===p.get("text-pitch-alignment"),"map"===p.get("text-rotation-alignment"),this.transform,en(o,1,this.transform.zoom));this.retainedQueryData[s.bucketInstanceId]=new es(s.bucketInstanceId,u,s.sourceLayerIndex,s.index,o.tileID);var y={bucket:s,layout:p,posMatrix:f,textLabelPlaneMatrix:m,scale:h,textPixelRatio:d,holdingForFade:o.holdingForFade(),collisionBoxArray:c,partiallyEvaluatedTextSize:r.evaluateSizeForZoom(s.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(s.sourceID)};if(a)for(var v=0,g=s.sortKeyRanges;v<g.length;v+=1){var $=g[v],_=$.sortKey,x=$.symbolInstanceStart,b=$.symbolInstanceEnd;n.push({sortKey:_,symbolInstanceStart:x,symbolInstanceEnd:b,parameters:y})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:s.symbolInstances.length,parameters:y})}},ep.prototype.attemptAnchorPlacement=function(r,n,i,o,a,s,u,c,p,h,d,f,m,y,v){var g,$=[f.textOffset0,f.textOffset1],_=eu(r,i,o,$,a),x=this.collisionIndex.placeCollisionBox(ec(n,_.x,_.y,s,u,this.transform.angle),d,c,p,h.predicate);if((!v||0!==this.collisionIndex.placeCollisionBox(ec(v,_.x,_.y,s,u,this.transform.angle),d,c,p,h.predicate).box.length)&&x.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[f.crossTileID]&&this.prevPlacement.placements[f.crossTileID]&&this.prevPlacement.placements[f.crossTileID].text&&(g=this.prevPlacement.variableOffsets[f.crossTileID].anchor),this.variableOffsets[f.crossTileID]={textOffset:$,width:i,height:o,anchor:r,textBoxScale:a,prevAnchor:g},this.markUsedJustification(m,r,f,y),m.allowVerticalPlacement&&(this.markUsedOrientation(m,y,f),this.placedOrientations[f.crossTileID]=y),{shift:_,placedGlyphBoxes:x}},ep.prototype.placeLayerBucketPart=function(n,i,o){var a=this,s=n.parameters,u=s.bucket,c=s.layout,p=s.posMatrix,h=s.textLabelPlaneMatrix,d=s.scale,f=s.textPixelRatio,m=s.holdingForFade,y=s.collisionBoxArray,v=s.partiallyEvaluatedTextSize,g=s.collisionGroup,$=c.get("text-optional"),_=c.get("icon-optional"),x=c.get("text-allow-overlap"),b=c.get("icon-allow-overlap"),w="map"===c.get("text-rotation-alignment"),E="map"===c.get("text-pitch-alignment"),T="none"!==c.get("icon-text-fit"),S="viewport-y"===c.get("symbol-z-order"),C=x&&(b||!u.hasIconData()||_),I=b&&(x||!u.hasTextData()||$);!u.collisionArrays&&y&&u.deserializeCollisionBoxes(y);var k=function(n,s){if(!i[n.crossTileID]){if(m)a.placements[n.crossTileID]=new ea(!1,!1,!1);else{var y,S=!1,k=!1,A=!0,P=null,L={box:null,offscreen:null},D={box:null,offscreen:null},z=null,M=null,R=0,B=0,F=0;s.textFeatureIndex&&(R=s.textFeatureIndex),s.verticalTextFeatureIndex&&(B=s.verticalTextFeatureIndex);var O=s.textBox;if(O){var N=function(i){var o=r.WritingMode.horizontal;if(u.allowVerticalPlacement&&!i&&a.prevPlacement){var s=a.prevPlacement.placedOrientations[n.crossTileID];s&&(a.placedOrientations[n.crossTileID]=s,o=s,a.markUsedOrientation(u,o,n))}return o},U=function(i,o){if(u.allowVerticalPlacement&&n.numVerticalGlyphVertices>0&&s.verticalTextBox)for(var a=0,c=u.writingModes;a<c.length&&(c[a]===r.WritingMode.vertical?D=L=o():L=i(),!L||!L.box||!L.box.length);a+=1);else L=i()};if(c.get("text-variable-anchor")){var V=c.get("text-variable-anchor");if(a.prevPlacement&&a.prevPlacement.variableOffsets[n.crossTileID]){var q=a.prevPlacement.variableOffsets[n.crossTileID];V.indexOf(q.anchor)>0&&(V=V.filter(function(r){return r!==q.anchor})).unshift(q.anchor)}var j=function(r,i,o){for(var s=r.x2-r.x1,c=r.y2-r.y1,h=n.textBoxScale,d=T&&!b?i:null,m={box:[],offscreen:!1},y=x?2*V.length:V.length,v=0;v<y;++v){var $=V[v%V.length],_=v>=V.length,C=a.attemptAnchorPlacement($,r,s,c,h,w,E,f,p,g,_,n,u,o,d);if(C&&(m=C.placedGlyphBoxes)&&m.box&&m.box.length){S=!0,P=C.shift;break}}return m};U(function(){return j(O,s.iconBox,r.WritingMode.horizontal)},function(){var i=s.verticalTextBox,o=L&&L.box&&L.box.length;return u.allowVerticalPlacement&&!o&&n.numVerticalGlyphVertices>0&&i?j(i,s.verticalIconBox,r.WritingMode.vertical):{box:null,offscreen:null}}),L&&(S=L.box,A=L.offscreen);var H=N(L&&L.box);if(!S&&a.prevPlacement){var G=a.prevPlacement.variableOffsets[n.crossTileID];G&&(a.variableOffsets[n.crossTileID]=G,a.markUsedJustification(u,G.anchor,n,H))}}else{var Z=function(r,i){var o=a.collisionIndex.placeCollisionBox(r,x,f,p,g.predicate);return o&&o.box&&o.box.length&&(a.markUsedOrientation(u,i,n),a.placedOrientations[n.crossTileID]=i),o};U(function(){return Z(O,r.WritingMode.horizontal)},function(){var i=s.verticalTextBox;return u.allowVerticalPlacement&&n.numVerticalGlyphVertices>0&&i?Z(i,r.WritingMode.vertical):{box:null,offscreen:null}}),N(L&&L.box&&L.box.length)}}S=(y=L)&&y.box&&y.box.length>0,A=y&&y.offscreen;var W=s.textCircles;if(W){var X=u.text.placedSymbolArray.get(n.centerJustifiedTextSymbolIndex),K=r.evaluateSizeForFeature(u.textSizeData,v,X);z=a.collisionIndex.placeCollisionCircles(W,x,d,f,X,u.lineVertexArray,u.glyphOffsetArray,K,p,h,o,E,g.predicate),S=x||z.circles.length>0,A=A&&z.offscreen}if(s.iconFeatureIndex&&(F=s.iconFeatureIndex),s.iconBox){var Y=function(r){var n=T&&P?ec(r,P.x,P.y,w,E,a.transform.angle):r;return a.collisionIndex.placeCollisionBox(n,b,f,p,g.predicate)};k=D&&D.box&&D.box.length&&s.verticalIconBox?(M=Y(s.verticalIconBox)).box.length>0:(M=Y(s.iconBox)).box.length>0,A=A&&M.offscreen}var J=$||0===n.numHorizontalGlyphVertices&&0===n.numVerticalGlyphVertices,Q=_||0===n.numIconVertices;J||Q?Q?J||(k=k&&S):S=k&&S:k=S=k&&S,S&&y&&y.box&&(D&&D.box&&B?a.collisionIndex.insertCollisionBox(y.box,c.get("text-ignore-placement"),u.bucketInstanceId,B,g.ID):a.collisionIndex.insertCollisionBox(y.box,c.get("text-ignore-placement"),u.bucketInstanceId,R,g.ID)),k&&M&&a.collisionIndex.insertCollisionBox(M.box,c.get("icon-ignore-placement"),u.bucketInstanceId,F,g.ID),S&&z&&a.collisionIndex.insertCollisionCircles(z.circles,c.get("text-ignore-placement"),u.bucketInstanceId,R,g.ID),a.placements[n.crossTileID]=new ea(S||C,k||I,A||u.justReloaded),i[n.crossTileID]=!0}}};if(S)for(var A=u.getSortedSymbolIndexes(this.transform.angle),P=A.length-1;P>=0;--P){var L=A[P];k(u.symbolInstances.get(L),u.collisionArrays[L])}else for(var D=n.symbolInstanceStart;D<n.symbolInstanceEnd;D++)k(u.symbolInstances.get(D),u.collisionArrays[D]);u.justReloaded=!1},ep.prototype.markUsedJustification=function(n,i,o,a){var s,u={left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex};s=a===r.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:u[r.getAnchorJustification(i)];for(var c=0,p=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];c<p.length;c+=1){var h=p[c];h>=0&&(n.text.placedSymbolArray.get(h).crossTileID=s>=0&&h!==s?0:o.crossTileID)}},ep.prototype.markUsedOrientation=function(n,i,o){for(var a=i===r.WritingMode.horizontal||i===r.WritingMode.horizontalOnly?i:0,s=i===r.WritingMode.vertical?i:0,u=0,c=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];u<c.length;u+=1){var p=c[u];n.text.placedSymbolArray.get(p).placedOrientation=a}o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=s)},ep.prototype.commit=function(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;var n=this.prevPlacement,i=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;var o=n?n.symbolFadeChange(r):1,a=n?n.opacities:{},s=n?n.variableOffsets:{},u=n?n.placedOrientations:{};for(var c in this.placements){var p=this.placements[c],h=a[c];h?(this.opacities[c]=new eo(h,o,p.text,p.icon),i=i||p.text!==h.text.placed||p.icon!==h.icon.placed):(this.opacities[c]=new eo(null,o,p.text,p.icon,p.skipFade),i=i||p.text||p.icon)}for(var d in a){var f=a[d];if(!this.opacities[d]){var m=new eo(f,o,!1,!1);m.isHidden()||(this.opacities[d]=m,i=i||f.text.placed||f.icon.placed)}}for(var y in s)this.variableOffsets[y]||!this.opacities[y]||this.opacities[y].isHidden()||(this.variableOffsets[y]=s[y]);for(var v in u)this.placedOrientations[v]||!this.opacities[v]||this.opacities[v].isHidden()||(this.placedOrientations[v]=u[v]);i?this.lastPlacementChangeTime=r:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:r)},ep.prototype.updateLayerOpacities=function(r,n){for(var i={},o=0,a=n;o<a.length;o+=1){var s=a[o],u=s.getBucket(r);u&&s.latestFeatureIndex&&r.id===u.layerIds[0]&&this.updateBucketOpacities(u,i,s.collisionBoxArray)}},ep.prototype.updateBucketOpacities=function(n,i,o){var a=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear(),n.hasIconCollisionCircleData()&&n.iconCollisionCircle.collisionVertexArray.clear(),n.hasTextCollisionCircleData()&&n.textCollisionCircle.collisionVertexArray.clear();var s=n.layers[0].layout,u=new eo(null,0,!1,!1,!0),c=s.get("text-allow-overlap"),p=s.get("icon-allow-overlap"),h=s.get("text-variable-anchor"),d="map"===s.get("text-rotation-alignment"),f="map"===s.get("text-pitch-alignment"),m="none"!==s.get("icon-text-fit"),y=new eo(null,0,c&&(p||!n.hasIconData()||s.get("icon-optional")),p&&(c||!n.hasTextData()||s.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasIconCollisionCircleData()||n.hasTextCollisionBoxData()||n.hasTextCollisionCircleData())&&n.deserializeCollisionBoxes(o);for(var v=function(r,n,i){for(var o=0;o<n/4;o++)r.opacityVertexArray.emplaceBack(i)},g=0;g<n.symbolInstances.length;g++)(function(o){var s=n.symbolInstances.get(o),c=s.numHorizontalGlyphVertices,p=s.numVerticalGlyphVertices,g=s.crossTileID,$=i[g],_=a.opacities[g];$?_=u:_||(_=y,a.opacities[g]=_),i[g]=!0;var x=s.numIconVertices>0,b=a.placedOrientations[s.crossTileID],w=b===r.WritingMode.vertical,E=b===r.WritingMode.horizontal||b===r.WritingMode.horizontalOnly;if(c>0||p>0){var T=ed(_.text);v(n.text,c,w?ef:T),v(n.text,p,E?ef:T);var S=_.text.isHidden();[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach(function(r){r>=0&&(n.text.placedSymbolArray.get(r).hidden=S||w?1:0)}),s.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(s.verticalPlacedTextSymbolIndex).hidden=S||E?1:0);var C=a.variableOffsets[s.crossTileID];C&&a.markUsedJustification(n,C.anchor,s,b);var I=a.placedOrientations[s.crossTileID];I&&(a.markUsedJustification(n,"left",s,I),a.markUsedOrientation(n,I,s))}if(x){var k=ed(_.icon),A=!(m&&s.verticalPlacedIconSymbolIndex&&w);s.placedIconSymbolIndex>=0&&(v(n.icon,s.numIconVertices,A?k:ef),n.icon.placedSymbolArray.get(s.placedIconSymbolIndex).hidden=_.icon.isHidden()),s.verticalPlacedIconSymbolIndex>=0&&(v(n.icon,s.numVerticalIconVertices,A?ef:k),n.icon.placedSymbolArray.get(s.verticalPlacedIconSymbolIndex).hidden=_.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasIconCollisionCircleData()||n.hasTextCollisionBoxData()||n.hasTextCollisionCircleData()){var P=n.collisionArrays[o];if(P){var L=new r.Point(0,0);if(P.textBox||P.verticalTextBox){var D=!0;if(h){var z=a.variableOffsets[g];z?(L=eu(z.anchor,z.width,z.height,z.textOffset,z.textBoxScale),d&&L._rotate(f?a.transform.angle:-a.transform.angle)):D=!1}P.textBox&&eh(n.textCollisionBox.collisionVertexArray,_.text.placed,!D||w,L.x,L.y),P.verticalTextBox&&eh(n.textCollisionBox.collisionVertexArray,_.text.placed,!D||E,L.x,L.y)}var M=Boolean(!E&&P.verticalIconBox);P.iconBox&&eh(n.iconCollisionBox.collisionVertexArray,_.icon.placed,M,m?L.x:0,m?L.y:0),P.verticalIconBox&&eh(n.iconCollisionBox.collisionVertexArray,_.icon.placed,!M,m?L.x:0,m?L.y:0);var R=P.textCircles;if(R&&n.hasTextCollisionCircleData())for(var B=0;B<R.length;B+=5){var F=$||0===R[B+4];eh(n.textCollisionCircle.collisionVertexArray,_.text.placed,F)}}}})(g);n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.hasIconCollisionCircleData()&&n.iconCollisionCircle.collisionVertexBuffer&&n.iconCollisionCircle.collisionVertexBuffer.updateData(n.iconCollisionCircle.collisionVertexArray),n.hasTextCollisionCircleData()&&n.textCollisionCircle.collisionVertexBuffer&&n.textCollisionCircle.collisionVertexBuffer.updateData(n.textCollisionCircle.collisionVertexArray)},ep.prototype.symbolFadeChange=function(r){return 0===this.fadeDuration?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},ep.prototype.zoomAdjustment=function(r){return Math.max(0,(this.transform.zoom-r)/1.5)},ep.prototype.hasTransitions=function(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration},ep.prototype.stillRecent=function(r,n){var i=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*i>r},ep.prototype.setStale=function(){this.stale=!0};var ef=0,em=function(r){this._sortAcrossTiles="viewport-y"!==r.layout.get("symbol-z-order")&&void 0!==r.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};em.prototype.continuePlacement=function(r,n,i,o,a){for(var s=this._bucketParts;this._currentTileIndex<r.length;){var u=r[this._currentTileIndex];if(n.getBucketParts(s,o,u,this._sortAcrossTiles),this._currentTileIndex++,a())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,s.sort(function(r,n){return r.sortKey-n.sortKey}));this._currentPartIndex<s.length;){var c=s[this._currentPartIndex];if(n.placeLayerBucketPart(c,this._seenCrossTileIDs,i),this._currentPartIndex++,a())return!0}return!1};var ey=function(r,n,i,o,a,s,u){this.placement=new ep(r,a,s,u),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=o,this._done=!1};ey.prototype.isDone=function(){return this._done},ey.prototype.continuePlacement=function(n,i,o){for(var a=this,s=r.browser.now(),u=function(){var n=r.browser.now()-s;return!a._forceFullPlacement&&n>2};this._currentPlacementIndex>=0;){var c=i[n[this._currentPlacementIndex]],p=this.placement.collisionIndex.transform.zoom;if("symbol"===c.type&&(!c.minzoom||c.minzoom<=p)&&(!c.maxzoom||c.maxzoom>p)){if(this._inProgressLayer||(this._inProgressLayer=new em(c)),this._inProgressLayer.continuePlacement(o[c.source],this.placement,this._showCollisionBoxes,c,u))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ey.prototype.commit=function(r){return this.placement.commit(r),this.placement};var ev=512/r.EXTENT/2,eg=function(r,n,i){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=i;for(var o=0;o<n.length;o++){var a=n.get(o),s=a.key;this.indexedSymbolInstances[s]||(this.indexedSymbolInstances[s]=[]),this.indexedSymbolInstances[s].push({crossTileID:a.crossTileID,coord:this.getScaledCoordinates(a,r)})}};eg.prototype.getScaledCoordinates=function(n,i){var o=ev/Math.pow(2,i.canonical.z-this.tileID.canonical.z);return{x:Math.floor((i.canonical.x*r.EXTENT+n.anchorX)*o),y:Math.floor((i.canonical.y*r.EXTENT+n.anchorY)*o)}},eg.prototype.findMatches=function(r,n,i){for(var o=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z),a=0;a<r.length;a++){var s=r.get(a);if(!s.crossTileID){var u=this.indexedSymbolInstances[s.key];if(u)for(var c=this.getScaledCoordinates(s,n),p=0,h=u;p<h.length;p+=1){var d=h[p];if(Math.abs(d.coord.x-c.x)<=o&&Math.abs(d.coord.y-c.y)<=o&&!i[d.crossTileID]){i[d.crossTileID]=!0,s.crossTileID=d.crossTileID;break}}}}};var e8=function(){this.maxCrossTileID=0};e8.prototype.generate=function(){return++this.maxCrossTileID};var e$=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};e$.prototype.handleWrapJump=function(r){var n=Math.round((r-this.lng)/360);if(0!==n)for(var i in this.indexes){var o=this.indexes[i],a={};for(var s in o){var u=o[s];u.tileID=u.tileID.unwrapTo(u.tileID.wrap+n),a[u.tileID.key]=u}this.indexes[i]=a}this.lng=r},e$.prototype.addBucket=function(r,n,i){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(var o=0;o<n.symbolInstances.length;o++)n.symbolInstances.get(o).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});var a=this.usedCrossTileIDs[r.overscaledZ];for(var s in this.indexes){var u=this.indexes[s];if(Number(s)>r.overscaledZ)for(var c in u){var p=u[c];p.tileID.isChildOf(r)&&p.findMatches(n.symbolInstances,r,a)}else{var h=u[r.scaledTo(Number(s)).key];h&&h.findMatches(n.symbolInstances,r,a)}}for(var d=0;d<n.symbolInstances.length;d++){var f=n.symbolInstances.get(d);f.crossTileID||(f.crossTileID=i.generate(),a[f.crossTileID]=!0)}return void 0===this.indexes[r.overscaledZ]&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new eg(r,n.symbolInstances,n.bucketInstanceId),!0},e$.prototype.removeBucketCrossTileIDs=function(r,n){for(var i in n.indexedSymbolInstances)for(var o=0,a=n.indexedSymbolInstances[i];o<a.length;o+=1){var s=a[o];delete this.usedCrossTileIDs[r][s.crossTileID]}},e$.prototype.removeStaleBuckets=function(r){var n=!1;for(var i in this.indexes){var o=this.indexes[i];for(var a in o)r[o[a].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,o[a]),delete o[a],n=!0)}return n};var e_=function(){this.layerIndexes={},this.crossTileIDs=new e8,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};e_.prototype.addLayer=function(r,n,i){var o=this.layerIndexes[r.id];void 0===o&&(o=this.layerIndexes[r.id]=new e$);var a=!1,s={};o.handleWrapJump(i);for(var u=0,c=n;u<c.length;u+=1){var p=c[u],h=p.getBucket(r);h&&r.id===h.layerIds[0]&&(h.bucketInstanceId||(h.bucketInstanceId=++this.maxBucketInstanceId),o.addBucket(p.tileID,h,this.crossTileIDs)&&(a=!0),s[h.bucketInstanceId]=!0)}return o.removeStaleBuckets(s)&&(a=!0),a},e_.prototype.pruneUnusedLayers=function(r){var n={};for(var i in r.forEach(function(r){n[r]=!0}),this.layerIndexes)n[i]||delete this.layerIndexes[i]};var ex=function(n,i){return r.emitValidationErrors(n,i&&i.filter(function(r){return"source.canvas"!==r.identifier}))},eb=r.pick(tB,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ew=r.pick(tB,["setCenter","setZoom","setBearing","setPitch"]),e0=function(){var n={},i=r.styleSpec.$version;for(var o in r.styleSpec.$root){var a=r.styleSpec.$root[o];if(a.required){var s=null;null!=(s="version"===o?i:"array"===a.type?[]:{})&&(n[o]=s)}}return n}(),eE=function(n){function i(o,a){var s=this;void 0===a&&(a={}),n.call(this),this.map=o,this.dispatcher=new C((t3||(t3=new tz),t3),this),this.imageManager=new v,this.imageManager.setEventedParent(this),this.glyphManager=new b(o._requestManager,a.localIdeographFontFamily),this.lineAtlas=new S(256,512),this.crossTileSymbolIndex=new e_,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new r.ZoomHistory,this._loaded=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",r.getReferrer()),this.dispatcher.broadcast("setToken",r.window.WEMAP_TOKEN);var u=this;this._rtlTextPluginCallback=i.registerForPluginStateChange(function(n){var i={pluginStatus:n.pluginStatus,pluginURL:n.pluginURL};u.dispatcher.broadcast("syncRTLPluginState",i,function(n,i){if(r.triggerPluginCompletionEvent(n),i&&i.every(function(r){return r}))for(var o in u.sourceCaches)u.sourceCaches[o].reload()})}),this.on("data",function(r){if("source"===r.dataType&&"metadata"===r.sourceDataType){var n=s.sourceCaches[r.sourceId];if(n){var i=n.getSource();if(i&&i.vectorLayerIds)for(var o in s._layers){var a=s._layers[o];a.source===i.id&&s._validateLayer(a)}}}})}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.loadURL=function(n,i){var o=this;void 0===i&&(i={}),this.fire(new r.Event("dataloading",{dataType:"style"}));var a="boolean"==typeof i.validate?i.validate:!r.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,i.accessToken);var s=this.map._requestManager.transformRequest(n,r.ResourceType.Style);this._request=r.getJSON(s,function(n,i){o._request=null,n?o.fire(new r.ErrorEvent(n)):i&&o._load(i,a)})},i.prototype.loadJSON=function(n,i){var o=this;void 0===i&&(i={}),this.fire(new r.Event("dataloading",{dataType:"style"})),this._request=r.browser.frame(function(){o._request=null,o._load(n,!1!==i.validate)})},i.prototype.loadEmpty=function(){this.fire(new r.Event("dataloading",{dataType:"style"})),this._load(e0,!1)},i.prototype._load=function(n,i){var o=this;if(!i||!ex(this,r.validateStyle(n))){for(var a in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(a,n.sources[a],{validate:!1});n.sprite?this._spriteRequest=function(n,i,o){var a,s,u,c=r.browser.devicePixelRatio>1?"@2x":"",p=r.getJSON(i.transformRequest(i.normalizeSpriteURL(n,c,".json"),r.ResourceType.SpriteJSON),function(r,n){p=null,u||(u=r,a=n,d())}),h=r.getImage(i.transformRequest(i.normalizeSpriteURL(n,c,".png"),r.ResourceType.SpriteImage),function(r,n){h=null,u||(u=r,s=n,d())});function d(){if(u)o(u);else if(a&&s){var n=r.browser.getImageData(s),i={};for(var c in a){var p=a[c],h=p.width,d=p.height,f=p.x,m=p.y,y=p.sdf,v=p.pixelRatio,g=p.stretchX,$=p.stretchY,_=p.content,x=new r.RGBAImage({width:h,height:d});r.RGBAImage.copy(n,x,{x:f,y:m},{x:0,y:0},{width:h,height:d}),i[c]={data:x,pixelRatio:v,sdf:y,stretchX:g,stretchY:$,content:_}}o(null,i)}}return{cancel:function(){p&&(p.cancel(),p=null),h&&(h.cancel(),h=null)}}}(n.sprite,this.map._requestManager,function(n,i){if(o._spriteRequest=null,n)o.fire(new r.ErrorEvent(n));else if(i)for(var a in i)o.imageManager.addImage(a,i[a]);o.imageManager.setLoaded(!0),o.dispatcher.broadcast("setImages",o.imageManager.listImages()),o.fire(new r.Event("data",{dataType:"style"}))}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var s=tR(this.stylesheet.layers);this._order=s.map(function(r){return r.id}),this._layers={};for(var u=0,c=s;u<c.length;u+=1){var p=c[u];(p=r.createStyleLayer(p)).setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=p}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new T(this.stylesheet.light),this.fire(new r.Event("data",{dataType:"style"})),this.fire(new r.Event("style.load"))}},i.prototype._validateLayer=function(n){var i=this.sourceCaches[n.source];if(i){var o=n.sourceLayer;if(o){var a=i.getSource();("geojson"===a.type||a.vectorLayerIds&&-1===a.vectorLayerIds.indexOf(o))&&this.fire(new r.ErrorEvent(Error('Source layer "'+o+'" does not exist on source "'+a.id+'" as specified by style layer "'+n.id+'"')))}}},i.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()},i.prototype._serializeLayers=function(r){for(var n=[],i=0,o=r;i<o.length;i+=1){var a=o[i],s=this._layers[a];"custom"!==s.type&&n.push(s.serialize())}return n},i.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var r in this.sourceCaches)if(this.sourceCaches[r].hasTransition())return!0;for(var n in this._layers)if(this._layers[n].hasTransition())return!0;return!1},i.prototype._checkLoaded=function(){if(!this._loaded)throw Error("Style is not done loading")},i.prototype.update=function(n){if(this._loaded){var i=this._changed;if(this._changed){var o=Object.keys(this._updatedLayers),a=Object.keys(this._removedLayers);for(var s in(o.length||a.length)&&this._updateWorkerLayers(o,a),this._updatedSources){var u=this._updatedSources[s];"reload"===u?this._reloadSource(s):"clear"===u&&this._clearSource(s)}for(var c in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[c].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}for(var p in this.sourceCaches)this.sourceCaches[p].used=!1;for(var h=0,d=this._order;h<d.length;h+=1){var f=d[h],m=this._layers[f];m.recalculate(n,this.imageManager.listImages()),!m.isHidden(n.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}this.light.recalculate(n),this.z=n.zoom,i&&this.fire(new r.Event("data",{dataType:"style"}))}},i.prototype._updateTilesForChangedImages=function(){var r=Object.keys(this._changedImages);if(r.length){for(var n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}},i.prototype._updateWorkerLayers=function(r,n){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:n})},i.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},i.prototype.setState=function(n){var i=this;if(this._checkLoaded(),ex(this,r.validateStyle(n)))return!1;(n=r.clone$1(n)).layers=tR(n.layers);var o=(function n(i,o){if(!i)return[{command:tB.setStyle,args:[o]}];var a=[];try{if(!r.deepEqual(i.version,o.version))return[{command:tB.setStyle,args:[o]}];r.deepEqual(i.center,o.center)||a.push({command:tB.setCenter,args:[o.center]}),r.deepEqual(i.zoom,o.zoom)||a.push({command:tB.setZoom,args:[o.zoom]}),r.deepEqual(i.bearing,o.bearing)||a.push({command:tB.setBearing,args:[o.bearing]}),r.deepEqual(i.pitch,o.pitch)||a.push({command:tB.setPitch,args:[o.pitch]}),r.deepEqual(i.sprite,o.sprite)||a.push({command:tB.setSprite,args:[o.sprite]}),r.deepEqual(i.glyphs,o.glyphs)||a.push({command:tB.setGlyphs,args:[o.glyphs]}),r.deepEqual(i.transition,o.transition)||a.push({command:tB.setTransition,args:[o.transition]}),r.deepEqual(i.light,o.light)||a.push({command:tB.setLight,args:[o.light]});var s={},u=[];!function(n,i,o,a){var s;for(s in i=i||{},n=n||{})n.hasOwnProperty(s)&&(i.hasOwnProperty(s)||tO(s,o,a));for(s in i)i.hasOwnProperty(s)&&(n.hasOwnProperty(s)?r.deepEqual(n[s],i[s])||("geojson"===n[s].type&&"geojson"===i[s].type&&t7(n,i,s)?o.push({command:tB.setGeoJSONSourceData,args:[s,i[s].data]}):t6(s,i,o,a)):tF(s,i,o))}(i.sources,o.sources,u,s);var c=[];i.layers&&i.layers.forEach(function(r){s[r.source]?a.push({command:tB.removeLayer,args:[r.id]}):c.push(r)}),a=a.concat(u),function(n,i,o){i=i||[];var a,s,u,c,p,h,d,f=(n=n||[]).map(tN),m=i.map(tN),y=n.reduce(tU,{}),v=i.reduce(tU,{}),g=f.slice(),$=Object.create(null);for(a=0,s=0;a<f.length;a++)u=f[a],v.hasOwnProperty(u)?s++:(o.push({command:tB.removeLayer,args:[u]}),g.splice(g.indexOf(u,s),1));for(a=0,s=0;a<m.length;a++)u=m[m.length-1-a],g[g.length-1-a]!==u&&(y.hasOwnProperty(u)?(o.push({command:tB.removeLayer,args:[u]}),g.splice(g.lastIndexOf(u,g.length-s),1)):s++,h=g[g.length-a],o.push({command:tB.addLayer,args:[v[u],h]}),g.splice(g.length-a,0,u),$[u]=!0);for(a=0;a<m.length;a++)if(c=y[u=m[a]],p=v[u],!$[u]&&!r.deepEqual(c,p)){if(r.deepEqual(c.source,p.source)&&r.deepEqual(c["source-layer"],p["source-layer"])&&r.deepEqual(c.type,p.type)){for(d in t5(c.layout,p.layout,o,u,null,tB.setLayoutProperty),t5(c.paint,p.paint,o,u,null,tB.setPaintProperty),r.deepEqual(c.filter,p.filter)||o.push({command:tB.setFilter,args:[u,p.filter]}),r.deepEqual(c.minzoom,p.minzoom)&&r.deepEqual(c.maxzoom,p.maxzoom)||o.push({command:tB.setLayerZoomRange,args:[u,p.minzoom,p.maxzoom]}),c)c.hasOwnProperty(d)&&"layout"!==d&&"paint"!==d&&"filter"!==d&&"metadata"!==d&&"minzoom"!==d&&"maxzoom"!==d&&(0===d.indexOf("paint.")?t5(c[d],p[d],o,u,d.slice(6),tB.setPaintProperty):r.deepEqual(c[d],p[d])||o.push({command:tB.setLayerProperty,args:[u,d,p[d]]}));for(d in p)p.hasOwnProperty(d)&&!c.hasOwnProperty(d)&&"layout"!==d&&"paint"!==d&&"filter"!==d&&"metadata"!==d&&"minzoom"!==d&&"maxzoom"!==d&&(0===d.indexOf("paint.")?t5(c[d],p[d],o,u,d.slice(6),tB.setPaintProperty):r.deepEqual(c[d],p[d])||o.push({command:tB.setLayerProperty,args:[u,d,p[d]]}))}else o.push({command:tB.removeLayer,args:[u]}),h=g[g.lastIndexOf(u)+1],o.push({command:tB.addLayer,args:[p,h]})}}(c,o.layers,a)}catch(p){console.warn("Unable to compute style diff:",p),a=[{command:tB.setStyle,args:[o]}]}return a})(this.serialize(),n).filter(function(r){return!(r.command in ew)});if(0===o.length)return!1;var a=o.filter(function(r){return!(r.command in eb)});if(a.length>0)throw Error("Unimplemented: "+a.map(function(r){return r.command}).join(", ")+".");return o.forEach(function(r){"setTransition"!==r.command&&i[r.command].apply(i,r.args)}),this.stylesheet=n,!0},i.prototype.addImage=function(n,i){if(this.getImage(n))return this.fire(new r.ErrorEvent(Error("An image with this name already exists.")));this.imageManager.addImage(n,i),this._changedImages[n]=!0,this._changed=!0,this.fire(new r.Event("data",{dataType:"style"}))},i.prototype.updateImage=function(r,n){this.imageManager.updateImage(r,n)},i.prototype.getImage=function(r){return this.imageManager.getImage(r)},i.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new r.ErrorEvent(Error("No image with this name exists.")));this.imageManager.removeImage(n),this._changedImages[n]=!0,this._changed=!0,this.fire(new r.Event("data",{dataType:"style"}))},i.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},i.prototype.addSource=function(n,i,o){var a=this;if(void 0===o&&(o={}),this._checkLoaded(),void 0!==this.sourceCaches[n])throw Error("There is already a source with this ID");if(!i.type)throw Error("The type property must be defined, but the only the following properties were given: "+Object.keys(i).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(i.type)>=0)||!this._validate(r.validateStyle.source,"sources."+n,i,null,o)){this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);var s=this.sourceCaches[n]=new tA(n,i,this.dispatcher);s.style=this,s.setEventedParent(this,function(){return{isSourceLoaded:a.loaded(),source:s.serialize(),sourceId:n}}),s.onAdd(this.map),this._changed=!0}},i.prototype.removeSource=function(n){if(this._checkLoaded(),void 0===this.sourceCaches[n])throw Error("There is no source with this ID");for(var i in this._layers)if(this._layers[i].source===n)return this.fire(new r.ErrorEvent(Error('Source "'+n+'" cannot be removed while layer "'+i+'" is using it.')));var o=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],o.fire(new r.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),o.setEventedParent(null),o.clearTiles(),o.onRemove&&o.onRemove(this.map),this._changed=!0},i.prototype.setGeoJSONSourceData=function(r,n){this._checkLoaded(),this.sourceCaches[r].getSource().setData(n),this._changed=!0},i.prototype.getSource=function(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()},i.prototype.addLayer=function(n,i,o){void 0===o&&(o={}),this._checkLoaded();var a=n.id;if(this.getLayer(a))this.fire(new r.ErrorEvent(Error('Layer with id "'+a+'" already exists on this map')));else{if("custom"===n.type){if(ex(this,r.validateCustomStyleLayer(n)))return;s=r.createStyleLayer(n)}else{if("object"==typeof n.source&&(this.addSource(a,n.source),n=r.clone$1(n),n=r.extend(n,{source:a})),this._validate(r.validateStyle.layer,"layers."+a,n,{arrayIndex:-1},o))return;s=r.createStyleLayer(n),this._validateLayer(s),s.setEventedParent(this,{layer:{id:a}})}var s,u=i?this._order.indexOf(i):this._order.length;if(i&&-1===u)this.fire(new r.ErrorEvent(Error('Layer with id "'+i+'" does not exist on this map.')));else{if(this._order.splice(u,0,a),this._layerOrderChanged=!0,this._layers[a]=s,this._removedLayers[a]&&s.source&&"custom"!==s.type){var c=this._removedLayers[a];delete this._removedLayers[a],c.type!==s.type?this._updatedSources[s.source]="clear":(this._updatedSources[s.source]="reload",this.sourceCaches[s.source].pause())}this._updateLayer(s),s.onAdd&&s.onAdd(this.map)}}},i.prototype.moveLayer=function(n,i){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==i){var o=this._order.indexOf(n);this._order.splice(o,1);var a=i?this._order.indexOf(i):this._order.length;i&&-1===a?this.fire(new r.ErrorEvent(Error('Layer with id "'+i+'" does not exist on this map.'))):(this._order.splice(a,0,n),this._layerOrderChanged=!0)}}else this.fire(new r.ErrorEvent(Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},i.prototype.removeLayer=function(n){this._checkLoaded();var i=this._layers[n];if(i){i.setEventedParent(null);var o=this._order.indexOf(n);this._order.splice(o,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=i,delete this._layers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],i.onRemove&&i.onRemove(this.map)}else this.fire(new r.ErrorEvent(Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},i.prototype.getLayer=function(r){return this._layers[r]},i.prototype.setLayerZoomRange=function(n,i,o){this._checkLoaded();var a=this.getLayer(n);a?a.minzoom===i&&a.maxzoom===o||(null!=i&&(a.minzoom=i),null!=o&&(a.maxzoom=o),this._updateLayer(a)):this.fire(new r.ErrorEvent(Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},i.prototype.setFilter=function(n,i,o){void 0===o&&(o={}),this._checkLoaded();var a=this.getLayer(n);if(a){if(!r.deepEqual(a.filter,i))return null==i?(a.filter=void 0,void this._updateLayer(a)):void(this._validate(r.validateStyle.filter,"layers."+a.id+".filter",i,null,o)||(a.filter=r.clone$1(i),this._updateLayer(a)))}else this.fire(new r.ErrorEvent(Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},i.prototype.getFilter=function(n){return r.clone$1(this.getLayer(n).filter)},i.prototype.setLayoutProperty=function(n,i,o,a){void 0===a&&(a={}),this._checkLoaded();var s=this.getLayer(n);s?r.deepEqual(s.getLayoutProperty(i),o)||(s.setLayoutProperty(i,o,a),this._updateLayer(s)):this.fire(new r.ErrorEvent(Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getLayoutProperty=function(n,i){var o=this.getLayer(n);if(o)return o.getLayoutProperty(i);this.fire(new r.ErrorEvent(Error("The layer '"+n+"' does not exist in the map's style.")))},i.prototype.setPaintProperty=function(n,i,o,a){void 0===a&&(a={}),this._checkLoaded();var s=this.getLayer(n);s?r.deepEqual(s.getPaintProperty(i),o)||(s.setPaintProperty(i,o,a)&&this._updateLayer(s),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new r.ErrorEvent(Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getPaintProperty=function(r,n){return this.getLayer(r).getPaintProperty(n)},i.prototype.setFeatureState=function(n,i){this._checkLoaded();var o=n.source,a=n.sourceLayer,s=this.sourceCaches[o];if(void 0!==s){var u=s.getSource().type;"geojson"===u&&a?this.fire(new r.ErrorEvent(Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==u||a?(void 0===n.id&&this.fire(new r.ErrorEvent(Error("The feature id parameter must be provided."))),s.setFeatureState(a,n.id,i)):this.fire(new r.ErrorEvent(Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new r.ErrorEvent(Error("The source '"+o+"' does not exist in the map's style.")))},i.prototype.removeFeatureState=function(n,i){this._checkLoaded();var o=n.source,a=this.sourceCaches[o];if(void 0!==a){var s=a.getSource().type,u="vector"===s?n.sourceLayer:void 0;"vector"!==s||u?i&&"string"!=typeof n.id&&"number"!=typeof n.id?this.fire(new r.ErrorEvent(Error("A feature id is requred to remove its specific state property."))):a.removeFeatureState(u,n.id,i):this.fire(new r.ErrorEvent(Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new r.ErrorEvent(Error("The source '"+o+"' does not exist in the map's style.")))},i.prototype.getFeatureState=function(n){this._checkLoaded();var i=n.source,o=n.sourceLayer,a=this.sourceCaches[i];if(void 0!==a){if("vector"!==a.getSource().type||o)return void 0===n.id&&this.fire(new r.ErrorEvent(Error("The feature id parameter must be provided."))),a.getFeatureState(o,n.id);this.fire(new r.ErrorEvent(Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new r.ErrorEvent(Error("The source '"+i+"' does not exist in the map's style.")))},i.prototype.getTransition=function(){return r.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},i.prototype.serialize=function(){return r.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:r.mapObject(this.sourceCaches,function(r){return r.serialize()}),layers:this._serializeLayers(this._order)},function(r){return void 0!==r})},i.prototype._updateLayer=function(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&"raster"!==this.sourceCaches[r.source].getSource().type&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._changed=!0},i.prototype._flattenAndSortRenderedFeatures=function(r){for(var n=this,i=function(r){return"fill-extrusion"===n._layers[r].type},o={},a=[],s=this._order.length-1;s>=0;s--){var u=this._order[s];if(i(u)){o[u]=s;for(var c=0,p=r;c<p.length;c+=1){var h=p[c][u];if(h)for(var d=0,f=h;d<f.length;d+=1){var m=f[d];a.push(m)}}}}a.sort(function(r,n){return n.intersectionZ-r.intersectionZ});for(var y=[],v=this._order.length-1;v>=0;v--){var g=this._order[v];if(i(g))for(var $=a.length-1;$>=0;$--){var _=a[$].feature;if(o[_.layer.id]<v)break;y.push(_),a.pop()}else for(var x=0,b=r;x<b.length;x+=1){var w=b[x][g];if(w)for(var E=0,T=w;E<T.length;E+=1){var S=T[E];y.push(S.feature)}}}return y},i.prototype.queryRenderedFeatures=function(n,i,o){i&&i.filter&&this._validate(r.validateStyle.filter,"queryRenderedFeatures.filter",i.filter,null,i);var a={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new r.ErrorEvent(Error("parameters.layers must be an Array."))),[];for(var s=0,u=i.layers;s<u.length;s+=1){var c=u[s],p=this._layers[c];if(!p)return this.fire(new r.ErrorEvent(Error("The layer '"+c+"' does not exist in the map's style and cannot be queried for features."))),[];a[p.source]=!0}}var h=[];for(var d in this.sourceCaches)i.layers&&!a[d]||h.push(U(this.sourceCaches[d],this._layers,n,i,o));return this.placement&&h.push(function(r,n,i,o,a,s){for(var u={},c=a.queryRenderedSymbols(i),p=[],h=0,d=Object.keys(c).map(Number);h<d.length;h+=1){var f=d[h];p.push(s[f])}p.sort(V);for(var m=0,y=p;m<y.length;m+=1)(function(){var n=y[m],i=n.featureIndex.lookupSymbolFeatures(c[n.bucketInstanceId],n.bucketIndex,n.sourceLayerIndex,o.filter,o.layers,r);for(var a in i){var s=u[a]=u[a]||[],p=i[a];p.sort(function(r,i){var o=n.featureSortOrder;if(o){var a=o.indexOf(r.featureIndex);return o.indexOf(i.featureIndex)-a}return i.featureIndex-r.featureIndex});for(var h=0,d=p;h<d.length;h+=1){var f=d[h];s.push(f)}}})();var v=function(i){u[i].forEach(function(o){var a=o.feature,s=n[r[i].source].getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=s})};for(var g in u)v(g);return u}(this._layers,this.sourceCaches,n,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(h)},i.prototype.querySourceFeatures=function(n,i){i&&i.filter&&this._validate(r.validateStyle.filter,"querySourceFeatures.filter",i.filter,null,i);var o=this.sourceCaches[n];return o?function(r,n){for(var i=r.getRenderableIds().map(function(n){return r.getTileByID(n)}),o=[],a={},s=0;s<i.length;s++){var u=i[s],c=u.tileID.canonical.key;a[c]||(a[c]=!0,u.querySourceFeatures(o,n))}return o}(o,i):[]},i.prototype.addSourceType=function(r,n,o){return i.getSourceType(r)?o(Error('A source type called "'+r+'" already exists.')):(i.setSourceType(r,n),n.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:n.workerSourceURL},o):o(null,null))},i.prototype.getLight=function(){return this.light.getLight()},i.prototype.setLight=function(n,i){void 0===i&&(i={}),this._checkLoaded();var o=this.light.getLight(),a=!1;for(var s in n)if(!r.deepEqual(n[s],o[s])){a=!0;break}if(a){var u={now:r.browser.now(),transition:r.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,i),this.light.updateTransitions(u)}},i.prototype._validate=function(n,i,o,a,s){return void 0===s&&(s={}),(!s||!1!==s.validate)&&ex(this,n.call(r.validateStyle,r.extend({key:i,style:this.serialize(),value:o,styleSpec:r.styleSpec},a)))},i.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var i in this.sourceCaches)this.sourceCaches[i].clearTiles(),this.sourceCaches[i].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},i.prototype._clearSource=function(r){this.sourceCaches[r].clearTiles()},i.prototype._reloadSource=function(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()},i.prototype._updateSources=function(r){for(var n in this.sourceCaches)this.sourceCaches[n].update(r)},i.prototype._generateCollisionBoxes=function(){for(var r in this.sourceCaches)this._reloadSource(r)},i.prototype._updatePlacement=function(n,i,o,a,s){void 0===s&&(s=!1);for(var u=!1,c=!1,p={},h=0,d=this._order;h<d.length;h+=1){var f=d[h],m=this._layers[f];if("symbol"===m.type){if(!p[m.source]){var y=this.sourceCaches[m.source];p[m.source]=y.getRenderableIds(!0).map(function(r){return y.getTileByID(r)}).sort(function(r,n){return n.tileID.overscaledZ-r.tileID.overscaledZ||(r.tileID.isLessThan(n.tileID)?-1:1)})}var v=this.crossTileSymbolIndex.addLayer(m,p[m.source],n.center.lng);u=u||v}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((s=s||this._layerOrderChanged||0===o)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.browser.now(),n.zoom))&&(this.pauseablePlacement=new ey(n,this._order,s,i,o,a,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,p),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.browser.now()),c=!0),u&&this.pauseablePlacement.placement.setStale()),c||u)for(var g=0,$=this._order;g<$.length;g+=1){var _=$[g],x=this._layers[_];"symbol"===x.type&&this.placement.updateLayerOpacities(x,p[x.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.browser.now())},i.prototype._releaseSymbolFadeTiles=function(){for(var r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()},i.prototype.getImages=function(r,n,i){this.imageManager.getImages(n.icons,i),this._updateTilesForChangedImages();var o=this.sourceCaches[n.source];o&&o.setDependencies(n.tileID.key,n.type,n.icons)},i.prototype.getGlyphs=function(r,n,i){this.glyphManager.getGlyphs(n.stacks,i)},i.prototype.getResource=function(n,i,o){return r.makeRequest(i,o)},i}(r.Evented);eE.getSourceType=function(r){return F[r]},eE.setSourceType=function(r,n){F[r]=n},eE.registerForPluginStateChange=r.registerForPluginStateChange;var eT=r.createLayout([{name:"a_pos",type:"Int16",components:2}]),eS=eH("#ifdef GL_ES\r\nprecision mediump float;\r\n#else\r\n#if !defined(lowp)\r\n#define lowp\r\n#endif\r\n#if !defined(mediump)\r\n#define mediump\r\n#endif\r\n#if !defined(highp)\r\n#define highp\r\n#endif\r\n#endif","#ifdef GL_ES\r\nprecision highp float;\r\n#else\r\n#if !defined(lowp)\r\n#define lowp\r\n#endif\r\n#if !defined(mediump)\r\n#define mediump\r\n#endif\r\n#if !defined(highp)\r\n#define highp\r\n#endif\r\n#endif\nvec2 unpack_float(const float packedValue) {\r\nint packedIntValue=int(packedValue);\r\nint v0=packedIntValue/256;\r\nreturn vec2(v0,packedIntValue-v0*256);\r\n}\r\nvec2 unpack_opacity(const float packedOpacity) {\r\nint intOpacity=int(packedOpacity)/2;\r\nreturn vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));\r\n}vec4 decode_color(const vec2 encodedColor) {\r\nreturn vec4(\r\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\r\n);\r\n}float unpack_mix_vec2(const vec2 packedValue,const float t) {\r\nreturn mix(packedValue[0],packedValue[1],t);\r\n}vec4 unpack_mix_color(const vec4 packedColors,const float t) {\r\nvec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));\r\nvec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));\r\nreturn mix(minColor,maxColor,t);\r\n}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {\r\nvec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);\r\nreturn (tile_units_to_pixels*pos+offset)/pattern_size;\r\n}"),eC=eH("uniform vec4 u_color;\r\nuniform float u_opacity;\r\nvoid main() {\r\ngl_FragColor=u_color*u_opacity;\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","attribute vec2 a_pos;\r\nuniform mat4 u_matrix;\r\nvoid main() {\r\ngl_Position=u_matrix*vec4(a_pos,0,1);\r\n}"),eI=eH("uniform vec2 u_pattern_tl_a;\r\nuniform vec2 u_pattern_br_a;\r\nuniform vec2 u_pattern_tl_b;\r\nuniform vec2 u_pattern_br_b;\r\nuniform vec2 u_texsize;\r\nuniform float u_mix;\r\nuniform float u_opacity;\r\nuniform sampler2D u_image;\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\nvoid main() {\r\nvec2 imagecoord=mod(v_pos_a,1.0);\r\nvec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);\r\nvec4 color1=texture2D(u_image,pos);\r\nvec2 imagecoord_b=mod(v_pos_b,1.0);\r\nvec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);\r\nvec4 color2=texture2D(u_image,pos2);\r\ngl_FragColor=mix(color1,color2,u_mix)*u_opacity;\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","uniform mat4 u_matrix;\r\nuniform vec2 u_pattern_size_a;\r\nuniform vec2 u_pattern_size_b;\r\nuniform vec2 u_pixel_coord_upper;\r\nuniform vec2 u_pixel_coord_lower;\r\nuniform float u_scale_a;\r\nuniform float u_scale_b;\r\nuniform float u_tile_units_to_pixels;\r\nattribute vec2 a_pos;\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\nvoid main() {\r\ngl_Position=u_matrix*vec4(a_pos,0,1);\r\nv_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);\r\nv_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\r\n}"),ek=eH("varying vec3 v_data;\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define mediump float radius\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define highp vec4 stroke_color\r\n#pragma mapbox: define mediump float stroke_width\r\n#pragma mapbox: define lowp float stroke_opacity\r\nvoid main() {\r\n#pragma mapbox: initialize highp vec4 color\r\n#pragma mapbox: initialize mediump float radius\r\n#pragma mapbox: initialize lowp float blur\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize highp vec4 stroke_color\r\n#pragma mapbox: initialize mediump float stroke_width\r\n#pragma mapbox: initialize lowp float stroke_opacity\r\nvec2 extrude=v_data.xy;\r\nfloat extrude_length=length(extrude);\r\nlowp float antialiasblur=v_data.z;\r\nfloat antialiased_blur=-max(blur,antialiasblur);\r\nfloat opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);\r\nfloat color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\r\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\r\n);\r\ngl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","uniform mat4 u_matrix;\r\nuniform bool u_scale_with_map;\r\nuniform bool u_pitch_with_map;\r\nuniform vec2 u_extrude_scale;\r\nuniform lowp float u_device_pixel_ratio;\r\nuniform highp float u_camera_to_center_distance;\r\nattribute vec2 a_pos;\r\nvarying vec3 v_data;\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define mediump float radius\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define highp vec4 stroke_color\r\n#pragma mapbox: define mediump float stroke_width\r\n#pragma mapbox: define lowp float stroke_opacity\r\nvoid main(void) {\r\n#pragma mapbox: initialize highp vec4 color\r\n#pragma mapbox: initialize mediump float radius\r\n#pragma mapbox: initialize lowp float blur\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize highp vec4 stroke_color\r\n#pragma mapbox: initialize mediump float stroke_width\r\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);\r\nif (u_pitch_with_map) {\r\nvec2 corner_position=circle_center;\r\nif (u_scale_with_map) {\r\ncorner_position+=extrude*(radius+stroke_width)*u_extrude_scale;\r\n} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);\r\ncorner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);\r\n}\r\ngl_Position=u_matrix*vec4(corner_position,0,1);\r\n} else {\r\ngl_Position=u_matrix*vec4(circle_center,0,1);\r\nif (u_scale_with_map) {\r\ngl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;\r\n} else {\r\ngl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;\r\n}\r\n}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);\r\nv_data=vec3(extrude.x,extrude.y,antialiasblur);\r\n}"),e1=eH("void main() {\r\ngl_FragColor=vec4(1.0);\r\n}","attribute vec2 a_pos;\r\nuniform mat4 u_matrix;\r\nvoid main() {\r\ngl_Position=u_matrix*vec4(a_pos,0,1);\r\n}"),e2=eH("uniform highp float u_intensity;\r\nvarying vec2 v_extrude;\r\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\r\nvoid main() {\r\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);\r\nfloat val=weight*u_intensity*GAUSS_COEF*exp(d);\r\ngl_FragColor=vec4(val,1.0,1.0,1.0);\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","uniform mat4 u_matrix;\r\nuniform float u_extrude_scale;\r\nuniform float u_opacity;\r\nuniform float u_intensity;\r\nattribute vec2 a_pos;\r\nvarying vec2 v_extrude;\r\n#pragma mapbox: define highp float weight\r\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\r\nvoid main(void) {\r\n#pragma mapbox: initialize highp float weight\r\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);\r\ngl_Position=u_matrix*pos;\r\n}"),eA=eH("uniform sampler2D u_image;\r\nuniform sampler2D u_color_ramp;\r\nuniform float u_opacity;\r\nvarying vec2 v_pos;\r\nvoid main() {\r\nfloat t=texture2D(u_image,v_pos).r;\r\nvec4 color=texture2D(u_color_ramp,vec2(t,0.5));\r\ngl_FragColor=color*u_opacity;\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(0.0);\r\n#endif\r\n}","uniform mat4 u_matrix;\r\nuniform vec2 u_world;\r\nattribute vec2 a_pos;\r\nvarying vec2 v_pos;\r\nvoid main() {\r\ngl_Position=u_matrix*vec4(a_pos*u_world,0,1);\r\nv_pos.x=a_pos.x;\r\nv_pos.y=1.0-a_pos.y;\r\n}"),eP=eH("varying float v_placed;\r\nvarying float v_notUsed;\r\nvoid main() {\r\nfloat alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {\r\ngl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;\r\n}\r\nif (v_notUsed > 0.5) {gl_FragColor*=.1;\r\n}\r\n}","attribute vec2 a_pos;\r\nattribute vec2 a_anchor_pos;\r\nattribute vec2 a_extrude;\r\nattribute vec2 a_placed;\r\nattribute vec2 a_shift;\r\nuniform mat4 u_matrix;\r\nuniform vec2 u_extrude_scale;\r\nuniform float u_camera_to_center_distance;\r\nvarying float v_placed;\r\nvarying float v_notUsed;\r\nvoid main() {\r\nvec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);\r\nhighp float camera_to_anchor_distance=projectedPoint.w;\r\nhighp float collision_perspective_ratio=clamp(\r\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);\r\ngl_Position=u_matrix*vec4(a_pos,0.0,1.0);\r\ngl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;\r\nv_placed=a_placed.x;\r\nv_notUsed=a_placed.y;\r\n}"),eL=eH("uniform float u_overscale_factor;\r\nvarying float v_placed;\r\nvarying float v_notUsed;\r\nvarying float v_radius;\r\nvarying vec2 v_extrude;\r\nvarying vec2 v_extrude_scale;\r\nvoid main() {\r\nfloat alpha=0.5;vec4 color=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {\r\ncolor=vec4(0.0,0.0,1.0,0.5)*alpha;\r\n}\r\nif (v_notUsed > 0.5) {color*=.2;\r\n}\r\nfloat extrude_scale_length=length(v_extrude_scale);\r\nfloat extrude_length=length(v_extrude)*extrude_scale_length;\r\nfloat stroke_width=15.0*extrude_scale_length/u_overscale_factor;\r\nfloat radius=v_radius*extrude_scale_length;\r\nfloat distance_to_edge=abs(extrude_length-radius);\r\nfloat opacity_t=smoothstep(-stroke_width,0.0,-distance_to_edge);\r\ngl_FragColor=opacity_t*color;\r\n}","attribute vec2 a_pos;\r\nattribute vec2 a_anchor_pos;\r\nattribute vec2 a_extrude;\r\nattribute vec2 a_placed;\r\nuniform mat4 u_matrix;\r\nuniform vec2 u_extrude_scale;\r\nuniform float u_camera_to_center_distance;\r\nvarying float v_placed;\r\nvarying float v_notUsed;\r\nvarying float v_radius;\r\nvarying vec2 v_extrude;\r\nvarying vec2 v_extrude_scale;\r\nvoid main() {\r\nvec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);\r\nhighp float camera_to_anchor_distance=projectedPoint.w;\r\nhighp float collision_perspective_ratio=clamp(\r\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);\r\ngl_Position=u_matrix*vec4(a_pos,0.0,1.0);\r\nhighp float padding_factor=1.2;gl_Position.xy+=a_extrude*u_extrude_scale*padding_factor*gl_Position.w*collision_perspective_ratio;\r\nv_placed=a_placed.x;\r\nv_notUsed=a_placed.y;\r\nv_radius=abs(a_extrude.y);v_extrude=a_extrude*padding_factor;\r\nv_extrude_scale=u_extrude_scale*u_camera_to_center_distance*collision_perspective_ratio;\r\n}"),eD=eH("uniform highp vec4 u_color;\r\nvoid main() {\r\ngl_FragColor=u_color;\r\n}","attribute vec2 a_pos;\r\nuniform mat4 u_matrix;\r\nvoid main() {\r\ngl_Position=u_matrix*vec4(a_pos,0,1);\r\n}"),ez=eH("#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float opacity\r\nvoid main() {\r\n#pragma mapbox: initialize highp vec4 color\r\n#pragma mapbox: initialize lowp float opacity\r\ngl_FragColor=color*opacity;\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","attribute vec2 a_pos;\r\nuniform mat4 u_matrix;\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float opacity\r\nvoid main() {\r\n#pragma mapbox: initialize highp vec4 color\r\n#pragma mapbox: initialize lowp float opacity\r\ngl_Position=u_matrix*vec4(a_pos,0,1);\r\n}"),e3=eH("varying vec2 v_pos;\r\n#pragma mapbox: define highp vec4 outline_color\r\n#pragma mapbox: define lowp float opacity\r\nvoid main() {\r\n#pragma mapbox: initialize highp vec4 outline_color\r\n#pragma mapbox: initialize lowp float opacity\r\nfloat dist=length(v_pos-gl_FragCoord.xy);\r\nfloat alpha=1.0-smoothstep(0.0,1.0,dist);\r\ngl_FragColor=outline_color*(alpha*opacity);\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","attribute vec2 a_pos;\r\nuniform mat4 u_matrix;\r\nuniform vec2 u_world;\r\nvarying vec2 v_pos;\r\n#pragma mapbox: define highp vec4 outline_color\r\n#pragma mapbox: define lowp float opacity\r\nvoid main() {\r\n#pragma mapbox: initialize highp vec4 outline_color\r\n#pragma mapbox: initialize lowp float opacity\r\ngl_Position=u_matrix*vec4(a_pos,0,1);\r\nv_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\r\n}"),e4=eH("uniform vec2 u_texsize;\r\nuniform sampler2D u_image;\r\nuniform float u_fade;\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\nvarying vec2 v_pos;\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp vec4 pattern_from\r\n#pragma mapbox: define lowp vec4 pattern_to\r\nvoid main() {\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize mediump vec4 pattern_from\r\n#pragma mapbox: initialize mediump vec4 pattern_to\r\nvec2 pattern_tl_a=pattern_from.xy;\r\nvec2 pattern_br_a=pattern_from.zw;\r\nvec2 pattern_tl_b=pattern_to.xy;\r\nvec2 pattern_br_b=pattern_to.zw;\r\nvec2 imagecoord=mod(v_pos_a,1.0);\r\nvec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);\r\nvec4 color1=texture2D(u_image,pos);\r\nvec2 imagecoord_b=mod(v_pos_b,1.0);\r\nvec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);\r\nvec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);\r\nfloat alpha=1.0-smoothstep(0.0,1.0,dist);\r\ngl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","uniform mat4 u_matrix;\r\nuniform vec2 u_world;\r\nuniform vec2 u_pixel_coord_upper;\r\nuniform vec2 u_pixel_coord_lower;\r\nuniform vec4 u_scale;\r\nattribute vec2 a_pos;\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\nvarying vec2 v_pos;\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp vec4 pattern_from\r\n#pragma mapbox: define lowp vec4 pattern_to\r\nvoid main() {\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize mediump vec4 pattern_from\r\n#pragma mapbox: initialize mediump vec4 pattern_to\r\nvec2 pattern_tl_a=pattern_from.xy;\r\nvec2 pattern_br_a=pattern_from.zw;\r\nvec2 pattern_tl_b=pattern_to.xy;\r\nvec2 pattern_br_b=pattern_to.zw;\r\nfloat pixelRatio=u_scale.x;\r\nfloat tileRatio=u_scale.y;\r\nfloat fromScale=u_scale.z;\r\nfloat toScale=u_scale.w;\r\ngl_Position=u_matrix*vec4(a_pos,0,1);\r\nvec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);\r\nvec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);\r\nv_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);\r\nv_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);\r\nv_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\r\n}"),eM=eH("uniform vec2 u_texsize;\r\nuniform float u_fade;\r\nuniform sampler2D u_image;\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp vec4 pattern_from\r\n#pragma mapbox: define lowp vec4 pattern_to\r\nvoid main() {\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize mediump vec4 pattern_from\r\n#pragma mapbox: initialize mediump vec4 pattern_to\r\nvec2 pattern_tl_a=pattern_from.xy;\r\nvec2 pattern_br_a=pattern_from.zw;\r\nvec2 pattern_tl_b=pattern_to.xy;\r\nvec2 pattern_br_b=pattern_to.zw;\r\nvec2 imagecoord=mod(v_pos_a,1.0);\r\nvec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);\r\nvec4 color1=texture2D(u_image,pos);\r\nvec2 imagecoord_b=mod(v_pos_b,1.0);\r\nvec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);\r\nvec4 color2=texture2D(u_image,pos2);\r\ngl_FragColor=mix(color1,color2,u_fade)*opacity;\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","uniform mat4 u_matrix;\r\nuniform vec2 u_pixel_coord_upper;\r\nuniform vec2 u_pixel_coord_lower;\r\nuniform vec4 u_scale;\r\nattribute vec2 a_pos;\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp vec4 pattern_from\r\n#pragma mapbox: define lowp vec4 pattern_to\r\nvoid main() {\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize mediump vec4 pattern_from\r\n#pragma mapbox: initialize mediump vec4 pattern_to\r\nvec2 pattern_tl_a=pattern_from.xy;\r\nvec2 pattern_br_a=pattern_from.zw;\r\nvec2 pattern_tl_b=pattern_to.xy;\r\nvec2 pattern_br_b=pattern_to.zw;\r\nfloat pixelRatio=u_scale.x;\r\nfloat tileZoomRatio=u_scale.y;\r\nfloat fromScale=u_scale.z;\r\nfloat toScale=u_scale.w;\r\nvec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);\r\nvec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);\r\ngl_Position=u_matrix*vec4(a_pos,0,1);\r\nv_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);\r\nv_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\r\n}"),eR=eH("varying vec4 v_color;\r\nvoid main() {\r\ngl_FragColor=v_color;\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","uniform mat4 u_matrix;\r\nuniform vec3 u_lightcolor;\r\nuniform lowp vec3 u_lightpos;\r\nuniform lowp float u_lightintensity;\r\nuniform float u_vertical_gradient;\r\nuniform lowp float u_opacity;\r\nattribute vec2 a_pos;\r\nattribute vec4 a_normal_ed;\r\nvarying vec4 v_color;\r\n#pragma mapbox: define highp float base\r\n#pragma mapbox: define highp float height\r\n#pragma mapbox: define highp vec4 color\r\nvoid main() {\r\n#pragma mapbox: initialize highp float base\r\n#pragma mapbox: initialize highp float height\r\n#pragma mapbox: initialize highp vec4 color\r\nvec3 normal=a_normal_ed.xyz;\r\nbase=max(0.0,base);\r\nheight=max(0.0,height);\r\nfloat t=mod(normal.x,2.0);\r\ngl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;\r\nv_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);\r\ncolor+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\r\n(1.0-u_vertical_gradient)+\n(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));\r\n}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);\r\nv_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);\r\nv_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);\r\nv_color*=u_opacity;\r\n}"),eB=eH("uniform vec2 u_texsize;\r\nuniform float u_fade;\r\nuniform sampler2D u_image;\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\nvarying vec4 v_lighting;\r\n#pragma mapbox: define lowp float base\r\n#pragma mapbox: define lowp float height\r\n#pragma mapbox: define lowp vec4 pattern_from\r\n#pragma mapbox: define lowp vec4 pattern_to\r\nvoid main() {\r\n#pragma mapbox: initialize lowp float base\r\n#pragma mapbox: initialize lowp float height\r\n#pragma mapbox: initialize mediump vec4 pattern_from\r\n#pragma mapbox: initialize mediump vec4 pattern_to\r\nvec2 pattern_tl_a=pattern_from.xy;\r\nvec2 pattern_br_a=pattern_from.zw;\r\nvec2 pattern_tl_b=pattern_to.xy;\r\nvec2 pattern_br_b=pattern_to.zw;\r\nvec2 imagecoord=mod(v_pos_a,1.0);\r\nvec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);\r\nvec4 color1=texture2D(u_image,pos);\r\nvec2 imagecoord_b=mod(v_pos_b,1.0);\r\nvec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);\r\nvec4 color2=texture2D(u_image,pos2);\r\nvec4 mixedColor=mix(color1,color2,u_fade);\r\ngl_FragColor=mixedColor*v_lighting;\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","uniform mat4 u_matrix;\r\nuniform vec2 u_pixel_coord_upper;\r\nuniform vec2 u_pixel_coord_lower;\r\nuniform float u_height_factor;\r\nuniform vec4 u_scale;\r\nuniform float u_vertical_gradient;\r\nuniform lowp float u_opacity;\r\nuniform vec3 u_lightcolor;\r\nuniform lowp vec3 u_lightpos;\r\nuniform lowp float u_lightintensity;\r\nattribute vec2 a_pos;\r\nattribute vec4 a_normal_ed;\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\nvarying vec4 v_lighting;\r\n#pragma mapbox: define lowp float base\r\n#pragma mapbox: define lowp float height\r\n#pragma mapbox: define lowp vec4 pattern_from\r\n#pragma mapbox: define lowp vec4 pattern_to\r\nvoid main() {\r\n#pragma mapbox: initialize lowp float base\r\n#pragma mapbox: initialize lowp float height\r\n#pragma mapbox: initialize mediump vec4 pattern_from\r\n#pragma mapbox: initialize mediump vec4 pattern_to\r\nvec2 pattern_tl_a=pattern_from.xy;\r\nvec2 pattern_br_a=pattern_from.zw;\r\nvec2 pattern_tl_b=pattern_to.xy;\r\nvec2 pattern_br_b=pattern_to.zw;\r\nfloat pixelRatio=u_scale.x;\r\nfloat tileRatio=u_scale.y;\r\nfloat fromScale=u_scale.z;\r\nfloat toScale=u_scale.w;\r\nvec3 normal=a_normal_ed.xyz;\r\nfloat edgedistance=a_normal_ed.w;\r\nvec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);\r\nvec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);\r\nbase=max(0.0,base);\r\nheight=max(0.0,height);\r\nfloat t=mod(normal.x,2.0);\r\nfloat z=t > 0.0 ? height : base;\r\ngl_Position=u_matrix*vec4(a_pos,z,1);\r\nvec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\r\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);\r\nv_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);\r\nv_lighting=vec4(0.0,0.0,0.0,1.0);\r\nfloat directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);\r\ndirectional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);\r\nif (normal.y !=0.0) {directional*=(\r\n(1.0-u_vertical_gradient)+\n(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));\r\n}\r\nv_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\r\nv_lighting*=u_opacity;\r\n}"),eF=eH("#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\nuniform sampler2D u_image;\r\nvarying vec2 v_pos;\r\nuniform vec2 u_dimension;\r\nuniform float u_zoom;\r\nuniform float u_maxzoom;\r\nuniform vec4 u_unpack;\r\nfloat getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;\r\ndata.a=-1.0;\r\nreturn dot(data,u_unpack)/4.0;\r\n}\r\nvoid main() {\r\nvec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);\r\nfloat b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);\r\nfloat c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);\r\nfloat d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);\r\nfloat e=getElevation(v_pos,0.0);\r\nfloat f=getElevation(v_pos+vec2(epsilon.x,0),0.0);\r\nfloat g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);\r\nfloat h=getElevation(v_pos+vec2(0,epsilon.y),0.0);\r\nfloat i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;\r\nvec2 deriv=vec2(\r\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\r\n)/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);\r\ngl_FragColor=clamp(vec4(\r\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","uniform mat4 u_matrix;\r\nuniform vec2 u_dimension;\r\nattribute vec2 a_pos;\r\nattribute vec2 a_texture_pos;\r\nvarying vec2 v_pos;\r\nvoid main() {\r\ngl_Position=u_matrix*vec4(a_pos,0,1);\r\nhighp vec2 epsilon=1.0/u_dimension;\r\nfloat scale=(u_dimension.x-2.0)/u_dimension.x;\r\nv_pos=(a_texture_pos/8192.0)*scale+epsilon;\r\n}"),eO=eH("uniform sampler2D u_image;\r\nvarying vec2 v_pos;\r\nuniform vec2 u_latrange;\r\nuniform vec2 u_light;\r\nuniform vec4 u_shadow;\r\nuniform vec4 u_highlight;\r\nuniform vec4 u_accent;\r\n#define PI 3.141592653589793\r\nvoid main() {\r\nvec4 pixel=texture2D(u_image,v_pos);\r\nvec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);\r\nfloat aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);\r\nfloat intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;\r\nfloat maxValue=0.5*PI;\r\nfloat scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);\r\nfloat shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);\r\nvec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);\r\ngl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","uniform mat4 u_matrix;\r\nattribute vec2 a_pos;\r\nattribute vec2 a_texture_pos;\r\nvarying vec2 v_pos;\r\nvoid main() {\r\ngl_Position=u_matrix*vec4(a_pos,0,1);\r\nv_pos=a_texture_pos/8192.0;\r\n}"),e6=eH("uniform lowp float u_device_pixel_ratio;\r\nvarying vec2 v_width2;\r\nvarying vec2 v_normal;\r\nvarying float v_gamma_scale;\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\nvoid main() {\r\n#pragma mapbox: initialize highp vec4 color\r\n#pragma mapbox: initialize lowp float blur\r\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;\r\nfloat alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\r\ngl_FragColor=color*(alpha*opacity);\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","\n#define scale 0.015873016\r\nattribute vec2 a_pos_normal;\r\nattribute vec4 a_data;\r\nuniform mat4 u_matrix;\r\nuniform mediump float u_ratio;\r\nuniform vec2 u_units_to_pixels;\r\nuniform lowp float u_device_pixel_ratio;\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying float v_gamma_scale;\r\nvarying highp float v_linesofar;\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define mediump float gapwidth\r\n#pragma mapbox: define lowp float offset\r\n#pragma mapbox: define mediump float width\r\nvoid main() {\r\n#pragma mapbox: initialize highp vec4 color\r\n#pragma mapbox: initialize lowp float blur\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize mediump float gapwidth\r\n#pragma mapbox: initialize lowp float offset\r\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;\r\nvec2 a_extrude=a_data.xy-128.0;\r\nfloat a_direction=mod(a_data.z,4.0)-1.0;\r\nv_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;\r\nvec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;\r\nnormal.y=normal.y*2.0-1.0;\r\nv_normal=normal;gapwidth=gapwidth/2.0;\r\nfloat halfwidth=width/2.0;\r\noffset=-1.0*offset;\r\nfloat inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);\r\nfloat outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;\r\nmediump float t=1.0-abs(u);\r\nmediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);\r\nvec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);\r\ngl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);\r\nfloat extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);\r\nv_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\r\nv_width2=vec2(outset,inset);\r\n}"),e7=eH("uniform lowp float u_device_pixel_ratio;\r\nuniform sampler2D u_image;\r\nvarying vec2 v_width2;\r\nvarying vec2 v_normal;\r\nvarying float v_gamma_scale;\r\nvarying highp float v_lineprogress;\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\nvoid main() {\r\n#pragma mapbox: initialize lowp float blur\r\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;\r\nfloat alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));\r\ngl_FragColor=color*(alpha*opacity);\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\r\nattribute vec2 a_pos_normal;\r\nattribute vec4 a_data;\r\nuniform mat4 u_matrix;\r\nuniform mediump float u_ratio;\r\nuniform lowp float u_device_pixel_ratio;\r\nuniform vec2 u_units_to_pixels;\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying float v_gamma_scale;\r\nvarying highp float v_lineprogress;\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define mediump float gapwidth\r\n#pragma mapbox: define lowp float offset\r\n#pragma mapbox: define mediump float width\r\nvoid main() {\r\n#pragma mapbox: initialize lowp float blur\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize mediump float gapwidth\r\n#pragma mapbox: initialize lowp float offset\r\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;\r\nvec2 a_extrude=a_data.xy-128.0;\r\nfloat a_direction=mod(a_data.z,4.0)-1.0;\r\nv_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;\r\nvec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;\r\nnormal.y=normal.y*2.0-1.0;\r\nv_normal=normal;gapwidth=gapwidth/2.0;\r\nfloat halfwidth=width/2.0;\r\noffset=-1.0*offset;\r\nfloat inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);\r\nfloat outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;\r\nmediump float t=1.0-abs(u);\r\nmediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);\r\nvec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);\r\ngl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);\r\nfloat extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);\r\nv_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\r\nv_width2=vec2(outset,inset);\r\n}"),e5=eH("uniform lowp float u_device_pixel_ratio;\r\nuniform vec2 u_texsize;\r\nuniform float u_fade;\r\nuniform mediump vec4 u_scale;\r\nuniform sampler2D u_image;\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying float v_linesofar;\r\nvarying float v_gamma_scale;\r\n#pragma mapbox: define lowp vec4 pattern_from\r\n#pragma mapbox: define lowp vec4 pattern_to\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\nvoid main() {\r\n#pragma mapbox: initialize mediump vec4 pattern_from\r\n#pragma mapbox: initialize mediump vec4 pattern_to\r\n#pragma mapbox: initialize lowp float blur\r\n#pragma mapbox: initialize lowp float opacity\r\nvec2 pattern_tl_a=pattern_from.xy;\r\nvec2 pattern_br_a=pattern_from.zw;\r\nvec2 pattern_tl_b=pattern_to.xy;\r\nvec2 pattern_br_b=pattern_to.zw;\r\nfloat pixelRatio=u_scale.x;\r\nfloat tileZoomRatio=u_scale.y;\r\nfloat fromScale=u_scale.z;\r\nfloat toScale=u_scale.w;\r\nvec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);\r\nvec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);\r\nvec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);\r\nvec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;\r\nfloat alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\r\nfloat x_a=mod(v_linesofar/pattern_size_a.x,1.0);\r\nfloat x_b=mod(v_linesofar/pattern_size_b.x,1.0);float y_a=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_a.y+2.0)/2.0)/pattern_size_a.y);\r\nfloat y_b=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_b.y+2.0)/2.0)/pattern_size_b.y);\r\nvec2 pos_a=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,vec2(x_a,y_a));\r\nvec2 pos_b=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,vec2(x_b,y_b));\r\nvec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\r\ngl_FragColor=color*alpha*opacity;\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\r\nattribute vec2 a_pos_normal;\r\nattribute vec4 a_data;\r\nuniform mat4 u_matrix;\r\nuniform vec2 u_units_to_pixels;\r\nuniform mediump float u_ratio;\r\nuniform lowp float u_device_pixel_ratio;\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying float v_linesofar;\r\nvarying float v_gamma_scale;\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp float offset\r\n#pragma mapbox: define mediump float gapwidth\r\n#pragma mapbox: define mediump float width\r\n#pragma mapbox: define lowp vec4 pattern_from\r\n#pragma mapbox: define lowp vec4 pattern_to\r\nvoid main() {\r\n#pragma mapbox: initialize lowp float blur\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize lowp float offset\r\n#pragma mapbox: initialize mediump float gapwidth\r\n#pragma mapbox: initialize mediump float width\r\n#pragma mapbox: initialize mediump vec4 pattern_from\r\n#pragma mapbox: initialize mediump vec4 pattern_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;\r\nvec2 a_extrude=a_data.xy-128.0;\r\nfloat a_direction=mod(a_data.z,4.0)-1.0;\r\nfloat a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;\r\nnormal.y=normal.y*2.0-1.0;\r\nv_normal=normal;gapwidth=gapwidth/2.0;\r\nfloat halfwidth=width/2.0;\r\noffset=-1.0*offset;\r\nfloat inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);\r\nfloat outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;\r\nmediump float t=1.0-abs(u);\r\nmediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);\r\nvec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);\r\ngl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);\r\nfloat extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);\r\nv_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\r\nv_linesofar=a_linesofar;\r\nv_width2=vec2(outset,inset);\r\n}"),eN=eH("uniform lowp float u_device_pixel_ratio;\r\nuniform sampler2D u_image;\r\nuniform float u_sdfgamma;\r\nuniform float u_mix;\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying vec2 v_tex_a;\r\nvarying vec2 v_tex_b;\r\nvarying float v_gamma_scale;\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define mediump float width\r\n#pragma mapbox: define lowp float floorwidth\r\nvoid main() {\r\n#pragma mapbox: initialize highp vec4 color\r\n#pragma mapbox: initialize lowp float blur\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize mediump float width\r\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;\r\nfloat alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\r\nfloat sdfdist_a=texture2D(u_image,v_tex_a).a;\r\nfloat sdfdist_b=texture2D(u_image,v_tex_b).a;\r\nfloat sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);\r\nalpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);\r\ngl_FragColor=color*(alpha*opacity);\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\r\nattribute vec2 a_pos_normal;\r\nattribute vec4 a_data;\r\nuniform mat4 u_matrix;\r\nuniform mediump float u_ratio;\r\nuniform lowp float u_device_pixel_ratio;\r\nuniform vec2 u_patternscale_a;\r\nuniform float u_tex_y_a;\r\nuniform vec2 u_patternscale_b;\r\nuniform float u_tex_y_b;\r\nuniform vec2 u_units_to_pixels;\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying vec2 v_tex_a;\r\nvarying vec2 v_tex_b;\r\nvarying float v_gamma_scale;\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define mediump float gapwidth\r\n#pragma mapbox: define lowp float offset\r\n#pragma mapbox: define mediump float width\r\n#pragma mapbox: define lowp float floorwidth\r\nvoid main() {\r\n#pragma mapbox: initialize highp vec4 color\r\n#pragma mapbox: initialize lowp float blur\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize mediump float gapwidth\r\n#pragma mapbox: initialize lowp float offset\r\n#pragma mapbox: initialize mediump float width\r\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;\r\nvec2 a_extrude=a_data.xy-128.0;\r\nfloat a_direction=mod(a_data.z,4.0)-1.0;\r\nfloat a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;\r\nvec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;\r\nnormal.y=normal.y*2.0-1.0;\r\nv_normal=normal;gapwidth=gapwidth/2.0;\r\nfloat halfwidth=width/2.0;\r\noffset=-1.0*offset;\r\nfloat inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);\r\nfloat outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;\r\nmediump float t=1.0-abs(u);\r\nmediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);\r\nvec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);\r\ngl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);\r\nfloat extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);\r\nv_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\r\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);\r\nv_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);\r\nv_width2=vec2(outset,inset);\r\n}"),eU=eH("uniform float u_fade_t;\r\nuniform float u_opacity;\r\nuniform sampler2D u_image0;\r\nuniform sampler2D u_image1;\r\nvarying vec2 v_pos0;\r\nvarying vec2 v_pos1;\r\nuniform float u_brightness_low;\r\nuniform float u_brightness_high;\r\nuniform float u_saturation_factor;\r\nuniform float u_contrast_factor;\r\nuniform vec3 u_spin_weights;\r\nvoid main() {vec4 color0=texture2D(u_image0,v_pos0);\r\nvec4 color1=texture2D(u_image1,v_pos1);\r\nif (color0.a > 0.0) {\r\ncolor0.rgb=color0.rgb/color0.a;\r\n}\r\nif (color1.a > 0.0) {\r\ncolor1.rgb=color1.rgb/color1.a;\r\n}\r\nvec4 color=mix(color0,color1,u_fade_t);\r\ncolor.a*=u_opacity;\r\nvec3 rgb=color.rgb;rgb=vec3(\r\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;\r\nrgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);\r\nvec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);\r\ngl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","uniform mat4 u_matrix;\r\nuniform vec2 u_tl_parent;\r\nuniform float u_scale_parent;\r\nuniform float u_buffer_scale;\r\nattribute vec2 a_pos;\r\nattribute vec2 a_texture_pos;\r\nvarying vec2 v_pos0;\r\nvarying vec2 v_pos1;\r\nvoid main() {\r\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;\r\nv_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\r\n}"),eV=eH("uniform sampler2D u_texture;\r\nvarying vec2 v_tex;\r\nvarying float v_fade_opacity;\r\n#pragma mapbox: define lowp float opacity\r\nvoid main() {\r\n#pragma mapbox: initialize lowp float opacity\r\nlowp float alpha=opacity*v_fade_opacity;\r\ngl_FragColor=texture2D(u_texture,v_tex)*alpha;\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","const float PI=3.141592653589793;\r\nattribute vec4 a_pos_offset;\r\nattribute vec4 a_data;\r\nattribute vec4 a_pixeloffset;\r\nattribute vec3 a_projected_pos;\r\nattribute float a_fade_opacity;\r\nuniform bool u_is_size_zoom_constant;\r\nuniform bool u_is_size_feature_constant;\r\nuniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;\r\nuniform highp float u_pitch;\r\nuniform bool u_rotate_symbol;\r\nuniform highp float u_aspect_ratio;\r\nuniform float u_fade_change;\r\nuniform mat4 u_matrix;\r\nuniform mat4 u_label_plane_matrix;\r\nuniform mat4 u_coord_matrix;\r\nuniform bool u_is_text;\r\nuniform bool u_pitch_with_map;\r\nuniform vec2 u_texsize;\r\nvarying vec2 v_tex;\r\nvarying float v_fade_opacity;\r\n#pragma mapbox: define lowp float opacity\r\nvoid main() {\r\n#pragma mapbox: initialize lowp float opacity\r\nvec2 a_pos=a_pos_offset.xy;\r\nvec2 a_offset=a_pos_offset.zw;\r\nvec2 a_tex=a_data.xy;\r\nvec2 a_size=a_data.zw;\r\nfloat a_size_min=floor(a_size[0]*0.5);\r\nvec2 a_pxoffset=a_pixeloffset.xy;\r\nvec2 a_minFontScale=a_pixeloffset.zw/256.0;\r\nhighp float segment_angle=-a_projected_pos[2];\r\nfloat size;\r\nif (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\r\nsize=mix(a_size_min,a_size[1],u_size_t)/128.0;\r\n} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\r\nsize=a_size_min/128.0;\r\n} else {\r\nsize=u_size;\r\n}\r\nvec4 projectedPoint=u_matrix*vec4(a_pos,0,1);\r\nhighp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\r\ncamera_to_anchor_distance/u_camera_to_center_distance :\r\nu_camera_to_center_distance/camera_to_anchor_distance;\r\nhighp float perspective_ratio=clamp(\r\n0.5+0.5*distance_ratio,0.0,4.0);\r\nsize*=perspective_ratio;\r\nfloat fontScale=u_is_text ? size/24.0 : size;\r\nhighp float symbol_rotation=0.0;\r\nif (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);\r\nvec2 a=projectedPoint.xy/projectedPoint.w;\r\nvec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;\r\nsymbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);\r\n}\r\nhighp float angle_sin=sin(segment_angle+symbol_rotation);\r\nhighp float angle_cos=cos(segment_angle+symbol_rotation);\r\nmat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);\r\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\r\ngl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);\r\nv_tex=a_tex/u_texsize;\r\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);\r\nfloat fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;\r\nv_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));\r\n}"),eq=eH("#define SDF_PX 8.0\r\nuniform bool u_is_halo;\r\nuniform sampler2D u_texture;\r\nuniform highp float u_gamma_scale;\r\nuniform lowp float u_device_pixel_ratio;\r\nuniform bool u_is_text;\r\nvarying vec2 v_data0;\r\nvarying vec3 v_data1;\r\n#pragma mapbox: define highp vec4 fill_color\r\n#pragma mapbox: define highp vec4 halo_color\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp float halo_width\r\n#pragma mapbox: define lowp float halo_blur\r\nvoid main() {\r\n#pragma mapbox: initialize highp vec4 fill_color\r\n#pragma mapbox: initialize highp vec4 halo_color\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize lowp float halo_width\r\n#pragma mapbox: initialize lowp float halo_blur\r\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;\r\nvec2 tex=v_data0.xy;\r\nfloat gamma_scale=v_data1.x;\r\nfloat size=v_data1.y;\r\nfloat fade_opacity=v_data1[2];\r\nfloat fontScale=u_is_text ? size/24.0 : size;\r\nlowp vec4 color=fill_color;\r\nhighp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);\r\nlowp float buff=(256.0-64.0)/256.0;\r\nif (u_is_halo) {\r\ncolor=halo_color;\r\ngamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);\r\nbuff=(6.0-halo_width/fontScale)/SDF_PX;\r\n}\r\nlowp float dist=texture2D(u_texture,tex).a;\r\nhighp float gamma_scaled=gamma*gamma_scale;\r\nhighp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);\r\ngl_FragColor=color*(alpha*opacity*fade_opacity);\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","const float PI=3.141592653589793;\r\nattribute vec4 a_pos_offset;\r\nattribute vec4 a_data;\r\nattribute vec4 a_pixeloffset;\r\nattribute vec3 a_projected_pos;\r\nattribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;\r\nuniform bool u_is_size_feature_constant;\r\nuniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;\r\nuniform mat4 u_label_plane_matrix;\r\nuniform mat4 u_coord_matrix;\r\nuniform bool u_is_text;\r\nuniform bool u_pitch_with_map;\r\nuniform highp float u_pitch;\r\nuniform bool u_rotate_symbol;\r\nuniform highp float u_aspect_ratio;\r\nuniform highp float u_camera_to_center_distance;\r\nuniform float u_fade_change;\r\nuniform vec2 u_texsize;\r\nvarying vec2 v_data0;\r\nvarying vec3 v_data1;\r\n#pragma mapbox: define highp vec4 fill_color\r\n#pragma mapbox: define highp vec4 halo_color\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp float halo_width\r\n#pragma mapbox: define lowp float halo_blur\r\nvoid main() {\r\n#pragma mapbox: initialize highp vec4 fill_color\r\n#pragma mapbox: initialize highp vec4 halo_color\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize lowp float halo_width\r\n#pragma mapbox: initialize lowp float halo_blur\r\nvec2 a_pos=a_pos_offset.xy;\r\nvec2 a_offset=a_pos_offset.zw;\r\nvec2 a_tex=a_data.xy;\r\nvec2 a_size=a_data.zw;\r\nfloat a_size_min=floor(a_size[0]*0.5);\r\nvec2 a_pxoffset=a_pixeloffset.xy;\r\nhighp float segment_angle=-a_projected_pos[2];\r\nfloat size;\r\nif (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\r\nsize=mix(a_size_min,a_size[1],u_size_t)/128.0;\r\n} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\r\nsize=a_size_min/128.0;\r\n} else {\r\nsize=u_size;\r\n}\r\nvec4 projectedPoint=u_matrix*vec4(a_pos,0,1);\r\nhighp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\r\ncamera_to_anchor_distance/u_camera_to_center_distance :\r\nu_camera_to_center_distance/camera_to_anchor_distance;\r\nhighp float perspective_ratio=clamp(\r\n0.5+0.5*distance_ratio,0.0,4.0);\r\nsize*=perspective_ratio;\r\nfloat fontScale=u_is_text ? size/24.0 : size;\r\nhighp float symbol_rotation=0.0;\r\nif (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);\r\nvec2 a=projectedPoint.xy/projectedPoint.w;\r\nvec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;\r\nsymbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);\r\n}\r\nhighp float angle_sin=sin(segment_angle+symbol_rotation);\r\nhighp float angle_cos=cos(segment_angle+symbol_rotation);\r\nmat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);\r\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\r\ngl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);\r\nfloat gamma_scale=gl_Position.w;\r\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);\r\nfloat fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;\r\nfloat interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));\r\nv_data0=a_tex/u_texsize;\r\nv_data1=vec3(gamma_scale,size,interpolated_fade_opacity);\r\n}"),ej=eH("#define SDF_PX 8.0\r\n#define SDF 1.0\r\n#define ICON 0.0\r\nuniform bool u_is_halo;\r\nuniform sampler2D u_texture;\r\nuniform sampler2D u_texture_icon;\r\nuniform highp float u_gamma_scale;\r\nuniform lowp float u_device_pixel_ratio;\r\nvarying vec4 v_data0;\r\nvarying vec4 v_data1;\r\n#pragma mapbox: define highp vec4 fill_color\r\n#pragma mapbox: define highp vec4 halo_color\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp float halo_width\r\n#pragma mapbox: define lowp float halo_blur\r\nvoid main() {\r\n#pragma mapbox: initialize highp vec4 fill_color\r\n#pragma mapbox: initialize highp vec4 halo_color\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize lowp float halo_width\r\n#pragma mapbox: initialize lowp float halo_blur\r\nfloat fade_opacity=v_data1[2];\r\nif (v_data1.w==ICON) {\r\nvec2 tex_icon=v_data0.zw;\r\nlowp float alpha=opacity*fade_opacity;\r\ngl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\nreturn;\r\n}\r\nvec2 tex=v_data0.xy;\r\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;\r\nfloat gamma_scale=v_data1.x;\r\nfloat size=v_data1.y;\r\nfloat fontScale=size/24.0;\r\nlowp vec4 color=fill_color;\r\nhighp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);\r\nlowp float buff=(256.0-64.0)/256.0;\r\nif (u_is_halo) {\r\ncolor=halo_color;\r\ngamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);\r\nbuff=(6.0-halo_width/fontScale)/SDF_PX;\r\n}\r\nlowp float dist=texture2D(u_texture,tex).a;\r\nhighp float gamma_scaled=gamma*gamma_scale;\r\nhighp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);\r\ngl_FragColor=color*(alpha*opacity*fade_opacity);\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}","const float PI=3.141592653589793;\r\nattribute vec4 a_pos_offset;\r\nattribute vec4 a_data;\r\nattribute vec3 a_projected_pos;\r\nattribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;\r\nuniform bool u_is_size_feature_constant;\r\nuniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;\r\nuniform mat4 u_label_plane_matrix;\r\nuniform mat4 u_coord_matrix;\r\nuniform bool u_is_text;\r\nuniform bool u_pitch_with_map;\r\nuniform highp float u_pitch;\r\nuniform bool u_rotate_symbol;\r\nuniform highp float u_aspect_ratio;\r\nuniform highp float u_camera_to_center_distance;\r\nuniform float u_fade_change;\r\nuniform vec2 u_texsize;\r\nuniform vec2 u_texsize_icon;\r\nvarying vec4 v_data0;\r\nvarying vec4 v_data1;\r\n#pragma mapbox: define highp vec4 fill_color\r\n#pragma mapbox: define highp vec4 halo_color\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp float halo_width\r\n#pragma mapbox: define lowp float halo_blur\r\nvoid main() {\r\n#pragma mapbox: initialize highp vec4 fill_color\r\n#pragma mapbox: initialize highp vec4 halo_color\r\n#pragma mapbox: initialize lowp float opacity\r\n#pragma mapbox: initialize lowp float halo_width\r\n#pragma mapbox: initialize lowp float halo_blur\r\nvec2 a_pos=a_pos_offset.xy;\r\nvec2 a_offset=a_pos_offset.zw;\r\nvec2 a_tex=a_data.xy;\r\nvec2 a_size=a_data.zw;\r\nfloat a_size_min=floor(a_size[0]*0.5);\r\nfloat is_sdf=a_size[0]-2.0*a_size_min;\r\nhighp float segment_angle=-a_projected_pos[2];\r\nfloat size;\r\nif (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\r\nsize=mix(a_size_min,a_size[1],u_size_t)/128.0;\r\n} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\r\nsize=a_size_min/128.0;\r\n} else {\r\nsize=u_size;\r\n}\r\nvec4 projectedPoint=u_matrix*vec4(a_pos,0,1);\r\nhighp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\r\ncamera_to_anchor_distance/u_camera_to_center_distance :\r\nu_camera_to_center_distance/camera_to_anchor_distance;\r\nhighp float perspective_ratio=clamp(\r\n0.5+0.5*distance_ratio,0.0,4.0);\r\nsize*=perspective_ratio;\r\nfloat fontScale=size/24.0;\r\nhighp float symbol_rotation=0.0;\r\nif (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);\r\nvec2 a=projectedPoint.xy/projectedPoint.w;\r\nvec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;\r\nsymbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);\r\n}\r\nhighp float angle_sin=sin(segment_angle+symbol_rotation);\r\nhighp float angle_cos=cos(segment_angle+symbol_rotation);\r\nmat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);\r\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\r\ngl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);\r\nfloat gamma_scale=gl_Position.w;\r\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);\r\nfloat fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;\r\nfloat interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));\r\nv_data0.xy=a_tex/u_texsize;\r\nv_data0.zw=a_tex/u_texsize_icon;\r\nv_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);\r\n}");function eH(r,n){var i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,o={};return{fragmentSource:r=r.replace(i,function(r,n,i,a,s){return o[s]=!0,"define"===n?"\n#ifndef HAS_UNIFORM_u_"+s+"\nvarying "+i+" "+a+" "+s+";\n#else\nuniform "+i+" "+a+" u_"+s+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+s+"\n    "+i+" "+a+" "+s+" = u_"+s+";\n#endif\n"}),vertexSource:n=n.replace(i,function(r,n,i,a,s){var u="float"===a?"vec2":"vec4",c=s.match(/color/)?"color":u;return o[s]?"define"===n?"\n#ifndef HAS_UNIFORM_u_"+s+"\nuniform lowp float u_"+s+"_t;\nattribute "+i+" "+u+" a_"+s+";\nvarying "+i+" "+a+" "+s+";\n#else\nuniform "+i+" "+a+" u_"+s+";\n#endif\n":"vec4"===c?"\n#ifndef HAS_UNIFORM_u_"+s+"\n    "+s+" = a_"+s+";\n#else\n    "+i+" "+a+" "+s+" = u_"+s+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+s+"\n    "+s+" = unpack_mix_"+c+"(a_"+s+", u_"+s+"_t);\n#else\n    "+i+" "+a+" "+s+" = u_"+s+";\n#endif\n":"define"===n?"\n#ifndef HAS_UNIFORM_u_"+s+"\nuniform lowp float u_"+s+"_t;\nattribute "+i+" "+u+" a_"+s+";\n#else\nuniform "+i+" "+a+" u_"+s+";\n#endif\n":"vec4"===c?"\n#ifndef HAS_UNIFORM_u_"+s+"\n    "+i+" "+a+" "+s+" = a_"+s+";\n#else\n    "+i+" "+a+" "+s+" = u_"+s+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+s+"\n    "+i+" "+a+" "+s+" = unpack_mix_"+c+"(a_"+s+", u_"+s+"_t);\n#else\n    "+i+" "+a+" "+s+" = u_"+s+";\n#endif\n"})}}var eG=Object.freeze({__proto__:null,prelude:eS,background:eC,backgroundPattern:eI,circle:ek,clippingMask:e1,heatmap:e2,heatmapTexture:eA,collisionBox:eP,collisionCircle:eL,debug:eD,fill:ez,fillOutline:e3,fillOutlinePattern:e4,fillPattern:eM,fillExtrusion:eR,fillExtrusionPattern:eB,hillshadePrepare:eF,hillshade:eO,line:e6,lineGradient:e7,linePattern:e5,lineSDF:eN,raster:eU,symbolIcon:eV,symbolSDF:eq,symbolTextAndIcon:ej}),eZ=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};eZ.prototype.bind=function(r,n,i,o,a,s,u,c){this.context=r;for(var p=this.boundPaintVertexBuffers.length!==o.length,h=0;!p&&h<o.length;h++)this.boundPaintVertexBuffers[h]!==o[h]&&(p=!0);var d=!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==i||p||this.boundIndexBuffer!==a||this.boundVertexOffset!==s||this.boundDynamicVertexBuffer!==u||this.boundDynamicVertexBuffer2!==c;!r.extVertexArrayObject||d?this.freshBind(n,i,o,a,s,u,c):(r.bindVertexArrayOES.set(this.vao),u&&u.bind(),a&&a.dynamicDraw&&a.bind(),c&&c.bind())},eZ.prototype.freshBind=function(r,n,i,o,a,s,u){var c,p=r.numAttributes,h=this.context,d=h.gl;if(h.extVertexArrayObject)this.vao&&this.destroy(),this.vao=h.extVertexArrayObject.createVertexArrayOES(),h.bindVertexArrayOES.set(this.vao),c=0,this.boundProgram=r,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=o,this.boundVertexOffset=a,this.boundDynamicVertexBuffer=s,this.boundDynamicVertexBuffer2=u;else{c=h.currentNumAttributes||0;for(var f=p;f<c;f++)d.disableVertexAttribArray(f)}n.enableAttributes(d,r);for(var m=0,y=i;m<y.length;m+=1)y[m].enableAttributes(d,r);s&&s.enableAttributes(d,r),u&&u.enableAttributes(d,r),n.bind(),n.setVertexAttribPointers(d,r,a);for(var v=0,g=i;v<g.length;v+=1){var $=g[v];$.bind(),$.setVertexAttribPointers(d,r,a)}s&&(s.bind(),s.setVertexAttribPointers(d,r,a)),o&&o.bind(),u&&(u.bind(),u.setVertexAttribPointers(d,r,a)),h.currentNumAttributes=p},eZ.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var eW=function(r,n,i,o,a){var s=r.gl;this.program=s.createProgram();var u=i.defines();a&&u.push("#define OVERDRAW_INSPECTOR;");var c=u.concat(eS.fragmentSource,n.fragmentSource).join("\n"),p=u.concat(eS.vertexSource,n.vertexSource).join("\n"),h=s.createShader(s.FRAGMENT_SHADER);if(s.isContextLost())this.failedToCreate=!0;else{s.shaderSource(h,c),s.compileShader(h),s.attachShader(this.program,h);var d=s.createShader(s.VERTEX_SHADER);if(s.isContextLost())this.failedToCreate=!0;else{s.shaderSource(d,p),s.compileShader(d),s.attachShader(this.program,d);for(var f=i.layoutAttributes||[],m=0;m<f.length;m++)s.bindAttribLocation(this.program,m,f[m].name);s.linkProgram(this.program),this.numAttributes=s.getProgramParameter(this.program,s.ACTIVE_ATTRIBUTES),this.attributes={};for(var y={},v=0;v<this.numAttributes;v++){var g=s.getActiveAttrib(this.program,v);g&&(this.attributes[g.name]=s.getAttribLocation(this.program,g.name))}for(var $=s.getProgramParameter(this.program,s.ACTIVE_UNIFORMS),_=0;_<$;_++){var x=s.getActiveUniform(this.program,_);x&&(y[x.name]=s.getUniformLocation(this.program,x.name))}this.fixedUniforms=o(r,y),this.binderUniforms=i.getUniforms(r,y)}}};function eX(n,i,o){var a=1/en(o,1,i.transform.tileZoom),s=Math.pow(2,o.tileID.overscaledZ),u=o.tileSize*Math.pow(2,i.transform.tileZoom)/s,c=u*(o.tileID.canonical.x+o.tileID.wrap*s),p=u*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[r.browser.devicePixelRatio,a,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[c>>16,p>>16],u_pixel_coord_lower:[65535&c,65535&p]}}eW.prototype.draw=function(r,n,i,o,a,s,u,c,p,h,d,f,m,y,v,g){var $,_=r.gl;if(!this.failedToCreate){for(var x in r.program.set(this.program),r.setDepthMode(i),r.setStencilMode(o),r.setColorMode(a),r.setCullFace(s),this.fixedUniforms)this.fixedUniforms[x].set(u[x]);y&&y.setUniforms(r,this.binderUniforms,f,{zoom:m});for(var b=(($={})[_.LINES]=2,$[_.TRIANGLES]=3,$[_.LINE_STRIP]=1,$)[n],w=0,E=d.get();w<E.length;w+=1){var T=E[w],S=T.vaos||(T.vaos={});(S[c]||(S[c]=new eZ)).bind(r,this,p,y?y.getPaintVertexBuffers():[],h,T.vertexOffset,v,g),_.drawElements(n,T.primitiveLength*b,_.UNSIGNED_SHORT,T.primitiveOffset*b*2)}}};var eK=function(n,i,o,a){var s=i.style.light,u=s.properties.get("position"),c=[u.x,u.y,u.z],p=r.create$1();"viewport"===s.properties.get("anchor")&&r.fromRotation(p,-i.transform.angle),r.transformMat3(c,c,p);var h=s.properties.get("color");return{u_matrix:n,u_lightpos:c,u_lightintensity:s.properties.get("intensity"),u_lightcolor:[h.r,h.g,h.b],u_vertical_gradient:+o,u_opacity:a}},eY=function(r){return{u_matrix:r}},eJ=function(n,i,o,a){return r.extend(eY(n),eX(o,i,a))},eQ=function(n,i,o,a){var s,u,c=n.transform;if("map"===a.paint.get("circle-pitch-alignment")){var p=en(o,1,c.zoom);s=!0,u=[p,p]}else s=!1,u=c.pixelsToGLUnits;return{u_camera_to_center_distance:c.cameraToCenterDistance,u_scale_with_map:+("map"===a.paint.get("circle-pitch-scale")),u_matrix:n.translatePosMatrix(i.posMatrix,o,a.paint.get("circle-translate"),a.paint.get("circle-translate-anchor")),u_pitch_with_map:+s,u_device_pixel_ratio:r.browser.devicePixelRatio,u_extrude_scale:u}},e9=function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_camera_to_center_distance:new r.Uniform1f(n,i.u_camera_to_center_distance),u_pixels_to_tile_units:new r.Uniform1f(n,i.u_pixels_to_tile_units),u_extrude_scale:new r.Uniform2f(n,i.u_extrude_scale),u_overscale_factor:new r.Uniform1f(n,i.u_overscale_factor)}},rt=function(r,n,i){var o=en(i,1,n.zoom),a=Math.pow(2,n.zoom-i.tileID.overscaledZ),s=i.tileID.overscaleFactor();return{u_matrix:r,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:o,u_extrude_scale:[n.pixelsToGLUnits[0]/(o*a),n.pixelsToGLUnits[1]/(o*a)],u_overscale_factor:s}},re=function(r,n){return{u_matrix:r,u_color:n}},rr=function(r){return{u_matrix:r}},rn=function(n,i,o,a){var s=r.create();r.ortho(s,0,n.width,n.height,0,0,1);var u=n.context.gl;return{u_matrix:s,u_world:[u.drawingBufferWidth,u.drawingBufferHeight],u_image:o,u_color_ramp:a,u_opacity:i.paint.get("heatmap-opacity")}},ri=function(n,i,o){var a=o.paint.get("hillshade-shadow-color"),s=o.paint.get("hillshade-highlight-color"),u=o.paint.get("hillshade-accent-color"),c=o.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===o.paint.get("hillshade-illumination-anchor")&&(c-=n.transform.angle);var p,h,d,f,m=!n.options.moving;return{u_matrix:n.transform.calculatePosMatrix(i.tileID.toUnwrapped(),m),u_image:0,u_latrange:(p=n,h=i.tileID,d=Math.pow(2,h.canonical.z),f=h.canonical.y,[new r.MercatorCoordinate(0,f/d).toLngLat().lat,new r.MercatorCoordinate(0,(f+1)/d).toLngLat().lat]),u_light:[o.paint.get("hillshade-exaggeration"),c],u_shadow:a,u_highlight:s,u_accent:u}},ro=function(n,i,o){var a=i.stride,s=r.create();return r.ortho(s,0,r.EXTENT,-r.EXTENT,0,0,1),r.translate(s,s,[0,-r.EXTENT,0]),{u_matrix:s,u_image:1,u_dimension:[a,a],u_zoom:n.overscaledZ,u_maxzoom:o,u_unpack:i.getUnpackVector()}},ra=function(n,i,o){var a=n.transform;return{u_matrix:rc(n,i,o),u_ratio:1/en(i,1,a.zoom),u_device_pixel_ratio:r.browser.devicePixelRatio,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},rs=function(n,i,o,a){var s=n.transform,u=ru(i,s);return{u_matrix:rc(n,i,o),u_texsize:i.imageAtlasTexture.size,u_ratio:1/en(i,1,s.zoom),u_device_pixel_ratio:r.browser.devicePixelRatio,u_image:0,u_scale:[r.browser.devicePixelRatio,u,a.fromScale,a.toScale],u_fade:a.t,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]]}},rl=function(n,i,o,a,s){var u=n.transform,c=n.lineAtlas,p=ru(i,u),h="round"===o.layout.get("line-cap"),d=c.getDash(a.from,h),f=c.getDash(a.to,h),m=d.width*s.fromScale,y=f.width*s.toScale;return r.extend(ra(n,i,o),{u_patternscale_a:[p/m,-d.height/2],u_patternscale_b:[p/y,-f.height/2],u_sdfgamma:c.width/(256*Math.min(m,y)*r.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:d.y,u_tex_y_b:f.y,u_mix:s.t})};function ru(r,n){return 1/en(r,1,n.tileZoom)}function rc(r,n,i){return r.translatePosMatrix(n.tileID.posMatrix,n,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}var rp=function(r,n,i,o,a){var s,u,c,p,h;return{u_matrix:r,u_tl_parent:n,u_scale_parent:i,u_buffer_scale:1,u_fade_t:o.mix,u_opacity:o.opacity*a.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:a.paint.get("raster-brightness-min"),u_brightness_high:a.paint.get("raster-brightness-max"),u_saturation_factor:(u=a.paint.get("raster-saturation"))>0?1-1/(1.001-u):-u,u_contrast_factor:(s=a.paint.get("raster-contrast"))>0?1/(1-s):1+s,u_spin_weights:(c=a.paint.get("raster-hue-rotate"),p=Math.sin(c*=Math.PI/180),h=Math.cos(c),[(2*h+1)/3,(-Math.sqrt(3)*p-h+1)/3,(Math.sqrt(3)*p-h+1)/3])}},rh=function(r,n,i,o,a,s,u,c,p,h){var d=a.transform;return{u_is_size_zoom_constant:+("constant"===r||"source"===r),u_is_size_feature_constant:+("constant"===r||"camera"===r),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:d.cameraToCenterDistance,u_pitch:d.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:d.width/d.height,u_fade_change:a.options.fadeDuration?a.symbolFadeChange:1,u_matrix:s,u_label_plane_matrix:u,u_coord_matrix:c,u_is_text:+p,u_pitch_with_map:+o,u_texsize:h,u_texture:0}},rd=function(n,i,o,a,s,u,c,p,h,d,f){var m=s.transform;return r.extend(rh(n,i,o,a,s,u,c,p,h,d),{u_gamma_scale:a?Math.cos(m._pitch)*m.cameraToCenterDistance:1,u_device_pixel_ratio:r.browser.devicePixelRatio,u_is_halo:+f})},rf=function(n,i,o,a,s,u){var c,p,h,d,f,m,y,v,g,$,_,x,b;return r.extend((c=a,p=u,h=o,d=s,f=h.imageManager.getPattern(c.from.toString()),m=h.imageManager.getPattern(c.to.toString()),v=(y=h.imageManager.getPixelSize()).width,g=y.height,$=Math.pow(2,d.tileID.overscaledZ),x=(_=d.tileSize*Math.pow(2,h.transform.tileZoom)/$)*(d.tileID.canonical.x+d.tileID.wrap*$),b=_*d.tileID.canonical.y,{u_image:0,u_pattern_tl_a:f.tl,u_pattern_br_a:f.br,u_pattern_tl_b:m.tl,u_pattern_br_b:m.br,u_texsize:[v,g],u_mix:p.t,u_pattern_size_a:f.displaySize,u_pattern_size_b:m.displaySize,u_scale_a:p.fromScale,u_scale_b:p.toScale,u_tile_units_to_pixels:1/en(d,1,h.transform.tileZoom),u_pixel_coord_upper:[x>>16,b>>16],u_pixel_coord_lower:[65535&x,65535&b]}),{u_matrix:n,u_opacity:i})},rm={fillExtrusion:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_lightpos:new r.Uniform3f(n,i.u_lightpos),u_lightintensity:new r.Uniform1f(n,i.u_lightintensity),u_lightcolor:new r.Uniform3f(n,i.u_lightcolor),u_vertical_gradient:new r.Uniform1f(n,i.u_vertical_gradient),u_opacity:new r.Uniform1f(n,i.u_opacity)}},fillExtrusionPattern:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_lightpos:new r.Uniform3f(n,i.u_lightpos),u_lightintensity:new r.Uniform1f(n,i.u_lightintensity),u_lightcolor:new r.Uniform3f(n,i.u_lightcolor),u_vertical_gradient:new r.Uniform1f(n,i.u_vertical_gradient),u_height_factor:new r.Uniform1f(n,i.u_height_factor),u_image:new r.Uniform1i(n,i.u_image),u_texsize:new r.Uniform2f(n,i.u_texsize),u_pixel_coord_upper:new r.Uniform2f(n,i.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(n,i.u_pixel_coord_lower),u_scale:new r.Uniform4f(n,i.u_scale),u_fade:new r.Uniform1f(n,i.u_fade),u_opacity:new r.Uniform1f(n,i.u_opacity)}},fill:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix)}},fillPattern:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_image:new r.Uniform1i(n,i.u_image),u_texsize:new r.Uniform2f(n,i.u_texsize),u_pixel_coord_upper:new r.Uniform2f(n,i.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(n,i.u_pixel_coord_lower),u_scale:new r.Uniform4f(n,i.u_scale),u_fade:new r.Uniform1f(n,i.u_fade)}},fillOutline:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_world:new r.Uniform2f(n,i.u_world)}},fillOutlinePattern:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_world:new r.Uniform2f(n,i.u_world),u_image:new r.Uniform1i(n,i.u_image),u_texsize:new r.Uniform2f(n,i.u_texsize),u_pixel_coord_upper:new r.Uniform2f(n,i.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(n,i.u_pixel_coord_lower),u_scale:new r.Uniform4f(n,i.u_scale),u_fade:new r.Uniform1f(n,i.u_fade)}},circle:function(n,i){return{u_camera_to_center_distance:new r.Uniform1f(n,i.u_camera_to_center_distance),u_scale_with_map:new r.Uniform1i(n,i.u_scale_with_map),u_pitch_with_map:new r.Uniform1i(n,i.u_pitch_with_map),u_extrude_scale:new r.Uniform2f(n,i.u_extrude_scale),u_device_pixel_ratio:new r.Uniform1f(n,i.u_device_pixel_ratio),u_matrix:new r.UniformMatrix4f(n,i.u_matrix)}},collisionBox:e9,collisionCircle:e9,debug:function(n,i){return{u_color:new r.UniformColor(n,i.u_color),u_matrix:new r.UniformMatrix4f(n,i.u_matrix)}},clippingMask:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix)}},heatmap:function(n,i){return{u_extrude_scale:new r.Uniform1f(n,i.u_extrude_scale),u_intensity:new r.Uniform1f(n,i.u_intensity),u_matrix:new r.UniformMatrix4f(n,i.u_matrix)}},heatmapTexture:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_world:new r.Uniform2f(n,i.u_world),u_image:new r.Uniform1i(n,i.u_image),u_color_ramp:new r.Uniform1i(n,i.u_color_ramp),u_opacity:new r.Uniform1f(n,i.u_opacity)}},hillshade:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_image:new r.Uniform1i(n,i.u_image),u_latrange:new r.Uniform2f(n,i.u_latrange),u_light:new r.Uniform2f(n,i.u_light),u_shadow:new r.UniformColor(n,i.u_shadow),u_highlight:new r.UniformColor(n,i.u_highlight),u_accent:new r.UniformColor(n,i.u_accent)}},hillshadePrepare:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_image:new r.Uniform1i(n,i.u_image),u_dimension:new r.Uniform2f(n,i.u_dimension),u_zoom:new r.Uniform1f(n,i.u_zoom),u_maxzoom:new r.Uniform1f(n,i.u_maxzoom),u_unpack:new r.Uniform4f(n,i.u_unpack)}},line:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_ratio:new r.Uniform1f(n,i.u_ratio),u_device_pixel_ratio:new r.Uniform1f(n,i.u_device_pixel_ratio),u_units_to_pixels:new r.Uniform2f(n,i.u_units_to_pixels)}},lineGradient:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_ratio:new r.Uniform1f(n,i.u_ratio),u_device_pixel_ratio:new r.Uniform1f(n,i.u_device_pixel_ratio),u_units_to_pixels:new r.Uniform2f(n,i.u_units_to_pixels),u_image:new r.Uniform1i(n,i.u_image)}},linePattern:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_texsize:new r.Uniform2f(n,i.u_texsize),u_ratio:new r.Uniform1f(n,i.u_ratio),u_device_pixel_ratio:new r.Uniform1f(n,i.u_device_pixel_ratio),u_image:new r.Uniform1i(n,i.u_image),u_units_to_pixels:new r.Uniform2f(n,i.u_units_to_pixels),u_scale:new r.Uniform4f(n,i.u_scale),u_fade:new r.Uniform1f(n,i.u_fade)}},lineSDF:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_ratio:new r.Uniform1f(n,i.u_ratio),u_device_pixel_ratio:new r.Uniform1f(n,i.u_device_pixel_ratio),u_units_to_pixels:new r.Uniform2f(n,i.u_units_to_pixels),u_patternscale_a:new r.Uniform2f(n,i.u_patternscale_a),u_patternscale_b:new r.Uniform2f(n,i.u_patternscale_b),u_sdfgamma:new r.Uniform1f(n,i.u_sdfgamma),u_image:new r.Uniform1i(n,i.u_image),u_tex_y_a:new r.Uniform1f(n,i.u_tex_y_a),u_tex_y_b:new r.Uniform1f(n,i.u_tex_y_b),u_mix:new r.Uniform1f(n,i.u_mix)}},raster:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_tl_parent:new r.Uniform2f(n,i.u_tl_parent),u_scale_parent:new r.Uniform1f(n,i.u_scale_parent),u_buffer_scale:new r.Uniform1f(n,i.u_buffer_scale),u_fade_t:new r.Uniform1f(n,i.u_fade_t),u_opacity:new r.Uniform1f(n,i.u_opacity),u_image0:new r.Uniform1i(n,i.u_image0),u_image1:new r.Uniform1i(n,i.u_image1),u_brightness_low:new r.Uniform1f(n,i.u_brightness_low),u_brightness_high:new r.Uniform1f(n,i.u_brightness_high),u_saturation_factor:new r.Uniform1f(n,i.u_saturation_factor),u_contrast_factor:new r.Uniform1f(n,i.u_contrast_factor),u_spin_weights:new r.Uniform3f(n,i.u_spin_weights)}},symbolIcon:function(n,i){return{u_is_size_zoom_constant:new r.Uniform1i(n,i.u_is_size_zoom_constant),u_is_size_feature_constant:new r.Uniform1i(n,i.u_is_size_feature_constant),u_size_t:new r.Uniform1f(n,i.u_size_t),u_size:new r.Uniform1f(n,i.u_size),u_camera_to_center_distance:new r.Uniform1f(n,i.u_camera_to_center_distance),u_pitch:new r.Uniform1f(n,i.u_pitch),u_rotate_symbol:new r.Uniform1i(n,i.u_rotate_symbol),u_aspect_ratio:new r.Uniform1f(n,i.u_aspect_ratio),u_fade_change:new r.Uniform1f(n,i.u_fade_change),u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_label_plane_matrix:new r.UniformMatrix4f(n,i.u_label_plane_matrix),u_coord_matrix:new r.UniformMatrix4f(n,i.u_coord_matrix),u_is_text:new r.Uniform1f(n,i.u_is_text),u_pitch_with_map:new r.Uniform1i(n,i.u_pitch_with_map),u_texsize:new r.Uniform2f(n,i.u_texsize),u_texture:new r.Uniform1i(n,i.u_texture)}},symbolSDF:function(n,i){return{u_is_size_zoom_constant:new r.Uniform1i(n,i.u_is_size_zoom_constant),u_is_size_feature_constant:new r.Uniform1i(n,i.u_is_size_feature_constant),u_size_t:new r.Uniform1f(n,i.u_size_t),u_size:new r.Uniform1f(n,i.u_size),u_camera_to_center_distance:new r.Uniform1f(n,i.u_camera_to_center_distance),u_pitch:new r.Uniform1f(n,i.u_pitch),u_rotate_symbol:new r.Uniform1i(n,i.u_rotate_symbol),u_aspect_ratio:new r.Uniform1f(n,i.u_aspect_ratio),u_fade_change:new r.Uniform1f(n,i.u_fade_change),u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_label_plane_matrix:new r.UniformMatrix4f(n,i.u_label_plane_matrix),u_coord_matrix:new r.UniformMatrix4f(n,i.u_coord_matrix),u_is_text:new r.Uniform1f(n,i.u_is_text),u_pitch_with_map:new r.Uniform1i(n,i.u_pitch_with_map),u_texsize:new r.Uniform2f(n,i.u_texsize),u_texture:new r.Uniform1i(n,i.u_texture),u_gamma_scale:new r.Uniform1f(n,i.u_gamma_scale),u_device_pixel_ratio:new r.Uniform1f(n,i.u_device_pixel_ratio),u_is_halo:new r.Uniform1f(n,i.u_is_halo)}},symbolTextAndIcon:function(n,i){return{u_is_size_zoom_constant:new r.Uniform1i(n,i.u_is_size_zoom_constant),u_is_size_feature_constant:new r.Uniform1i(n,i.u_is_size_feature_constant),u_size_t:new r.Uniform1f(n,i.u_size_t),u_size:new r.Uniform1f(n,i.u_size),u_camera_to_center_distance:new r.Uniform1f(n,i.u_camera_to_center_distance),u_pitch:new r.Uniform1f(n,i.u_pitch),u_rotate_symbol:new r.Uniform1i(n,i.u_rotate_symbol),u_aspect_ratio:new r.Uniform1f(n,i.u_aspect_ratio),u_fade_change:new r.Uniform1f(n,i.u_fade_change),u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_label_plane_matrix:new r.UniformMatrix4f(n,i.u_label_plane_matrix),u_coord_matrix:new r.UniformMatrix4f(n,i.u_coord_matrix),u_is_text:new r.Uniform1f(n,i.u_is_text),u_pitch_with_map:new r.Uniform1i(n,i.u_pitch_with_map),u_texsize:new r.Uniform2f(n,i.u_texsize),u_texsize_icon:new r.Uniform2f(n,i.u_texsize_icon),u_texture:new r.Uniform1i(n,i.u_texture),u_texture_icon:new r.Uniform1i(n,i.u_texture_icon),u_gamma_scale:new r.Uniform1f(n,i.u_gamma_scale),u_device_pixel_ratio:new r.Uniform1f(n,i.u_device_pixel_ratio),u_is_halo:new r.Uniform1f(n,i.u_is_halo)}},background:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_opacity:new r.Uniform1f(n,i.u_opacity),u_color:new r.UniformColor(n,i.u_color)}},backgroundPattern:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_opacity:new r.Uniform1f(n,i.u_opacity),u_image:new r.Uniform1i(n,i.u_image),u_pattern_tl_a:new r.Uniform2f(n,i.u_pattern_tl_a),u_pattern_br_a:new r.Uniform2f(n,i.u_pattern_br_a),u_pattern_tl_b:new r.Uniform2f(n,i.u_pattern_tl_b),u_pattern_br_b:new r.Uniform2f(n,i.u_pattern_br_b),u_texsize:new r.Uniform2f(n,i.u_texsize),u_mix:new r.Uniform1f(n,i.u_mix),u_pattern_size_a:new r.Uniform2f(n,i.u_pattern_size_a),u_pattern_size_b:new r.Uniform2f(n,i.u_pattern_size_b),u_scale_a:new r.Uniform1f(n,i.u_scale_a),u_scale_b:new r.Uniform1f(n,i.u_scale_b),u_pixel_coord_upper:new r.Uniform2f(n,i.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(n,i.u_pixel_coord_lower),u_tile_units_to_pixels:new r.Uniform1f(n,i.u_tile_units_to_pixels)}}};function ry(r,n,i,o,a,s,u,c){for(var p=r.context,h=p.gl,d=a?r.useProgram("collisionCircle"):r.useProgram("collisionBox"),f=0;f<o.length;f++){var m=o[f],y=n.getTile(m),v=y.getBucket(i);if(v){var g=a?c?v.textCollisionCircle:v.iconCollisionCircle:c?v.textCollisionBox:v.iconCollisionBox;if(g){var $=m.posMatrix;0===s[0]&&0===s[1]||($=r.translatePosMatrix(m.posMatrix,y,s,u)),d.draw(p,a?h.TRIANGLES:h.LINES,tC.disabled,tI.disabled,r.colorModeForRenderPass(),t1.disabled,rt($,r.transform,y),i.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,null,r.transform.zoom,null,null,g.collisionVertexBuffer)}}}}function rv(r,n,i,o,a,s,u){ry(r,n,i,o,!1,a,s,u),ry(r,n,i,o,!0,a,s,u)}var rg=r.identity(new Float32Array(16));function r8(n,i,o,a,s,u){var c=r.getAnchorAlignment(n),p=-(c.horizontalAlign-.5)*i,h=-(c.verticalAlign-.5)*o,d=r.evaluateVariableOffset(n,a);return new r.Point((p/s+d[0])*u,(h/s+d[1])*u)}function r$(n,i,o,a,s,u,c,p,h,d,f){var m=n.text.placedSymbolArray,y=n.text.dynamicLayoutVertexArray,v=n.icon.dynamicLayoutVertexArray,g={};y.clear();for(var $=0;$<m.length;$++){var _=m.get($),x=n.allowVerticalPlacement&&!_.placedOrientation,b=_.hidden||!_.crossTileID||x?null:a[_.crossTileID];if(b){var w=new r.Point(_.anchorX,_.anchorY),E=tH(w,o?p:c),T=.5+u.cameraToCenterDistance/E.signedDistanceFromCamera*.5,S=s.evaluateSizeForFeature(n.textSizeData,d,_)*T/r.ONE_EM;o&&(S*=n.tilePixelRatio/h);for(var C=b.width,I=b.height,k=r8(b.anchor,C,I,b.textOffset,b.textBoxScale,S),A=o?tH(w.add(k),c).point:E.point.add(i?k.rotate(-u.angle):k),P=n.allowVerticalPlacement&&_.placedOrientation===r.WritingMode.vertical?Math.PI/2:0,L=0;L<_.numGlyphs;L++)r.addDynamicAttributes(y,A,P);f&&_.associatedIconIndex>=0&&(g[_.associatedIconIndex]={shiftedAnchor:A,angle:P})}else t9(_.numGlyphs,y)}if(f){v.clear();for(var D=n.icon.placedSymbolArray,z=0;z<D.length;z++){var M=D.get(z);if(M.hidden)t9(M.numGlyphs,v);else{var R=g[z];if(R)for(var B=0;B<M.numGlyphs;B++)r.addDynamicAttributes(v,R.shiftedAnchor,R.angle);else t9(M.numGlyphs,v)}}n.icon.dynamicLayoutVertexBuffer.updateData(v)}n.text.dynamicLayoutVertexBuffer.updateData(y)}function r_(r,n,i){return i.iconsInText&&n?"symbolTextAndIcon":r?"symbolSDF":"symbolIcon"}function rx(n,i,o,a,s,u,c,p,h,d,f,m){for(var y,v,g=n.context,$=g.gl,_=n.transform,x="map"===p,b="map"===h,w=x&&"point"!==o.layout.get("symbol-placement"),E=x&&!b&&!w,T=void 0!==o.layout.get("symbol-sort-key").constantOr(1),S=n.depthModeForSublayer(0,tC.ReadOnly),C=o.layout.get("text-variable-anchor"),I=[],k=0,A=a;k<A.length;k+=1){var P=A[k],L=i.getTile(P),D=L.getBucket(o);if(D){var z=s?D.text:D.icon;if(z&&z.segments.get().length){var M=z.programConfigurations.get(o.id),R=s||D.sdfIcons,B=s?D.textSizeData:D.iconSizeData,F=b||0!==_.pitch;y||(y=n.useProgram(r_(R,s,D),M),v=r.evaluateSizeForZoom(B,_.zoom));var O=void 0,N=[0,0],U=void 0,V=void 0,q=null,j=void 0;if(s){if(U=L.glyphAtlasTexture,V=$.LINEAR,O=L.glyphAtlasTexture.size,D.iconsInText){N=L.imageAtlasTexture.size,q=L.imageAtlasTexture;var H="composite"===B.kind||"camera"===B.kind;j=F||n.options.rotating||n.options.zooming||H?$.LINEAR:$.NEAREST}}else{var G=1!==o.layout.get("icon-size").constantOr(0)||D.iconsNeedLinear;U=L.imageAtlasTexture,V=R||n.options.rotating||n.options.zooming||G||F?$.LINEAR:$.NEAREST,O=L.imageAtlasTexture.size}var Z,W,X,K,Y,J,Q,tt,te,tr,tn=en(L,1,n.transform.zoom),ti=tq(P.posMatrix,b,x,n.transform,tn),to=tj(P.posMatrix,b,x,n.transform,tn),ta=C&&D.hasTextData(),ts="none"!==o.layout.get("icon-text-fit")&&ta&&D.hasIconData();w&&tZ(D,P.posMatrix,n,s,ti,to,b,d);var tl=n.translatePosMatrix(P.posMatrix,L,u,c),tu=w||s&&C||ts?rg:ti,tc=n.translatePosMatrix(to,L,u,c,!0),tp=R&&0!==o.paint.get(s?"text-halo-width":"icon-halo-width").constantOr(1),th={program:y,buffers:z,uniformValues:R?D.iconsInText?(Z=B.kind,W=v,X=E,K=b,Y=n,J=tl,Q=tu,tt=tc,te=O,tr=N,r.extend(rd(Z,W,X,K,Y,J,Q,tt,!0,te,!0),{u_texsize_icon:tr,u_texture_icon:1})):rd(B.kind,v,E,b,n,tl,tu,tc,s,O,!0):rh(B.kind,v,E,b,n,tl,tu,tc,s,O),atlasTexture:U,atlasTextureIcon:q,atlasInterpolation:V,atlasInterpolationIcon:j,isSDF:R,hasHalo:tp};if(T)for(var td=0,tf=z.segments.get();td<tf.length;td+=1){var tm=tf[td];I.push({segments:new r.SegmentVector([tm]),sortKey:tm.sortKey,state:th})}else I.push({segments:z.segments,sortKey:0,state:th})}}}T&&I.sort(function(r,n){return r.sortKey-n.sortKey});for(var ty=0,tv=I;ty<tv.length;ty+=1){var tg=tv[ty],t8=tg.state;if(g.activeTexture.set($.TEXTURE0),t8.atlasTexture.bind(t8.atlasInterpolation,$.CLAMP_TO_EDGE),t8.atlasTextureIcon&&(g.activeTexture.set($.TEXTURE1),t8.atlasTextureIcon&&t8.atlasTextureIcon.bind(t8.atlasInterpolationIcon,$.CLAMP_TO_EDGE)),t8.isSDF){var t$=t8.uniformValues;t8.hasHalo&&(t$.u_is_halo=1,rb(t8.buffers,tg.segments,o,n,t8.program,S,f,m,t$)),t$.u_is_halo=0}rb(t8.buffers,tg.segments,o,n,t8.program,S,f,m,t8.uniformValues)}}function rb(r,n,i,o,a,s,u,c,p){var h=o.context,d=h.gl;a.draw(h,d.TRIANGLES,s,u,c,t1.disabled,p,i.id,r.layoutVertexBuffer,r.indexBuffer,n,i.paint,o.transform.zoom,r.programConfigurations.get(i.id),r.dynamicLayoutVertexBuffer,r.opacityVertexBuffer)}function rw(n,i,o,a,s,u,c){var p,h,d,f,m,y=n.context.gl,v=o.paint.get("fill-pattern"),g=v&&v.constantOr(1),$=o.getCrossfadeParameters();c?(h=g&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",p=y.LINES):(h=g?"fillPattern":"fill",p=y.TRIANGLES);for(var _=0,x=a;_<x.length;_+=1){var b=x[_],w=i.getTile(b);if(!g||w.patternsLoaded()){var E=w.getBucket(o);if(E){var T=E.programConfigurations.get(o.id),S=n.useProgram(h,T);g&&(n.context.activeTexture.set(y.TEXTURE0),w.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),T.updatePatternPaintBuffers($));var C=v.constantOr(null);if(C&&w.imageAtlas){var I=w.imageAtlas,k=I.patternPositions[C.to.toString()],A=I.patternPositions[C.from.toString()];k&&A&&T.setConstantPatternPositions(k,A)}var P=n.translatePosMatrix(b.posMatrix,w,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(c){f=E.indexBuffer2,m=E.segments2;var L,D,z,M,R,B,F,O=[y.drawingBufferWidth,y.drawingBufferHeight];d="fillOutlinePattern"===h&&g?(L=P,D=n,z=$,M=w,R=O,r.extend(eJ(L,D,z,M),{u_world:R})):(B=P,{u_matrix:B,u_world:F=O})}else f=E.indexBuffer,m=E.segments,d=g?eJ(P,n,$,w):eY(P);S.draw(n.context,p,s,n.stencilModeForClipping(b),u,t1.disabled,d,o.id,E.layoutVertexBuffer,f,m,o.paint,n.transform.zoom,T)}}}}function r0(n,i,o,a,s,u,c){for(var p=n.context,h=p.gl,d=o.paint.get("fill-extrusion-pattern"),f=d.constantOr(1),m=o.getCrossfadeParameters(),y=o.paint.get("fill-extrusion-opacity"),v=0,g=a;v<g.length;v+=1){var $=g[v],_=i.getTile($),x=_.getBucket(o);if(x){var b=x.programConfigurations.get(o.id),w=n.useProgram(f?"fillExtrusionPattern":"fillExtrusion",b);f&&(n.context.activeTexture.set(h.TEXTURE0),_.imageAtlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),b.updatePatternPaintBuffers(m));var E=d.constantOr(null);if(E&&_.imageAtlas){var T=_.imageAtlas,S=T.patternPositions[E.to.toString()],C=T.patternPositions[E.from.toString()];S&&C&&b.setConstantPatternPositions(S,C)}var I,k,A,P,L,D,z,M=n.translatePosMatrix($.posMatrix,_,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),R=o.paint.get("fill-extrusion-vertical-gradient"),B=f?(I=M,k=n,A=R,P=y,L=$,D=m,z=_,r.extend(eK(I,k,A,P),eX(D,k,z),{u_height_factor:-Math.pow(2,L.overscaledZ)/z.tileSize/8})):eK(M,n,R,y);w.draw(p,p.gl.TRIANGLES,s,u,c,t1.backCCW,B,o.id,x.layoutVertexBuffer,x.indexBuffer,x.segments,o.paint,n.transform.zoom,b)}}}function rE(r,n,i,o,a,s){var u=r.context,c=u.gl,p=n.fbo;if(p){var h=r.useProgram("hillshade");u.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,p.colorAttachment.get());var d=ri(r,n,i);h.draw(u,c.TRIANGLES,o,a,s,t1.disabled,d,i.id,r.rasterBoundsBuffer,r.quadTriangleIndexBuffer,r.rasterBoundsSegments)}}function rT(n,i,o,a,s,u,c){var p=n.context,h=p.gl,d=i.dem;if(d&&d.data){var f=d.dim,m=d.stride,y=d.getPixels();if(p.activeTexture.set(h.TEXTURE1),p.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||n.getTileTexture(m),i.demTexture){var v=i.demTexture;v.update(y,{premultiply:!1}),v.bind(h.NEAREST,h.CLAMP_TO_EDGE)}else i.demTexture=new r.Texture(p,y,h.RGBA,{premultiply:!1}),i.demTexture.bind(h.NEAREST,h.CLAMP_TO_EDGE);p.activeTexture.set(h.TEXTURE0);var g=i.fbo;if(!g){var $=new r.Texture(p,{width:f,height:f,data:null},h.RGBA);$.bind(h.LINEAR,h.CLAMP_TO_EDGE),(g=i.fbo=p.createFramebuffer(f,f)).colorAttachment.set($.texture)}p.bindFramebuffer.set(g.framebuffer),p.viewport.set([0,0,f,f]),n.useProgram("hillshadePrepare").draw(p,h.TRIANGLES,s,u,c,t1.disabled,ro(i.tileID,d,a),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function rS(n,i,o,a,s){var u=a.paint.get("raster-fade-duration");if(u>0){var c=r.browser.now(),p=(c-n.timeAdded)/u,h=i?(c-i.timeAdded)/u:-1,d=o.getSource(),f=s.coveringZoomLevel({tileSize:d.tileSize,roundZoom:d.roundZoom}),m=!i||Math.abs(i.tileID.overscaledZ-f)>Math.abs(n.tileID.overscaledZ-f),y=m&&n.refreshedUponExpiration?1:r.clamp(m?p:1-h,0,1);return n.refreshedUponExpiration&&p>=1&&(n.refreshedUponExpiration=!1),i?{opacity:1,mix:1-y}:{opacity:y,mix:0}}return{opacity:1,mix:0}}function rC(n,i,o){var a=n.context,s=a.gl,u=o.posMatrix,c=n.useProgram("debug"),p=tC.disabled,h=tI.disabled,d=n.colorModeForRenderPass(),f="$debug";c.draw(a,s.LINE_STRIP,p,h,d,t1.disabled,re(u,r.Color.red),f,n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var m=i.getTileByID(o.key).latestRawTileData,y=Math.floor((m&&m.byteLength||0)/1024),v=i.getTile(o).tileSize,g=512/Math.min(v,512),$=o.canonical.toString();o.overscaledZ!==o.canonical.z&&($+=" => "+o.overscaledZ);for(var _=function(r,n,i,o){o=o||1;var a,s,u,c,p,h,d,f,m=[];for(a=0,s=r.length;a<s;a++)if(p=rI[r[a]]){for(f=null,u=0,c=p[1].length;u<c;u+=2)-1===p[1][u]&&-1===p[1][u+1]?f=null:(h=n+p[1][u]*o,d=i-p[1][u+1]*o,f&&m.push(f.x,f.y,h,d),f={x:h,y:d});n+=p[0]*o}return m}($+" "+y+"kb",50,200*g,5*g),x=new r.StructArrayLayout2i4,b=new r.StructArrayLayout2ui4,w=0;w<_.length;w+=2)x.emplaceBack(_[w],_[w+1]),b.emplaceBack(w,w+1);for(var E=a.createVertexBuffer(x,eT.members),T=a.createIndexBuffer(b),S=r.SegmentVector.simpleSegment(0,0,x.length/2,x.length/2),C=r.EXTENT/(Math.pow(2,n.transform.zoom-o.overscaledZ)*v*g),I=[],k=-1;k<=1;k++)for(var A=-1;A<=1&&(0!==k||0!==A);A++)I.push([k,A]);for(var P=0;P<I.length;P++){var L=I[P];c.draw(a,s.LINES,p,h,d,t1.disabled,re(r.translate([],u,[C*L[0],C*L[1],0]),r.Color.white),f,E,T,S)}c.draw(a,s.LINES,p,h,d,t1.disabled,re(u,r.Color.black),f,E,T,S),E.destroy(),T.destroy(),S.destroy()}var rI={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]},rk={symbol:function(n,i,o,a,s){if("translucent"===n.renderPass){var u=tI.disabled,c=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(n,i,o,a,s,u,c){for(var p=i.transform,h="map"===s,d="map"===u,f=0,m=n;f<m.length;f+=1){var y=m[f],v=a.getTile(y),g=v.getBucket(o);if(g&&g.text&&g.text.segments.get().length){var $=g.textSizeData,_=r.evaluateSizeForZoom($,p.zoom),x=en(v,1,i.transform.zoom),b=tq(y.posMatrix,d,h,i.transform,x),w="none"!==o.layout.get("icon-text-fit")&&g.hasIconData();if(_){var E=Math.pow(2,p.zoom-v.tileID.overscaledZ);r$(g,h,d,c,r.symbolSize,p,b,y.posMatrix,E,_,w)}}}}(a,n,o,i,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),s),0!==o.paint.get("icon-opacity").constantOr(1)&&rx(n,i,o,a,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),u,c),0!==o.paint.get("text-opacity").constantOr(1)&&rx(n,i,o,a,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),u,c),i.map.showCollisionBoxes&&(rv(n,i,o,a,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),rv(n,i,o,a,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,i,o,a){if("translucent"===n.renderPass){var s=o.paint.get("circle-opacity"),u=o.paint.get("circle-stroke-width"),c=o.paint.get("circle-stroke-opacity"),p=void 0!==o.layout.get("circle-sort-key").constantOr(1);if(0!==s.constantOr(1)||0!==u.constantOr(1)&&0!==c.constantOr(1)){for(var h=n.context,d=h.gl,f=n.depthModeForSublayer(0,tC.ReadOnly),m=tI.disabled,y=n.colorModeForRenderPass(),v=[],g=0;g<a.length;g++){var $=a[g],_=i.getTile($),x=_.getBucket(o);if(x){var b=x.programConfigurations.get(o.id),w={programConfiguration:b,program:n.useProgram("circle",b),layoutVertexBuffer:x.layoutVertexBuffer,indexBuffer:x.indexBuffer,uniformValues:eQ(n,$,_,o)};if(p)for(var E=0,T=x.segments.get();E<T.length;E+=1){var S=T[E];v.push({segments:new r.SegmentVector([S]),sortKey:S.sortKey,state:w})}else v.push({segments:x.segments,sortKey:0,state:w})}}p&&v.sort(function(r,n){return r.sortKey-n.sortKey});for(var C=0,I=v;C<I.length;C+=1){var k=I[C],A=k.state,P=A.programConfiguration,L=A.program,D=A.layoutVertexBuffer,z=A.indexBuffer,M=A.uniformValues,R=k.segments;L.draw(h,d.TRIANGLES,f,m,y,t1.disabled,M,o.id,D,z,R,o.paint,n.transform.zoom,P)}}}},heatmap:function(n,i,o,a){if(0!==o.paint.get("heatmap-opacity")){if("offscreen"===n.renderPass){var s=n.context,u=s.gl,c=n.depthModeForSublayer(0,tC.ReadOnly),p=tI.disabled,h=new tk([u.ONE,u.ONE],r.Color.transparent,[!0,!0,!0,!0]);(function(r,n,i){var o=r.gl;r.activeTexture.set(o.TEXTURE1),r.viewport.set([0,0,n.width/4,n.height/4]);var a=i.heatmapFbo;if(a)o.bindTexture(o.TEXTURE_2D,a.colorAttachment.get()),r.bindFramebuffer.set(a.framebuffer);else{var s=o.createTexture();o.bindTexture(o.TEXTURE_2D,s),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),a=i.heatmapFbo=r.createFramebuffer(n.width/4,n.height/4),function r(n,i,o,a){var s=n.gl;s.texImage2D(s.TEXTURE_2D,0,s.RGBA,i.width/4,i.height/4,0,s.RGBA,n.extTextureHalfFloat?n.extTextureHalfFloat.HALF_FLOAT_OES:s.UNSIGNED_BYTE,null),a.colorAttachment.set(o),n.extTextureHalfFloat&&s.checkFramebufferStatus(s.FRAMEBUFFER)!==s.FRAMEBUFFER_COMPLETE&&(n.extTextureHalfFloat=null,a.colorAttachment.setDirty(),r(n,i,o,a))}(r,n,s,a)}})(s,n,o),s.clear({color:r.Color.transparent});for(var d=0;d<a.length;d++){var f=a[d];if(!i.hasRenderableParent(f)){var m=i.getTile(f),y=m.getBucket(o);if(y){var v,g,$,_,x=y.programConfigurations.get(o.id),b=n.useProgram("heatmap",x),w=n.transform.zoom;b.draw(s,u.TRIANGLES,c,p,h,t1.disabled,(v=f.posMatrix,g=m,$=w,_=o.paint.get("heatmap-intensity"),{u_matrix:v,u_extrude_scale:en(g,1,$),u_intensity:_}),o.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,o.paint,n.transform.zoom,x)}}}s.viewport.set([0,0,n.width,n.height])}else"translucent"===n.renderPass&&(n.context.setColorMode(n.colorModeForRenderPass()),function(n,i){var o=n.context,a=o.gl,s=i.heatmapFbo;if(s){o.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,s.colorAttachment.get()),o.activeTexture.set(a.TEXTURE1);var u=i.colorRampTexture;u||(u=i.colorRampTexture=new r.Texture(o,i.colorRamp,a.RGBA)),u.bind(a.LINEAR,a.CLAMP_TO_EDGE),n.useProgram("heatmapTexture").draw(o,a.TRIANGLES,tC.disabled,tI.disabled,n.colorModeForRenderPass(),t1.disabled,rn(n,i,0,1),i.id,n.viewportBuffer,n.quadTriangleIndexBuffer,n.viewportSegments,i.paint,n.transform.zoom)}}(n,o))}},line:function(n,i,o,a){if("translucent"===n.renderPass){var s=o.paint.get("line-opacity"),u=o.paint.get("line-width");if(0!==s.constantOr(1)&&0!==u.constantOr(1)){var c=n.depthModeForSublayer(0,tC.ReadOnly),p=n.colorModeForRenderPass(),h=o.paint.get("line-dasharray"),d=o.paint.get("line-pattern"),f=d.constantOr(1),m=o.paint.get("line-gradient"),y=o.getCrossfadeParameters(),v=h?"lineSDF":f?"linePattern":m?"lineGradient":"line",g=n.context,$=g.gl,_=!0;if(m){g.activeTexture.set($.TEXTURE0);var x=o.gradientTexture;if(!o.gradient)return;x||(x=o.gradientTexture=new r.Texture(g,o.gradient,$.RGBA)),x.bind($.LINEAR,$.CLAMP_TO_EDGE)}for(var b=0,w=a;b<w.length;b+=1){var E=w[b],T=i.getTile(E);if(!f||T.patternsLoaded()){var S=T.getBucket(o);if(S){var C=S.programConfigurations.get(o.id),I=n.context.program.get(),k=n.useProgram(v,C),A=_||k.program!==I,P=d.constantOr(null);if(P&&T.imageAtlas){var L=T.imageAtlas,D=L.patternPositions[P.to.toString()],z=L.patternPositions[P.from.toString()];D&&z&&C.setConstantPatternPositions(D,z)}var M,R,B,F=h?rl(n,T,o,h,y):f?rs(n,T,o,y):m?(M=n,R=T,B=o,r.extend(ra(M,R,B),{u_image:0})):ra(n,T,o);h&&(A||n.lineAtlas.dirty)?(g.activeTexture.set($.TEXTURE0),n.lineAtlas.bind(g)):f&&(g.activeTexture.set($.TEXTURE0),T.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),C.updatePatternPaintBuffers(y)),k.draw(g,$.TRIANGLES,c,n.stencilModeForClipping(E),p,t1.disabled,F,o.id,S.layoutVertexBuffer,S.indexBuffer,S.segments,o.paint,n.transform.zoom,C),_=!1}}}}}},fill:function(n,i,o,a){var s=o.paint.get("fill-color"),u=o.paint.get("fill-opacity");if(0!==u.constantOr(1)){var c=n.colorModeForRenderPass(),p=o.paint.get("fill-pattern"),h=n.opaquePassEnabledForLayer()&&!p.constantOr(1)&&1===s.constantOr(r.Color.transparent).a&&1===u.constantOr(0)?"opaque":"translucent";if(n.renderPass===h){var d=n.depthModeForSublayer(1,"opaque"===n.renderPass?tC.ReadWrite:tC.ReadOnly);rw(n,i,o,a,d,c,!1)}if("translucent"===n.renderPass&&o.paint.get("fill-antialias")){var f=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,tC.ReadOnly);rw(n,i,o,a,f,c,!0)}}},"fill-extrusion":function(r,n,i,o){var a=i.paint.get("fill-extrusion-opacity");if(0!==a&&"translucent"===r.renderPass){var s=new tC(r.context.gl.LEQUAL,tC.ReadWrite,r.depthRangeFor3D);if(1!==a||i.paint.get("fill-extrusion-pattern").constantOr(1))r0(r,n,i,o,s,tI.disabled,tk.disabled),r0(r,n,i,o,s,r.stencilModeFor3D(),r.colorModeForRenderPass());else{var u=r.colorModeForRenderPass();r0(r,n,i,o,s,tI.disabled,u)}}},hillshade:function(r,n,i,o){if("offscreen"===r.renderPass||"translucent"===r.renderPass){for(var a=r.context,s=n.getSource().maxzoom,u=r.depthModeForSublayer(0,tC.ReadOnly),c=r.colorModeForRenderPass(),p="translucent"===r.renderPass?r.stencilConfigForOverlap(o):[{},o],h=p[0],d=0,f=p[1];d<f.length;d+=1){var m=f[d],y=n.getTile(m);y.needsHillshadePrepare&&"offscreen"===r.renderPass?rT(r,y,i,s,u,tI.disabled,c):"translucent"===r.renderPass&&rE(r,y,i,u,h[m.overscaledZ],c)}a.viewport.set([0,0,r.width,r.height])}},raster:function(r,n,i,o){if("translucent"===r.renderPass&&0!==i.paint.get("raster-opacity")&&o.length)for(var a=r.context,s=a.gl,u=n.getSource(),c=r.useProgram("raster"),p=r.colorModeForRenderPass(),h=u instanceof M?[{},o]:r.stencilConfigForOverlap(o),d=h[0],f=h[1],m=f[f.length-1].overscaledZ,y=!r.options.moving,v=0,g=f;v<g.length;v+=1){var $=g[v],_=r.depthModeForSublayer($.overscaledZ-m,1===i.paint.get("raster-opacity")?tC.ReadWrite:tC.ReadOnly,s.LESS),x=n.getTile($),b=r.transform.calculatePosMatrix($.toUnwrapped(),y);x.registerFadeDuration(i.paint.get("raster-fade-duration"));var w=n.findLoadedParent($,0),E=rS(x,w,n,i,r.transform),T=void 0,S=void 0,C="nearest"===i.paint.get("raster-resampling")?s.NEAREST:s.LINEAR;a.activeTexture.set(s.TEXTURE0),x.texture.bind(C,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.activeTexture.set(s.TEXTURE1),w?(w.texture.bind(C,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),T=Math.pow(2,w.tileID.overscaledZ-x.tileID.overscaledZ),S=[x.tileID.canonical.x*T%1,x.tileID.canonical.y*T%1]):x.texture.bind(C,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST);var I=rp(b,S||[0,0],T||1,E,i);u instanceof M?c.draw(a,s.TRIANGLES,_,tI.disabled,p,t1.disabled,I,i.id,u.boundsBuffer,r.quadTriangleIndexBuffer,u.boundsSegments):c.draw(a,s.TRIANGLES,_,d[$.overscaledZ],p,t1.disabled,I,i.id,r.rasterBoundsBuffer,r.quadTriangleIndexBuffer,r.rasterBoundsSegments)}},background:function(r,n,i){var o=i.paint.get("background-color"),a=i.paint.get("background-opacity");if(0!==a){var s=r.context,u=s.gl,c=r.transform,p=c.tileSize,h=i.paint.get("background-pattern");if(!r.isPatternMissing(h)){var d=!h&&1===o.a&&1===a&&r.opaquePassEnabledForLayer()?"opaque":"translucent";if(r.renderPass===d){var f=tI.disabled,m=r.depthModeForSublayer(0,"opaque"===d?tC.ReadWrite:tC.ReadOnly),y=r.colorModeForRenderPass(),v=r.useProgram(h?"backgroundPattern":"background"),g=c.coveringTiles({tileSize:p});h&&(s.activeTexture.set(u.TEXTURE0),r.imageManager.bind(r.context));for(var $=i.getCrossfadeParameters(),_=0,x=g;_<x.length;_+=1){var b,w,E,T=x[_],S=r.transform.calculatePosMatrix(T.toUnwrapped()),C=h?rf(S,a,r,h,{tileID:T,tileSize:p},$):(b=S,w=a,E=o,{u_matrix:b,u_opacity:w,u_color:E});v.draw(s,u.TRIANGLES,m,f,y,t1.disabled,C,i.id,r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments)}}}}},debug:function(r,n,i){for(var o=0;o<i.length;o++)rC(r,n,i[o])},custom:function(r,n,i){var o=r.context,a=i.implementation;if("offscreen"===r.renderPass){var s=a.prerender;s&&(r.setCustomLayerDefaults(),o.setColorMode(r.colorModeForRenderPass()),s.call(a,o.gl,r.transform.customLayerMatrix()),o.setDirty(),r.setBaseState())}else if("translucent"===r.renderPass){r.setCustomLayerDefaults(),o.setColorMode(r.colorModeForRenderPass()),o.setStencilMode(tI.disabled);var u="3d"===a.renderingMode?new tC(r.context.gl.LEQUAL,tC.ReadWrite,r.depthRangeFor3D):r.depthModeForSublayer(0,tC.ReadOnly);o.setDepthMode(u),a.render(o.gl,r.transform.customLayerMatrix()),o.setDirty(),r.setBaseState(),o.bindFramebuffer.set(null)}}},r1=function(n,i){this.context=new t2(n),this.transform=i,this._tileTextures={},this.setup(),this.numSublayers=tA.maxUnderzooming+tA.maxOverzooming+1,this.depthEpsilon=1/65536,this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new r.ProgramConfiguration,this.crossTileSymbolIndex=new e_,this.gpuTimers={}};function r2(r,n){if(r.y>n.y){var i=r;r=n,n=i}return{x0:r.x,y0:r.y,x1:n.x,y1:n.y,dx:n.x-r.x,dy:n.y-r.y}}function rA(r,n,i,o,a){var s=Math.max(i,Math.floor(n.y0)),u=Math.min(o,Math.ceil(n.y1));if(r.x0===n.x0&&r.y0===n.y0?r.x0+n.dy/r.dy*r.dx<n.x1:r.x1-n.dy/r.dy*r.dx<n.x0){var c=r;r=n,n=c}for(var p=r.dx/r.dy,h=n.dx/n.dy,d=r.dx>0,f=n.dx<0,m=s;m<u;m++){var y=p*Math.max(0,Math.min(r.dy,m+d-r.y0))+r.x0;a(Math.floor(h*Math.max(0,Math.min(n.dy,m+f-n.y0))+n.x0),Math.ceil(y),m)}}function rP(r,n,i,o,a,s){var u,c=r2(r,n),p=r2(n,i),h=r2(i,r);c.dy>p.dy&&(u=c,c=p,p=u),c.dy>h.dy&&(u=c,c=h,h=u),p.dy>h.dy&&(u=p,p=h,h=u),c.dy&&rA(h,c,o,a,s),p.dy&&rA(h,p,o,a,s)}r1.prototype.resize=function(n,i){var o=this.context.gl;if(this.width=n*r.browser.devicePixelRatio,this.height=i*r.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var a=0,s=this.style._order;a<s.length;a+=1){var u=s[a];this.style._layers[u].resize()}this.depthRbo&&(o.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},r1.prototype.setup=function(){var n=this.context,i=new r.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(r.EXTENT,0),i.emplaceBack(0,r.EXTENT),i.emplaceBack(r.EXTENT,r.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(i,eT.members),this.tileExtentSegments=r.SegmentVector.simpleSegment(0,0,4,2);var o=new r.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(r.EXTENT,0),o.emplaceBack(0,r.EXTENT),o.emplaceBack(r.EXTENT,r.EXTENT),this.debugBuffer=n.createVertexBuffer(o,eT.members),this.debugSegments=r.SegmentVector.simpleSegment(0,0,4,5);var a=new r.StructArrayLayout4i8;a.emplaceBack(0,0,0,0),a.emplaceBack(r.EXTENT,0,r.EXTENT,0),a.emplaceBack(0,r.EXTENT,0,r.EXTENT),a.emplaceBack(r.EXTENT,r.EXTENT,r.EXTENT,r.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(a,z.members),this.rasterBoundsSegments=r.SegmentVector.simpleSegment(0,0,4,2);var s=new r.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(1,0),s.emplaceBack(0,1),s.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(s,eT.members),this.viewportSegments=r.SegmentVector.simpleSegment(0,0,4,2);var u=new r.StructArrayLayout1ui2;u.emplaceBack(0),u.emplaceBack(1),u.emplaceBack(3),u.emplaceBack(2),u.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(u);var c=new r.StructArrayLayout3ui6;c.emplaceBack(0,1,2),c.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(c);var p=this.context.gl;this.stencilClearMode=new tI({func:p.ALWAYS,mask:0},0,255,p.ZERO,p.ZERO,p.ZERO)},r1.prototype.clearStencil=function(){var n=this.context,i=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=r.create();r.ortho(o,0,this.width,this.height,0,0,1),r.scale(o,o,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,i.TRIANGLES,tC.disabled,this.stencilClearMode,tk.disabled,t1.disabled,rr(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},r1.prototype._renderTileClippingMasks=function(r,n){if(this.currentStencilSource!==r.source&&r.isTileClipped()&&n&&n.length){this.currentStencilSource=r.source;var i=this.context,o=i.gl;this.nextStencilID+n.length>256&&this.clearStencil(),i.setColorMode(tk.disabled),i.setDepthMode(tC.disabled);var a=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var s=0,u=n;s<u.length;s+=1){var c=u[s],p=this._tileClippingMaskIDs[c.key]=this.nextStencilID++;a.draw(i,o.TRIANGLES,tC.disabled,new tI({func:o.ALWAYS,mask:0},p,255,o.KEEP,o.KEEP,o.REPLACE),tk.disabled,t1.disabled,rr(c.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},r1.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var r=this.nextStencilID++,n=this.context.gl;return new tI({func:n.NOTEQUAL,mask:255},r,255,n.KEEP,n.KEEP,n.REPLACE)},r1.prototype.stencilModeForClipping=function(r){var n=this.context.gl;return new tI({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,n.KEEP,n.KEEP,n.REPLACE)},r1.prototype.stencilConfigForOverlap=function(r){var n,i=this.context.gl,o=r.sort(function(r,n){return n.overscaledZ-r.overscaledZ}),a=o[o.length-1].overscaledZ,s=o[0].overscaledZ-a+1;if(s>1){this.currentStencilSource=void 0,this.nextStencilID+s>256&&this.clearStencil();for(var u={},c=0;c<s;c++)u[c+a]=new tI({func:i.GEQUAL,mask:255},c+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=s,[u,o]}return[((n={})[a]=tI.disabled,n),o]},r1.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new tk([n.CONSTANT_COLOR,n.ONE],new r.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?tk.unblended:tk.alphaBlended},r1.prototype.depthModeForSublayer=function(r,n,i){if(!this.opaquePassEnabledForLayer())return tC.disabled;var o=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new tC(i||this.context.gl.LEQUAL,n,[o,o])},r1.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},r1.prototype.render=function(n,i){var o=this;this.style=n,this.options=i,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(r.browser.now()),this.imageManager.beginFrame();var a=this.style._order,s=this.style.sourceCaches;for(var u in s){var c=s[u];c.used&&c.prepare(this.context)}var p,h,d={},f={},m={};for(var y in s){var v=s[y];d[y]=v.getVisibleCoordinates(),f[y]=d[y].slice().reverse(),m[y]=v.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var g=0;g<a.length;g++){var $=a[g];if(this.style._layers[$].is3D()){this.opaquePassCutoff=g;break}}this.renderPass="offscreen",this.depthRboNeedsClear=!0;for(var _=0,x=a;_<x.length;_+=1){var b=x[_],w=this.style._layers[b];if(w.hasOffscreenPass()&&!w.isHidden(this.transform.zoom)){var E=f[w.source];("custom"===w.type||E.length)&&this.renderLayer(this,s[w.source],w,E)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?r.Color.black:r.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=a.length-1;this.currentLayer>=0;this.currentLayer--){var T=this.style._layers[a[this.currentLayer]],S=s[T.source],C=d[T.source];this._renderTileClippingMasks(T,C),this.renderLayer(this,S,T,C)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<a.length;this.currentLayer++){var I=this.style._layers[a[this.currentLayer]],k=s[I.source],A=("symbol"===I.type?m:f)[I.source];this._renderTileClippingMasks(I,d[I.source]),this.renderLayer(this,k,I,A)}this.options.showTileBoundaries&&(r.values(this.style._layers).forEach(function(r){r.source&&!r.isHidden(o.transform.zoom)&&(r.source!==(h&&h.id)&&(h=o.style.sourceCaches[r.source]),(!p||p.getSource().maxzoom<h.getSource().maxzoom)&&(p=h))}),p&&rk.debug(this,p,p.getVisibleCoordinates())),this.context.setDefault()},r1.prototype.setupOffscreenDepthRenderbuffer=function(){var r=this.context;this.depthRbo||(this.depthRbo=r.createRenderbuffer(r.gl.DEPTH_COMPONENT16,this.width,this.height))},r1.prototype.renderLayer=function(r,n,i,o){i.isHidden(this.transform.zoom)||("background"===i.type||"custom"===i.type||o.length)&&(this.id=i.id,this.gpuTimingStart(i),rk[i.type](r,n,i,o,this.style.placement.variableOffsets),this.gpuTimingEnd())},r1.prototype.gpuTimingStart=function(r){if(this.options.gpuTiming){var n=this.context.extTimerQuery,i=this.gpuTimers[r.id];i||(i=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:n.createQueryEXT()}),i.calls++,n.beginQueryEXT(n.TIME_ELAPSED_EXT,i.query)}},r1.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}},r1.prototype.collectGpuTimers=function(){var r=this.gpuTimers;return this.gpuTimers={},r},r1.prototype.queryGpuTimers=function(r){var n={};for(var i in r){var o=r[i],a=this.context.extTimerQuery,s=a.getQueryObjectEXT(o.query,a.QUERY_RESULT_EXT)/1e6;a.deleteQueryEXT(o.query),n[i]=s}return n},r1.prototype.translatePosMatrix=function(n,i,o,a,s){if(!o[0]&&!o[1])return n;var u=s?"map"===a?this.transform.angle:0:"viewport"===a?-this.transform.angle:0;if(u){var c=Math.sin(u),p=Math.cos(u);o=[o[0]*p-o[1]*c,o[0]*c+o[1]*p]}var h=[s?o[0]:en(i,o[0],this.transform.zoom),s?o[1]:en(i,o[1],this.transform.zoom),0],d=new Float32Array(16);return r.translate(d,n,h),d},r1.prototype.saveTileTexture=function(r){var n=this._tileTextures[r.size[0]];n?n.push(r):this._tileTextures[r.size[0]]=[r]},r1.prototype.getTileTexture=function(r){var n=this._tileTextures[r];return n&&n.length>0?n.pop():null},r1.prototype.isPatternMissing=function(r){if(!r)return!1;var n=this.imageManager.getPattern(r.from.toString()),i=this.imageManager.getPattern(r.to.toString());return!n||!i},r1.prototype.useProgram=function(r,n){void 0===n&&(n=this.emptyProgramConfiguration),this.cache=this.cache||{};var i=""+r+(n.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[i]||(this.cache[i]=new eW(this.context,eG[r],n,rm[r],this._showOverdrawInspector)),this.cache[i]},r1.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},r1.prototype.setBaseState=function(){var r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)};var rL=function(n,i,o,a,s){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===s||s,this._minZoom=n||0,this._maxZoom=i||22,this._minPitch=null==o?0:o,this._maxPitch=null==a?60:a,this.setMaxBounds(),this.width=0,this.height=0,this._center=new r.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},rD={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};rL.prototype.clone=function(){var r=new rL(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.tileSize=this.tileSize,r.latRange=this.latRange,r.width=this.width,r.height=this.height,r._center=this._center,r.zoom=this.zoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._unmodified=this._unmodified,r._calcMatrices(),r},rD.minZoom.get=function(){return this._minZoom},rD.minZoom.set=function(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))},rD.maxZoom.get=function(){return this._maxZoom},rD.maxZoom.set=function(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))},rD.minPitch.get=function(){return this._minPitch},rD.minPitch.set=function(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))},rD.maxPitch.get=function(){return this._maxPitch},rD.maxPitch.set=function(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))},rD.renderWorldCopies.get=function(){return this._renderWorldCopies},rD.renderWorldCopies.set=function(r){void 0===r?r=!0:null===r&&(r=!1),this._renderWorldCopies=r},rD.worldSize.get=function(){return this.tileSize*this.scale},rD.centerPoint.get=function(){return this.size._div(2)},rD.size.get=function(){return new r.Point(this.width,this.height)},rD.bearing.get=function(){return-this.angle/Math.PI*180},rD.bearing.set=function(n){var i=-r.wrap(n,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=r.create$2(),r.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},rD.pitch.get=function(){return this._pitch/Math.PI*180},rD.pitch.set=function(n){var i=r.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())},rD.fov.get=function(){return this._fov/Math.PI*180},rD.fov.set=function(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())},rD.zoom.get=function(){return this._zoom},rD.zoom.set=function(r){var n=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==n&&(this._unmodified=!1,this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom,this._constrain(),this._calcMatrices())},rD.center.get=function(){return this._center},rD.center.set=function(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())},rL.prototype.coveringZoomLevel=function(r){return Math.max(0,(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize)))},rL.prototype.getVisibleUnwrappedCoordinates=function(n){var i=[new r.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new r.Point(0,0)),a=this.pointCoordinate(new r.Point(this.width,0)),s=this.pointCoordinate(new r.Point(this.width,this.height)),u=this.pointCoordinate(new r.Point(0,this.height)),c=Math.floor(Math.min(o.x,a.x,s.x,u.x)),p=Math.floor(Math.max(o.x,a.x,s.x,u.x)),h=c-1;h<=p+1;h++)0!==h&&i.push(new r.UnwrappedTileID(h,n));return i},rL.prototype.coveringTiles=function(n){var i=this.coveringZoomLevel(n),o=i;if(void 0!==n.minzoom&&i<n.minzoom)return[];void 0!==n.maxzoom&&i>n.maxzoom&&(i=n.maxzoom);var a=r.MercatorCoordinate.fromLngLat(this.center),s=Math.pow(2,i),u=new r.Point(s*a.x-.5,s*a.y-.5);return(function(n,i,o,a){void 0===a&&(a=!0);var s=1<<n,u={};function c(i,c,p){var h,d,f,m;if(p>=0&&p<=s)for(h=i;h<c;h++)d=Math.floor(h/s),f=(h%s+s)%s,0!==d&&!0!==a||(u[(m=new r.OverscaledTileID(o,d,n,f,p)).key]=m)}var p=i.map(function(n){return new r.Point(n.x,n.y)._mult(s)});return rP(p[0],p[1],p[2],0,s,c),rP(p[2],p[3],p[0],0,s,c),Object.keys(u).map(function(r){return u[r]})})(i,[this.pointCoordinate(new r.Point(0,0)),this.pointCoordinate(new r.Point(this.width,0)),this.pointCoordinate(new r.Point(this.width,this.height)),this.pointCoordinate(new r.Point(0,this.height))],n.reparseOverscaled?o:i,this._renderWorldCopies).sort(function(r,n){return u.dist(r.canonical)-u.dist(n.canonical)})},rL.prototype.resize=function(r,n){this.width=r,this.height=n,this.pixelsToGLUnits=[2/r,-2/n],this._constrain(),this._calcMatrices()},rD.unmodified.get=function(){return this._unmodified},rL.prototype.zoomScale=function(r){return Math.pow(2,r)},rL.prototype.scaleZoom=function(r){return Math.log(r)/Math.LN2},rL.prototype.project=function(n){var i=r.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new r.Point(r.mercatorXfromLng(n.lng)*this.worldSize,r.mercatorYfromLat(i)*this.worldSize)},rL.prototype.unproject=function(n){return new r.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},rD.point.get=function(){return this.project(this.center)},rL.prototype.setLocationAtPoint=function(n,i){var o=this.pointCoordinate(i),a=this.pointCoordinate(this.centerPoint),s=this.locationCoordinate(n),u=new r.MercatorCoordinate(s.x-(o.x-a.x),s.y-(o.y-a.y));this.center=this.coordinateLocation(u),this._renderWorldCopies&&(this.center=this.center.wrap())},rL.prototype.locationPoint=function(r){return this.coordinatePoint(this.locationCoordinate(r))},rL.prototype.pointLocation=function(r){return this.coordinateLocation(this.pointCoordinate(r))},rL.prototype.locationCoordinate=function(n){return r.MercatorCoordinate.fromLngLat(n)},rL.prototype.coordinateLocation=function(r){return r.toLngLat()},rL.prototype.pointCoordinate=function(n){var i=[n.x,n.y,0,1],o=[n.x,n.y,1,1];r.transformMat4(i,i,this.pixelMatrixInverse),r.transformMat4(o,o,this.pixelMatrixInverse);var a=i[3],s=o[3],u=i[0]/a,c=o[0]/s,p=i[1]/a,h=o[1]/s,d=i[2]/a,f=o[2]/s,m=d===f?0:(0-d)/(f-d);return new r.MercatorCoordinate(r.number(u,c,m)/this.worldSize,r.number(p,h,m)/this.worldSize)},rL.prototype.coordinatePoint=function(n){var i=[n.x*this.worldSize,n.y*this.worldSize,0,1];return r.transformMat4(i,i,this.pixelMatrix),new r.Point(i[0]/i[3],i[1]/i[3])},rL.prototype.getBounds=function(){return(new r.LngLatBounds).extend(this.pointLocation(new r.Point(0,0))).extend(this.pointLocation(new r.Point(this.width,0))).extend(this.pointLocation(new r.Point(this.width,this.height))).extend(this.pointLocation(new r.Point(0,this.height)))},rL.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new r.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},rL.prototype.setMaxBounds=function(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},rL.prototype.calculatePosMatrix=function(n,i){void 0===i&&(i=!1);var o=n.key,a=i?this._alignedPosMatrixCache:this._posMatrixCache;if(a[o])return a[o];var s=n.canonical,u=this.worldSize/this.zoomScale(s.z),c=s.x+Math.pow(2,s.z)*n.wrap,p=r.identity(new Float64Array(16));return r.translate(p,p,[c*u,s.y*u,0]),r.scale(p,p,[u/r.EXTENT,u/r.EXTENT,1]),r.multiply(p,i?this.alignedProjMatrix:this.projMatrix,p),a[o]=new Float32Array(p),a[o]},rL.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},rL.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,i,o,a,s=-90,u=90,c=-180,p=180,h=this.size,d=this._unmodified;if(this.latRange){var f=this.latRange;s=r.mercatorYfromLat(f[1])*this.worldSize,n=(u=r.mercatorYfromLat(f[0])*this.worldSize)-s<h.y?h.y/(u-s):0}if(this.lngRange){var m=this.lngRange;c=r.mercatorXfromLng(m[0])*this.worldSize,i=(p=r.mercatorXfromLng(m[1])*this.worldSize)-c<h.x?h.x/(p-c):0}var y=this.point,v=Math.max(i||0,n||0);if(v)return this.center=this.unproject(new r.Point(i?(p+c)/2:y.x,n?(u+s)/2:y.y)),this.zoom+=this.scaleZoom(v),this._unmodified=d,void(this._constraining=!1);if(this.latRange){var g=y.y,$=h.y/2;g-$<s&&(a=s+$),g+$>u&&(a=u-$)}if(this.lngRange){var _=y.x,x=h.x/2;_-x<c&&(o=c+x),_+x>p&&(o=p-x)}void 0===o&&void 0===a||(this.center=this.unproject(new r.Point(void 0!==o?o:y.x,void 0!==a?a:y.y))),this._unmodified=d,this._constraining=!1}},rL.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var n=this._fov/2,i=Math.PI/2+this._pitch,o=Math.sin(n)*this.cameraToCenterDistance/Math.sin(Math.PI-i-n),a=this.point,s=a.x,u=a.y,c=1.01*(Math.cos(Math.PI/2-this._pitch)*o+this.cameraToCenterDistance),p=this.height/50,h=new Float64Array(16);r.perspective(h,this._fov,this.width/this.height,p,c),r.scale(h,h,[1,-1,1]),r.translate(h,h,[0,0,-this.cameraToCenterDistance]),r.rotateX(h,h,this._pitch),r.rotateZ(h,h,this.angle),r.translate(h,h,[-s,-u,0]),this.mercatorMatrix=r.scale([],h,[this.worldSize,this.worldSize,this.worldSize]),r.scale(h,h,[1,1,r.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=h;var d=this.width%2/2,f=this.height%2/2,m=Math.cos(this.angle),y=Math.sin(this.angle),v=s-Math.round(s)+m*d+y*f,g=u-Math.round(u)+m*f+y*d,$=new Float64Array(h);if(r.translate($,$,[v>.5?v-1:v,g>.5?g-1:g,0]),this.alignedProjMatrix=$,h=r.create(),r.scale(h,h,[this.width/2,-this.height/2,1]),r.translate(h,h,[1,-1,0]),this.labelPlaneMatrix=h,h=r.create(),r.scale(h,h,[1,-1,1]),r.translate(h,h,[-1,-1,0]),r.scale(h,h,[2/this.width,2/this.height,1]),this.glCoordMatrix=h,this.pixelMatrix=r.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(h=r.invert(new Float64Array(16),this.pixelMatrix)))throw Error("failed to invert matrix");this.pixelMatrixInverse=h,this._posMatrixCache={},this._alignedPosMatrixCache={}}},rL.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new r.Point(0,0)),i=[n.x*this.worldSize,n.y*this.worldSize,0,1];return r.transformMat4(i,i,this.pixelMatrix)[3]/this.cameraToCenterDistance},rL.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.Point(0,n))},rL.prototype.getCameraQueryGeometry=function(n){var i=this.getCameraPoint();if(1===n.length)return[n[0],i];for(var o=i.x,a=i.y,s=i.x,u=i.y,c=0,p=n;c<p.length;c+=1){var h=p[c];o=Math.min(o,h.x),a=Math.min(a,h.y),s=Math.max(s,h.x),u=Math.max(u,h.y)}return[new r.Point(o,a),new r.Point(s,a),new r.Point(s,u),new r.Point(o,u),new r.Point(o,a)]},Object.defineProperties(rL.prototype,rD);var rz=function(n){var i,o,a,s,u;this._hashName=n&&encodeURIComponent(n),r.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(i=this._updateHashUnthrottled.bind(this),o=300,a=!1,s=null,u=function(){s=null,a&&(i(),s=setTimeout(u,o),a=!1)},function(){return a=!0,s||u(),s})};rz.prototype.addTo=function(n){return this._map=n,r.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},rz.prototype.remove=function(){return r.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},rz.prototype.getHashString=function(n){var i=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,a=Math.pow(10,Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10)),s=Math.round(i.lng*a)/a,u=Math.round(i.lat*a)/a,c=this._map.getBearing(),p=this._map.getPitch(),h="";if(h+=n?"/"+s+"/"+u+"/"+o:o+"/"+u+"/"+s,(c||p)&&(h+="/"+Math.round(10*c)/10),p&&(h+="/"+Math.round(p)),this._hashName){var d=this._hashName,f=!1,m=r.window.location.hash.slice(1).split("&").map(function(r){var n=r.split("=")[0];return n===d?(f=!0,n+"="+h):r}).filter(function(r){return r});return f||m.push(d+"="+h),"#"+m.join("&")}return"#"+h},rz.prototype._getCurrentHash=function(){var n,i=this,o=r.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(r){return r.split("=")}).forEach(function(r){r[0]===i._hashName&&(n=r)}),(n&&n[1]||"").split("/")):o.split("/")},rz.prototype._onHashChange=function(){var r=this._getCurrentHash();if(r.length>=3&&!r.some(function(r){return isNaN(r)})){var n=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:n,pitch:+(r[4]||0)}),!0}return!1},rz.prototype._updateHashUnthrottled=function(){var n=this.getHashString();try{r.window.history.replaceState(r.window.history.state,"",n)}catch(i){}};var r3=function(n){function i(i,a,s,u){void 0===u&&(u={});var c=o.mousePos(a.getCanvasContainer(),s),p=a.unproject(c);n.call(this,i,r.extend({point:c,lngLat:p,originalEvent:s},u)),this._defaultPrevented=!1,this.target=a}n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i;var a={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,a),i}(r.Event),r4=function(n){function i(i,a,s){var u=o.touchPos(a.getCanvasContainer(),s),c=u.map(function(r){return a.unproject(r)}),p=u.reduce(function(r,n,i,o){return r.add(n.div(o.length))},new r.Point(0,0)),h=a.unproject(p);n.call(this,i,{points:u,point:p,lngLats:c,lngLat:h,originalEvent:s}),this._defaultPrevented=!1}n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i;var a={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,a),i}(r.Event),rM=function(r){function n(n,i,o){r.call(this,n,{originalEvent:o}),this._defaultPrevented=!1}r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n;var i={defaultPrevented:{configurable:!0}};return n.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(n.prototype,i),n}(r.Event),rR=function(n){this._map=n,this._el=n.getCanvasContainer(),this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,r.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};rR.prototype.setZoomRate=function(r){this._defaultZoomRate=r},rR.prototype.setWheelZoomRate=function(r){this._wheelZoomRate=r},rR.prototype.isEnabled=function(){return!!this._enabled},rR.prototype.isActive=function(){return!!this._active},rR.prototype.isZooming=function(){return!!this._zooming},rR.prototype.enable=function(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=r&&"center"===r.around)},rR.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},rR.prototype.onWheel=function(n){if(this.isEnabled()){var i=n.deltaMode===r.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=r.browser.now(),a=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,0!==i&&i%4.000244140625==0?this._type="wheel":0!==i&&4>Math.abs(i)?this._type="trackpad":a>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=200>Math.abs(a*i)?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),n.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=n,this._delta-=i,this.isActive()||this._start(n)),n.preventDefault()}},rR.prototype._onTimeout=function(r){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(r)},rR.prototype._start=function(n){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0,this._map.fire(new r.Event("movestart",{originalEvent:n})),this._map.fire(new r.Event("zoomstart",{originalEvent:n}))),this._finishTimeout&&clearTimeout(this._finishTimeout);var i=o.mousePos(this._el,n);this._around=r.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(i)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},rR.prototype._onScrollFrame=function(){var n=this;if(this._frameId=null,this.isActive()){var i=this._map.transform;if(0!==this._delta){var o="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,a=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&0!==a&&(a=1/a);var s="number"==typeof this._targetZoom?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(s*a))),"wheel"===this._type&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var u="number"==typeof this._targetZoom?this._targetZoom:i.zoom,c=this._startZoom,p=this._easing,h=!1;if("wheel"===this._type&&c&&p){var d=Math.min((r.browser.now()-this._lastWheelEventTime)/200,1),f=p(d);i.zoom=r.number(c,u,f),d<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):h=!0}else i.zoom=u,h=!0;i.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new r.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new r.Event("zoom",{originalEvent:this._lastWheelEvent})),h&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._map.fire(new r.Event("zoomend",{originalEvent:n._lastWheelEvent})),n._map.fire(new r.Event("moveend",{originalEvent:n._lastWheelEvent})),delete n._targetZoom},200))}},rR.prototype._smoothOutEasing=function(n){var i=r.ease;if(this._prevEase){var o=this._prevEase,a=(r.browser.now()-o.start)/o.duration,s=o.easing(a+.01)-o.easing(a),u=.27/Math.sqrt(s*s+1e-4)*.01,c=Math.sqrt(.0729-u*u);i=r.bezier(u,c,.25,1)}return this._prevEase={start:r.browser.now(),duration:n,easing:i},i};var rB=function(n,i){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=i.clickTolerance||1,r.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};rB.prototype.isEnabled=function(){return!!this._enabled},rB.prototype.isActive=function(){return!!this._active},rB.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},rB.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},rB.prototype.onMouseDown=function(n){this.isEnabled()&&n.shiftKey&&0===n.button&&(r.window.document.addEventListener("mousemove",this._onMouseMove,!1),r.window.document.addEventListener("keydown",this._onKeyDown,!1),r.window.document.addEventListener("mouseup",this._onMouseUp,!1),o.disableDrag(),this._startPos=this._lastPos=o.mousePos(this._el,n),this._active=!0)},rB.prototype._onMouseMove=function(r){var n=o.mousePos(this._el,r);if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var i=this._startPos;this._lastPos=n,this._box||(this._box=o.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));var a=Math.min(i.x,n.x),s=Math.max(i.x,n.x),u=Math.min(i.y,n.y),c=Math.max(i.y,n.y);o.setTransform(this._box,"translate("+a+"px,"+u+"px)"),this._box.style.width=s-a+"px",this._box.style.height=c-u+"px"}},rB.prototype._onMouseUp=function(n){if(0===n.button){var i=this._startPos,a=o.mousePos(this._el,n);this._finish(),o.suppressClick(),i.x===a.x&&i.y===a.y?this._fireEvent("boxzoomcancel",n):this._map.fitScreenCoordinates(i,a,this._map.getBearing(),{linear:!0}).fire(new r.Event("boxzoomend",{originalEvent:n}))}},rB.prototype._onKeyDown=function(r){27===r.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",r))},rB.prototype._finish=function(){this._active=!1,r.window.document.removeEventListener("mousemove",this._onMouseMove,!1),r.window.document.removeEventListener("keydown",this._onKeyDown,!1),r.window.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(o.remove(this._box),this._box=null),o.enableDrag(),delete this._startPos,delete this._lastPos},rB.prototype._fireEvent=function(n,i){return this._map.fire(new r.Event(n,{originalEvent:i}))};var rF=r.bezier(0,0,.25,1),rO=function(n,i){this._map=n,this._el=i.element||n.getCanvasContainer(),this._state="disabled",this._button=i.button||"right",this._bearingSnap=i.bearingSnap||0,this._pitchWithRotate=!1!==i.pitchWithRotate,this._clickTolerance=i.clickTolerance||1,r.bindAll(["onMouseDown","_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};rO.prototype.isEnabled=function(){return"disabled"!==this._state},rO.prototype.isActive=function(){return"active"===this._state},rO.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},rO.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},rO.prototype.onMouseDown=function(n){if("enabled"===this._state){var i="touchstart"===n.type;if(i)this._startTime=Date.now();else if("right"===this._button){if(this._eventButton=o.mouseButton(n),this._eventButton!==(n.ctrlKey?0:2))return}else{if(n.ctrlKey||0!==o.mouseButton(n))return;this._eventButton=0}o.disableDrag(),i?(r.window.document.addEventListener("touchmove",this._onMouseMove,{capture:!0}),r.window.document.addEventListener("touchend",this._onMouseUp)):(r.window.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),r.window.document.addEventListener("mouseup",this._onMouseUp)),r.window.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[r.browser.now(),this._map.getBearing()]],this._startPos=this._prevPos=this._lastPos=o.mousePos(this._el,n),this._center=this._map.transform.centerPoint,n.preventDefault()}},rO.prototype._onMouseMove=function(r){var n=o.mousePos(this._el,r);this._lastPos.equals(n)||"pending"===this._state&&n.dist(this._startPos)<this._clickTolerance||(this._lastMoveEvent=r,this._lastPos=n,"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",r),this._fireEvent("movestart",r),this._pitchWithRotate&&this._fireEvent("pitchstart",r)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},rO.prototype._onDragFrame=function(){this._frameId=null;var n=this._lastMoveEvent;if(n){var i=this._map.transform,o=this._prevPos,a=this._lastPos,s=.8*(o.x-a.x),u=-.5*(o.y-a.y),c=i.bearing-s,p=i.pitch-u,h=this._inertia,d=h[h.length-1];this._drainInertiaBuffer(),h.push([r.browser.now(),this._map._normalizeBearing(c,d[1])]);var f=i.bearing;if(i.bearing=c,this._pitchWithRotate){var m=i.pitch;i.pitch=p,i.pitch!==m&&this._fireEvent("pitch",n)}i.bearing!==f&&this._fireEvent("rotate",n),this._fireEvent("move",n),delete this._lastMoveEvent,this._prevPos=this._lastPos}},rO.prototype._onMouseUp=function(r){var n="touchend"===r.type;if(n&&this._startPos===this._lastPos&&Date.now()-this._startTime<300&&this._el.click(),n||o.mouseButton(r)===this._eventButton)switch(this._state){case"active":this._state="enabled",o.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(r);break;case"pending":this._state="enabled",this._unbind()}},rO.prototype._onBlur=function(r){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",r),this._pitchWithRotate&&this._fireEvent("pitchend",r),this._fireEvent("moveend",r);break;case"pending":this._state="enabled",this._unbind()}},rO.prototype._unbind=function(){r.window.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),r.window.document.removeEventListener("mouseup",this._onMouseUp),r.window.document.removeEventListener("touchmove",this._onMouseMove,{capture:!0}),r.window.document.removeEventListener("touchend",this._onMouseUp),r.window.removeEventListener("blur",this._onBlur),o.enableDrag()},rO.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._prevPos,delete this._lastPos},rO.prototype._inertialRotate=function(r){var n=this;this._fireEvent("rotateend",r),this._drainInertiaBuffer();var i=this._map,o=i.getBearing(),a=this._inertia,s=function(){Math.abs(o)<n._bearingSnap?i.resetNorth({noMoveStart:!0},{originalEvent:r}):n._fireEvent("moveend",r),n._pitchWithRotate&&n._fireEvent("pitchend",r)};if(a.length<2)s();else{var u=a[0],c=a[a.length-1],p=a[a.length-2],h=i._normalizeBearing(o,p[1]),d=c[1]-u[1],f=(c[0]-u[0])/1e3;if(0!==d&&0!==f){var m=Math.abs(d*(.25/f));m>180&&(m=180);var y=m/180;h+=(d<0?-1:1)*m*(y/2),Math.abs(i._normalizeBearing(h,0))<this._bearingSnap&&(h=i._normalizeBearing(0,h)),i.rotateTo(h,{duration:1e3*y,easing:rF,noMoveStart:!0},{originalEvent:r})}else s()}},rO.prototype._fireEvent=function(n,i){return this._map.fire(new r.Event(n,i?{originalEvent:i}:{}))},rO.prototype._drainInertiaBuffer=function(){for(var n=this._inertia,i=r.browser.now();n.length>0&&i-n[0][0]>160;)n.shift()};var r6={linearity:.3,easing:r.bezier(0,0,.3,1),maxSpeed:1400,deceleration:2500},r7=function(n,i){this._map=n,this._el=n.getCanvasContainer(),this._state="disabled",this._clickTolerance=i.clickTolerance||1,this._inertiaOptions=r6,r.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};r7.prototype.isEnabled=function(){return"disabled"!==this._state},r7.prototype.isActive=function(){return"active"===this._state},r7.prototype.enable=function(n){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled",this._inertiaOptions=r.extend(r6,n))},r7.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},r7.prototype.onMouseDown=function(n){"enabled"===this._state&&(n.ctrlKey||0!==o.mouseButton(n)||(o.addEventListener(r.window.document,"mousemove",this._onMove,{capture:!0}),o.addEventListener(r.window.document,"mouseup",this._onMouseUp),this._start(n)))},r7.prototype.onTouchStart=function(n){this.isEnabled()&&(n.touches&&n.touches.length>1&&("pending"===this._state||"active"===this._state)||(o.addEventListener(r.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),o.addEventListener(r.window.document,"touchend",this._onTouchEnd),this._start(n)))},r7.prototype._start=function(n){r.window.addEventListener("blur",this._onBlur),this._state="pending",this._startPos=this._mouseDownPos=this._prevPos=this._lastPos=o.mousePos(this._el,n),this._startTouch=this._lastTouch=r.window.TouchEvent&&n instanceof r.window.TouchEvent?o.touchPos(this._el,n):null,this._inertia=[[r.browser.now(),this._startPos]]},r7.prototype._touchesMatch=function(r,n){return!(!r||!n||r.length!==n.length)&&r.every(function(r,i){return n[i]===r})},r7.prototype._onMove=function(n){n.preventDefault();var i=r.window.TouchEvent&&n instanceof r.window.TouchEvent?o.touchPos(this._el,n):null,a=o.mousePos(this._el,n);(i?this._touchesMatch(this._lastTouch,i):this._lastPos.equals(a))||"pending"===this._state&&a.dist(this._mouseDownPos)<this._clickTolerance||(this._lastMoveEvent=n,this._lastPos=a,this._lastTouch=i,this._drainInertiaBuffer(),this._inertia.push([r.browser.now(),this._lastPos]),"pending"===this._state&&(this._state="active",this._shouldStart=!0),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},r7.prototype._onDragFrame=function(){this._frameId=null;var r=this._lastMoveEvent;if(r){if(this._map.touchZoomRotate.isActive())this._abort(r);else if(this._shouldStart&&(this._fireEvent("dragstart",r),this._fireEvent("movestart",r),this._shouldStart=!1),this.isActive()){var n=this._map.transform;n.setLocationAtPoint(n.pointLocation(this._prevPos),this._lastPos),this._fireEvent("drag",r),this._fireEvent("move",r),this._prevPos=this._lastPos,delete this._lastMoveEvent}}},r7.prototype._onMouseUp=function(r){if(0===o.mouseButton(r))switch(this._state){case"active":this._state="enabled",o.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(r);break;case"pending":this._state="enabled",this._unbind()}},r7.prototype._onTouchEnd=function(r){if(r.touches&&0!==r.touches.length)switch(this._state){case"pending":case"active":break;case"enabled":this.onTouchStart(r)}else switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(r);break;case"pending":this._state="enabled",this._unbind();break;case"enabled":this._unbind()}},r7.prototype._abort=function(n){switch(this._state){case"active":this._state="enabled",this._shouldStart||(this._fireEvent("dragend",n),this._fireEvent("moveend",n)),this._unbind(),this._deactivate(),r.window.TouchEvent&&n instanceof r.window.TouchEvent&&n.touches.length>1&&o.addEventListener(r.window.document,"touchend",this._onTouchEnd);break;case"pending":this._state="enabled",this._unbind();break;case"enabled":this._unbind()}},r7.prototype._onBlur=function(r){this._abort(r)},r7.prototype._unbind=function(){o.removeEventListener(r.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),o.removeEventListener(r.window.document,"touchend",this._onTouchEnd),o.removeEventListener(r.window.document,"mousemove",this._onMove,{capture:!0}),o.removeEventListener(r.window.document,"mouseup",this._onMouseUp),o.removeEventListener(r.window,"blur",this._onBlur)},r7.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._prevPos,delete this._mouseDownPos,delete this._lastPos,delete this._startTouch,delete this._lastTouch,delete this._shouldStart},r7.prototype._inertialPan=function(r){this._fireEvent("dragend",r),this._drainInertiaBuffer();var n=this._inertia;if(n.length<2)this._fireEvent("moveend",r);else{var i=n[n.length-1],o=n[0],a=i[1].sub(o[1]),s=(i[0]-o[0])/1e3;if(0===s||i[1].equals(o[1]))this._fireEvent("moveend",r);else{var u=this._inertiaOptions,c=u.linearity,p=u.easing,h=u.maxSpeed,d=u.deceleration,f=a.mult(c/s),m=f.mag();m>h&&(m=h,f._unit()._mult(m));var y=m/(d*c),v=f.mult(-y/2);this._map.panBy(v,{duration:1e3*y,easing:p,noMoveStart:!0},{originalEvent:r})}}},r7.prototype._fireEvent=function(n,i){return this._map.fire(new r.Event(n,i?{originalEvent:i}:{}))},r7.prototype._drainInertiaBuffer=function(){for(var n=this._inertia,i=r.browser.now();n.length>0&&i-n[0][0]>160;)n.shift()};var r5=function(n){this._map=n,this._el=n.getCanvasContainer(),r.bindAll(["_onKeyDown"],this)};function rN(r){return r*(2-r)}r5.prototype.isEnabled=function(){return!!this._enabled},r5.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},r5.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},r5.prototype._onKeyDown=function(r){if(!(r.altKey||r.ctrlKey||r.metaKey)){var n=0,i=0,o=0,a=0,s=0;switch(r.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:r.shiftKey?i=-1:(r.preventDefault(),a=-1);break;case 39:r.shiftKey?i=1:(r.preventDefault(),a=1);break;case 38:r.shiftKey?o=1:(r.preventDefault(),s=-1);break;case 40:r.shiftKey?o=-1:(s=1,r.preventDefault());break;default:return}var u=this._map,c=u.getZoom(),p={duration:300,delayEndEvents:500,easing:rN,zoom:n?Math.round(c)+n*(r.shiftKey?2:1):c,bearing:u.getBearing()+15*i,pitch:u.getPitch()+10*o,offset:[-(100*a),-(100*s)],center:u.getCenter()};u.easeTo(p,{originalEvent:r})}};var rU=function(n){this._map=n,r.bindAll(["_onDblClick","_onZoomEnd"],this)};rU.prototype.isEnabled=function(){return!!this._enabled},rU.prototype.isActive=function(){return!!this._active},rU.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},rU.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},rU.prototype.onTouchStart=function(r){var n=this;if(this.isEnabled()&&!(r.points.length>1)){if(this._tapped){var i=r.points[0],o=this._tappedPoint;if(o&&30>=o.dist(i)){r.originalEvent.preventDefault();var a=function(){n._tapped&&n._zoom(r),n._map.off("touchcancel",s),n._resetTapped()},s=function(){n._map.off("touchend",a),n._resetTapped()};this._map.once("touchend",a),this._map.once("touchcancel",s)}else this._resetTapped()}else this._tappedPoint=r.points[0],this._tapped=setTimeout(function(){n._tapped=null,n._tappedPoint=null},300)}},rU.prototype._resetTapped=function(){clearTimeout(this._tapped),this._tapped=null,this._tappedPoint=null},rU.prototype.onDblClick=function(r){this.isEnabled()&&(r.originalEvent.preventDefault(),this._zoom(r))},rU.prototype._zoom=function(r){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(r.originalEvent.shiftKey?-1:1),{around:r.lngLat},r)},rU.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var rV=r.bezier(0,0,.15,1),rq=function(n){this._map=n,this._el=n.getCanvasContainer(),r.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};rq.prototype.isEnabled=function(){return!!this._enabled},rq.prototype.enable=function(r){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!r&&"center"===r.around)},rq.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},rq.prototype.disableRotation=function(){this._rotationDisabled=!0},rq.prototype.enableRotation=function(){this._rotationDisabled=!1},rq.prototype.isActive=function(){return this.isEnabled()&&!!this._gestureIntent},rq.prototype.onStart=function(n){if(this.isEnabled()&&2===n.touches.length){var i=o.mousePos(this._el,n.touches[0]),a=o.mousePos(this._el,n.touches[1]),s=i.add(a).div(2);this._startVec=i.sub(a),this._startAround=this._map.transform.pointLocation(s),this._gestureIntent=void 0,this._inertia=[],o.addEventListener(r.window.document,"touchmove",this._onMove,{passive:!1}),o.addEventListener(r.window.document,"touchend",this._onEnd)}},rq.prototype._getTouchEventData=function(r){var n=o.mousePos(this._el,r.touches[0]),i=o.mousePos(this._el,r.touches[1]),a=n.sub(i);return{vec:a,center:n.add(i).div(2),scale:a.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*a.angleWith(this._startVec)/Math.PI}},rq.prototype._onMove=function(n){if(2===n.touches.length){var i=this._getTouchEventData(n),o=i.vec,a=i.scale,s=i.bearing;if(!this._gestureIntent){var u=this._rotationDisabled&&1!==a||Math.abs(1-a)>.15;Math.abs(s)>10?this._gestureIntent="rotate":u&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new r.Event(this._gestureIntent+"start",{originalEvent:n})),this._map.fire(new r.Event("movestart",{originalEvent:n})),this._startVec=o)}this._lastTouchEvent=n,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),n.preventDefault()}},rq.prototype._onTouchFrame=function(){this._frameId=null;var n=this._gestureIntent;if(n){var i=this._map.transform;this._startScale||(this._startScale=i.scale,this._startBearing=i.bearing);var o=this._getTouchEventData(this._lastTouchEvent),a=o.center,s=o.bearing,u=o.scale,c=i.pointLocation(a),p=i.locationPoint(c);"rotate"===n&&(i.bearing=this._startBearing+s),i.zoom=i.scaleZoom(this._startScale*u),i.setLocationAtPoint(this._startAround,p),this._map.fire(new r.Event(n,{originalEvent:this._lastTouchEvent})),this._map.fire(new r.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([r.browser.now(),u,a])}},rq.prototype._onEnd=function(n){o.removeEventListener(r.window.document,"touchmove",this._onMove,{passive:!1}),o.removeEventListener(r.window.document,"touchend",this._onEnd);var i=this._gestureIntent,a=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,i){this._map.fire(new r.Event(i+"end",{originalEvent:n})),this._drainInertiaBuffer();var s=this._inertia,u=this._map;if(s.length<2)u.snapToNorth({},{originalEvent:n});else{var c=s[s.length-1],p=s[0],h=u.transform.scaleZoom(a*c[1]),d=u.transform.scaleZoom(a*p[1]),f=(c[0]-p[0])/1e3,m=c[2];if(0!==f&&h!==d){var y=.15*(h-d)/f;Math.abs(y)>2.5&&(y=y>0?2.5:-2.5);var v=1e3*Math.abs(y/(12*.15)),g=h+y*v/2e3;u.easeTo({zoom:g,duration:v,easing:rV,around:this._aroundCenter?u.getCenter():u.unproject(m),noMoveStart:!0},{originalEvent:n})}else u.snapToNorth({},{originalEvent:n})}}},rq.prototype._drainInertiaBuffer=function(){for(var n=this._inertia,i=r.browser.now();n.length>2&&i-n[0][0]>160;)n.shift()};var rj={scrollZoom:rR,boxZoom:rB,dragRotate:rO,dragPan:r7,keyboard:r5,doubleClickZoom:rU,touchZoomRotate:rq},rH=function(n){function i(i,o){n.call(this),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=o.bearingSnap,r.bindAll(["_renderFrameCallback"],this)}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.getCenter=function(){return new r.LngLat(this.transform.center.lng,this.transform.center.lat)},i.prototype.setCenter=function(r,n){return this.jumpTo({center:r},n)},i.prototype.panBy=function(n,i,o){return n=r.Point.convert(n).mult(-1),this.panTo(this.transform.center,r.extend({offset:n},i),o)},i.prototype.panTo=function(n,i,o){return this.easeTo(r.extend({center:n},i),o)},i.prototype.getZoom=function(){return this.transform.zoom},i.prototype.setZoom=function(r,n){return this.jumpTo({zoom:r},n),this},i.prototype.zoomTo=function(n,i,o){return this.easeTo(r.extend({zoom:n},i),o)},i.prototype.zoomIn=function(r,n){return this.zoomTo(this.getZoom()+1,r,n),this},i.prototype.zoomOut=function(r,n){return this.zoomTo(this.getZoom()-1,r,n),this},i.prototype.getBearing=function(){return this.transform.bearing},i.prototype.setBearing=function(r,n){return this.jumpTo({bearing:r},n),this},i.prototype.rotateTo=function(n,i,o){return this.easeTo(r.extend({bearing:n},i),o)},i.prototype.resetNorth=function(n,i){return this.rotateTo(0,r.extend({duration:1e3},n),i),this},i.prototype.resetNorthPitch=function(n,i){return this.easeTo(r.extend({bearing:0,pitch:0,duration:1e3},n),i),this},i.prototype.snapToNorth=function(r,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,n):this},i.prototype.getPitch=function(){return this.transform.pitch},i.prototype.setPitch=function(r,n){return this.jumpTo({pitch:r},n),this},i.prototype.cameraForBounds=function(n,i){return n=r.LngLatBounds.convert(n),this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),0,i)},i.prototype._cameraForBoxAndBearing=function(n,i,o,a){if("number"==typeof(a=r.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},a)).padding){var s=a.padding;a.padding={top:s,bottom:s,right:s,left:s}}if(r.deepEqual(Object.keys(a.padding).sort(function(r,n){return r<n?-1:r>n?1:0}),["bottom","left","right","top"])){var u=this.transform,c=u.project(r.LngLat.convert(n)),p=u.project(r.LngLat.convert(i)),h=c.rotate(-o*Math.PI/180),d=p.rotate(-o*Math.PI/180),f=new r.Point(Math.max(h.x,d.x),Math.max(h.y,d.y)),m=new r.Point(Math.min(h.x,d.x),Math.min(h.y,d.y)),y=f.sub(m),v=(u.width-a.padding.left-a.padding.right)/y.x,g=(u.height-a.padding.top-a.padding.bottom)/y.y;if(!(g<0||v<0)){var $=Math.min(u.scaleZoom(u.scale*Math.min(v,g)),a.maxZoom),_=r.Point.convert(a.offset),x=(a.padding.left-a.padding.right)/2,b=(a.padding.top-a.padding.bottom)/2,w=new r.Point(_.x+x,_.y+b).mult(u.scale/u.zoomScale($));return{center:u.unproject(c.add(p).div(2).sub(w)),zoom:$,bearing:o}}r.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}else r.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")},i.prototype.fitBounds=function(r,n,i){return this._fitInternal(this.cameraForBounds(r,n),n,i)},i.prototype.fitScreenCoordinates=function(n,i,o,a,s){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(r.Point.convert(n)),this.transform.pointLocation(r.Point.convert(i)),o,a),a,s)},i.prototype._fitInternal=function(n,i,o){return n?(i=r.extend(n,i)).linear?this.easeTo(i,o):this.flyTo(i,o):this},i.prototype.jumpTo=function(n,i){this.stop();var o=this.transform,a=!1,s=!1,u=!1;return"zoom"in n&&o.zoom!==+n.zoom&&(a=!0,o.zoom=+n.zoom),void 0!==n.center&&(o.center=r.LngLat.convert(n.center)),"bearing"in n&&o.bearing!==+n.bearing&&(s=!0,o.bearing=+n.bearing),"pitch"in n&&o.pitch!==+n.pitch&&(u=!0,o.pitch=+n.pitch),this.fire(new r.Event("movestart",i)).fire(new r.Event("move",i)),a&&this.fire(new r.Event("zoomstart",i)).fire(new r.Event("zoom",i)).fire(new r.Event("zoomend",i)),s&&this.fire(new r.Event("rotatestart",i)).fire(new r.Event("rotate",i)).fire(new r.Event("rotateend",i)),u&&this.fire(new r.Event("pitchstart",i)).fire(new r.Event("pitch",i)).fire(new r.Event("pitchend",i)),this.fire(new r.Event("moveend",i))},i.prototype.easeTo=function(n,i){var o=this;this.stop(),(!1===(n=r.extend({offset:[0,0],duration:500,easing:r.ease},n)).animate||!n.essential&&r.browser.prefersReducedMotion)&&(n.duration=0);var a=this.transform,s=this.getZoom(),u=this.getBearing(),c=this.getPitch(),p="zoom"in n?+n.zoom:s,h="bearing"in n?this._normalizeBearing(n.bearing,u):u,d="pitch"in n?+n.pitch:c,f=a.centerPoint.add(r.Point.convert(n.offset)),m=a.pointLocation(f),y=r.LngLat.convert(n.center||m);this._normalizeCenter(y);var v,g,$=a.project(m),_=a.project(y).sub($),x=a.zoomScale(p-s);return n.around&&(v=r.LngLat.convert(n.around),g=a.locationPoint(v)),this._zooming=p!==s,this._rotating=u!==h,this._pitching=d!==c,this._prepareEase(i,n.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease(function(n){if(o._zooming&&(a.zoom=r.number(s,p,n)),o._rotating&&(a.bearing=r.number(u,h,n)),o._pitching&&(a.pitch=r.number(c,d,n)),v)a.setLocationAtPoint(v,g);else{var m=a.zoomScale(a.zoom-s),y=Math.pow(p>s?Math.min(2,x):Math.max(.5,x),1-n),b=a.unproject($.add(_.mult(n*y)).mult(m));a.setLocationAtPoint(a.renderWorldCopies?b.wrap():b,f)}o._fireMoveEvents(i)},function(){n.delayEndEvents?o._easeEndTimeoutID=setTimeout(function(){return o._afterEase(i)},n.delayEndEvents):o._afterEase(i)},n),this},i.prototype._prepareEase=function(n,i){this._moving=!0,i||this.fire(new r.Event("movestart",n)),this._zooming&&this.fire(new r.Event("zoomstart",n)),this._rotating&&this.fire(new r.Event("rotatestart",n)),this._pitching&&this.fire(new r.Event("pitchstart",n))},i.prototype._fireMoveEvents=function(n){this.fire(new r.Event("move",n)),this._zooming&&this.fire(new r.Event("zoom",n)),this._rotating&&this.fire(new r.Event("rotate",n)),this._pitching&&this.fire(new r.Event("pitch",n))},i.prototype._afterEase=function(n){var i=this._zooming,o=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,i&&this.fire(new r.Event("zoomend",n)),o&&this.fire(new r.Event("rotateend",n)),a&&this.fire(new r.Event("pitchend",n)),this.fire(new r.Event("moveend",n))},i.prototype.flyTo=function(n,i){var o=this;if(!n.essential&&r.browser.prefersReducedMotion){var a=r.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(a,i)}this.stop(),n=r.extend({offset:[0,0],speed:1.2,curve:1.42,easing:r.ease},n);var s=this.transform,u=this.getZoom(),c=this.getBearing(),p=this.getPitch(),h="zoom"in n?r.clamp(+n.zoom,s.minZoom,s.maxZoom):u,d="bearing"in n?this._normalizeBearing(n.bearing,c):c,f="pitch"in n?+n.pitch:p,m=s.zoomScale(h-u),y=s.centerPoint.add(r.Point.convert(n.offset)),v=s.pointLocation(y),g=r.LngLat.convert(n.center||v);this._normalizeCenter(g);var $=s.project(v),_=s.project(g).sub($),x=n.curve,b=Math.max(s.width,s.height),w=b/m,E=_.mag();if("minZoom"in n){var T=r.clamp(Math.min(n.minZoom,u,h),s.minZoom,s.maxZoom);x=Math.sqrt(b/s.zoomScale(T-u)/E*2)}var S=x*x;function C(r){var n=(w*w-b*b+(r?-1:1)*S*S*E*E)/(2*(r?w:b)*S*E);return Math.log(Math.sqrt(n*n+1)-n)}function I(r){return(Math.exp(r)-Math.exp(-r))/2}function k(r){return(Math.exp(r)+Math.exp(-r))/2}var A=C(0),P=function(r){return k(A)/k(A+x*r)},L=function(r){var n;return b*((k(A)*(I(n=A+x*r)/k(n))-I(A))/S)/E},D=(C(1)-A)/x;if(1e-6>Math.abs(E)||!isFinite(D)){if(1e-6>Math.abs(b-w))return this.easeTo(n,i);var z=w<b?-1:1;D=Math.abs(Math.log(w/b))/x,L=function(){return 0},P=function(r){return Math.exp(z*x*r)}}if("duration"in n)n.duration=+n.duration;else{var M="screenSpeed"in n?+n.screenSpeed/x:+n.speed;n.duration=1e3*D/M}return n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=c!==d,this._pitching=f!==p,this._prepareEase(i,!1),this._ease(function(n){var a=n*D,m=1/P(a);s.zoom=1===n?h:u+s.scaleZoom(m),o._rotating&&(s.bearing=r.number(c,d,n)),o._pitching&&(s.pitch=r.number(p,f,n));var v=1===n?g:s.unproject($.add(_.mult(L(a))).mult(m));s.setLocationAtPoint(s.renderWorldCopies?v.wrap():v,y),o._fireMoveEvents(i)},function(){return o._afterEase(i)},n),this},i.prototype.isEasing=function(){return!!this._easeFrameId},i.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var r=this._onEaseEnd;delete this._onEaseEnd,r.call(this)}return this},i.prototype._ease=function(n,i,o){!1===o.animate||0===o.duration?(n(1),i()):(this._easeStart=r.browser.now(),this._easeOptions=o,this._onEaseFrame=n,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},i.prototype._renderFrameCallback=function(){var n=Math.min((r.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},i.prototype._normalizeBearing=function(n,i){var o=Math.abs((n=r.wrap(n,-180,180))-i);return Math.abs(n-360-i)<o&&(n-=360),Math.abs(n+360-i)<o&&(n+=360),n},i.prototype._normalizeCenter=function(r){var n=this.transform;if(n.renderWorldCopies&&!n.lngRange){var i=r.lng-n.center.lng;r.lng+=i>180?-360:i<-180?360:0}},i}(r.Evented),rG=function(n){void 0===n&&(n={}),this.options=n,r.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};rG.prototype.getDefaultPosition=function(){return"bottom-right"},rG.prototype.onAdd=function(r){var n=this.options&&this.options.compact;return this._map=r,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=o.create("div","mapboxgl-ctrl-attrib-inner",this._container),n&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===n&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},rG.prototype.onRemove=function(){o.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},rG.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.config.ACCESS_TOKEN}];if(n){var o=i.reduce(function(r,n,o){return n.value&&(r+=n.key+"="+n.value+(o<i.length-1?"&":"")),r},"?");n.href=r.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow"}},rG.prototype._updateData=function(r){r&&("metadata"===r.sourceDataType||"style"===r.dataType)&&(this._updateAttributions(),this._updateEditLink())},rG.prototype._updateAttributions=function(){if(this._map.style){var r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(function(r){return"string"!=typeof r?"":r})):"string"==typeof this.options.customAttribution&&r.push(this.options.customAttribution)),this._map.style.stylesheet){var n=this._map.style.stylesheet;this.styleOwner=n.owner,this.styleId=n.id}var i=this._map.style.sourceCaches;for(var o in i){var a=i[o];if(a.used){var s=a.getSource();s.attribution&&0>r.indexOf(s.attribution)&&r.push(s.attribution)}}r.sort(function(r,n){return r.length-n.length});var u=(r=r.filter(function(n,i){for(var o=i+1;o<r.length;o++)if(r[o].indexOf(n)>=0)return!1;return!0})).join(" | ");u!==this._attribHTML&&(this._attribHTML=u,r.length?(this._innerContainer.innerHTML=u,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},rG.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var rZ=function(){r.bindAll(["_updateLogo"],this),r.bindAll(["_updateCompact"],this)};rZ.prototype.onAdd=function(r){this._map=r,this._container=o.create("div","mapboxgl-ctrl");var n=o.create("a","mapboxgl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://www.mapbox.com/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},rZ.prototype.onRemove=function(){o.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},rZ.prototype.getDefaultPosition=function(){return"bottom-left"},rZ.prototype._updateLogo=function(r){r&&"metadata"!==r.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},rZ.prototype._logoRequired=function(){if(this._map.style){var r=this._map.style.sourceCaches;for(var n in r)if(r[n].getSource().mapbox_logo)return!0;return!1}},rZ.prototype._updateCompact=function(){var r=this._container.children;if(r.length){var n=r[0];this._map.getCanvasContainer().offsetWidth<250?n.classList.add("mapboxgl-compact"):n.classList.remove("mapboxgl-compact")}};var rW=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};rW.prototype.add=function(r){var n=++this._id;return this._queue.push({callback:r,id:n,cancelled:!1}),n},rW.prototype.remove=function(r){for(var n=this._currentlyRunning,i=0,o=n?this._queue.concat(n):this._queue;i<o.length;i+=1){var a=o[i];if(a.id===r)return void(a.cancelled=!0)}},rW.prototype.run=function(){var r=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,i=r;n<i.length;n+=1){var o=i[n];if(!o.cancelled&&(o.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},rW.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var rX={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},rK=r.window.HTMLImageElement,rY=r.window.HTMLElement,rJ=r.window.ImageBitmap,rQ={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,clickTolerance:3,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},r9=function(i){function a(n){var a=this;if(null!=(n=r.extend({},rQ,n)).minZoom&&null!=n.maxZoom&&n.minZoom>n.maxZoom)throw Error("maxZoom must be greater than or equal to minZoom");if(null!=n.minPitch&&null!=n.maxPitch&&n.minPitch>n.maxPitch)throw Error("maxPitch must be greater than or equal to minPitch");if(null!=n.minPitch&&n.minPitch<0)throw Error("minPitch must be greater than or equal to 0");if(null!=n.maxPitch&&n.maxPitch>60)throw Error("maxPitch must be less than or equal to 60");var s=new rL(n.minZoom,n.maxZoom,n.minPitch,n.maxPitch,n.renderWorldCopies);if(i.call(this,s,n),this._interactive=n.interactive,this._maxTileCacheSize=n.maxTileCacheSize,this._failIfMajorPerformanceCaveat=n.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=n.preserveDrawingBuffer,this._antialias=n.antialias,this._trackResize=n.trackResize,this._bearingSnap=n.bearingSnap,this._refreshExpiredTiles=n.refreshExpiredTiles,this._fadeDuration=n.fadeDuration,this._crossSourceCollisions=n.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=n.collectResourceTiming,this._renderTaskQueue=new rW,this._controls=[],this._mapId=r.uniqueId(),this._locale=r.extend({},rX,n.locale),this._requestManager=new r.RequestManager(n.transformRequest,n.accessToken),"string"==typeof n.container){if(this._container=r.window.document.getElementById(n.container),!this._container)throw Error("Container '"+n.container+"' not found.")}else{if(!(n.container instanceof rY))throw Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=n.container}if(n.maxBounds&&this.setMaxBounds(n.maxBounds),r.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw Error("Failed to initialize WebGL.");this.on("move",function(){return a._update(!1)}),this.on("moveend",function(){return a._update(!1)}),this.on("zoom",function(){return a._update(!0)}),void 0!==r.window&&(r.window.addEventListener("online",this._onWindowOnline,!1),r.window.addEventListener("resize",this._onWindowResize,!1)),function(r,n){var i=r.getCanvasContainer(),a=null,s=!1,u=null;for(var c in rj)r[c]=new rj[c](r,n),n.interactive&&n[c]&&r[c].enable(n[c]);o.addEventListener(i,"mouseout",function(n){r.fire(new r3("mouseout",r,n))}),o.addEventListener(i,"mousedown",function(a){s=!0,u=o.mousePos(i,a);var c=new r3("mousedown",r,a);r.fire(c),!c.defaultPrevented&&(n.interactive&&!r.doubleClickZoom.isActive()&&r.stop(),r.boxZoom.onMouseDown(a),r.boxZoom.isActive()||r.dragPan.isActive()||r.dragRotate.onMouseDown(a),r.boxZoom.isActive()||r.dragRotate.isActive()||r.dragPan.onMouseDown(a))}),o.addEventListener(i,"mouseup",function(n){var i=r.dragRotate.isActive();a&&!i&&r.fire(new r3("contextmenu",r,a)),a=null,s=!1,r.fire(new r3("mouseup",r,n))}),o.addEventListener(i,"mousemove",function(n){if(!(r.dragPan.isActive()||r.dragRotate.isActive())){for(var o=n.target;o&&o!==i;)o=o.parentNode;o===i&&r.fire(new r3("mousemove",r,n))}}),o.addEventListener(i,"mouseover",function(n){for(var o=n.target;o&&o!==i;)o=o.parentNode;o===i&&r.fire(new r3("mouseover",r,n))}),o.addEventListener(i,"touchstart",function(i){var o=new r4("touchstart",r,i);r.fire(o),o.defaultPrevented||(n.interactive&&r.stop(),r.boxZoom.isActive()||r.dragRotate.isActive()||r.dragPan.onTouchStart(i),r.touchZoomRotate.onStart(i),r.doubleClickZoom.onTouchStart(o))},{passive:!1}),o.addEventListener(i,"touchmove",function(n){r.fire(new r4("touchmove",r,n))},{passive:!1}),o.addEventListener(i,"touchend",function(n){r.fire(new r4("touchend",r,n))}),o.addEventListener(i,"touchcancel",function(n){r.fire(new r4("touchcancel",r,n))}),o.addEventListener(i,"click",function(a){var s=o.mousePos(i,a);(!u||s.equals(u)||s.dist(u)<n.clickTolerance)&&r.fire(new r3("click",r,a))}),o.addEventListener(i,"dblclick",function(n){var i=new r3("dblclick",r,n);r.fire(i),i.defaultPrevented||r.doubleClickZoom.onDblClick(i)}),o.addEventListener(i,"contextmenu",function(n){var i=r.dragRotate.isActive();s||i?s&&(a=n):r.fire(new r3("contextmenu",r,n)),(r.dragRotate.isEnabled()||r.listens("contextmenu"))&&n.preventDefault()}),o.addEventListener(i,"wheel",function(i){n.interactive&&r.stop();var o=new rM("wheel",r,i);r.fire(o),o.defaultPrevented||r.scrollZoom.onWheel(i)},{passive:!1})}(this,n);var u="string"==typeof n.hash&&n.hash||void 0;this._hash=n.hash&&new rz(u).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}),n.bounds&&(this.resize(),this.fitBounds(n.bounds,r.extend({},n.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=n.localIdeographFontFamily,n.style&&this.setStyle(n.style,{localIdeographFontFamily:n.localIdeographFontFamily}),n.attributionControl&&this.addControl(new rG({customAttribution:n.customAttribution})),this.addControl(new rZ,n.logoPosition),this.on("style.load",function(){a.transform.unmodified&&a.jumpTo(a.style.stylesheet)}),this.on("data",function(n){a._update("style"===n.dataType),a.fire(new r.Event(n.dataType+"data",n))}),this.on("dataloading",function(n){a.fire(new r.Event(n.dataType+"dataloading",n))})}i&&(a.__proto__=i),a.prototype=Object.create(i&&i.prototype),a.prototype.constructor=a;var s={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(n,i){if(void 0===i&&n.getDefaultPosition&&(i=n.getDefaultPosition()),void 0===i&&(i="top-right"),!n||!n.onAdd)return this.fire(new r.ErrorEvent(Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var o=n.onAdd(this);this._controls.push(n);var a=this._controlPositions[i];return -1!==i.indexOf("bottom")?a.insertBefore(o,a.firstChild):a.appendChild(o),this},a.prototype.removeControl=function(n){if(!n||!n.onRemove)return this.fire(new r.ErrorEvent(Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var i=this._controls.indexOf(n);return i>-1&&this._controls.splice(i,1),n.onRemove(this),this},a.prototype.resize=function(n){var i=this._containerDimensions(),o=i[0],a=i[1];return this._resizeCanvas(o,a),this.transform.resize(o,a),this.painter.resize(o,a),this.fire(new r.Event("movestart",n)).fire(new r.Event("move",n)).fire(new r.Event("resize",n)).fire(new r.Event("moveend",n)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(n){return this.transform.setMaxBounds(r.LngLatBounds.convert(n)),this._update()},a.prototype.setMinZoom=function(r){if((r=null==r?-2:r)>=-2&&r<=this.transform.maxZoom)return this.transform.minZoom=r,this._update(),this.getZoom()<r&&this.setZoom(r),this;throw Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(r){if((r=null==r?22:r)>=this.transform.minZoom)return this.transform.maxZoom=r,this._update(),this.getZoom()>r&&this.setZoom(r),this;throw Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(r){if((r=null==r?0:r)<0)throw Error("minPitch must be greater than or equal to 0");if(r>=0&&r<=this.transform.maxPitch)return this.transform.minPitch=r,this._update(),this.getPitch()<r&&this.setPitch(r),this;throw Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(r){if((r=null==r?60:r)>60)throw Error("maxPitch must be less than or equal to 60");if(r>=this.transform.minPitch)return this.transform.maxPitch=r,this._update(),this.getPitch()>r&&this.setPitch(r),this;throw Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(r){return this.transform.renderWorldCopies=r,this._update()},a.prototype.project=function(n){return this.transform.locationPoint(r.LngLat.convert(n))},a.prototype.unproject=function(n){return this.transform.pointLocation(r.Point.convert(n))},a.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},a.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},a.prototype._createDelegatedListener=function(r,n,i){var o,a=this;if("mouseenter"===r||"mouseover"===r){var s=!1;return{layer:n,listener:i,delegates:{mousemove:function(o){var u=a.getLayer(n)?a.queryRenderedFeatures(o.point,{layers:[n]}):[];u.length?s||(s=!0,i.call(a,new r3(r,a,o.originalEvent,{features:u}))):s=!1},mouseout:function(){s=!1}}}}if("mouseleave"===r||"mouseout"===r){var u=!1;return{layer:n,listener:i,delegates:{mousemove:function(o){(a.getLayer(n)?a.queryRenderedFeatures(o.point,{layers:[n]}):[]).length?u=!0:u&&(u=!1,i.call(a,new r3(r,a,o.originalEvent)))},mouseout:function(n){u&&(u=!1,i.call(a,new r3(r,a,n.originalEvent)))}}}}return{layer:n,listener:i,delegates:((o={})[r]=function(r){var o=a.getLayer(n)?a.queryRenderedFeatures(r.point,{layers:[n]}):[];o.length&&(r.features=o,i.call(a,r),delete r.features)},o)}},a.prototype.on=function(r,n,o){if(void 0===o)return i.prototype.on.call(this,r,n);var a=this._createDelegatedListener(r,n,o);for(var s in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[r]=this._delegatedListeners[r]||[],this._delegatedListeners[r].push(a),a.delegates)this.on(s,a.delegates[s]);return this},a.prototype.once=function(r,n,o){if(void 0===o)return i.prototype.once.call(this,r,n);var a=this._createDelegatedListener(r,n,o);for(var s in a.delegates)this.once(s,a.delegates[s]);return this},a.prototype.off=function(r,n,o){var a=this;return void 0===o?i.prototype.off.call(this,r,n):(this._delegatedListeners&&this._delegatedListeners[r]&&function(i){for(var s=i[r],u=0;u<s.length;u++){var c=s[u];if(c.layer===n&&c.listener===o){for(var p in c.delegates)a.off(p,c.delegates[p]);return s.splice(u,1),a}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(n,i){if(!this.style)return[];if(void 0!==i||void 0===n||n instanceof r.Point||Array.isArray(n)||(i=n,n=void 0),i=i||{},(n=n||[[0,0],[this.transform.width,this.transform.height]])instanceof r.Point||"number"==typeof n[0])o=[r.Point.convert(n)];else{var o,a=r.Point.convert(n[0]),s=r.Point.convert(n[1]);o=[a,new r.Point(s.x,a.y),s,new r.Point(a.x,s.y),a]}return this.style.queryRenderedFeatures(o,i,this.transform)},a.prototype.querySourceFeatures=function(r,n){return this.style.querySourceFeatures(r,n)},a.prototype.setStyle=function(n,i){return!1!==(i=r.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&n?(this._diffStyle(n,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(n,i))},a.prototype._getUIString=function(r){var n=this._locale[r];if(null==n)throw Error("Missing UI string '"+r+"'");return n},a.prototype._updateStyle=function(r,n){return this.style&&(this.style.setEventedParent(null),this.style._remove()),r?(this.style=new eE(this,n||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof r?this.style.loadURL(r):this.style.loadJSON(r),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new eE(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(n,i){var o=this;if("string"==typeof n){var a=this._requestManager.normalizeStyleURL(n),s=this._requestManager.transformRequest(a,r.ResourceType.Style);r.getJSON(s,function(n,a){n?o.fire(new r.ErrorEvent(n)):a&&o._updateDiff(a,i)})}else"object"==typeof n&&this._updateDiff(n,i)},a.prototype._updateDiff=function(n,i){try{this.style.setState(n)&&this._update(!0)}catch(o){r.warnOnce("Unable to perform style diff: "+(o.message||o.error||o)+".  Rebuilding the style from scratch."),this._updateStyle(n,i)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():r.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(r,n){return this._lazyInitEmptyStyle(),this.style.addSource(r,n),this._update(!0)},a.prototype.isSourceLoaded=function(n){var i=this.style&&this.style.sourceCaches[n];if(void 0!==i)return i.loaded();this.fire(new r.ErrorEvent(Error("There is no source with ID '"+n+"'")))},a.prototype.areTilesLoaded=function(){var r=this.style&&this.style.sourceCaches;for(var n in r){var i=r[n]._tiles;for(var o in i){var a=i[o];if("loaded"!==a.state&&"errored"!==a.state)return!1}}return!0},a.prototype.addSourceType=function(r,n,i){return this._lazyInitEmptyStyle(),this.style.addSourceType(r,n,i)},a.prototype.removeSource=function(r){return this.style.removeSource(r),this._update(!0)},a.prototype.getSource=function(r){return this.style.getSource(r)},a.prototype.addImage=function(n,i,o){void 0===o&&(o={});var a=o.pixelRatio;void 0===a&&(a=1);var s=o.sdf;void 0===s&&(s=!1);var u=o.stretchX,c=o.stretchY,p=o.content;if(this._lazyInitEmptyStyle(),i instanceof rK||rJ&&i instanceof rJ){var h=r.browser.getImageData(i),d=h.width,f=h.height,m=h.data;this.style.addImage(n,{data:new r.RGBAImage({width:d,height:f},m),pixelRatio:a,stretchX:u,stretchY:c,content:p,sdf:s,version:0})}else{if(void 0===i.width||void 0===i.height)return this.fire(new r.ErrorEvent(Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var y=i.width,v=i.height,g=i.data,$=i;this.style.addImage(n,{data:new r.RGBAImage({width:y,height:v},new Uint8Array(g)),pixelRatio:a,stretchX:u,stretchY:c,content:p,sdf:s,version:0,userImage:$}),$.onAdd&&$.onAdd(this,n)}},a.prototype.updateImage=function(n,i){var o=this.style.getImage(n);if(!o)return this.fire(new r.ErrorEvent(Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var a=i instanceof rK||rJ&&i instanceof rJ?r.browser.getImageData(i):i,s=a.width,u=a.height,c=a.data;return void 0===s||void 0===u?this.fire(new r.ErrorEvent(Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):s!==o.data.width||u!==o.data.height?this.fire(new r.ErrorEvent(Error("The width and height of the updated image must be that same as the previous version of the image"))):void(o.data.replace(c,!(i instanceof rK||rJ&&i instanceof rJ)),this.style.updateImage(n,o))},a.prototype.hasImage=function(n){return n?!!this.style.getImage(n):(this.fire(new r.ErrorEvent(Error("Missing required image id"))),!1)},a.prototype.removeImage=function(r){this.style.removeImage(r)},a.prototype.loadImage=function(n,i){r.getImage(this._requestManager.transformRequest(n,r.ResourceType.Image),i)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(r,n){return this._lazyInitEmptyStyle(),this.style.addLayer(r,n),this._update(!0)},a.prototype.moveLayer=function(r,n){return this.style.moveLayer(r,n),this._update(!0)},a.prototype.removeLayer=function(r){return this.style.removeLayer(r),this._update(!0)},a.prototype.getLayer=function(r){return this.style.getLayer(r)},a.prototype.setLayerZoomRange=function(r,n,i){return this.style.setLayerZoomRange(r,n,i),this._update(!0)},a.prototype.setFilter=function(r,n,i){return void 0===i&&(i={}),this.style.setFilter(r,n,i),this._update(!0)},a.prototype.getFilter=function(r){return this.style.getFilter(r)},a.prototype.setPaintProperty=function(r,n,i,o){return void 0===o&&(o={}),this.style.setPaintProperty(r,n,i,o),this._update(!0)},a.prototype.getPaintProperty=function(r,n){return this.style.getPaintProperty(r,n)},a.prototype.setLayoutProperty=function(r,n,i,o){return void 0===o&&(o={}),this.style.setLayoutProperty(r,n,i,o),this._update(!0)},a.prototype.getLayoutProperty=function(r,n){return this.style.getLayoutProperty(r,n)},a.prototype.setLight=function(r,n){return void 0===n&&(n={}),this._lazyInitEmptyStyle(),this.style.setLight(r,n),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(r,n){return this.style.setFeatureState(r,n),this._update()},a.prototype.removeFeatureState=function(r,n){return this.style.removeFeatureState(r,n),this._update()},a.prototype.getFeatureState=function(r){return this.style.getFeatureState(r)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var r=0,n=0;return this._container&&(r=this._container.clientWidth||400,n=this._container.clientHeight||300),[r,n]},a.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==r.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&r.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var r=this._container;r.classList.add("mapboxgl-map"),(this._missingCSSCanary=o.create("div","mapboxgl-canary",r)).style.visibility="hidden",this._detectMissingCSS();var n=this._canvasContainer=o.create("div","mapboxgl-canvas-container",r);this._interactive&&n.classList.add("mapboxgl-interactive"),this._canvas=o.create("canvas","mapboxgl-canvas",n),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var i=this._containerDimensions();this._resizeCanvas(i[0],i[1]);var a=this._controlContainer=o.create("div","mapboxgl-control-container",r),s=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(r){s[r]=o.create("div","mapboxgl-ctrl-"+r,a)})},a.prototype._resizeCanvas=function(n,i){var o=r.browser.devicePixelRatio||1;this._canvas.width=o*n,this._canvas.height=o*i,this._canvas.style.width=n+"px",this._canvas.style.height=i+"px"},a.prototype._setupPainter=function(){var i=r.extend({},n.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl",i)||this._canvas.getContext("experimental-webgl",i);o?(this.painter=new r1(o,this.transform),r.webpSupported.testSupport(o)):this.fire(new r.ErrorEvent(Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(n){n.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.Event("webglcontextlost",{originalEvent:n}))},a.prototype._contextRestored=function(n){this._setupPainter(),this.resize(),this._update(),this.fire(new r.Event("webglcontextrestored",{originalEvent:n}))},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(r){return this.style&&(this._styleDirty=this._styleDirty||r,this._sourcesDirty=!0,this.triggerRepaint()),this},a.prototype._requestRenderFrame=function(r){return this._update(),this._renderTaskQueue.add(r)},a.prototype._cancelRenderFrame=function(r){this._renderTaskQueue.remove(r)},a.prototype._render=function(){var n,i=this,o=0,a=this.painter.context.extTimerQuery;this.listens("gpu-timing-frame")&&(n=a.createQueryEXT(),a.beginQueryEXT(a.TIME_ELAPSED_EXT,n),o=r.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run();var s=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var u=this.transform.zoom,c=r.browser.now();this.style.zoomHistory.update(u,c);var p=new r.EvaluationParameters(u,{now:c,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),h=p.crossFadingFactor();1===h&&h===this._crossFadingFactor||(s=!0,this._crossFadingFactor=h),this.style.update(p)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),gpuTiming:!!this.listens("gpu-timing-layer"),fadeDuration:this._fadeDuration}),this.fire(new r.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new r.Event("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var d=r.browser.now()-o;a.endQueryEXT(a.TIME_ELAPSED_EXT,n),setTimeout(function(){var o=a.getQueryObjectEXT(n,a.QUERY_RESULT_EXT)/1e6;a.deleteQueryEXT(n),i.fire(new r.Event("gpu-timing-frame",{cpuTime:d,gpuTime:o}))},50)}if(this.listens("gpu-timing-layer")){var f=this.painter.collectGpuTimers();setTimeout(function(){var n=i.painter.queryGpuTimers(f);i.fire(new r.Event("gpu-timing-layer",{layerTimes:n}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new r.Event("idle"))),this},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var n=0,i=this._controls;n<i.length;n+=1)i[n].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.setStyle(null),void 0!==r.window&&(r.window.removeEventListener("resize",this._onWindowResize,!1),r.window.removeEventListener("online",this._onWindowOnline,!1));var o=this.painter.context.gl.getExtension("WEBGL_lose_context");o&&o.loseContext(),nt(this._canvasContainer),nt(this._controlContainer),nt(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this.fire(new r.Event("remove"))},a.prototype.triggerRepaint=function(){var n=this;this.style&&!this._frame&&(this._frame=r.browser.frame(function(r){n._frame=null,n._render()}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(r){this._trackResize&&this.resize({originalEvent:r})._update()},s.showTileBoundaries.get=function(){return!!this._showTileBoundaries},s.showTileBoundaries.set=function(r){this._showTileBoundaries!==r&&(this._showTileBoundaries=r,this._update())},s.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},s.showCollisionBoxes.set=function(r){this._showCollisionBoxes!==r&&(this._showCollisionBoxes=r,r?this.style._generateCollisionBoxes():this._update())},s.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},s.showOverdrawInspector.set=function(r){this._showOverdrawInspector!==r&&(this._showOverdrawInspector=r,this._update())},s.repaint.get=function(){return!!this._repaint},s.repaint.set=function(r){this._repaint!==r&&(this._repaint=r,this.triggerRepaint())},s.vertices.get=function(){return!!this._vertices},s.vertices.set=function(r){this._vertices=r,this._update()},a.prototype._setCacheLimits=function(n,i){r.setCacheLimits(n,i)},s.version.get=function(){return r.version},Object.defineProperties(a.prototype,s),a}(rH);function nt(r){r.parentNode&&r.parentNode.removeChild(r)}var ne={showCompass:!0,showZoom:!0,visualizePitch:!1},nr=function(n){var i=this;this.options=r.extend({},ne,n),this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(r){return r.preventDefault()}),this.options.showZoom&&(r.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(r){return i._map.zoomIn({},{originalEvent:r})}),o.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(r){return i._map.zoomOut({},{originalEvent:r})}),o.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(r.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(r){i.options.visualizePitch?i._map.resetNorthPitch({},{originalEvent:r}):i._map.resetNorth({},{originalEvent:r})}),this._compassIcon=o.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};function nn(n,i,o){if(n=new r.LngLat(n.lng,n.lat),i){var a=new r.LngLat(n.lng-360,n.lat),s=new r.LngLat(n.lng+360,n.lat),u=o.locationPoint(n).distSqr(i);o.locationPoint(a).distSqr(i)<u?n=a:o.locationPoint(s).distSqr(i)<u&&(n=s)}for(;Math.abs(n.lng-o.center.lng)>180;){var c=o.locationPoint(n);if(c.x>=0&&c.y>=0&&c.x<=o.width&&c.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}nr.prototype._updateZoomButtons=function(){var r=this._map.getZoom();this._zoomInButton.disabled=r===this._map.getMaxZoom(),this._zoomOutButton.disabled=r===this._map.getMinZoom()},nr.prototype._rotateCompassArrow=function(){var r=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=r},nr.prototype.onAdd=function(r){return this._map=r,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new rO(r,{button:"left",element:this._compass,clickTolerance:r.dragRotate._clickTolerance}),o.addEventListener(this._compass,"mousedown",this._handler.onMouseDown),o.addEventListener(this._compass,"touchstart",this._handler.onMouseDown,{passive:!1}),this._handler.enable()),this._container},nr.prototype.onRemove=function(){o.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),o.removeEventListener(this._compass,"mousedown",this._handler.onMouseDown),o.removeEventListener(this._compass,"touchstart",this._handler.onMouseDown,{passive:!1}),this._handler.disable(),delete this._handler),delete this._map},nr.prototype._createButton=function(r,n){var i=o.create("button",r,this._container);return i.type="button",i.addEventListener("click",n),i},nr.prototype._setButtonTitle=function(r,n){var i=this._map._getUIString("NavigationControl."+n);r.title=i,r.setAttribute("aria-label",i)};var ni={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function no(r,n,i){var o=r.classList;for(var a in ni)o.remove("mapboxgl-"+i+"-anchor-"+a);o.add("mapboxgl-"+i+"-anchor-"+n)}var na,ns=function(n){function i(i,a){var s=this;if(n.call(this),(i instanceof r.window.HTMLElement||a)&&(i=r.extend({element:i},a)),r.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._draggable=i&&i.draggable||!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&"auto"!==i.pitchAlignment?i.pitchAlignment:this._rotationAlignment,i&&i.element)this._element=i.element,this._offset=r.Point.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=o.create("div"),this._element.setAttribute("aria-label","Map marker");var u=o.createNS("http://www.w3.org/2000/svg","svg");u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height","41px"),u.setAttributeNS(null,"width","27px"),u.setAttributeNS(null,"viewBox","0 0 27 41");var c=o.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"stroke","none"),c.setAttributeNS(null,"stroke-width","1"),c.setAttributeNS(null,"fill","none"),c.setAttributeNS(null,"fill-rule","evenodd");var p=o.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"fill-rule","nonzero");var h=o.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"transform","translate(3.0, 29.0)"),h.setAttributeNS(null,"fill","#000000");for(var d=0,f=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];d<f.length;d+=1){var m=f[d],y=o.createNS("http://www.w3.org/2000/svg","ellipse");y.setAttributeNS(null,"opacity","0.04"),y.setAttributeNS(null,"cx","10.5"),y.setAttributeNS(null,"cy","5.80029008"),y.setAttributeNS(null,"rx",m.rx),y.setAttributeNS(null,"ry",m.ry),h.appendChild(y)}var v=o.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"fill",this._color);var g=o.createNS("http://www.w3.org/2000/svg","path");g.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),v.appendChild(g);var $=o.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");var _=o.createNS("http://www.w3.org/2000/svg","path");_.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(_);var x=o.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"transform","translate(6.0, 7.0)"),x.setAttributeNS(null,"fill","#FFFFFF");var b=o.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"transform","translate(8.0, 8.0)");var w=o.createNS("http://www.w3.org/2000/svg","circle");w.setAttributeNS(null,"fill","#000000"),w.setAttributeNS(null,"opacity","0.25"),w.setAttributeNS(null,"cx","5.5"),w.setAttributeNS(null,"cy","5.5"),w.setAttributeNS(null,"r","5.4999962");var E=o.createNS("http://www.w3.org/2000/svg","circle");E.setAttributeNS(null,"fill","#FFFFFF"),E.setAttributeNS(null,"cx","5.5"),E.setAttributeNS(null,"cy","5.5"),E.setAttributeNS(null,"r","5.4999962"),b.appendChild(w),b.appendChild(E),p.appendChild(h),p.appendChild(v),p.appendChild($),p.appendChild(x),p.appendChild(b),u.appendChild(p),this._element.appendChild(u),this._offset=r.Point.convert(i&&i.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(r){r.preventDefault()}),this._element.addEventListener("mousedown",function(r){r.preventDefault()}),this._element.addEventListener("focus",function(){var r=s._map.getContainer();r.scrollTop=0,r.scrollLeft=0}),no(this._element,this._anchor,"marker"),this._popup=null}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.addTo=function(r){return this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},i.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),o.remove(this._element),this._popup&&this._popup.remove(),this},i.prototype.getLngLat=function(){return this._lngLat},i.prototype.setLngLat=function(n){return this._lngLat=r.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},i.prototype.getElement=function(){return this._element},i.prototype.setPopup=function(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){var n=Math.sqrt(91.125);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[n,-1*(24.6+n)],"bottom-right":[-n,-1*(24.6+n)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=r,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},i.prototype._onKeyPress=function(r){var n=r.code,i=r.charCode||r.keyCode;"Space"!==n&&"Enter"!==n&&32!==i&&13!==i||this.togglePopup()},i.prototype._onMapClick=function(r){var n=r.originalEvent.target,i=this._element;this._popup&&(n===i||i.contains(n))&&this.togglePopup()},i.prototype.getPopup=function(){return this._popup},i.prototype.togglePopup=function(){var r=this._popup;return r&&(r.isOpen()?r.remove():r.addTo(this._map)),this},i.prototype._update=function(r){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=nn(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var n="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?n="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(n="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var i="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?i="rotateX(0deg)":"map"===this._pitchAlignment&&(i="rotateX("+this._map.getPitch()+"deg)"),r&&"moveend"!==r.type||(this._pos=this._pos.round()),o.setTransform(this._element,ni[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+i+" "+n)}},i.prototype.getOffset=function(){return this._offset},i.prototype.setOffset=function(n){return this._offset=r.Point.convert(n),this._update(),this},i.prototype._onMove=function(n){this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new r.Event("dragstart"))),this.fire(new r.Event("drag"))},i.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new r.Event("dragend")),this._state="inactive"},i.prototype._addDragHandler=function(r){this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},i.prototype.setDraggable=function(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},i.prototype.isDraggable=function(){return this._draggable},i.prototype.setRotation=function(r){return this._rotation=r||0,this._update(),this},i.prototype.getRotation=function(){return this._rotation},i.prototype.setRotationAlignment=function(r){return this._rotationAlignment=r||"auto",this._update(),this},i.prototype.getRotationAlignment=function(){return this._rotationAlignment},i.prototype.setPitchAlignment=function(r){return this._pitchAlignment=r&&"auto"!==r?r:this._rotationAlignment,this._update(),this},i.prototype.getPitchAlignment=function(){return this._pitchAlignment},i}(r.Evented),nl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},nu=0,nc=!1,np=function(n){function i(i){n.call(this),this.options=r.extend({},nl,i),r.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.onAdd=function(n){this._map=n,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),i=this._setupUI,void 0!==na?i(na):void 0!==r.window.navigator.permissions?r.window.navigator.permissions.query({name:"geolocation"}).then(function(r){i(na="denied"!==r.state)}):i(na=!!r.window.navigator.geolocation);var i,a=this;return n.on("load",function(){a.trigger()}),this._container},i.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(r.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),o.remove(this._container),this._map=void 0,nu=0,nc=!1},i.prototype._isOutOfMapMaxBounds=function(r){var n=this._map.getMaxBounds(),i=r.coords;return n&&(i.longitude<n.getWest()||i.longitude>n.getEast()||i.latitude<n.getSouth()||i.latitude>n.getNorth())},i.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},i.prototype._onSuccess=function(n){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new r.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(n),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("geolocate",n)),this._finish()},i.prototype._updateCamera=function(n){var i=new r.LngLat(n.coords.longitude,n.coords.latitude),o=n.coords.accuracy,a=this._map.getBearing(),s=r.extend({bearing:a},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(o),s,{geolocateSource:!0})},i.prototype._updateMarker=function(r){r?this._userLocationDotMarker.setLngLat([r.coords.longitude,r.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},i.prototype._onError=function(n){if(this.options.trackUserLocation){if(1===n.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===n.code&&nc)return;this._setErrorState()}}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("error",n)),this._finish()},i.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},i.prototype._setupUI=function(n){var i=this;if(this._container.addEventListener("contextmenu",function(r){return r.preventDefault()}),this._geolocateButton=o.create("button","mapboxgl-ctrl-geolocate",this._container),o.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===n){r.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{var s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=o.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new ns(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(n){var o=n.originalEvent&&"resize"===n.originalEvent.type;n.geolocateSource||"ACTIVE_LOCK"!==i._watchState||o||(i._watchState="BACKGROUND",i._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),i._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),i.fire(new r.Event("trackuserlocationend")))})},i.prototype.trigger=function(){if(!this._setup)return r.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":nu--,nc=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var n;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++nu>1?(n={maximumAge:6e5,timeout:0},nc=!0):(n=this.options.positionOptions,nc=!1),this._geolocationWatchID=r.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else r.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},i.prototype._clearWatch=function(){r.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},i}(r.Evented),nh={maxWidth:100,unit:"metric"},nd=function(n){this.options=r.extend({},nh,n),r.bindAll(["_onMove","setUnit"],this)};function nf(r,n,i){var o,a,s,u,c,p,h=i&&i.maxWidth||100,d=r._container.clientHeight/2,f=(o=r.unproject([0,d]),a=r.unproject([h,d]),s=Math.PI/180,6371e3*Math.acos(Math.min(p=Math.sin(u=o.lat*s)*Math.sin(c=a.lat*s)+Math.cos(u)*Math.cos(c)*Math.cos((a.lng-o.lng)*s),1)));if(i&&"imperial"===i.unit){var m=3.2808*f;m>5280?nm(n,h,m/5280,r._getUIString("ScaleControl.Miles")):nm(n,h,m,r._getUIString("ScaleControl.Feet"))}else i&&"nautical"===i.unit?nm(n,h,f/1852,r._getUIString("ScaleControl.NauticalMiles")):f>=1e3?nm(n,h,f/1e3,r._getUIString("ScaleControl.Kilometers")):nm(n,h,f,r._getUIString("ScaleControl.Meters"))}function nm(r,n,i,o){var a,s,u,c,p,h=(c=Math.pow(10,(""+Math.floor(u=i)).length-1),p=(p=u/c)>=10?10:p>=5?5:p>=3?3:p>=2?2:p>=1?1:Math.round(a*s)/(s=Math.pow(10,Math.ceil(-Math.log(a=p)/Math.LN10))),c*p);r.style.width=n*(h/i)+"px",r.innerHTML=h+o}nd.prototype.getDefaultPosition=function(){return"bottom-left"},nd.prototype._onMove=function(){nf(this._map,this._container,this.options)},nd.prototype.onAdd=function(r){return this._map=r,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",r.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},nd.prototype.onRemove=function(){o.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},nd.prototype.setUnit=function(r){this.options.unit=r,nf(this._map,this._container,this.options)};var ny=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof r.window.HTMLElement?this._container=n.container:r.warnOnce("Full screen control 'container' must be a DOM element.")),r.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in r.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in r.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in r.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in r.window.document&&(this._fullscreenchange="MSFullscreenChange")};ny.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},ny.prototype.onRemove=function(){o.remove(this._controlContainer),this._map=null,r.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},ny.prototype._checkFullscreenSupport=function(){return!!(r.window.document.fullscreenEnabled||r.window.document.mozFullScreenEnabled||r.window.document.msFullscreenEnabled||r.window.document.webkitFullscreenEnabled)},ny.prototype._setupUI=function(){var n=this._fullscreenButton=o.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);o.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),r.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},ny.prototype._updateTitle=function(){var r=this._getTitle();this._fullscreenButton.setAttribute("aria-label",r),this._fullscreenButton.title=r},ny.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},ny.prototype._isFullscreen=function(){return this._fullscreen},ny.prototype._changeIcon=function(){(r.window.document.fullscreenElement||r.window.document.mozFullScreenElement||r.window.document.webkitFullscreenElement||r.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},ny.prototype._onClickFullscreen=function(){this._isFullscreen()?r.window.document.exitFullscreen?r.window.document.exitFullscreen():r.window.document.mozCancelFullScreen?r.window.document.mozCancelFullScreen():r.window.document.msExitFullscreen?r.window.document.msExitFullscreen():r.window.document.webkitCancelFullScreen&&r.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var nv={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},ng=function(n){function i(i){n.call(this),this.options=r.extend(Object.create(nv),i),r.bindAll(["_update","_onClose","remove"],this)}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.addTo=function(n){var i=this;return this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",function(r){i._update(r.point)}),this._map.on("mouseup",function(r){i._update(r.point)}),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new r.Event("open")),this},i.prototype.isOpen=function(){return!!this._map},i.prototype.remove=function(){return this._content&&o.remove(this._content),this._container&&(o.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove"),delete this._map),this.fire(new r.Event("close")),this},i.prototype.getLngLat=function(){return this._lngLat},i.prototype.setLngLat=function(n){return this._lngLat=r.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove"),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},i.prototype.trackPointer=function(){var r=this;return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",function(n){r._update(n.point)}),this._map.on("drag",function(n){r._update(n.point)}),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},i.prototype.getElement=function(){return this._container},i.prototype.setText=function(n){return this.setDOMContent(r.window.document.createTextNode(n))},i.prototype.setHTML=function(n){var i,o=r.window.document.createDocumentFragment(),a=r.window.document.createElement("body");for(a.innerHTML=n;i=a.firstChild;)o.appendChild(i);return this.setDOMContent(o)},i.prototype.getMaxWidth=function(){return this._container.style.maxWidth},i.prototype.setMaxWidth=function(r){return this.options.maxWidth=r,this._update(),this},i.prototype.setDOMContent=function(r){return this._createContent(),this._content.appendChild(r),this._update(),this},i.prototype.addClassName=function(r){this._container.classList.add(r)},i.prototype.removeClassName=function(r){this._container.classList.remove(r)},i.prototype.toggleClassName=function(r){return this._container.classList.toggle(r)},i.prototype._createContent=function(){this._content&&o.remove(this._content),this._content=o.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=o.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},i.prototype._update=function(n){var i=this,a=this._lngLat||this._trackPointer;if(this._map&&a&&this._content&&(this._container||(this._container=o.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=o.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(r){return i._container.classList.add(r)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=nn(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var s=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),u=this.options.anchor,c=function n(i){if(i){if("number"==typeof i){var o=Math.round(Math.sqrt(.5*Math.pow(i,2)));return{center:new r.Point(0,0),top:new r.Point(0,i),"top-left":new r.Point(o,o),"top-right":new r.Point(-o,o),bottom:new r.Point(0,-i),"bottom-left":new r.Point(o,-o),"bottom-right":new r.Point(-o,-o),left:new r.Point(i,0),right:new r.Point(-i,0)}}if(i instanceof r.Point||Array.isArray(i)){var a=r.Point.convert(i);return{center:a,top:a,"top-left":a,"top-right":a,bottom:a,"bottom-left":a,"bottom-right":a,left:a,right:a}}return{center:r.Point.convert(i.center||[0,0]),top:r.Point.convert(i.top||[0,0]),"top-left":r.Point.convert(i["top-left"]||[0,0]),"top-right":r.Point.convert(i["top-right"]||[0,0]),bottom:r.Point.convert(i.bottom||[0,0]),"bottom-left":r.Point.convert(i["bottom-left"]||[0,0]),"bottom-right":r.Point.convert(i["bottom-right"]||[0,0]),left:r.Point.convert(i.left||[0,0]),right:r.Point.convert(i.right||[0,0])}}return n(new r.Point(0,0))}(this.options.offset);if(!u){var p,h=this._container.offsetWidth,d=this._container.offsetHeight;p=s.y+c.bottom.y<d?["top"]:s.y>this._map.transform.height-d?["bottom"]:[],s.x<h/2?p.push("left"):s.x>this._map.transform.width-h/2&&p.push("right"),u=0===p.length?"bottom":p.join("-")}var f=s.add(c[u]).round();o.setTransform(this._container,ni[u]+" translate("+f.x+"px,"+f.y+"px)"),no(this._container,u,"popup")}},i.prototype._onClose=function(){this.remove()},i}(r.Evented),n8={style:{default:"bright",bright:"https://apis.wemap.asia/vector-tiles/styles/osm-bright/style.json",dark:"https://apis.wemap.asia/vector-tiles/styles/osm-bright/style.json"},reverse:"https://apis.wemap.asia/geocode-1/reverse",streetMaxDistance:20,pointMaxDistance:20,pipService:"https://apis.wemap.asia/we-tools/pip",direction:{engine:{default:"https://apis.wemap.asia/direction-api/route/v1/",osrm:"https://apis.wemap.asia/direction-api/route/v1/",graphhopper:"https://apis.wemap.asia/route-api/route?",routeAPI:"http://route.wemap.vn/route?",testGraphhopper:"http://localhost:8989/route?",mapbox:"https://api.mapbox.com/directions/v5/"},geocoder:{default:"https://apis.wemap.asia/geocode-1/autocomplete?text=",pelias:"https://apis.wemap.asia/geocode-1/autocomplete?text=",mapbox:"https://api.mapbox.com/geocoding/v5/mapbox.places/"}},lookup:{osmTypeId:"https://apis.wemap.asia/we-tools/lookup",osmId:"https://apis.wemap.asia/we-tools/lookup/"},map:{center:[105.8550736,21.0283243],zoom:10},url:{view:{params:["x","y","z"],history:!1},route:{params:["ox","oy","dx","dy","vehicle","action","via"],history:!0},place:{params:["osmid","osmtype","name","lat","lon","address","type"],history:!0},reverse:{params:["rx","ry"],history:!1}},search:{url:"https://apis.wemap.asia/geocode-1"},language:{vi:"vi-VN",en:"en-US"},rerank:{iploc:"https://apis.wemap.asia/iploc/w?key=vpstPRxkBBTLaZkOaCfAHlqXtCR",accuracyUpperLimit:4e3},satellite:"https://apis.wemap.asia/geocode-1/satellite"},n$=r.createCommonjsModule(function(r){function n(r){if(r=r||{},this.opts={},this.opts.placeholder=r.placeholder||"Search",this.opts.url=r.url,this.opts.flyTo=void 0===r.flyTo||r.flyTo,this.opts.sources=r.sources,this.opts.useFocusPoint=r.useFocusPoint,this.opts.removeDuplicates=void 0===r.removeDuplicates||r.removeDuplicates,this.opts.onSubmitOnly=r.onSubmitOnly,this.customAttribution=r.customAttribution,r.marker&&(this.opts.marker={},this.opts.marker.icon=r.marker.icon||"marker-15",this.opts.marker.anchor=r.marker.anchor||"bottom",this.opts.marker.multiple=void 0===r.marker.multiple||r.marker.multiple,this._customHtmlMarkers=[]),r.wof&&(this.opts.wof={},this.opts.wof.url=r.wof.url||"https://raw.githubusercontent.com/whosonfirst-data/whosonfirst-data-admin-$country/master/data/",this.opts.wof.fillColor=r.wof.fillColor||"rgba(200, 40, 32, 0.1)",this.opts.wof.fillOutlineColor=r.wof.fillOutlineColor||"rgba(200, 40, 32, 0.7)",this.getWOFURL=r.wof.getWOFURL||this.getDefaultWOFURLFunction()),r.params)for(var n in this.params="",r.params)r.params.hasOwnProperty(n)&&(this.params+="&"+n+"="+r.params[n]);this.markerLayerId="pelias-mapbox-gl-js-marker",this.polygonLayerId="pelias-mapbox-gl-js-polygon",this._removePolygon=this._removeSources.bind(this,this.opts.wof,this.polygonLayerId),this._keys={},this._keys.enter={},this._keys.enter.key="Enter",this._keys.enter.keyCode=13,this._keys.arrowUp={},this._keys.arrowUp.key="ArrowUp",this._keys.arrowUp.keyCode=38,this._keys.arrowDown={},this._keys.arrowDown.key="ArrowDown",this._keys.arrowDown.keyCode=40}n.prototype.onAdd=function(r){this._map=r;var n=this._createElement({class:"pelias-ctrl mapboxgl-ctrl"}),i=this._createElement({class:"pelias-ctrl-input-wrapper"}),o=this._createElement({class:"pelias-ctrl-input-actions-wrapper pelias-ctrl-shadow"});return this._resultsEl=this._createElement({class:"pelias-ctrl-results pelias-ctrl-hide pelias-ctrl-shadow"}),this._inputEl=this._buildInputHTMLElement(),this._iconCrossEl=this._buildIconCrossHTMLElement(),this._iconSearchEl=this._buildIconSearchHTMLElement(),this._resultsListEl=this._buildResultsListHTMLElement(),i.appendChild(this._inputEl),i.appendChild(this._iconCrossEl),o.appendChild(i),o.appendChild(this._iconSearchEl),this._resultsEl.appendChild(this._resultsListEl),n.appendChild(o),n.appendChild(this._resultsEl),n},n.prototype.getDefaultPosition=function(){return"top-left"},n.prototype.search=function(r,n){if(!(r=r||{}).text||0===r.text.length)return n();this.opts.sources instanceof Array&&(this.opts.sources=this.opts.sources.join(",")),this._search=r.text;var i=this.opts.url+"/search?text="+r.text+(this.params?this.params:"")+(this.opts.sources?"&sources="+this.opts.sources:"")+(this.opts.useFocusPoint?"&focus.point.lat="+this._map.getCenter().lat+"&focus.point.lon="+this._map.getCenter().lng:"");this._sendXmlHttpRequest(i,n)},n.prototype._showResults=function(r){var n=this,i=this._removeDuplicates(r.features);this._results=r,this._resultsListEl.removeAll(),this._addOrRemoveClassToElement(this._resultsEl,0===i.length,"pelias-ctrl-hide"),i.forEach(function(r,o){n._resultsListEl.appendChild(n._buildAndGetResult(r,o)),n.opts.marker&&n.opts.marker.multiple&&n._updateMarkers(i)}),n._resultsListEl.appendChild(n._createAttribution(r.geocoding,i.length))},n.prototype._removeDuplicates=function(r){var n=this,i={};if(!this.opts.removeDuplicates)return r;for(var o in r.forEach(function(r){var n=r.properties.label;i[n]||(i[n]=[]),i[n].push(r)}),i)i.hasOwnProperty(o)&&i[o].forEach(function(r,a){if(!r.remove&&1!==i[o].length)for(var s=a+1;s<i[o].length;s++)!i[o][s].remove&&n._areNear(r.geometry.coordinates,i[o][s].geometry.coordinates,.2)&&(i[o][s].remove=!0)});return r.filter(function(r){return!r.remove})},n.prototype._showError=function(r){var n=this._createElement();n.innerHTML=r,this._resultsListEl.removeAll(),this._resultsListEl.appendChild(n)},n.prototype._selectFeature=function(r){this._selectedFeature=r,this._inputEl.value=r.properties.label,this._addOrRemoveClassToElement(this._iconSearchEl,!1,"pelias-ctrl-disabled")},n.prototype._goToFeatureLocation=function(r){this._results=void 0,this._resultsListEl.removeAll();var n={center:r.geometry.coordinates,zoom:this._getBestZoom(r)};this._useFlyTo(n)?this._map.flyTo(n):this._map.jumpTo(n),"whosonfirst"===r.properties.source&&["macroregion","region","macrocounty","county","locality","localadmin","borough","macrohood","neighbourhood","postalcode"].indexOf(r.properties.layer)>=0?this._showPolygon(r.properties,n.zoom):this._removePolygon()},n.prototype._showPolygon=function(r,n){this.opts.wof&&(this._removePolygon(),this._map.addLayer({id:this.polygonLayerId,type:"fill",source:{type:"geojson",data:this.getWOFURL(r)},paint:{"fill-color":this.opts.wof.fillColor,"fill-outline-color":this.opts.wof.fillOutlineColor,"fill-opacity":{stops:[[n+3,1],[n+4,0]]}}}))},n.prototype.getDefaultWOFURLFunction=function(){var r=this;return function(n){for(var i=n.id.toString(),o=[];i.length;){var a=i.substr(0,3);o.push(a),i=i.substr(3)}var s=n.country_a&&n.country_a.substring(0,2).toLowerCase();return r.opts.wof.url.replace("$country",s)+o.join("/")+"/"+n.id+".geojson"}},n.prototype._updateMarkers=function(r){if(this.opts.marker){if(this._removeMarkers(),Array.isArray(r)||(r=[r]),this.opts.marker.icon instanceof HTMLElement)for(var n=0;n<r.length;++n)this._customHtmlMarkers.push(this._addAndGetCustomHtmlMarker(r[n].geometry.coordinates));else this._map.addLayer({id:this.markerLayerId,type:"symbol",source:{type:"geojson",data:{type:"FeatureCollection",features:r}},layout:{"icon-allow-overlap":!0,"icon-image":this.opts.marker.icon,"icon-anchor":this.opts.marker.anchor}})}},n.prototype._addAndGetCustomHtmlMarker=function(r){return new i.Marker(this.opts.marker.icon.cloneNode(!0)).setLngLat(r).addTo(this._map)},n.prototype._removeMarkers=function(){if(this.opts.marker){if(this.opts.marker.icon instanceof HTMLElement){for(var r=0;r<this._customHtmlMarkers.length;++r)this._customHtmlMarkers[r].remove();this._customHtmlMarkers=[]}else this._removeSources(this.opts.marker,this.markerLayerId)}},n.prototype._createElement=function(r){var n=document.createElement(r.type||"div");return void 0!==r.class&&(n.className=r.class),void 0!==r.html&&(n.innerHTML=r.html),n},n.prototype._buildIconCrossHTMLElement=function(){var r=this,n=this._createElement({type:"span",class:"pelias-ctrl-icon-cross pelias-ctrl-hide"});return n.addEventListener("click",function(){r._clearAll()}),n},n.prototype._buildIconSearchHTMLElement=function(){var r=this,n=this._createElement({type:"span",class:"pelias-ctrl-action-icon pelias-ctrl-action-icon-search pelias-ctrl-disabled"});return n.addEventListener("click",function(){r._selectedFeature&&r._goToFeatureLocation(r._selectedFeature)}),n},n.prototype._buildInputHTMLElement=function(){var r=this,n=this._createElement({type:"input"});return n.type="text",n.placeholder=this.opts.placeholder,n.addEventListener("keyup",function(i){if(r._eventMatchKey(i,r._keys.enter)&&r._selectedFeature)return n.blur(),void r._goToFeatureLocation(r._selectedFeature);if(r._eventMatchKey(i,r._keys.arrowDown)&&r._results&&r._results.features[0])r._resultsListEl.firstChild.focus();else{var o=this.value.trim();0!==o.length?(r._selectedFeature&&o!==r._selectedFeature.properties.label&&(r._addOrRemoveClassToElement(r._iconSearchEl,!0,"pelias-ctrl-disabled"),r._selectedFeature=void 0),!r._eventMatchKey(i,r._keys.enter)&&r.opts.onSubmitOnly||(r._addOrRemoveClassToElement(r._iconCrossEl,!1,"pelias-ctrl-hide"),void 0!==this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=setTimeout(function(){r.search({text:o},function(n,i){return n?r._showError(n):i?r._showResults(i):void 0})},r._eventMatchKey(i,r._keys.enter)?0:350))):r._clearAll()}}),n},n.prototype._buildResultsListHTMLElement=function(){var r=this,n=this._createElement({class:"pelias-ctrl-results-list"});return n.removeAll=function(){for(r._addOrRemoveClassToElement(r._resultsEl,!0,"pelias-ctrl-hide");this.firstChild;)this.removeChild(this.firstChild)},n},n.prototype._buildAndGetResult=function(r,n){var i=this,o=this._createElement({class:"pelias-ctrl-result"});o.feature=r,o.setAttribute("tabindex","-1");var a=this._layerToIcon(r.properties.layer);if(a){var s=this._createElement({type:"span",class:"pelias-ctrl-icon-result "+a});o.appendChild(s)}var u=this._createElement({type:"span",class:"pelias-ctrl-wrapper-label"}),c=r.properties.label.match(/^([^,]+)(, (.+))?$/),p=this._boldingPartsOfStringAccordingToTheSearch(c[1],this._search);if(p.className="name",u.appendChild(p),c[3]){var h=this._createElement({type:"span",class:"pelias-ctrl-separator"});h.innerHTML=" - ",u.appendChild(h);var d=this._boldingPartsOfStringAccordingToTheSearch(c[3],this._search);d.className="pelias-ctrl-location",u.appendChild(d)}return o.appendChild(u),o.onclick=function(){i._goToFeatureLocation(r)},o.addEventListener("focus",function(){i._selectFeature(this.feature)}),o.addEventListener("keydown",function(o){i._eventMatchKey(o,i._keys.enter)&&i._goToFeatureLocation(r),i._eventMatchKey(o,i._keys.arrowUp)&&(i._resultsListEl.childNodes[n-1]?i._resultsListEl.childNodes[n-1].focus():n-1==-1&&i._inputEl.focus()),i._eventMatchKey(o,i._keys.arrowDown)&&i._resultsListEl.childNodes[n+1]&&i._resultsListEl.childNodes[n+1].focus()}),o},n.prototype._layerToIcon=function(r){switch(r){case"address":case"venue":default:return"pelias-ctrl-icon-result-marker";case"country":return"pelias-ctrl-icon-result-flag";case"localadmin":case"locality":return"pelias-ctrl-icon-result-city";case"street":return"pelias-ctrl-icon-result-road"}},n.prototype._boldingPartsOfStringAccordingToTheSearch=function(r,n){if(!n)return this._createElement({type:"span",html:r});for(var i,o=r.toLowerCase().split(n.toLowerCase()),a=this._createElement({type:"span"}),s=-1,u=0;u<o.length;++u){if(o[u].length>0){var c=this._createElement({type:"span"});i="";for(var p=0;p<o[u].length;++p)i+=r[++s];c.innerHTML=i,a.appendChild(c)}if(u+1<o.length){var h=this._createElement({type:"span"});h.className="pelias-ctrl-bold",i="";for(var d=1;d<=n.length;++d)i+=r[++s];h.innerHTML=i,a.appendChild(h)}}return a},n.prototype._createAttribution=function(r,n){var i=this._createElement({class:"pelias-ctrl-attribution"});i.setAttribute("tabindex","-1");var o=this._createElement({type:"span",class:"pelias-ctrl-wrapper-label"});return o.innerHTML=this.customAttribution||r.attribution,i.appendChild(o),i},n.prototype._sendXmlHttpRequest=function(r,n){var i=new XMLHttpRequest;i.addEventListener("load",function(){switch(this.status){case 200:return n(null,JSON.parse(this.responseText));case 400:return n("You sent a bad request.");case 401:return n("You are not authorized to use this geocode.");case 500:return n("This server can not answer yet.")}}),i.open("GET",r),i.send()},n.prototype._coordinatesToArray=function(r){return[r.lng,r.lat]},n.prototype._between=function(r,n,i){return r>=n&&r<=i},n.prototype._getBestZoom=function(r){var n=r.bbox;if(!n)return["address","venue","street"].indexOf(r.properties.layer)>-1?18:14;var i=Math.abs(n[2]-n[0])*Math.abs(n[3]-n[1]);return 0!==i?8.5-Math.log10(i):8.5},n.prototype._addOrRemoveClassToElement=function(r,n,i){var o=r.classList.contains(i);o&&!n?r.classList.remove(i):!o&&n&&r.classList.add(i)},n.prototype._useFlyTo=function(r){return"hybrid"===this.opts.flyTo?this._areNear(r.center,this._coordinatesToArray(this._map.getCenter()),this._getFlyToToleranceByZoom(this._map.getZoom())):this.opts.flyTo},n.prototype._getFlyToToleranceByZoom=function(r){return r<3?360:160/Math.pow(r+1,2)},n.prototype._areNear=function(r,n,i){return this._between(r[0],n[0]-i,n[0]+i)&&this._between(r[1],n[1]-i,n[1]+i)},n.prototype._removeSources=function(r,n){r&&this._map.getSource(n)&&(this._map.removeLayer(n),this._map.removeSource(n))},n.prototype._eventMatchKey=function(r,n){return void 0!==r.key&&r.key===n.key||void 0!==r.keyCode&&r.keyCode===n.keyCode},n.prototype._clearAll=function(){this._selectedFeature=void 0,this._addOrRemoveClassToElement(this._iconSearchEl,!0,"pelias-ctrl-disabled"),this._addOrRemoveClassToElement(this._iconCrossEl,!0,"pelias-ctrl-hide"),this._resultsListEl.removeAll(),this._inputEl.value="",this._removeMarkers(),this._removePolygon()},r.exports=n}),n_=function(){};n_.lookup=function(n,i){var o=n.osmId,a=n.osmType,s=n.key;switch(a){case null:case void 0:case"":a="N"}var u=n8.lookup.osmTypeId+"?key="+s+"&id="+a+o;r.makeRequest({url:u,method:"GET",key:s},function(r,n){r?console(r):i(n=JSON.parse(n))})};var nx=function(r){r=r||{},this.options=r,this.key=this.options.key};nx.prototype.setAttribute=function(r){this.options=r},nx.prototype.showDetailFeature=function(){document.getElementById("wemap-detail-feature").style.display="block";var r=this.options.type,n=this.options.lat,i=this.options.lon,o=this.options.name,a=this.options.address,s=nb.getAddress(a),u=this.options.osm_id,c=this.options.osm_type,p=document.getElementById("wemap-feature-name"),h=document.getElementById("feature-location"),d=document.getElementById("feature-coordinates");p.innerHTML=o,d.innerHTML='<i class="fa fa-compass"></i>  '+i+", "+n,h.innerHTML='<i class="fa fa-map"></i>  '+s,this.showAdvanceDetailFeature(u,c),wemapgl.urlController.updateParams("place",{name:o,type:r,lat:n,lon:i,address:a,osmid:u}),document.getElementById("wemap-feature-directions").onclick=function(){nb.initEventDirection(n,i)}},nx.prototype.deleteAdvanceDetailFeature=function(r){r.forEach(function(r){r.innerHTML="",r.classList.remove("wemap-detail-feature-element")})},nx.prototype.showAdvanceDetailFeature=function(r,n){var i=document.getElementById("feature-website"),o=document.getElementById("feature-opening-hours"),a=document.getElementById("feature-description"),s=document.getElementById("feature-phone"),u=document.getElementById("feature-internt-access"),c=document.getElementById("feature-fax"),p=document.getElementById("feature-email"),h=document.getElementById("feature-level"),d=document.getElementById("feature-smoking"),f=document.getElementById("feature-stars");if(this.deleteAdvanceDetailFeature([i,o,a,s,u,c,p,h,d,f]),r){var m=this.key;n_.lookup({osmId:r,osmType:n,key:m},function(r){if(r&&r[0]&&r[0].extratags){var n=r[0].extratags,m=n.website,y=n.description,v=n.phone,g=n.fax,$=n.email,_=n.level,x=n.smoking,b=n.stars,w=n.opening_hours,E=n.inrternet_access;if(m&&(i.innerHTML='<i class="fas fa-home"></i><a href="{'+m+'}">'+m+" </a>",i.className="wemap-detail-feature-element"),v&&(s.innerHTML='<i class="fas fa-phone"></i>'+v,s.className="wemap-detail-feature-element"),E&&(u.innerHTML='<i class="fas fa-wifi"></i>'+E,u.className="wemap-detail-feature-element"),g&&(c.innerHTML='<i class="fas fa-fax"></i>'+g,c.className="wemap-detail-feature-element"),$&&(p.innerHTML='<i class="fas fa-envelope"></i>'+$,p.className="wemap-detail-feature-element"),_&&(h.innerHTML='<i class="fas fa-layer-group"></i>'+_,h.className="wemap-detail-feature-element"),x&&(d.innerHTML='<i class="fas fa-smoking-ban"></i>'+x,d.className="wemap-detail-feature-element"),b&&(f.innerHTML='<i class="fas fa-star"></i>'+b,f.className="wemap-detail-feature-element"),y&&(a.innerHTML=y,a.style.borderBottom="1px solid lightgray",a.className="wemap-detail-feature-element",a.style.marginTop="0px"),w){var T=w.replace(/Th/gi,"Thứ 5").replace(/Mo/gi,"Thứ 2").replace(/Tu/gi,"Thứ 3").replace(/We/gi,"Thứ 4").replace(/Fr/gi,"Thứ 6").replace(/Sa/gi,"Thứ 7").replace(/Su/gi,"Chủ nhật").replace(/;/gi,"<br>");o.innerHTML='<i class="fas fa fa-clock-o"></i> <span>'+T+"</span>",o.className="wemap-detail-feature-element"}}})}};var nb=function r(n){return n=n||{},this.options=n,this.options.params={key:this.options.key},this.options.url=n8.search.url,this.options.suggestion.min_chars|=4,this.options.marker||(this.options.marker={}),this.options.useFocusPoint=!0,this.options.marker.icon=this.initMarker(),r.min_chars=this.options.suggestion.min_chars,this.geocoder=this.getGeocoder(this.options),this.geocoder.resultAutocompele=null,this.geocoder.resultSearch=null,this.place=new nx({key:this.options.key}),this.init(),this.geocoder};nb.prototype.getGeocoder=function(r){switch(r.engine){case void 0:case"default":case"pelias":return this.enginePeliasGeocoder(r);default:return null}},nb.prototype.enginePeliasGeocoder=function(r){return new n$(r)},nb.prototype.init=function(){this.initMultiView(),this.overrideFunctionPelias(),this.initEvent()},nb.prototype.flyto=function(r,n,i){void 0===i&&(i=15);var o=this.geocoder,a=o._map,s={center:[n,r],zoom:i};o._removePolygon(),o._useFlyTo(s)?a.flyTo(s):a.jumpTo(s)},nb.prototype.updateInfoFromUrl=function(){var r=this,n=wemapgl.urlController.getParams(),i=parseFloat(n.lat),o=parseFloat(n.lon),a=r.geocoder;if(i){r.place.setAttribute({name:n.name,type:n.type,lat:i,lon:o,address:n.address,osm_id:n.osmid,osm_type:n.osmtype}),a._removeMarkers(),a._results=null,r.place.showDetailFeature();try{a._customHtmlMarkers.push(a._addAndGetCustomHtmlMarker([o,i])),r.flyto(i,o)}catch(s){window.addEventListener("DOMContentLoaded",function(){a._customHtmlMarkers.push(a._addAndGetCustomHtmlMarker([o,i])),r.flyto(i,o)})}}},nb.prototype.updateListMarker=function(r){if(r){var n=this._removeDuplicates(r.features);this.opts.marker&&this.opts.marker.multiple&&this._updateMarkers(n)}},nb.prototype.getFeatureFromResultByLatLon=function(r){var n=this._results;if(!n)return null;var i=n.features;for(var o in i)if(r==i[o].geometry.coordinates)return i[o];return null},nb.prototype.overrideAddAndGetCustomHtmlMarker=function(r){var n=this,i=new wemapgl.Marker(this.opts.marker.icon.cloneNode(!0)).setLngLat(r).addTo(this._map),o=this.getFeatureFromResultByLatLon(r);if(!o)return i;var a=[o.properties.street,o.properties.county,o.properties.region,o.properties.country];a=nb.getAddress(a);var s=document.createElement("div");s.classList.add("viewPopup"),s.innerHTML='<div class="popupname">'+o.properties.name+'</div><div class="popupaddress">'+a+'</div><div class="popuplatlon">'+o.geometry.coordinates[0]+", "+o.geometry.coordinates[1]+"</div>",i._map.off("click",i._onMapClick),i._map.off("mousedown",i._addDragHandler),i._map.off("touchstart",i._addDragHandler),i._map.off("mousemove",i._onMove);var u=i._element;u.appendChild(s);var c=u.firstChild;return c.onmouseenter=function(r){var n=r.target;(n===u||u.contains(n))&&(s.style.display="block")},c.onmouseleave=function(r){s.style.display="none"},c.onclick=function(r){n._goToFeatureLocation(o,!0),r||(r=window.event),r.cancelBubble=!0,r.stopPropagation&&r.stopPropagation(),wemapgl.reverse.marker&&wemapgl.reverse.removeMarkerAndHideUI()},i},nb.prototype.overrideSearch=function(r,n,i){if(!(r=r||{}).text||0===r.text.length)return n();this.opts.sources instanceof Array&&(this.opts.sources=this.opts.sources.join(",")),this._search=r.text;var o=wemapgl.userLocation[0]&&wemapgl.userLocation[1]?"&location.lat="+wemapgl.userLocation[0]+"&location.lon="+wemapgl.userLocation[1]:"",a="&bbox.min_lat="+wemapgl.bboxMaxMin.minLatLng.lat+"&bbox.min_lon="+wemapgl.bboxMaxMin.minLatLng.lon+"&bbox.max_lat="+wemapgl.bboxMaxMin.maxLatLng.lat+"&bbox.max_lon="+wemapgl.bboxMaxMin.maxLatLng.lon,s=this.opts.url+"/"+i+"?text="+r.text+"&boundary.country=VNM"+(this.params?this.params:"")+(this.opts.sources?"&sources="+this.opts.sources:"")+o+a;this._sendXmlHttpRequest(s,n)},nb.prototype.initPolygon=function(){var r=this.geocoder;r.opts.wof={},r.opts.wof.url="https://raw.githubusercontent.com/whosonfirst-data/whosonfirst-data-admin-$country/master/data/",r.opts.wof.fillColor="rgba(200, 40, 32, 0.1)",r.opts.wof.fillOutlineColor="rgba(200, 40, 32, 0.7)",r.getWOFURL=r.getDefaultWOFURLFunction(),r._removePolygon=r._removeSources.bind(r,r.opts.wof,r.polygonLayerId)},nb.prototype.overrideRemovePolygon=function(){},nb.prototype.overrideBuildInputHTMLElement=function(){var r=this,n=this._createElement({type:"input"});return n.type="text",n.placeholder=this.opts.placeholder,n.addEventListener("focus",function(n){r._removeMarkers(),r.resultAutocompele&&r.resultAutocompele.features.length>0?(r.updateListMarker(r.resultAutocompele),r._resultsListEl.showAll()):r.resultSearch&&r.resultSearch.features.length>0&&(r.updateListMarker(r.resultSearch),nb.showResultSearch()),nb.hideDetailFeatureFrame()}),n.addEventListener("keyup",function(i){if(nb.hideNoResult(),r._eventMatchKey(i,r._keys.enter)&&r._selectedFeature)return n.blur(),void r._goToFeatureLocation(r._selectedFeature,!0);if(r._eventMatchKey(i,r._keys.arrowDown)&&r._results&&r._results.features[0])r._resultsListEl.firstChild.focus();else{var o=this.value.trim();0!==o.length?(r._selectedFeature&&o!==r._selectedFeature.properties.label&&(r._addOrRemoveClassToElement(r._iconSearchEl,!0,"pelias-ctrl-disabled"),r._selectedFeature=void 0),!r._eventMatchKey(i,r._keys.enter)&&r.opts.onSubmitOnly||(r._addOrRemoveClassToElement(r._iconCrossEl,!1,"pelias-ctrl-hide"),void 0!==this._timeoutId&&clearTimeout(this._timeoutId),r._eventMatchKey(i,r._keys.enter)&&(r.search({text:o},function(n,i){if(n)return r._showError(n);if(i){r._clearAll(),nb.hideDetailFeatureFrame(),r.createResultsSearch(i),r._results=i,r.resultSearch=i,r.resultAutocompele=null;var o=r._removeDuplicates(i.features);r.opts.marker&&r.opts.marker.multiple&&r._updateMarkers(o),r._addOrRemoveClassToElement(r._iconCrossEl,!1,"pelias-ctrl-hide"),r._addOrRemoveClassToElement(r._iconSearchEl,!1,"pelias-ctrl-disabled")}},"search"),r._resultsListEl.hideAll()),r._eventMatchKey(i,r._keys.enter)||r._eventMatchKey(i,r._keys.arrowUp)||this.value.length>=nb.min_chars&&r.search({text:o},function(n,i){return n?r._showError(n):i?(r.resultAutocompele=i,r._resultsListEl.showAll(),r._showResults(i)):void 0},"autocomplete"))):r._clearAll()}}),n},nb.prototype.initEventClickBottomCard=function(){var r=this,n=document.getElementById("wemap-click-detail");n&&n.addEventListener("click",function(n){r.updateInfoFromUrl(),nb.hideResultSearch()})},nb.initEventDirection=function(r,n){nb.hideAll(),wemapgl.urlController.updateParams("route",{dx:r,dy:n})},nb.prototype.initEventIconCross=function(){var r=this,n=this.geocoder._buildIconCrossHTMLElement;this.geocoder._buildIconCrossHTMLElement=function(){var i=n.call(this);return i.addEventListener("click",function(){r._results=null,r.resultAutocompele=null,r.resultSearch=null,nb.hideDetailFeatureFrame(),nb.hideResultSearch(),nb.removeAllMarker()}),i}},nb.prototype.initEventCloseDetailFrame=function(){var r=this.geocoder;document.getElementById("wemap-close-detail-button").addEventListener("click",function(){r._removeMarkers(),r._results&&r._results.features.length>0&&r.updateListMarker(),nb.hideDetailFeatureFrame()})},nb.prototype.initEventClickMap=function(){var r=this,n=r.geocoder;this.geocoder._map.on("click",function(i){nb.hideResultAutocompele(),nb.removeAllMarker(),n.resultSearch&&n.resultSearch.features.length>0&&n.updateListMarker(n.resultSearch),wemapgl.reverse&&wemapgl.reverse.isIcon(i)&&setTimeout(function(){r.updateInfoFromUrl(),wemapgl.reverse.removeMarkerAndHideUI()},300)})},nb.prototype.initEvent=function(){var r=this;window.addEventListener("DOMContentLoaded",function(){r.initEventClickBottomCard(),r.initEventCloseDetailFrame(),r.clickedToResultLists(),r.initEventClickMap()})},nb.prototype.createResultsSearch=function(r){var n=this,i=document.getElementById("wemap-results-list");if(0==r.features){var o=document.getElementById("wemap-no-result");return o.classList.add("wemap-no-result"),o.innerHTML='Kh\xf4ng c\xf3 kết quả t\xecm kiếm<span class="fa fa-times" id= "wemap-icon-cross-noresult"></span>',nb.hideResultSearch(),nb.showNoResult(),n._clearAll(),void document.getElementById("wemap-icon-cross-noresult").addEventListener("click",function(r){nb.hideNoResult()})}nb.hideNoResult(),nb.showResultSearch();var a=r.features;n._goToFeatureLocation(a[0]);var s="";a.forEach(function(r,n){n<a.length&&(s=s+'<li class="js-poicard poicard"><div class="f-control feature-directions"><i class="fa fa-arrow-right wemap-directions"  class="routing-button"></i><div class="result-way">Đường đi</div></div><div class="poicard-info w_rating"><h5 class="poicard-title" ><a href="/en/map/3461127733553674">'+r.properties.name+'</a></h5><span class="average">0 </span><span class="stars"><div class="rating"><label class = "full" for="star5" title="Awesome - 5 stars"></label><label class = "full" for="star4" title="Pretty good - 4 stars"></label><label class = "full" for="star3" title="Meh - 3 stars"></label><label class = "full" for="star2" title="Kinda bad - 2 stars"></label><label class = "full" for="star1" title="Sucks big time - 1 star"></label></div></span><span class="average1"> ('+Math.floor(300+1e3*Math.random())+')</span><div class="poicard-category_and_rating"><div class="poicard-category">'+r.geometry.type+'</div></div><ul class="poicard-data"><div class="poicard-data-item address">'+nb.getAddress([r.properties.street,r.properties.county,r.properties.region,r.properties.country])+'</div><div id="lat-log">'+r.geometry.coordinates[1]+","+r.geometry.coordinates[0]+"</div></ul></div></li>")}),i.innerHTML=s,i.querySelectorAll("li").forEach(function(r,i){r.onmouseover=function(r){n._goToFeatureLocation(a[i])},r.onclick=function(r){n._selectFeature(a[i]),n._goToFeatureLocation(a[i],!0),nb.hideResultSearch()};for(var o=r.querySelectorAll(".full"),s=2+Math.floor(3*Math.random()*10)/10,u=0;u<Math.floor(s);u++)o[4-u].style.color="#E7711B";r.querySelector(".average").innerHTML=s,o.onclick=function(r){r||(r=window.event),r.cancelBubble=!0,r.stopPropagation&&r.stopPropagation()},r.querySelector(".f-control").onclick=function(r){r||(r=window.event),r.cancelBubble=!0,r.stopPropagation&&r.stopPropagation();var n=wemapgl.urlController.getParams();nb.initEventDirection(n.x,n.y)},r.querySelector(".stars").onclick=function(r){r||(r=window.event),r.cancelBubble=!0,r.stopPropagation&&r.stopPropagation()}})},nb.prototype.initMarker=function(){var r=document.createElement("div");return r.innerHTML="<div class='wemap-marker-arrow'></div><div class='wemap-marker-pulse'></div>",r},nb.prototype.initMultiView=function(){var r=document.createElement("div");r.setAttribute("id","wemap-results-search"),r.innerHTML='<div id="wemap-results-items"><section class="results with_ads">    <ul id="wemap-results-list"></ul></section></div><ul id="wemap-no-result"></ul>';var n=document.createElement("div");n.setAttribute("id","wemap-detail-feature"),n.setAttribute("class","wemap-scrollbar"),n.innerHTML='<button class="btn" id="wemap-close-detail-button" title="Close"><i class="fa fa-close"></i></button><div class="wemap-detail-feature-element" id="wemap-feature-img"></div><div class="wemap-detail-feature-heading">    <div id="wemap-feature-name"></div>    <div class="wemap-detail-feature-category-rating">        <div id="feature-rating"></div>    </div></div><div id="wemap-feature-controls">    <div class="wemap-feature-control" id="wemap-feature-directions">        <i class="fa fa-arrow-right "></i><span>Chỉ đường</span>    </div>    <div class="wemap-feature-control">        <i class="fa fa-share-alt"></i><span>Chia sẻ</span>    </div>    <div class="wemap-feature-control">        <i class="fa fa-comments"></i><span>Nhận x\xe9t</span>    </div></div><div class="wemap-detail-feature-body">    <p id="feature-description"></p>    <div class="wemap-information-feature">        <div class="wemap-detail-feature-element" id="feature-location">        </div>        <div class="wemap-detail-feature-element" id="feature-coordinates">        </div>        <div id="feature-website">        </div>        <div id="feature-phone">        </div>        <div id="feature-opening-hours">        </div>        <div id="feature-internt-access">        </div>        <div id="feature-fax">        </div>        <div id="feature-email">        </div>        <div id="feature-level">        </div>        <div id="feature-smoking">        </div>        <div id="feature-stars">        </div>        <div id="feature-smoking">        </div>    </div></div>',document.body.appendChild(r),document.body.appendChild(n)},nb.prototype.overrideFunctionPelias=function(){var n=this,i=n.geocoder;n.updateInfoFromUrl(),i._sendXmlHttpRequest=function(i,o){var a=n.options.key;i=r.encodeURL(i,a);var s=new XMLHttpRequest;s.addEventListener("load",function(){switch(this.status){case 200:return o(null,JSON.parse(this.responseText));case 400:return o("You sent a bad request.");case 401:return o("You are not authorized to use this geocode.");case 500:return o("This server can not answer yet.")}}),s.open("GET",i),s.setRequestHeader("accept-language","vi-VN,vn;q=0.9"),s.send()},n.initPolygon(),i._buildAndGetResult=function(r,n){var i=this,o=this._createElement({class:"pelias-ctrl-result"});o.feature=r,o.setAttribute("tabindex","-1");var a=this._layerToIcon(r.properties.layer);if(a){var s=this._createElement({type:"span",class:"pelias-ctrl-icon-result "+a});o.appendChild(s)}var u="";u=r.properties.name?u+r.properties.name:u,u=r.properties.street?u+", "+r.properties.street:u;var c=this._boldingPartsOfStringAccordingToTheSearch(u,this._search);c.className="name";var p=this._createElement({type:"span",class:"pelias-ctrl-wrapper-label"});if(p.appendChild(c),r.properties.country){var h=this._createElement({type:"span",class:"pelias-ctrl-separator"});h.innerHTML=" - ",p.appendChild(h);var d="";d=r.properties.locality?d+r.properties.locality+", ":d,d=r.properties.county?d+r.properties.county+", ":d,d=r.properties.region?d+r.properties.region+", ":d,d=r.properties.country?d+r.properties.country:d;var f=this._boldingPartsOfStringAccordingToTheSearch(d,this._search);f.className="pelias-ctrl-location",p.appendChild(f)}return o.appendChild(p),o.addEventListener("focus",function(){i._goToFeatureLocation(r),i._resultsListEl.showAll()}),o.addEventListener("click",function(){nb.hideResultSearch(),i._goToFeatureLocation(r,!0)}),o.addEventListener("keydown",function(o){i._eventMatchKey(o,i._keys.enter)&&i._goToFeatureLocation(r,!0),i._eventMatchKey(o,i._keys.arrowUp)&&(i._resultsListEl.childNodes[n-1]?i._resultsListEl.childNodes[n-1].focus():n-1==-1&&i._inputEl.focus()),i._eventMatchKey(o,i._keys.arrowDown)&&i._resultsListEl.childNodes[n+1]&&i._resultsListEl.childNodes[n+1].focus()}),o},n.initEventIconCross(),i.getFeatureFromResultByLatLon=n.getFeatureFromResultByLatLon,i._addAndGetCustomHtmlMarker=n.overrideAddAndGetCustomHtmlMarker,i.createResultsSearch=n.createResultsSearch,i.search=n.overrideSearch,n.geocoder._buildInputHTMLElement=n.overrideBuildInputHTMLElement,i.updateListMarker=n.updateListMarker;var o=n.geocoder._buildResultsListHTMLElement;i._buildResultsListHTMLElement=function(){var r=o.call(this);return r.hideAll=function(){r.style.display="none"},r.showAll=function(){r.style.display="block"},r},i._goToFeatureLocation=function(r,i){var o=r.properties,a=r.geometry.coordinates[1],s=r.geometry.coordinates[0],u="",c="";if("openstreetmap"==r.properties.source&&(u=o.id.match(/[0-9]/g).join(""),c=o.id.match(/[a-zA-Z]/).join("").toUpperCase()),i){this._removeMarkers();var p=o.name,h=r.geometry.type,d=[o.street,o.locality,o.county,o.region,o.country];n.place.setAttribute({name:p,type:h,lat:a,lon:s,address:d,osm_id:u,osm_type:c}),n.place.showDetailFeature(),this._updateMarkers(r)}var f=this._getBestZoom(r);n.flyto(a,s,f);var m={center:r.geometry.coordinates,zoom:f};"whosonfirst"===r.properties.source&&["macroregion","region","macrocounty","county","locality","localadmin","borough","macrohood","neighbourhood","postalcode"].indexOf(r.properties.layer)>=0?this._showPolygon(r.properties,m.zoom):this._removePolygon()}},nb.getAddress=function(r){Array.isArray(r)||(r=r.split(","));for(var n="",i="",o=0;o<r.length;o++)r[o]=r[o]?r[o]:"",r[o]&&(n=n+i+r[o],i=", ");return n},nb.hideDetailFeatureFrame=function(){document.getElementById("wemap-detail-feature")&&(document.getElementById("wemap-detail-feature").style.display="none"),wemapgl.urlController.deleteParams("place")},nb.hideResultSearch=function(){document.getElementById("wemap-results-items").style.display="none",document.getElementById("wemap-no-result").style.display="none"},nb.showResultSearch=function(){document.getElementById("wemap-results-items").style.display="inline-block"},nb.hideNoResult=function(){document.getElementById("wemap-no-result").style.display="none"},nb.showNoResult=function(){document.getElementById("wemap-no-result").style.display="inline-block"},nb.hideResultAutocompele=function(){var r=document.getElementsByClassName("pelias-ctrl-results-list")[0];r&&(r.style.display="none")},nb.removeAllMarker=function(){document.querySelectorAll("div.mapboxgl-marker.mapboxgl-marker-anchor-center").forEach(function(r){r.remove()})},nb.hideAll=function(){document.getElementsByClassName("pelias-ctrl-icon-cross")[0].click()},nb.prototype.clickedToResultLists=function(){window.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("div.pelias-ctrl-results.pelias-ctrl-shadow")[0].addEventListener("click",function(){wemapgl.reverse.removeMarkerAndHideUI()})})};var nw=function(r){this.options=r,this.map=this.options.map,this.key=this.options.key,this.on=!0,this.pointLayers=[],this.receivedData={},this.marker,this.receivedDataType="",this.getStyle(),this.leftClick(),this.clickBottomCard(),this.clickDirectionIcon(),this.closeBottomCard()};nw.prototype.onReverse=function(){this.on=!0},nw.prototype.offReverse=function(){this.displayUI("wemap-place","none"),this.on=!1},nw.prototype.getStyle=function(){var n=this,i=[];r.makeRequest({url:""+n8.style.bright,method:"GET",key:this.key},function(r,o){o=JSON.parse(o);for(var a=0;a<o.layers.length;a++){var s=o.layers[a].id;s.includes("poi")&&i.push(s)}n.pointLayers=i,n.hoverIcon()})},nw.prototype.hoverIcon=function(){var r=this;this.pointLayers.forEach(function(n,i){r.map.on("mouseover",n,function(n){r.map.getCanvas().style.cursor="pointer"}),r.map.on("mouseleave",n,function(n){r.map.getCanvas().style.cursor=""})})},nw.prototype.getReverseData=function(n){var i=this;return new Promise(function(o,a){r.makeRequest({url:n8.reverse+"?point.lat="+n.lngLat.lat+"&point.lon="+n.lngLat.lng,method:"GET",key:i.key,headers:{"accept-language":"vi-VN,vn;q=0.9"}},function(r,n){r?a(r):o(n=JSON.parse(n))})})},nw.prototype.getReversePolygonData=function(n){var i=this;return new Promise(function(o,a){r.makeRequest({url:n8.reverse+"?point.lat="+n.lngLat.lat+"&point.lon="+n.lngLat.lng+"&layers=locality",method:"GET",key:i.key,headers:{"accept-language":"vi-VN,vn;q=0.9"}},function(r,n){r?a(r):o(n=JSON.parse(n))})})},nw.prototype.getReverseStreetData=function(n){var i=this;return new Promise(function(o,a){r.makeRequest({url:n8.reverse+"?point.lat="+n.lngLat.lat+"&point.lon="+n.lngLat.lng+"&layers=street",method:"GET",key:i.key,headers:{"accept-language":"vi-VN,vn;q=0.9"}},function(r,n){r?a(r):o(n=JSON.parse(n))})})},nw.prototype.leftClick=function(){var r=this;this.map.on("click",function(n){r.on&&r.onClick(n)})},nw.prototype.rightClick=function(r){this.onClick(r)},nw.prototype.onClick=function(r){var n=this,i=this,o=i.isIcon(r);this.getReverseData(r).then(function(a){var s=a.features,u=s.length,c=!1;if(0===u||o||n.checkDistance(s[0],n8.pointMaxDistance)||(c=!0),0===u||c)n.getReversePolygonData(r).then(function(i){0===i.features.length?n.showUiNoData(r.lngLat.lat,r.lngLat.lng):(n.receivedDataType="polygon",n.clickoutIcon(i.features[0]))});else if(o){var p=i.validatePointDetailClicked(s,r);n.receivedDataType="point",p.length>0?n.clickonIcon(p[0]):n.clickonIcon(s[0])}else n.receivedDataType="point",n.clickoutIcon(s[0]);n.addMarker(r.lngLat.lng,r.lngLat.lat)}).catch(function(r){return console.log(r)})},nw.prototype.validatePointDetailClicked=function(r,n){var i=this.map.queryRenderedFeatures(n.point,{layers:this.pointLayers})[0].properties.name;return r.filter(function(r){return r.properties.name===i})},nw.prototype.isIcon=function(r){for(var n=this.map.queryRenderedFeatures(r.point),i=!1,o=0;o<n.length;o++)if(this.pointLayers.includes(n[o].layer.id)){i=!0;break}return i},nw.prototype.clickoutIcon=function(r){this.displayUI("wemap-detail-feature","none"),wemapgl.urlController.deleteParams("route"),wemapgl.urlController.deleteParams("place"),this.displayUI("wemap-place","block");for(var n=this.listAddress(r),i=[],o=0,a=0;a<5;a++){var s=n[a];if(s){document.getElementById("wemap-placename").innerHTML=s,o=a;break}}for(var u=o+1;u<5;u++){var c=n[u];c&&i.push(c)}document.getElementById("wemap-placeadd").innerHTML=i.join(", "),document.getElementById("wemap-placelatlon").innerHTML=Number(r.geometry.coordinates[0]).toFixed(7)+", "+Number(r.geometry.coordinates[1]).toFixed(7),this.receivedData=r},nw.prototype.checkDistance=function(r,n){var i=!1;return r.properties.distance<=n/1e3&&(i=!0),i},nw.prototype.clickonIcon=function(r){this.displayUI("wemap-place","none"),this.receivedDataType="point",this.removeMarkerAndHideUI(),this.updateUrlDetailFeatures(r)},nw.prototype.updateUrlDetailFeatures=function(r){var n=this.listAddress(r),i=n[0];n.splice(0,1);var o={name:i,type:r.type,lat:r.geometry.coordinates[1],lon:r.geometry.coordinates[0],address:n,osmid:r.properties.id.split("/")[1],osmtype:r.properties.osm_type};wemapgl.urlController.deleteParams("route"),wemapgl.urlController.deleteParams("place"),wemapgl.urlController.updateParams("place",o)},nw.prototype.showUiNoData=function(r,n){this.displayUI("wemap-place","block"),this.receivedData={},document.getElementById("wemap-placename").innerHTML="Kh\xf4ng c\xf3 th\xf4ng tin",document.getElementById("wemap-placeadd").innerHTML="Kh\xf4ng c\xf3 th\xf4ng tin",document.getElementById("wemap-placelatlon").innerHTML=Number(n).toFixed(7)+" ,"+Number(r).toFixed(7)},nw.prototype.addMarker=function(r,n){this.marker&&this.marker.remove();var i=document.createElement("div");i.innerHTML="<div class='wemap-marker-arrow wemap-background-color-red'></div><div class='wemap-marker-pulse'></div>",this.marker=new wemapgl.Marker(i).setLngLat([r,n]).addTo(this.map)},nw.prototype.clickBottomCard=function(){var r=this;document.getElementById("wemap-click-detail").addEventListener("click",function(n){r.displayUI("wemap-place","none"),r.marker.remove(),Object.keys(r.receivedData).length&&r.updateUrlDetailFeatures(r.receivedData)})},nw.prototype.removeMarkerAndHideUI=function(){this.displayUI("wemap-place","none"),this.marker&&this.marker.remove()},nw.prototype.closeBottomCard=function(){var r=this;document.getElementById("wemap-placeclose").addEventListener("click",function(n){r.displayUI("wemap-place","none")})},nw.prototype.clickDirectionIcon=function(){var r=this;document.getElementById("wemap-direction-icon").addEventListener("click",function(n){Object.keys(r.receivedData).length&&(nb.hideAll(),wemapgl.urlController.updateParams("route",{dx:r.receivedData.geometry.coordinates[0],dy:r.receivedData.geometry.coordinates[1]}))})},nw.prototype.listAddress=function(r){var n=[r.properties.name,r.properties.street,r.properties.locality,r.properties.county,r.properties.region,r.properties.country];return"polygon"===this.receivedDataType?n.splice(1,2):"street"===this.receivedDataType&&n.splice(1,1),n},nw.prototype.displayUI=function(r,n){if(r){var i=document.getElementById(r);i&&(i.style.display=n)}};var n0=function(r){this.options=r,this.map=this.options.map,this.key=this.options.key,this.on=this.options.on,this.turnOnTrafficDefault(this.map)};n0.prototype.onTraffic=function(){this.on=!0,this.turnOnTraffic(this.map)},n0.prototype.offTraffic=function(){this.on=!1,this.turnOffTraffic(this.map)},n0.prototype.getTrafficStatus=function(){},n0.prototype.turnOnTrafficDefault=function(r){this.on&&r.once("idle",function(n){r&&r.getBounds&&(r.addSource("wemap-traffic",{type:"raster",tiles:["https://mt1.google.com/vt/lyrs=transit,traffic&x={x}&y={y}&z={z}"],tileSize:256,attribution:'Traffic Map by <a target="_top" rel="noopener" href="https://wemap.asia">WeMap</a>'}),r.addLayer({id:"wemap-traffic-tiles",type:"raster",source:"wemap-traffic",minzoom:0,maxzoom:22}))})},n0.prototype.turnOnTraffic=function(r){this.on&&(r.addSource("wemap-traffic",{type:"raster",tiles:["https://mt1.google.com/vt/lyrs=transit,traffic&x={x}&y={y}&z={z}"],tileSize:256,attribution:'Traffic Map by <a target="_top" rel="noopener" href="https://wemap.asia">WeMap</a>'}),r.addLayer({id:"wemap-traffic-tiles",type:"raster",source:"wemap-traffic",minzoom:0,maxzoom:22}))},n0.prototype.turnOffTraffic=function(r){this.on||r.getLayer("wemap-traffic-tiles")&&r.getSource("wemap-traffic")&&(r.removeLayer("wemap-traffic-tiles"),r.removeSource("wemap-traffic"))};var nE=function(r){this.options=r,this.map=this.options.map,this.key=this.options.key,this.on=this.options.on,this.wmsTiles=n8.satellite,this.turnOnSatelliteDefault(this.map)};nE.prototype.onSatellite=function(){this.on=!0,this.turnOnSatellite(this.map)},nE.prototype.offSatellite=function(){this.on=!1,this.turnOffSatellite(this.map)},nE.prototype.getSatelliteStatus=function(){},nE.prototype.turnOnSatelliteDefault=function(r){var n=this;n.on&&r.once("idle",function(i){r&&r.getBounds&&(r.addSource("wemap-satellite",{type:"raster",tiles:[n.wmsTiles+"/{z}/{y}/{x}?key="+n.key],tileSize:256}),r.addLayer({id:"wemap-satellite-tiles",type:"raster",source:"wemap-satellite",minzoom:0,maxzoom:18,paint:{}},"highway-primary"))})},nE.prototype.turnOnSatellite=function(r){this.on&&(r.addSource("wemap-satellite",{type:"raster",tiles:[this.wmsTiles+"/{z}/{y}/{x}?key="+this.key],tileSize:256}),r.addLayer({id:"wemap-satellite-tiles",type:"raster",source:"wemap-satellite",minzoom:0,maxzoom:18,paint:{}},"highway-primary"))},nE.prototype.turnOffSatellite=function(r){this.on||r.getLayer("wemap-satellite-tiles")&&r.getSource("wemap-satellite")&&(r.removeLayer("wemap-satellite-tiles"),r.removeSource("wemap-satellite"))};var nT=function(r){this.map=r,this.lat=0,this.lon=0,this.clickedPoi={},this.initView(),this.addMenuItemStart(),this.addMenuItemEnd(),this.addMenuItemReverse(),this.showMenu(),this.updateUrlStart(),this.updateUrlEnd(),this.closeMenu(),this.onReverse(),this.getLocation()};nT.prototype.initView=function(){var r=document.createElement("div");r.innerHTML="<div id = \"wemap-right-click-menu-container\"style = 'display: none'></div>",document.body.appendChild(r);var n=document.createElement("div");n.innerHTML='<div id="wemap-place" style="display: none"><div class="wemap-class-pl"><div class="wemap-image-place"><img class="wemap-placeicon" id="wemap-preview-image"></div><div class="wemap-add-place"><button class="wemap-click-detail" id="wemap-click-detail"><a class="wemap-placename" id="wemap-placename">a</a><a class="wemap-placeadd" id="wemap-placeadd">a</a></button><div class="wemap-placelatlon"><a href="#" id="wemap-placelatlon"></a></div></div><div class="wemap-image-direc"><div id="wemap-direction-icon"></div></div><div class="wemap-close-place"><div id="wemap-placeclose" style="color: black;"><i class="fa fa-times"></i></div></div></div></div>',document.body.appendChild(n)},nT.prototype.showMenu=function(){var r=this;this.map.on("contextmenu",function(n){var i=n.point.x,o=n.point.y,a=window.innerWidth,s=window.innerHeight,u=document.getElementById("wemap-right-click-menu-container").clientWidth,c=document.getElementById("wemap-right-click-menu-container").clientHeight,p=0,h=0;p=i+u>a?a-u:i,h=o+c>s?s-c:o,r.displayUI("wemap-right-click-menu-container","block"),document.getElementById("wemap-right-click-menu-container").style.transform="translate("+p+"px,"+h+"px)",r.clickedPoi=n})},nT.prototype.closeMenu=function(){var r=this;this.map.on("click",function(n){r.displayUI("wemap-right-click-menu-container","none")})},nT.prototype.closeMenuUI=function(){this.displayUI("wemap-right-click-menu-container","none")},nT.prototype.onReverse=function(){var r=this;document.getElementById("wemap-right-click-reverse").addEventListener("click",function(n){r.displayUI("wemap-right-click-menu-container","none"),wemapgl.reverse.rightClick(r.clickedPoi)})},nT.prototype.displayUI=function(r,n){document.getElementById(r).style.display=n},nT.prototype.addMenuItem=function(r,n){var i=document.createElement("div");i.setAttribute("id",r),i.setAttribute("class","wemap-right-click-menu-item"),i.innerText=n,document.getElementById("wemap-right-click-menu-container").appendChild(i)},nT.prototype.addMenuItemStart=function(){this.addMenuItem("wemap-right-click-start","Điểm bắt đầu")},nT.prototype.addMenuItemEnd=function(){this.addMenuItem("wemap-right-click-end","Điểm kết th\xfac")},nT.prototype.addMenuItemReverse=function(){this.addMenuItem("wemap-right-click-reverse","Đ\xe2y l\xe0 đ\xe2u ?")},nT.prototype.updateUrlStart=function(){var r=this;document.getElementById("wemap-right-click-start").addEventListener("click",function(n){wemapgl.urlController.updateParams("route",{ox:r.clickedPoi.lngLat.lng,oy:r.clickedPoi.lngLat.lat,action:!0})})},nT.prototype.updateUrlEnd=function(){var r=this;document.getElementById("wemap-right-click-end").addEventListener("click",function(n){wemapgl.urlController.updateParams("route",{dx:r.clickedPoi.lngLat.lng,dy:r.clickedPoi.lngLat.lat,action:!0})})},nT.prototype.getLocation=function(){var r=this;this.map.on("contextmenu",function(n){r.lat=n.lngLat.lat,r.lon=n.lngLat.lng})};var nS=function(){};nS.prototype.getParams=function(){var r=this,n={};for(var i in n8.url)n8.url[i].params.forEach(function(i){n[i]=r.parseParam(i)});return n},nS.prototype.updateParams=function(r,n){var i=n||{},o=new URL(window.location),a=new URLSearchParams(o.search);n8.url[r].params.forEach(function(r){null!=i[r]&&""!=i[r]&&null!=i[r]&&a.set(r,i[r])}),o.search=a.toString(),n8.url[r].history?window.history.pushState("","",o):window.history.replaceState("","",o)},nS.prototype.deleteParams=function(r){var n=new URL(window.location),i=new URLSearchParams(n.search);n8.url[r].params.forEach(function(r){i.delete(r)}),n.search=i.toString(),n8.url[r].history?window.history.pushState("","",n):window.history.replaceState("","",n)},nS.prototype.parseParam=function(r){var n=new URL(window.location).searchParams.get(r);return null!=n&&""!=n&&null!=n||(n=null),n};var nC=function(n){return n=n||{},this.options=n,n.key&&(r.window.WEMAP_TOKEN=n.key),this.init(),this.map};nC.prototype.init=function(){var r=this;switch(this.options.style){case"dark":case"bright":break;default:this.options.style=n8.style.default}var n=Object.assign({},this.options);switch(delete n.reverse,delete n.key,delete n.urlController,delete n.traffic,delete n.satellite,n.style=n8.style[this.options.style],n.attributionControl=!1,n.center){case null:case void 0:case[]:n.center=n8.map.center}switch(n.zoom){case null:case void 0:n.zoom=n8.map.zoom}switch(this.map=new wemapgl.Map(n),this.options.reverse){case!0:case"true":case null:case void 0:case"default":wemapgl.rightClick=new nT(this.map,this.options.key),wemapgl.reverse=new nw({map:this.map,key:this.options.key})}switch(this.options.traffic){case!0:case"true":case null:case void 0:case"default":var i=!1;(this.options.traffic||"true"===this.options.traffic)&&(i=!0),this.map.traffic=new n0({map:this.map,key:this.options.key,on:i})}switch(this.options.satellite){case!0:case"true":case null:case void 0:case"default":var o=!1;(this.options.satellite||"true"===this.options.satellite)&&(o=!0),this.map.satellite=new nE({map:this.map,key:this.options.key,on:o})}function a(){var r=wemapgl.Map.getBounds();wemapgl.bboxMaxMin={minLatLng:{lat:r._sw.lat,lon:r._sw.lng},maxLatLng:{lat:r._ne.lat,lon:r._ne.lng}}}switch(wemapgl.urlController=new nS,wemapgl.userLocation=[0,0],wemapgl.bboxMaxMin={minLatLng:{lat:0,lon:0},maxLatLng:{lat:0,lon:0}},this.map.on("style.load",function(r){var n=wemapgl.Map;n&&n.getBounds&&a()}),this.map.on("zoom",function(r){var n=wemapgl.Map;n&&n.getBounds&&a()}),this.map.on("move",function(r){var n=wemapgl.Map;n&&n.getBounds&&a()}),this.map.on("click",function(r){var n=wemapgl.Map;n&&n.getBounds&&a()}),this.options.urlController){case!0:case"true":case null:case void 0:case"default":var s=wemapgl.urlController.getParams();null!=s.x&&null!=s.y&&null!=s.z&&this.map.jumpTo({center:[s.x,s.y],zoom:s.z}),this.map.on("zoomend",function(){wemapgl.urlController.updateParams("view",{z:r.map.getZoom()})}),this.map.on("moveend",function(){wemapgl.urlController.updateParams("view",{x:r.map.getCenter().lng,y:r.map.getCenter().lat,z:r.map.getZoom()})})}this.map.addControl(new wemapgl.AttributionControl({compact:!1}))};var nI=r.createCommonjsModule(function(n,i){n.exports=(function n(i,o,a){function s(c,p){if(!o[c]){if(!i[c]){var h="function"==typeof r.commonjsRequire&&r.commonjsRequire;if(!p&&h)return h(c,!0);if(u)return u(c,!0);var d=Error("Cannot find module '"+c+"'");throw d.code="MODULE_NOT_FOUND",d}var f=o[c]={exports:{}};i[c][0].call(f.exports,function(r){return s(i[c][1][r]||r)},f,f.exports,n,i,o,a)}return o[c].exports}for(var u="function"==typeof r.commonjsRequire&&r.commonjsRequire,c=0;c<a.length;c++)s(a[c]);return s})({1:[function(r,n,i){var o={};function a(r){return Math.floor(Math.abs(r)+.5)*(r>=0?1:-1)}function s(r,n,i){var o=(r=a(r*i))-(n=a(n*i));o<<=1,r-n<0&&(o=~o);for(var s="";o>=32;)s+=String.fromCharCode(63+(32|31&o)),o>>=5;return s+String.fromCharCode(o+63)}function u(r){for(var n=[],i=0;i<r.length;i++)n.push(r[i].slice().reverse());return n}o.decode=function(r,n){for(var i,o=0,a=0,s=0,u=[],c=0,p=0,h=null,d=Math.pow(10,Number.isInteger(n)?n:5);o<r.length;){h=null,c=0,p=0;do p|=(31&(h=r.charCodeAt(o++)-63))<<c,c+=5;while(h>=32);i=1&p?~(p>>1):p>>1,c=p=0;do p|=(31&(h=r.charCodeAt(o++)-63))<<c,c+=5;while(h>=32);a+=i,s+=1&p?~(p>>1):p>>1,u.push([a/d,s/d])}return u},o.encode=function(r,n){if(!r.length)return"";for(var i=Math.pow(10,Number.isInteger(n)?n:5),o=s(r[0][0],0,i)+s(r[0][1],0,i),a=1;a<r.length;a++){var u=r[a],c=r[a-1];o+=s(u[0],c[0],i),o+=s(u[1],c[1],i)}return o},o.fromGeoJSON=function(r,n){if(r&&"Feature"===r.type&&(r=r.geometry),!r||"LineString"!==r.type)throw Error("Input must be a GeoJSON LineString");return o.encode(u(r.coordinates),n)},o.toGeoJSON=function(r,n){return{type:"LineString",coordinates:u(o.decode(r,n))}},"object"==typeof n&&n.exports&&(n.exports=o)},{}],2:[function(r,n,i){var o=r("is-obj"),a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function u(r,n,i){var s=n[i];if(null!=s){if(a.call(r,i)&&(void 0===r[i]||null===r[i]))throw TypeError("Cannot convert undefined or null to object ("+i+")");a.call(r,i)&&o(s)?r[i]=c(Object(r[i]),n[i]):r[i]=s}}function c(r,n){if(r===n)return r;for(var i in n=Object(n))a.call(n,i)&&u(r,n,i);if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(n),c=0;c<o.length;c++)s.call(n,o[c])&&u(r,n,o[c]);return r}n.exports=function(r){var n=arguments;r=function r(n){if(null==n)throw TypeError("Sources cannot be null or undefined");return Object(n)}(r);for(var i=1;i<arguments.length;i++)c(r,n[i]);return r}},{"is-obj":5}],3:[function(r,n,i){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(r){return"function"==typeof r}function s(r){return"object"==typeof r&&null!==r}function u(r){return void 0===r}n.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(r){if("number"!=typeof r||r<0||isNaN(r))throw TypeError("n must be a positive number");return this._maxListeners=r,this},o.prototype.emit=function(r){var n,i,o,c,p,h;if(this._events||(this._events={}),"error"===r&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((n=arguments[1])instanceof Error)throw n;var d=Error('Uncaught, unspecified "error" event. ('+n+")");throw d.context=n,d}if(u(i=this._events[r]))return!1;if(a(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:c=Array.prototype.slice.call(arguments,1),i.apply(this,c)}else if(s(i))for(c=Array.prototype.slice.call(arguments,1),o=(h=i.slice()).length,p=0;p<o;p++)h[p].apply(this,c);return!0},o.prototype.addListener=function(r,n){var i;if(!a(n))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",r,a(n.listener)?n.listener:n),this._events[r]?s(this._events[r])?this._events[r].push(n):this._events[r]=[this._events[r],n]:this._events[r]=n,s(this._events[r])&&!this._events[r].warned&&(i=u(this._maxListeners)?o.defaultMaxListeners:this._maxListeners)&&i>0&&this._events[r].length>i&&(this._events[r].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[r].length),"function"==typeof console.trace&&console.trace()),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(r,n){if(!a(n))throw TypeError("listener must be a function");var i=!1;function o(){this.removeListener(r,o),i||(i=!0,n.apply(this,arguments))}return o.listener=n,this.on(r,o),this},o.prototype.removeListener=function(r,n){var i,o,u,c;if(!a(n))throw TypeError("listener must be a function");if(!this._events||!this._events[r])return this;if(u=(i=this._events[r]).length,o=-1,i===n||a(i.listener)&&i.listener===n)delete this._events[r],this._events.removeListener&&this.emit("removeListener",r,n);else if(s(i)){for(c=u;c-- >0;)if(i[c]===n||i[c].listener&&i[c].listener===n){o=c;break}if(o<0)return this;1===i.length?(i.length=0,delete this._events[r]):i.splice(o,1),this._events.removeListener&&this.emit("removeListener",r,n)}return this},o.prototype.removeAllListeners=function(r){var n,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[r]&&delete this._events[r],this;if(0===arguments.length){for(n in this._events)"removeListener"!==n&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events={},this}if(a(i=this._events[r]))this.removeListener(r,i);else if(i)for(;i.length;)this.removeListener(r,i[i.length-1]);return delete this._events[r],this},o.prototype.listeners=function(r){return this._events&&this._events[r]?a(this._events[r])?[this._events[r]]:this._events[r].slice():[]},o.prototype.listenerCount=function(r){if(this._events){var n=this._events[r];if(a(n))return 1;if(n)return n.length}return 0},o.listenerCount=function(r,n){return r.listenerCount(n)}},{}],4:[function(r,n,i){!function(){var r={};void 0!==i?n.exports=r:this.fuzzy=r,r.simpleFilter=function(n,i){return i.filter(function(i){return r.test(n,i)})},r.test=function(n,i){return null!==r.match(n,i)},r.match=function(r,n,i){i=i||{};var o,a=0,s=[],u=n.length,c=0,p=0,h=i.pre||"",d=i.post||"",f=i.caseSensitive&&n||n.toLowerCase();r=i.caseSensitive&&r||r.toLowerCase();for(var m=0;m<u;m++)o=n[m],f[m]===r[a]?(o=h+o+d,a+=1,p+=1+p):p=0,c+=p,s[s.length]=o;return a===r.length?(c=f===r?1/0:c,{rendered:s.join(""),score:c}):null},r.filter=function(n,i,o){return i&&0!==i.length?"string"!=typeof n?i:(o=o||{},i.reduce(function(i,a,s,u){var c=a;o.extract&&(c=o.extract(a));var p=r.match(n,c,o);return null!=p&&(i[i.length]={string:p.rendered,score:p.score,index:s,original:a}),i},[]).sort(function(r,n){return n.score-r.score||r.index-n.index})):[]}}()},{}],5:[function(r,n,i){n.exports=function(r){var n=typeof r;return null!==r&&("object"===n||"function"===n)}},{}],6:[function(r,n,i){n.exports=/<%=([\s\S]+?)%>/g},{}],7:[function(n,i,o){(function(n){var o=NaN,a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,c=/^0o[0-7]+$/i,p=parseInt,h="object"==typeof n&&n&&n.Object===Object&&n,d="object"==typeof r.window&&r.window&&r.window.Object===Object&&r.window,f=h||d||Function("return this")(),m=Object.prototype.toString,y=Math.max,v=Math.min,g=function(){return f.Date.now()};function $(r){var n=typeof r;return!!r&&("object"==n||"function"==n)}function _(r){if("number"==typeof r)return r;if("symbol"==typeof(n=r)||(i=n)&&"object"==typeof i&&"[object Symbol]"==m.call(n))return o;if($(r)){var n,i,h="function"==typeof r.valueOf?r.valueOf():r;r=$(h)?h+"":h}if("string"!=typeof r)return 0===r?r:+r;r=r.replace(a,"");var d=u.test(r);return d||c.test(r)?p(r.slice(2),d?2:8):s.test(r)?o:+r}i.exports=function(r,n,i){var o,a,s,u,c,p,h=0,d=!1,f=!1,m=!0;if("function"!=typeof r)throw TypeError("Expected a function");function x(n){var i=o,s=a;return o=a=void 0,h=n,u=r.apply(s,i)}function b(r){var i=r-p;return void 0===p||i>=n||i<0||f&&r-h>=s}function w(){var r,i,o=g();if(b(o))return E(o);c=setTimeout(w,(i=n-((r=o)-p),f?v(i,s-(r-h)):i))}function E(r){return c=void 0,m&&o?x(r):(o=a=void 0,u)}function T(){var r,i=g(),s=b(i);if(o=arguments,a=this,p=i,s){if(void 0===c)return h=r=p,c=setTimeout(w,n),d?x(r):u;if(f)return c=setTimeout(w,n),x(p)}return void 0===c&&(c=setTimeout(w,n)),u}return n=_(n)||0,$(i)&&(d=!!i.leading,s=(f="maxWait"in i)?y(_(i.maxWait)||0,n):s,m="trailing"in i?!!i.trailing:m),T.cancel=function(){void 0!==c&&clearTimeout(c),h=0,o=p=a=c=void 0},T.flush=function(){return void 0===c?u:E(g())},T}}).call(this,"undefined"!=typeof global?global:void 0!==r.window?r.window:"undefined"!=typeof window?window:{})},{}],8:[function(n,i,o){(function(n){var a="__lodash_hash_undefined__",s="[object Arguments]",u="[object Array]",c="[object Boolean]",p="[object Date]",h="[object Error]",d="[object Function]",f="[object Map]",m="[object Number]",y="[object Null]",v="[object Object]",g="[object RegExp]",$="[object Set]",_="[object String]",x="[object Undefined]",b="[object ArrayBuffer]",w="[object DataView]",E=/^\[object .+?Constructor\]$/,T=/^(?:0|[1-9]\d*)$/,S={};S["[object Float32Array]"]=S["[object Float64Array]"]=S["[object Int8Array]"]=S["[object Int16Array]"]=S["[object Int32Array]"]=S["[object Uint8Array]"]=S["[object Uint8ClampedArray]"]=S["[object Uint16Array]"]=S["[object Uint32Array]"]=!0,S[s]=S[u]=S[b]=S[c]=S[w]=S[p]=S[h]=S[d]=S[f]=S[m]=S[v]=S[g]=S[$]=S[_]=S["[object WeakMap]"]=!1;var C="object"==typeof n&&n&&n.Object===Object&&n,I="object"==typeof r.window&&r.window&&r.window.Object===Object&&r.window,k=C||I||Function("return this")(),A="object"==typeof o&&o&&!o.nodeType&&o,P=A&&"object"==typeof i&&i&&!i.nodeType&&i,L=P&&P.exports===A,D=L&&C.process,z=function(){try{return D&&D.binding&&D.binding("util")}catch(r){}}(),M=z&&z.isTypedArray;function R(r,n){for(var i=-1,o=null==r?0:r.length;++i<o;)if(n(r[i],i,r))return!0;return!1}function B(r){var n=-1,i=Array(r.size);return r.forEach(function(r,o){i[++n]=[o,r]}),i}function F(r){var n=-1,i=Array(r.size);return r.forEach(function(r){i[++n]=r}),i}var O,N,U,V=Array.prototype,q=Function.prototype,j=Object.prototype,H=k["__core-js_shared__"],G=q.toString,Z=j.hasOwnProperty,W=(O=/[^.]+$/.exec(H&&H.keys&&H.keys.IE_PROTO||""))?"Symbol(src)_1."+O:"",X=j.toString,K=RegExp("^"+G.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Y=L?k.Buffer:void 0,J=k.Symbol,Q=k.Uint8Array,tt=j.propertyIsEnumerable,te=V.splice,tr=J?J.toStringTag:void 0,tn=Object.getOwnPropertySymbols,ti=Y?Y.isBuffer:void 0,to=(N=Object.keys,U=Object,function(r){return N(U(r))}),ta=tI(k,"DataView"),ts=tI(k,"Map"),tl=tI(k,"Promise"),tu=tI(k,"Set"),tc=tI(k,"WeakMap"),tp=tI(Object,"create"),th=tA(ta),td=tA(ts),tf=tA(tl),tm=tA(tu),ty=tA(tc),tv=J?J.prototype:void 0,tg=tv?tv.valueOf:void 0;function t8(r){var n=-1,i=null==r?0:r.length;for(this.clear();++n<i;){var o=r[n];this.set(o[0],o[1])}}function t$(r){var n=-1,i=null==r?0:r.length;for(this.clear();++n<i;){var o=r[n];this.set(o[0],o[1])}}function t_(r){var n=-1,i=null==r?0:r.length;for(this.clear();++n<i;){var o=r[n];this.set(o[0],o[1])}}function tx(r){var n=-1,i=null==r?0:r.length;for(this.__data__=new t_;++n<i;)this.add(r[n])}function tb(r){var n=this.__data__=new t$(r);this.size=n.size}function tw(r,n){for(var i=r.length;i--;)if(tP(r[i][0],n))return i;return -1}function t0(r){var n;return null==r?void 0===r?x:y:tr&&tr in Object(r)?function(r){var n=Z.call(r,tr),i=r[tr];try{r[tr]=void 0;var o=!0}catch(a){}var s=X.call(r);return o&&(n?r[tr]=i:delete r[tr]),s}(r):(n=r,X.call(n))}function tE(r){return tR(r)&&t0(r)==s}function tT(r,n,i,o,a,s){var u=1&i,c=r.length,p=n.length;if(c!=p&&!(u&&p>c))return!1;var h=s.get(r);if(h&&s.get(n))return h==n;var d=-1,f=!0,m=2&i?new tx:void 0;for(s.set(r,n),s.set(n,r);++d<c;){var y=r[d],v=n[d];if(o)var g=u?o(v,y,d,n,r,s):o(y,v,d,r,n,s);if(void 0!==g){if(g)continue;f=!1;break}if(m){if(!R(n,function(r,n){var u;if(u=n,!m.has(u)&&(y===r||a(y,r,i,o,s)))return m.push(n)})){f=!1;break}}else if(y!==v&&!a(y,v,i,o,s)){f=!1;break}}return s.delete(r),s.delete(n),f}function tS(r){var n,i,o,a;return n=r,i=tO,o=tk,a=i(n),tD(n)?a:function(r,n){for(var i=-1,o=n.length,a=r.length;++i<o;)r[a+i]=n[i];return r}(a,o(n))}function tC(r,n){var i,o,a=r.__data__;return("string"==(o=typeof(i=n))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==i:null===i)?a["string"==typeof n?"string":"hash"]:a.map}function tI(r,n){var i,o,a,s,u=(i=r,o=n,null==i?void 0:i[o]);return!(!tM(a=u)||(s=a,W&&W in s))&&(t3(a)?K:E).test(tA(a))?u:void 0}t8.prototype.clear=function(){this.__data__=tp?tp(null):{},this.size=0},t8.prototype.delete=function(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n},t8.prototype.get=function(r){var n=this.__data__;if(tp){var i=n[r];return i===a?void 0:i}return Z.call(n,r)?n[r]:void 0},t8.prototype.has=function(r){var n=this.__data__;return tp?void 0!==n[r]:Z.call(n,r)},t8.prototype.set=function(r,n){var i=this.__data__;return this.size+=this.has(r)?0:1,i[r]=tp&&void 0===n?a:n,this},t$.prototype.clear=function(){this.__data__=[],this.size=0},t$.prototype.delete=function(r){var n=this.__data__,i=tw(n,r);return!(i<0||(i==n.length-1?n.pop():te.call(n,i,1),--this.size,0))},t$.prototype.get=function(r){var n=this.__data__,i=tw(n,r);return i<0?void 0:n[i][1]},t$.prototype.has=function(r){return tw(this.__data__,r)>-1},t$.prototype.set=function(r,n){var i=this.__data__,o=tw(i,r);return o<0?(++this.size,i.push([r,n])):i[o][1]=n,this},t_.prototype.clear=function(){this.size=0,this.__data__={hash:new t8,map:new(ts||t$),string:new t8}},t_.prototype.delete=function(r){var n=tC(this,r).delete(r);return this.size-=n?1:0,n},t_.prototype.get=function(r){return tC(this,r).get(r)},t_.prototype.has=function(r){return tC(this,r).has(r)},t_.prototype.set=function(r,n){var i=tC(this,r),o=i.size;return i.set(r,n),this.size+=i.size==o?0:1,this},tx.prototype.add=tx.prototype.push=function(r){return this.__data__.set(r,a),this},tx.prototype.has=function(r){return this.__data__.has(r)},tb.prototype.clear=function(){this.__data__=new t$,this.size=0},tb.prototype.delete=function(r){var n=this.__data__,i=n.delete(r);return this.size=n.size,i},tb.prototype.get=function(r){return this.__data__.get(r)},tb.prototype.has=function(r){return this.__data__.has(r)},tb.prototype.set=function(r,n){var i=this.__data__;if(i instanceof t$){var o=i.__data__;if(!ts||o.length<199)return o.push([r,n]),this.size=++i.size,this;i=this.__data__=new t_(o)}return i.set(r,n),this.size=i.size,this};var tk=tn?function(r){return null==r?[]:function(r,n){for(var i=-1,o=null==r?0:r.length,a=0,s=[];++i<o;){var u=r[i];n(u,i,r)&&(s[a++]=u)}return s}(tn(r=Object(r)),function(n){return tt.call(r,n)})}:function(){return[]},t1=t0;function t2(r,n){return!!(n=null==n?9007199254740991:n)&&("number"==typeof r||T.test(r))&&r>-1&&r%1==0&&r<n}function tA(r){if(null!=r){try{return G.call(r)}catch(n){}try{return r+""}catch(i){}}return""}function tP(r,n){return r===n||r!=r&&n!=n}(ta&&t1(new ta(new ArrayBuffer(1)))!=w||ts&&t1(new ts)!=f||tl&&"[object Promise]"!=t1(tl.resolve())||tu&&t1(new tu)!=$||tc&&"[object WeakMap]"!=t1(new tc))&&(t1=function(r){var n=t0(r),i=n==v?r.constructor:void 0,o=i?tA(i):"";if(o)switch(o){case th:return w;case td:return f;case tf:return"[object Promise]";case tm:return $;case ty:return"[object WeakMap]"}return n});var tL=tE(function(){return arguments}())?tE:function(r){return tR(r)&&Z.call(r,"callee")&&!tt.call(r,"callee")},tD=Array.isArray,tz=ti||function(){return!1};function t3(r){if(!tM(r))return!1;var n=t0(r);return n==d||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n}function t4(r){return"number"==typeof r&&r>-1&&r%1==0&&r<=9007199254740991}function tM(r){var n=typeof r;return null!=r&&("object"==n||"function"==n)}function tR(r){return null!=r&&"object"==typeof r}var tB,tF=M?(tB=M,function(r){return tB(r)}):function(r){return tR(r)&&t4(r.length)&&!!S[t0(r)]};function tO(r){var n;return null!=(n=r)&&t4(n.length)&&!t3(n)?function r(n,i){var o=tD(n),a=!o&&tL(n),s=!o&&!a&&tz(n),u=!o&&!a&&!s&&tF(n),c=o||a||s||u,p=c?function(r,n){for(var i=-1,o=Array(r);++i<r;)o[i]=n(i);return o}(n.length,String):[],h=p.length;for(var d in n)!Z.call(n,d)||c&&("length"==d||s&&("offset"==d||"parent"==d)||u&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||t2(d,h))||p.push(d);return p}(r):function r(n){if(a="function"==typeof(o=(i=n)&&i.constructor)&&o.prototype||j,i!==a)return to(n);var i,o,a,s=[];for(var u in Object(n))Z.call(n,u)&&"constructor"!=u&&s.push(u);return s}(r)}i.exports=function(r,n){return function r(n,i,o,a,d){return n===i||(null!=n&&null!=i&&(tR(n)||tR(i))?function(r,n,i,o,a,d){var y=tD(r),x=tD(n),E=y?u:t1(r),T=x?u:t1(n),S=(E=E==s?v:E)==v,C=(T=T==s?v:T)==v,I=E==T;if(I&&tz(r)){if(!tz(n))return!1;y=!0,S=!1}if(I&&!S)return d||(d=new tb),y||tF(r)?tT(r,n,i,o,a,d):function(r,n,i,o,a,s,u){switch(i){case w:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)break;r=r.buffer,n=n.buffer;case b:return!(r.byteLength!=n.byteLength||!s(new Q(r),new Q(n)));case c:case p:case m:return tP(+r,+n);case h:return r.name==n.name&&r.message==n.message;case g:case _:return r==n+"";case f:var d=B;case $:var y=1&o;if(d||(d=F),r.size!=n.size&&!y)break;var v=u.get(r);if(v)return v==n;o|=2,u.set(r,n);var x=tT(d(r),d(n),o,a,s,u);return u.delete(r),x;case"[object Symbol]":if(tg)return tg.call(r)==tg.call(n)}return!1}(r,n,E,i,o,a,d);if(!(1&i)){var k=S&&Z.call(r,"__wrapped__"),A=C&&Z.call(n,"__wrapped__");if(k||A){var P=k?r.value():r,L=A?n.value():n;return d||(d=new tb),a(P,L,i,o,d)}}return!!I&&(d||(d=new tb),function(r,n,i,o,a,s){var u=1&i,c=tS(r),p=c.length,h=tS(n).length;if(p!=h&&!u)return!1;for(var d=p;d--;){var f=c[d];if(!(u?f in n:Z.call(n,f)))return!1}var m=s.get(r);if(m&&s.get(n))return m==n;var y=!0;s.set(r,n),s.set(n,r);for(var v=u;++d<p;){var g=r[f=c[d]],$=n[f];if(o)var _=u?o($,g,f,n,r,s):o(g,$,f,r,n,s);if(!(void 0===_?g===$||a(g,$,i,o,s):_)){y=!1;break}v||(v="constructor"==f)}if(y&&!v){var x=r.constructor,b=n.constructor;x!=b&&"constructor"in r&&"constructor"in n&&!("function"==typeof x&&x instanceof x&&"function"==typeof b&&b instanceof b)&&(y=!1)}return s.delete(r),s.delete(n),y}(r,n,i,o,a,d))}(n,i,void 0,void 0,r,void 0):n!=n&&i!=i)}(r,n)}}).call(this,"undefined"!=typeof global?global:void 0!==r.window?r.window:"undefined"!=typeof window?window:{})},{}],9:[function(n,i,o){(function(a){var s=n("lodash._reinterpolate"),u=n("lodash.templatesettings"),c=1/0,p="[object Arguments]",h="[object Error]",d="[object Function]",f="[object Object]",m=/\b__p \+= '';/g,y=/\b(__p \+=) '' \+/g,v=/(__e\(.*?\)|\b__t\)) \+\n'';/g,g=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,$=/^\[object .+?Constructor\]$/,_=/^(?:0|[1-9]\d*)$/,x=/($^)/,b=/['\n\r\u2028\u2029\\]/g,w={};w["[object Float32Array]"]=w["[object Float64Array]"]=w["[object Int8Array]"]=w["[object Int16Array]"]=w["[object Int32Array]"]=w["[object Uint8Array]"]=w["[object Uint8ClampedArray]"]=w["[object Uint16Array]"]=w["[object Uint32Array]"]=!0,w[p]=w["[object Array]"]=w["[object ArrayBuffer]"]=w["[object Boolean]"]=w["[object DataView]"]=w["[object Date]"]=w[h]=w[d]=w["[object Map]"]=w["[object Number]"]=w[f]=w["[object RegExp]"]=w["[object Set]"]=w["[object String]"]=w["[object WeakMap]"]=!1;var E={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},T="object"==typeof a&&a&&a.Object===Object&&a,S="object"==typeof r.window&&r.window&&r.window.Object===Object&&r.window,C=T||S||Function("return this")(),I="object"==typeof o&&o&&!o.nodeType&&o,k=I&&"object"==typeof i&&i&&!i.nodeType&&i,A=k&&k.exports===I,P=A&&T.process,L=function(){try{return k&&k.require&&k.require("util").types||P&&P.binding&&P.binding("util")}catch(r){}}(),D=L&&L.isTypedArray;function z(r,n,i){switch(i.length){case 0:return r.call(n);case 1:return r.call(n,i[0]);case 2:return r.call(n,i[0],i[1]);case 3:return r.call(n,i[0],i[1],i[2])}return r.apply(n,i)}function M(r,n){for(var i=-1,o=null==r?0:r.length,a=Array(o);++i<o;)a[i]=n(r[i],i,r);return a}function R(r){return"\\"+E[r]}function B(r,n){return function(i){return r(n(i))}}var F,O=Function.prototype,N=Object.prototype,U=C["__core-js_shared__"],V=O.toString,q=N.hasOwnProperty,j=(F=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||""))?"Symbol(src)_1."+F:"",H=N.toString,G=V.call(Object),Z=RegExp("^"+V.call(q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),W=A?C.Buffer:void 0,X=C.Symbol,K=B(Object.getPrototypeOf,Object),Y=N.propertyIsEnumerable,J=X?X.toStringTag:void 0,Q=function(){try{var r,n,i,o,a,s=(n=a=(r=o=Object,null==r?void 0:r.defineProperty),!(!tS(n)||(i=n,j&&j in i))&&(tE(n)?Z:$).test(function(r){if(null!=r){try{return V.call(r)}catch(n){}try{return r+""}catch(i){}}return""}(n)))?a:void 0;return s({},"",{}),s}catch(u){}}(),tt=W?W.isBuffer:void 0,te=B(Object.keys,Object),tr=Math.max,tn=Date.now,ti=X?X.prototype:void 0,to=ti?ti.toString:void 0;function ta(r,n){var i=tx(r),o=!i&&t_(r),a=!i&&!o&&tw(r),s=!i&&!o&&!a&&t1(r),u=i||o||a||s,c=u?function(r,n){for(var i=-1,o=Array(r);++i<r;)o[i]=n(i);return o}(r.length,String):[],p=c.length;for(var h in r)!n&&!q.call(r,h)||u&&("length"==h||a&&("offset"==h||"parent"==h)||s&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||td(h,p))||c.push(h);return c}function ts(r,n,i){var o=r[n];q.call(r,n)&&t$(o,i)&&(void 0!==i||n in r)||tl(r,n,i)}function tl(r,n,i){"__proto__"==n&&Q?Q(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}function tu(r){var n;return null==r?void 0===r?"[object Undefined]":"[object Null]":J&&J in Object(r)?function(r){var n=q.call(r,J),i=r[J];try{r[J]=void 0;var o=!0}catch(a){}var s=H.call(r);return o&&(n?r[J]=i:delete r[J]),s}(r):(n=r,H.call(n))}function tc(r){return tC(r)&&tu(r)==p}function tp(r,n){var i,o,a;return t8((i=r,o=n,a=tP,o=tr(void 0===o?i.length-1:o,0),function(){for(var r=arguments,n=-1,s=tr(r.length-o,0),u=Array(s);++n<s;)u[n]=r[o+n];n=-1;for(var c=Array(o+1);++n<o;)c[n]=r[n];return c[o]=a(u),z(i,this,c)}),r+"")}function th(r,n,i,o){return void 0===r||t$(r,N[i])&&!q.call(o,i)?n:r}function td(r,n){var i=typeof r;return!!(n=null==n?9007199254740991:n)&&("number"==i||"symbol"!=i&&_.test(r))&&r>-1&&r%1==0&&r<n}function tf(r,n,i){if(!tS(i))return!1;var o=typeof n;return!!("number"==o?tb(i)&&td(n,i.length):"string"==o&&n in i)&&t$(i[n],r)}function tm(r){var n=r&&r.constructor;return r===("function"==typeof n&&n.prototype||N)}var ty,tv,tg,t8=(ty=Q?function(r,n){var i;return Q(r,"toString",{configurable:!0,enumerable:!1,value:(i=n,function(){return i}),writable:!0})}:tP,tv=0,tg=0,function(){var r=tn(),n=16-(r-tg);if(tg=r,n>0){if(++tv>=800)return arguments[0]}else tv=0;return ty.apply(void 0,arguments)});function t$(r,n){return r===n||r!=r&&n!=n}var t_=tc(function(){return arguments}())?tc:function(r){return tC(r)&&q.call(r,"callee")&&!Y.call(r,"callee")},tx=Array.isArray;function tb(r){return null!=r&&tT(r.length)&&!tE(r)}var tw=tt||function(){return!1};function t0(r){if(!tC(r))return!1;var n=tu(r);return n==h||"[object DOMException]"==n||"string"==typeof r.message&&"string"==typeof r.name&&!function(r){if(!tC(r)||tu(r)!=f)return!1;var n=K(r);if(null===n)return!0;var i=q.call(n,"constructor")&&n.constructor;return"function"==typeof i&&i instanceof i&&V.call(i)==G}(r)}function tE(r){if(!tS(r))return!1;var n=tu(r);return n==d||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n}function tT(r){return"number"==typeof r&&r>-1&&r%1==0&&r<=9007199254740991}function tS(r){var n=typeof r;return null!=r&&("object"==n||"function"==n)}function tC(r){return null!=r&&"object"==typeof r}var tI,tk,t1=D?(tI=D,function(r){return tI(r)}):function(r){return tC(r)&&tT(r.length)&&!!w[tu(r)]},t2=(tk=function(r,n,i,o){var a;!function(r,n,i,o){var a=!i;i||(i={});for(var s=-1,u=n.length;++s<u;){var c=n[s],p=o?o(i[c],r[c],c,i,r):void 0;void 0===p&&(p=r[c]),a?tl(i,c,p):ts(i,c,p)}}(n,tb(a=n)?ta(a,!0):function r(n){if(!tS(n))return function(r){var n=[];if(null!=r)for(var i in Object(r))n.push(i);return n}(n);var i=tm(n),o=[];for(var a in n)("constructor"!=a||!i&&q.call(n,a))&&o.push(a);return o}(a),r,o)},tp(function(r,n){var i=-1,o=n.length,a=o>1?n[o-1]:void 0,s=o>2?n[2]:void 0;for(a=tk.length>3&&"function"==typeof a?(o--,a):void 0,s&&tf(n[0],n[1],s)&&(a=o<3?void 0:a,o=1),r=Object(r);++i<o;){var u=n[i];u&&tk(r,u,i,a)}return r})),tA=tp(function(r,n){try{return z(r,void 0,n)}catch(i){return t0(i)?i:Error(i)}});function tP(r){return r}i.exports=function(r,n,i){var o,a,p=u.imports._.templateSettings||u;i&&tf(r,n,i)&&(n=void 0),r=null==(o=r)?"":function r(n){if("string"==typeof n)return n;if(tx(n))return M(n,r)+"";if("symbol"==typeof(i=n)||tC(i)&&"[object Symbol]"==tu(i))return to?to.call(n):"";var i,o=n+"";return"0"==o&&1/n==-c?"-0":o}(o),n=t2({},n,p,th);var h,d,f,$=t2({},n.imports,p.imports,th),_=(a=$,tb(a)?ta(a):function(r){if(!tm(r))return te(r);var n=[];for(var i in Object(r))q.call(r,i)&&"constructor"!=i&&n.push(i);return n}(a)),w=(h=$,M(_,function(r){return h[r]})),E=0,T=n.interpolate||x,S="__p += '",C=RegExp((n.escape||x).source+"|"+T.source+"|"+(T===s?g:x).source+"|"+(n.evaluate||x).source+"|$","g"),I=q.call(n,"sourceURL")?"//# sourceURL="+(n.sourceURL+"").replace(/[\r\n]/g," ")+"\n":"";r.replace(C,function(n,i,o,a,s,u){return o||(o=a),S+=r.slice(E,u).replace(b,R),i&&(d=!0,S+="' +\n__e("+i+") +\n'"),s&&(f=!0,S+="';\n"+s+";\n__p += '"),o&&(S+="' +\n((__t = ("+o+")) == null ? '' : __t) +\n'"),E=u+n.length,n}),S+="';\n";var k=q.call(n,"variable")&&n.variable;k||(S="with (obj) {\n"+S+"\n}\n"),S=(f?S.replace(m,""):S).replace(y,"$1").replace(v,"$1;"),S="function("+(k||"obj")+") {\n"+(k?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(d?", __e = _.escape":"")+(f?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+S+"return __p\n}";var A=tA(function(){return Function(_,I+"return "+S).apply(void 0,w)});if(A.source=S,t0(A))throw A;return A}}).call(this,"undefined"!=typeof global?global:void 0!==r.window?r.window:"undefined"!=typeof window?window:{})},{"lodash._reinterpolate":6,"lodash.templatesettings":10}],10:[function(n,i,o){(function(o){var a,s=n("lodash._reinterpolate"),u=1/0,c=/[&<>"']/g,p=RegExp(c.source),h="object"==typeof o&&o&&o.Object===Object&&o,d="object"==typeof r.window&&r.window&&r.window.Object===Object&&r.window,f=h||d||Function("return this")(),m=(a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},function(r){return null==a?void 0:a[r]}),y=Object.prototype,v=y.hasOwnProperty,g=y.toString,$=f.Symbol,_=$?$.toStringTag:void 0,x=$?$.prototype:void 0,b=x?x.toString:void 0,w=Array.isArray;i.exports={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:s,variable:"",imports:{_:{escape:function(r){var n;return(r=null==(n=r)?"":function r(n){if("string"==typeof n)return n;if(w(n))return function(r,n){for(var i=-1,o=null==r?0:r.length,a=Array(o);++i<o;)a[i]=n(r[i],i,r);return a}(n,r)+"";if("symbol"==typeof(i=n)||null!=(o=i)&&"object"==typeof o&&(null==(a=i)?void 0===a?"[object Undefined]":"[object Null]":_&&_ in Object(a)?function(r){var n=v.call(r,_),i=r[_];try{r[_]=void 0;var o=!0}catch(a){}var s=g.call(r);return o&&(n?r[_]=i:delete r[_]),s}(a):(s=a,g.call(s)))=="[object Symbol]")return b?b.call(n):"";var i,o,a,s,c=n+"";return"0"==c&&1/n==-u?"-0":c}(n))&&p.test(r)?r.replace(c,m):r}}}}}).call(this,"undefined"!=typeof global?global:void 0!==r.window?r.window:"undefined"!=typeof window?window:{})},{"lodash._reinterpolate":6}],11:[function(r,n,i){var o=r("./_root").Symbol;n.exports=o},{"./_root":18}],12:[function(r,n,i){var o=r("./_Symbol"),a=r("./_getRawTag"),s=r("./_objectToString"),u=o?o.toStringTag:void 0;n.exports=function(r){return null==r?void 0===r?"[object Undefined]":"[object Null]":u&&u in Object(r)?a(r):s(r)}},{"./_Symbol":11,"./_getRawTag":15,"./_objectToString":16}],13:[function(n,i,o){(function(r){var n="object"==typeof r&&r&&r.Object===Object&&r;i.exports=n}).call(this,"undefined"!=typeof global?global:void 0!==r.window?r.window:"undefined"!=typeof window?window:{})},{}],14:[function(r,n,i){var o=r("./_overArg")(Object.getPrototypeOf,Object);n.exports=o},{"./_overArg":17}],15:[function(r,n,i){var o=r("./_Symbol"),a=Object.prototype,s=a.hasOwnProperty,u=a.toString,c=o?o.toStringTag:void 0;n.exports=function(r){var n=s.call(r,c),i=r[c];try{r[c]=void 0;var o=!0}catch(a){}var p=u.call(r);return o&&(n?r[c]=i:delete r[c]),p}},{"./_Symbol":11}],16:[function(r,n,i){var o=Object.prototype.toString;n.exports=function(r){return o.call(r)}},{}],17:[function(r,n,i){n.exports=function(r,n){return function(i){return r(n(i))}}},{}],18:[function(n,i,o){var a=n("./_freeGlobal"),s="object"==typeof r.window&&r.window&&r.window.Object===Object&&r.window,u=a||s||Function("return this")();i.exports=u},{"./_freeGlobal":13}],19:[function(r,n,i){n.exports=function(r){return null!=r&&"object"==typeof r}},{}],20:[function(r,n,i){var o=r("./_baseGetTag"),a=r("./_getPrototype"),s=r("./isObjectLike"),u=Function.prototype,c=Object.prototype,p=u.toString,h=c.hasOwnProperty,d=p.call(Object);n.exports=function(r){if(!s(r)||"[object Object]"!=o(r))return!1;var n=a(r);if(null===n)return!0;var i=h.call(n,"constructor")&&n.constructor;return"function"==typeof i&&i instanceof i&&p.call(i)==d}},{"./_baseGetTag":12,"./_getPrototype":14,"./isObjectLike":19}],21:[function(r,n,i){function o(r){return function(n){var i=n.dispatch,o=n.getState;return function(n){return function(a){return"function"==typeof a?a(i,o,r):n(a)}}}}i.__esModule=!0;var a=o();a.withExtraArgument=o,i.default=a},{}],22:[function(r,n,i){i.__esModule=!0;var o=Object.assign||function(r){for(var n=arguments,i=1;i<arguments.length;i++){var o=n[i];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(r[a]=o[a])}return r};i.default=function(){for(var r=arguments,n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=r[a];return function(r){return function(n,a,u){var c,p=r(n,a,u),h=p.dispatch,d={getState:p.getState,dispatch:function(r){return h(r)}};return c=i.map(function(r){return r(d)}),h=s.default.apply(void 0,c)(p.dispatch),o({},p,{dispatch:h})}}};var a,s=(a=r("./compose"))&&a.__esModule?a:{default:a}},{"./compose":25}],23:[function(r,n,i){function o(r,n){return function(){return n(r.apply(void 0,arguments))}}i.__esModule=!0,i.default=function(r,n){if("function"==typeof r)return o(r,n);if("object"!=typeof r||null===r)throw Error("bindActionCreators expected an object or a function, instead received "+(null===r?"null":typeof r)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var i=Object.keys(r),a={},s=0;s<i.length;s++){var u=i[s],c=r[u];"function"==typeof c&&(a[u]=o(c,n))}return a}},{}],24:[function(r,n,i){i.__esModule=!0,i.default=function(r){for(var n=Object.keys(r),i={},u=0;u<n.length;u++){var p=n[u];void 0===r[p]&&(0,s.default)('No reducer provided for key "'+p+'"'),"function"==typeof r[p]&&(i[p]=r[p])}var h,d=Object.keys(i);h={};var f=void 0;try{!function(r){Object.keys(r).forEach(function(n){var i=r[n];if(void 0===i(void 0,{type:o.ActionTypes.INIT}))throw Error('Reducer "'+n+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===i(void 0,{type:"@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".")}))throw Error('Reducer "'+n+"\" returned undefined when probed with a random type. Don't try to handle "+o.ActionTypes.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(i)}catch(m){f=m}return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];if(f)throw f;var u=function r(n,i,s,u){var c=Object.keys(i),p=s&&s.type===o.ActionTypes.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer";if(0===c.length)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!(0,a.default)(n))return"The "+p+' has unexpected type of "'+({}).toString.call(n).match(/\s([a-z|A-Z]+)/)[1]+'". Expected argument to be an object with the following keys: "'+c.join('", "')+'"';var h=Object.keys(n).filter(function(r){return!i.hasOwnProperty(r)&&!u[r]});return h.forEach(function(r){u[r]=!0}),h.length>0?"Unexpected "+(h.length>1?"keys":"key")+' "'+h.join('", "')+'" found in '+p+'. Expected to find one of the known reducer keys instead: "'+c.join('", "')+'". Unexpected keys will be ignored.':void 0}(r,i,n,h);u&&(0,s.default)(u);for(var p=!1,m={},y=0;y<d.length;y++){var v=d[y],g=i[v],$=r[v],_=g($,n);if(void 0===_)throw Error(c(v,n));m[v]=_,p=p||_!==$}return p?m:r}};var o=r("./createStore"),a=u(r("lodash/isPlainObject")),s=u(r("./utils/warning"));function u(r){return r&&r.__esModule?r:{default:r}}function c(r,n){var i=n&&n.type;return"Given action "+(i&&'"'+i.toString()+'"'||"an action")+', reducer "'+r+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}},{"./createStore":26,"./utils/warning":28,"lodash/isPlainObject":20}],25:[function(r,n,i){i.__esModule=!0,i.default=function(){for(var r=arguments,n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=r[o];return 0===i.length?function(r){return r}:1===i.length?i[0]:i.reduce(function(r,n){return function(){return r(n.apply(void 0,arguments))}})}},{}],26:[function(r,n,i){i.__esModule=!0,i.ActionTypes=void 0,i.default=function r(n,i,s){if("function"==typeof i&&void 0===s&&(s=i,i=void 0),void 0!==s){if("function"!=typeof s)throw Error("Expected the enhancer to be a function.");return s(r)(n,i)}if("function"!=typeof n)throw Error("Expected the reducer to be a function.");var c,p=n,h=i,d=[],f=d,m=!1;function y(){f===d&&(f=d.slice())}function v(){return h}function g(r){if("function"!=typeof r)throw Error("Expected listener to be a function.");var n=!0;return y(),f.push(r),function(){if(n){n=!1,y();var i=f.indexOf(r);f.splice(i,1)}}}function $(r){if(!(0,o.default)(r))throw Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===r.type)throw Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(m)throw Error("Reducers may not dispatch actions.");try{m=!0,h=p(h,r)}finally{m=!1}for(var n=d=f,i=0;i<n.length;i++)(0,n[i])();return r}return $({type:u.INIT}),(c={dispatch:$,subscribe:g,getState:v,replaceReducer:function(r){if("function"!=typeof r)throw Error("Expected the nextReducer to be a function.");p=r,$({type:u.INIT})}})[a.default]=function(){var r,n=g;return(r={subscribe:function(r){if("object"!=typeof r)throw TypeError("Expected the observer to be an object.");function i(){r.next&&r.next(h)}return i(),{unsubscribe:n(i)}}})[a.default]=function(){return this},r},c};var o=s(r("lodash/isPlainObject")),a=s(r("symbol-observable"));function s(r){return r&&r.__esModule?r:{default:r}}var u=i.ActionTypes={INIT:"@@redux/INIT"}},{"lodash/isPlainObject":20,"symbol-observable":33}],27:[function(r,n,i){i.__esModule=!0,i.compose=i.applyMiddleware=i.bindActionCreators=i.combineReducers=i.createStore=void 0;var o=h(r("./createStore")),a=h(r("./combineReducers")),s=h(r("./bindActionCreators")),u=h(r("./applyMiddleware")),c=h(r("./compose")),p=h(r("./utils/warning"));function h(r){return r&&r.__esModule?r:{default:r}}function d(){}"string"==typeof d.name&&"isCrushed"===d.name&&(0,p.default)("You are currently using minified code outside of NODE_ENV === 'production'. This means that you are running a slower development build of Redux. You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify or DefinePlugin for webpack (http://stackoverflow.com/questions/30030031) to ensure you have the correct code for your production build."),i.createStore=o.default,i.combineReducers=a.default,i.bindActionCreators=s.default,i.applyMiddleware=u.default,i.compose=c.default},{"./applyMiddleware":22,"./bindActionCreators":23,"./combineReducers":24,"./compose":25,"./createStore":26,"./utils/warning":28}],28:[function(r,n,i){i.__esModule=!0,i.default=function(r){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(r);try{throw Error(r)}catch(n){}}},{}],29:[function(r,n,i){var o=r("./src/suggestions");window.Suggestions=n.exports=o},{"./src/suggestions":32}],30:[function(r,n,i){n.exports=function(){for(var r=arguments,n={},i=0;i<arguments.length;i++){var a=r[i];for(var s in a)o.call(a,s)&&(n[s]=a[s])}return n};var o=Object.prototype.hasOwnProperty},{}],31:[function(r,n,i){var o=function(r){return this.component=r,this.items=[],this.active=0,this.element=document.createElement("ul"),this.element.className="suggestions",this.selectingListItem=!1,r.el.parentNode.insertBefore(this.element,r.el.nextSibling),this};o.prototype.show=function(){this.element.style.display="block"},o.prototype.hide=function(){this.element.style.display="none"},o.prototype.add=function(r){this.items.push(r)},o.prototype.clear=function(){this.items=[],this.active=0},o.prototype.isEmpty=function(){return!this.items.length},o.prototype.draw=function(){if(this.element.innerHTML="",0!==this.items.length){for(var r=0;r<this.items.length;r++)this.drawItem(this.items[r],this.active===r);this.show()}else this.hide()},o.prototype.drawItem=function(r,n){var i=document.createElement("li"),o=document.createElement("a");n&&(i.className+=" active"),o.innerHTML=r.string,i.appendChild(o),this.element.appendChild(i),i.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),i.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,r)}).bind(this))},o.prototype.handleMouseUp=function(r){this.selectingListItem=!1,this.component.value(r.original),this.clear(),this.draw()},o.prototype.move=function(r){this.active=r,this.draw()},o.prototype.previous=function(){this.move(0===this.active?this.items.length-1:this.active-1)},o.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},n.exports=o},{}],32:[function(r,n,i){var o=r("xtend"),a=r("fuzzy"),s=r("./list"),u=function(r,n,i){return i=i||{},this.options=o({minLength:2,limit:5,filter:!0},i),this.el=r,this.data=n||[],this.list=new s(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(r){this.handleKeyUp(r.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(r){this.handleKeyDown(r)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(r){this.handlePaste(r)}).bind(this)),this};u.prototype.handleKeyUp=function(r){40!==r&&38!==r&&27!==r&&13!==r&&9!==r&&this.handleInputChange(this.el.value)},u.prototype.handleKeyDown=function(r){switch(r.keyCode){case 13:case 9:r.preventDefault(),this.list.isEmpty()||(this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},u.prototype.handleBlur=function(){this.list.selectingListItem||this.list.hide()},u.prototype.handlePaste=function(r){if(r.clipboardData)this.handleInputChange(r.clipboardData.getData("Text"));else{var n=this;setTimeout(function(){n.handleInputChange(r.target.value)},100)}},u.prototype.handleInputChange=function(r){this.query=this.normalize(r),this.list.clear(),this.query.length<this.options.minLength?this.list.draw():this.getCandidates((function(r){for(var n=0;n<r.length&&(this.list.add(r[n]),n!==this.options.limit-1);n++);this.list.draw()}).bind(this))},u.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},u.prototype.update=function(r){this.data=r,this.handleKeyUp()},u.prototype.clear=function(){this.data=[],this.list.clear()},u.prototype.normalize=function(r){return r=r.toLowerCase()},u.prototype.match=function(r,n){return r.indexOf(n)>-1},u.prototype.value=function(r){if(this.selected=r,this.el.value=this.getItemValue(r),document.createEvent){var n=document.createEvent("HTMLEvents");n.initEvent("change",!0,!1),this.el.dispatchEvent(n)}else this.el.fireEvent("onchange")},u.prototype.getCandidates=function(r){var n={pre:"<strong>",post:"</strong>",extract:(function(r){return this.getItemValue(r)}).bind(this)};r(this.options.filter?a.filter(this.query,this.data,n):this.data.map((function(r){for(var n=this.getItemValue(r),i=this.normalize(n),o=i.lastIndexOf(this.query);o>-1;){var a=o+this.query.length;n=n.slice(0,o)+"<strong>"+n.slice(o,a)+"</strong>"+n.slice(a),o=i.slice(0,o).lastIndexOf(this.query)}return{original:r,string:n}}).bind(this)))},u.prototype.getItemValue=function(r){return r},n.exports=u},{"./list":31,fuzzy:4,xtend:30}],33:[function(n,i,o){(function(a){Object.defineProperty(o,"__esModule",{value:!0});var s,u,c=(s=n("./ponyfill.js"))&&s.__esModule?s:{default:s};u=void 0!==r.window?r.window:"undefined"!=typeof window?window:void 0!==a?a:void 0!==i?i:Function("return this")();var p=(0,c.default)(u);o.default=p}).call(this,"undefined"!=typeof global?global:void 0!==r.window?r.window:"undefined"!=typeof window?window:{})},{"./ponyfill.js":34}],34:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(r){var n,i=r.Symbol;return"function"==typeof i?i.observable?n=i.observable:(n=i("observable"),i.observable=n):n="@@observable",n}},{}],35:[function(r,n,i){var o=r("turf-meta").coordEach;n.exports=function(r){var n=[1/0,1/0,-1/0,-1/0];return o(r,function(r){n[0]>r[0]&&(n[0]=r[0]),n[1]>r[1]&&(n[1]=r[1]),n[2]<r[0]&&(n[2]=r[0]),n[3]<r[1]&&(n[3]=r[1])}),n}},{"turf-meta":36}],36:[function(r,n,i){function o(r,n,i){var o,a,s,u,c,p,h,d,f,m=0,y="FeatureCollection"===r.type,v="Feature"===r.type,g=y?r.features.length:1;for(o=0;o<g;o++)for(p=(f="GeometryCollection"===(d=y?r.features[o].geometry:v?r.geometry:r).type)?d.geometries.length:1,u=0;u<p;u++)if(h=(c=f?d.geometries[u]:d).coordinates,m=i&&("Polygon"===c.type||"MultiPolygon"===c.type)?1:0,"Point"===c.type)n(h);else if("LineString"===c.type||"MultiPoint"===c.type)for(a=0;a<h.length;a++)n(h[a]);else if("Polygon"===c.type||"MultiLineString"===c.type)for(a=0;a<h.length;a++)for(s=0;s<h[a].length-m;s++)n(h[a][s]);else{if("MultiPolygon"!==c.type)throw Error("Unknown Geometry Type");for(a=0;a<h.length;a++)for(s=0;s<h[a].length;s++)for(l=0;l<h[a][s].length-m;l++)n(h[a][s][l])}}function a(r,n){var i;switch(r.type){case"FeatureCollection":for(features=r.features,i=0;i<r.features.length;i++)n(r.features[i].properties);break;case"Feature":n(r.properties)}}n.exports.coordEach=o,n.exports.coordReduce=function(r,n,i,a){return o(r,function(r){i=n(i,r)},a),i},n.exports.propEach=a,n.exports.propReduce=function(r,n,i){return a(r,function(r){i=n(i,r)}),i}},{}],37:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.queryOrigin=function(r){return{type:a.ORIGIN_QUERY,query:r}},i.queryDestination=function(r){return{type:a.DESTINATION_QUERY,query:r}},i.queryViaPoint=function(r){return{type:a.VIA_POINTS_QUERY,query:r}},i.queryOriginCoordinates=_,i.queryDestinationCoordinates=x,i.queryViaPointCoordinates=function(r){return{type:a.VIA_POINTS_FROM_COORDINATES,coordinates:r}},i.clearOrigin=function(){return function(r){r({type:a.ORIGIN_CLEAR}),r(S("clear",{type:"origin"})),r($(null))}},i.clearDestination=function(){return function(r){r({type:a.DESTINATION_CLEAR}),r(S("clear",{type:"destination"})),r($(null))}},i.clearViaPoint=function(){return function(r){r({type:a.VIA_POINTS_CLEAR}),r(S("clear",{type:"viaPoints"})),r($(null))}},i.setOptions=function(r){return{type:a.SET_OPTIONS,options:r}},i.hoverMarker=function(r){return function(n){var i;n((i=r?s.default.createPoint(r,{id:"hover"}):{},{type:a.HOVER_MARKER,hoverMarker:i}))}},i.setRouteIndex=b,i.createOrigin=w,i.createDestination=E,i.createViaPoint=function(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(o,u){var c=u(),p=c.viaPoints,h=(c.destination,s.default.createPoint(r,{id:i,index:"viaPoint"+n,"marker-symbol":"V"+n}));p.splice(n,0,h),o(m(p)),o({type:a.VIA_POINTS,viaPoints:p}),o(S("viaPoints",{feature:p}))}},i.setViaPoint=T,i.removeViaPointByIndex=function(r){return function(n,i){var o=i(),a=o.destination,s=(o.waypoints,o.viaPoints);s.splice(r,1),n(m(s)),a.geometry&&n(v())}},i.setProfile=function(r){return function(n,i){var o=i(),s=o.origin,u=o.destination;n({type:a.DIRECTIONS_PROFILE,profile:r}),n(S("profile",{profile:r})),s.geometry&&u.geometry&&n(v())}},i.setInputTime=function(r){return function(n,i){n({type:a.INPUT_TIME,inputTime:r}),n(S("inputTime",{inputTime:r})),r&&n(v())}},i.reverse=function(){return function(r,n){var i=n();i.destination.geometry&&r(h(i.destination.geometry.coordinates)),i.origin.geometry&&r(d(i.origin.geometry.coordinates)),i.origin.geometry&&i.destination.geometry&&r(v())}},i.setOriginFromCoordinates=function(r){return function(n){if(s.default.validCoords(r)||(r=[s.default.wrap(r[0]),s.default.wrap(r[1])]),isNaN(r[0])&&isNaN(r[1]))return n($(Error("Coordinates are not valid")));n(_(r)),n(w(r))}},i.setDestinationFromCoordinates=function(r){return function(n){if(s.default.validCoords(r)||(r=[s.default.wrap(r[0]),s.default.wrap(r[1])]),isNaN(r[0])&&isNaN(r[1]))return n($(Error("Coordinates are not valid")));n(E(r)),n(x(r))}},i.setViaPointFromCoordinates=function(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(o,a){if(s.default.validCoords(r)||(r=[s.default.wrap(r[0]),s.default.wrap(r[1])]),isNaN(r[0])&&isNaN(r[1]))return o($(Error("Coordinates are not valid")));o(T(n,i,r))}},i.addWaypoint=function(r,n){return function(i,o){var a=o(),s=a.destination,u=a.waypoints;u.splice(r,0,g(n)),i(y(u)),s.geometry&&i(v())}},i.setWaypoint=function(r,n){return function(i,o){var a=o(),s=a.destination,u=a.waypoints;u[r]=g(n),i(y(u)),s.geometry&&i(v())}},i.removeWaypoint=function(r){return function(n,i){var o=i(),a=o.destination,u=o.waypoints;n(y(u=u.filter(function(n){return!s.default.coordinateMatch(n,r)}))),a.geometry&&n(v())}},i.eventSubscribe=function(r,n){return function(i,o){var s=o().events;return s[r]=s[r]||[],s[r].push(n),{type:a.EVENTS,events:s}}},i.eventEmit=S;var o=c(r("../wemap/encode")),a=function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n.default=r,n}(r("../constants/action_types")),s=c(r("../utils")),u=r("../wemap/graph2osrm");function c(r){return r&&r.__esModule?r:{default:r}}var p=new XMLHttpRequest;function h(r){return function(n){var i=s.default.createPoint(r,{id:"origin","marker-symbol":"A"});n({type:a.ORIGIN,origin:i}),n(S("origin",{feature:i}))}}function d(r){return function(n){var i=s.default.createPoint(r,{id:"destination","marker-symbol":"B"});n({type:a.DESTINATION,destination:i}),n(S("destination",{feature:i}))}}function f(r){return function(n){n({type:a.DIRECTIONS,directions:r}),n(S("route",{route:r}))}}function m(r){return{type:a.VIA_POINTS,viaPoints:r}}function y(r){return{type:a.WAYPOINTS,waypoints:r}}function v(){return function(r,n){var i=n(),a=i.api,s=i.accessToken,c=i.routeIndex,m=i.profile,y=i.alternatives,v=i.congestion,g=i.destination,_=(i.language,i.inputTime),x=i.viaPoints;if(g&&g.geometry){var w,E,T,S,C,I,k=(T=(E=(w=n)()).origin,S=E.destination,C=E.waypoints,(I=[]).push(T.geometry.coordinates.join(",")),I.push(";"),C.length&&C.forEach(function(r){I.push(r.geometry.coordinates.join(",")),I.push(";")}),I.push(S.geometry.coordinates.join(",")),encodeURIComponent(I.join(""))),A=[];A.push("geometries=polyline"),y&&A.push("alternatives=true"),v&&A.push("annotations=congestion"),A.push("steps=true"),A.push("overview=full"),p.abort();var P="",L="",D=m.split("/")[0],z=x.map(function(r){return r.geometry.coordinates});if("engine01"===D){var M=z.map(function(r){return r.join(",")}).join(";");M.length>0&&(M=";"+M);var R=k.split("%3B"),B=R[0].split("%2C"),F=R[1].split("%2C");s&&A.push("key="+s);var O="";O="engine01/driving-traffic"===m?"driving":"engine01/driving"===m?"driving":"engine01/walking"===m?"walking":"engine01/cycling"===m?"cycling":"driving",P=a.osrm+O+"/"+B.join(",")+M+";"+F.join(",")+"?"+A.join("&")}else if("engine02"===D){s&&A.push("key="+s);var N=k.split("%3B"),U=N[0].split("%2C"),V=N[1].split("%2C");L="engine02/driving-traffic"===m?"car":"engine02/driving"===m?"car":"engine02/walking"===m?"foot":"engine02/cycling"===m?"bike":"car";var q=a.graphhopper,j=z.map(function(r){var n;return"point="+[(n=r)[1],n[0]].join(",")}).join("&");if(j.length>0&&(j="&"+j),P=q+"point="+U[1]+","+U[0]+j+"&point="+V[1]+","+V[0]+"&type=json&vehicle="+L+"&weighting=fastest&elevation=false&points_encoded=false&locale=vi-VN&key="+s,"engine02/public-transport"===m){var H=new Date(_).toISOString();P=q+"point="+U[1]+","+U[0]+"&point="+V[1]+","+V[0]+"&type=json&vehicle=pt&pt.earliest_departure_time="+H+"&weighting=fastest&elevation=false&points_encoded=false&locale=vi-VN&key="+s+"&pt.profile=true&pt.limit_solutions=5"}}P=o.default.encodeURL(P,s),p.open("GET",P,!0),p.onload=function(){if(!(p.status>=200&&p.status<400))return r(f([])),r($(JSON.parse(p.responseText).message));var n=JSON.parse(p.responseText);if(n.error)return r(f([])),r($(n.error));if(r($(null)),"engine02"===D){var i=(0,u.convertGraph2OSRM)(n.paths,L);i[c]||r(b(0)),r(f(i)),r(h(n.paths[0].snapped_waypoints.coordinates[0]));var o=n.paths[0].snapped_waypoints.coordinates;r(d(n.paths[0].snapped_waypoints.coordinates[o.length-1]))}else n.routes[c]||r(b(0)),r(f(n.routes)),r(h(n.waypoints[0].location)),r(d(n.waypoints[n.waypoints.length-1].location))},p.onerror=function(){return r(f([])),r($(JSON.parse(p.responseText).message))},p.send()}}}function g(r){var n={id:"waypoint"};return Object.assign(r,{properties:r.properties?Object.assign(r.properties,n):n})}function $(r){return function(n){n({type:"ERROR",error:r}),r&&n(S("error",{error:r}))}}function _(r){return{type:a.ORIGIN_FROM_COORDINATES,coordinates:r}}function x(r){return{type:a.DESTINATION_FROM_COORDINATES,coordinates:r}}function b(r){return{type:a.ROUTE_INDEX,routeIndex:r}}function w(r){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(i,o){var a=o().destination;i(h(r)),a.geometry&&n&&i(v())}}function E(r){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(i,o){var a=o().origin;i(d(r)),a.geometry&&n&&i(v())}}function T(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments[2];return function(o,a){var u=a().viaPoints;u[r]=s.default.createPoint(i,{id:n,index:"viaPoint"+r,"marker-symbol":"V"+r}),o(m(u)),u&&u[r]&&u[r].geometry&&o(v())}}function S(r,n){var i=this;return function(o,s){var u=s().events;if(!u[r])return{type:a.EVENTS,events:u};for(var c=u[r].slice(),p=0;p<c.length;p++)c[p].call(i,n)}}},{"../constants/action_types":38,"../utils":46,"../wemap/encode":47,"../wemap/graph2osrm":48}],38:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.VIA_POINTS="VIA_POINTS",i.VIA_POINTS_CLEAR="VIA_POINTS_CLEAR",i.VIA_POINTS_QUERY="VIA_POINTS_QUERY",i.VIA_POINTS_FROM_COORDINATES="VIA_POINTS_FROM_COORDINATES",i.VIA_POINTS_ARR="VIA_POINTS_ARR",i.VIA_POINTS_ARR_QUERY="VIA_POINTS_ARR_QUERY",i.DESTINATION="DESTINATION",i.DESTINATION_CLEAR="DESTINATION_CLEAR",i.DESTINATION_QUERY="DESTINATION_QUERY",i.DESTINATION_FROM_COORDINATES="DESTINATION_FROM_COORDINATES",i.DIRECTIONS="DIRECTIONS",i.DIRECTIONS_PROFILE="DIRECTIONS_PROFILE",i.EVENTS="EVENTS",i.ERROR="ERROR",i.HOVER_MARKER="HOVER_MARKER",i.ORIGIN="ORIGIN",i.ORIGIN_CLEAR="ORIGIN_CLEAR",i.ORIGIN_QUERY="ORIGIN_QUERY",i.ORIGIN_FROM_COORDINATES="ORIGIN_FROM_COORDINATES",i.ROUTE_INDEX="ROUTE_INDEX",i.SET_OPTIONS="SET_OPTIONS",i.WAYPOINTS="WAYPOINTS",i.INPUT_TIME="INPUT_TIME",i.INPUT_TIME_QUERY="INPUT_TIME_QUERY"},{}],39:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},a=function(){function r(r,n){for(var i=0;i<n.length;i++){var o=n[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}return function(n,i,o){return i&&r(n.prototype,i),o&&r(n,o),n}}(),s=d(r("../wemap/encode")),u=d(r("suggestions")),c=d(r("lodash.debounce")),p=r("events"),h=d(r("../utils"));function d(r){return r&&r.__esModule?r:{default:r}}var f=function(){function r(n){(function(r,n){if(!(r instanceof n))throw TypeError("Cannot call a class as a function")})(this,r),this._ev=new p.EventEmitter,this.options=n,this.api=n&&n.api||"#"}return a(r,[{key:"onAdd",value:function(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(new Date).getTime();this._map=r,this.request=new XMLHttpRequest;var i=document.createElement("div");i.className="mapboxgl-ctrl-geocoder",i.id="input-"+n;var o=document.createElement("span");o.className="geocoder-icon geocoder-icon-search";var a=this._inputEl=document.createElement("input");a.type="text",a.placeholder=this.options.placeholder,a.addEventListener("keydown",(0,c.default)((function(r){if(!r.target.value)return this._clearEl.classList.remove("active");r.metaKey||-1!==[9,27,37,39,13,38,40].indexOf(r.keyCode)||this._queryFromInput(r.target.value)}).bind(this)),200),a.addEventListener("change",(function(n){n.target.value&&this._clearEl.classList.add("active");var i=this._typeahead.selected;if(i){if(this.options.flyTo){if(i.bbox&&i.context&&i.context.length<=3||i.bbox&&!i.context){var o=i.bbox;r.fitBounds([[o[0],o[1]],[o[2],o[3]]])}else r.flyTo({center:i.center,zoom:this.options.zoom})}this._input=i,this.fire("result",{result:i})}}).bind(this));var s=document.createElement("div");s.classList.add("geocoder-pin-right");var p=this._clearEl=document.createElement("button");p.className="geocoder-icon geocoder-icon-close",p.addEventListener("click",this._clear.bind(this));var h=this._loadingEl=document.createElement("span");return h.className="geocoder-icon geocoder-icon-loading",s.appendChild(p),s.appendChild(h),i.appendChild(o),i.appendChild(a),i.appendChild(s),this.options.container&&(this.options.position=!1),this._typeahead=new u.default(a,[],{filter:!1}),this._typeahead.getItemValue=function(r){return r.place_name},i}},{key:"_geocode",value:function(r,n){this._loadingEl.classList.add("active"),this.fire("loading");var i=this.options,o=["placeholder","zoom","flyTo","accessToken"],a=Object.keys(this.options).filter(function(r){return -1===o.indexOf(r)}).map(function(r){return r+"="+i[r]}),u=this.options.engine,c=this.options.accessToken?this.options.accessToken:wemapgl.accessToken;a.push("access_token="+c),this.request.abort();var p="";if("wemap"===u)p=this.api+encodeURIComponent(r.trim())+".json?"+a.join("&");else{var h=wemapgl.userLocation[0]&&wemapgl.userLocation[1]?"&location.lat="+wemapgl.userLocation[0]+"&location.lon="+wemapgl.userLocation[1]:"",d="&focus.point.lat="+this._map.getCenter().lat+"&focus.point.lon="+this._map.getCenter().lng,f=h.length>0?h:d,m="&bbox.min_lat="+wemapgl.bboxMaxMin.minLatLng.lat+"&bbox.min_lon="+wemapgl.bboxMaxMin.minLatLng.lon+"&bbox.max_lat="+wemapgl.bboxMaxMin.maxLatLng.lat+"&bbox.max_lon="+wemapgl.bboxMaxMin.maxLatLng.lon;p=this.api+r.trim()+"&key="+c+"&boundary.country=VNM"+f+m}p=s.default.encodeURL(p,c),this.request.open("GET",p,!0),this.request.setRequestHeader("accept-language","vi-VN,vn;q=0.9"),this.request.onload=(function(){if(this._loadingEl.classList.remove("active"),this.request.status>=200&&this.request.status<400){var r=JSON.parse(this.request.responseText);if(r.features.length){if("pelias"===u)for(var i=0;i<r.features.length;i++)r.features[i]=this._convertPeliasData(r.features[i]);this._clearEl.classList.add("active")}else this._typeahead.selected=null;return this.fire("results",{results:r.features}),this._typeahead.update(r.features),n(r.features)}this.fire("error",{error:JSON.parse(this.request.responseText).message})}).bind(this),this.request.onerror=(function(){this._loadingEl.classList.remove("active"),this.fire("error",{error:JSON.parse(this.request.responseText).message})}).bind(this),this.request.send()}},{key:"_queryFromInput",value:function(r){(r=r.trim())||this._clear(),r.length>2&&this._geocode(r,(function(r){this._results=r}).bind(this))}},{key:"_convertPeliasData",value:function(r){var n="";n=r.properties.name?n+r.properties.name:n,n=r.properties.street?n+", "+r.properties.street:n,n=r.properties.county?n+"-"+r.properties.county+", ":n,n=r.properties.region?n+r.properties.region+", ":n,n=r.properties.country?n+r.properties.country:n;var i={type:"Feature"};return i.geometry=r.geometry,i.place_name=n,i.text=n,i.matching_text=r.properties.name,i.matching_place_name="address"+r.properties.name,i.center=r.geometry.coordinates,i}},{key:"_change",value:function(){var r=document.createEvent("HTMLEvents");r.initEvent("change",!0,!1),this._inputEl.dispatchEvent(r)}},{key:"_query",value:function(r){r&&("object"===(void 0===r?"undefined":o(r))&&r.length&&(r=[h.default.wrap(r[0]),h.default.wrap(r[1])].join()),this._geocode(r,(function(r){if(r.length){var n=r[0];this._results=r,this._typeahead.selected=n,this._inputEl.value=n.place_name,this._change()}}).bind(this)))}},{key:"_setInput",value:function(r){r&&("object"===(void 0===r?"undefined":o(r))&&r.length&&(r=[h.default.roundWithOriginalPrecision(h.default.wrap(r[0]),r[0]),h.default.roundWithOriginalPrecision(h.default.wrap(r[1]),r[1])].join()),this._inputEl.value=r,this._input=null,this._typeahead.selected=null,this._typeahead.clear(),this._change())}},{key:"_clear",value:function(){this._input=null,this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._change(),this._inputEl.focus(),this._clearEl.classList.remove("active"),this.fire("clear")}},{key:"getResult",value:function(){return this._input}},{key:"query",value:function(r){return this._query(r),this}},{key:"setInput",value:function(r){return this._setInput(r),this}},{key:"on",value:function(r,n){return this._ev.on(r,n),this}},{key:"fire",value:function(r,n){return this._ev.emit(r,n),this}},{key:"off",value:function(r,n){return this._ev.removeListener(r,n),this}}]),r}();i.default=f},{"../utils":46,"../wemap/encode":47,events:3,"lodash.debounce":7,suggestions:29}],40:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function r(r,n){for(var i=0;i<n.length;i++){var o=n[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}return function(n,i,o){return i&&r(n.prototype,i),o&&r(n,o),n}}(),a=p(r("./geocoder")),s=p(r("lodash.template")),u=p(r("lodash.isequal")),c=p(r("turf-extent"));function p(r){return r&&r.__esModule?r:{default:r}}var h=(0,s.default)("<%\r\nlet isActivePublicTransport = \"\";\r\nif(profile.includes(\"public-transport\")) {\r\n    isActivePublicTransport = \"hidden\";\r\n}\r\n%>\r\n\r\n<div class='mapbox-directions-component mapbox-directions-inputs'>\r\n    <div class='mapbox-directions-component-keyline' id='mapbox-directions-form-area'>\r\n        <div class='mapbox-directions-origin'>\r\n            <label class='mapbox-form-label'>\r\n                <span class='directions-icon directions-icon-depart'></span>\r\n            </label>\r\n            <div id='mapbox-directions-origin-input'></div>\r\n        </div>\r\n\r\n        <div id=\"wemap-directions-middle\" class='<%= isActivePublicTransport %>'>\r\n\r\n        </div>\r\n\r\n        <button id='wemap-directions-reverse'\r\n            class='directions-icon directions-icon-reverse directions-reverse js-reverse-inputs'\r\n            title='Reverse origin &amp; destination'>\r\n        </button>\r\n\r\n        <div class='mapbox-directions-destination'>\r\n            <label class='mapbox-form-label'>\r\n                <span class='directions-icon directions-icon-arrive'></span>\r\n            </label>\r\n            <div id='mapbox-directions-destination-input'></div>\r\n        </div>\r\n        <div id='wemap-directions-add-button' class='<%= isActivePublicTransport %>'>\r\n            <a aria-label='Th\xeam điểm dừng' class='add-button' href='#'>Th\xeam điểm dừng</a>\r\n        </div>\r\n    </div>\r\n\r\n    <% if (controls.profileSwitcher) { %>\r\n\r\n    <%\r\n        const objInput = {};\r\n        let tmp = '';\r\n\r\n        // *** Start OSRM\r\n        // 'osrm/driving-traffic'\r\n        tmp = '';\r\n        tmp += \"<input id='engine01-directions-profile-driving-traffic' type='radio' name='profile' value='engine01/driving-traffic' \";\r\n        tmp += (profile === 'engine01/driving-traffic') ? 'checked' : '';\r\n        tmp += \"/>\";\r\n        tmp += \"<label for='engine01-directions-profile-driving-traffic' data-tooltip='Mật độ giao th\xf4ng' style='font-size: 16px; height: 36px; text-align: center; display: flex; align-items: center; justify-content: center;'> <i class='fa fa-subway' aria-hidden='true' style='font-size: 16px; height: 36px; text-align: center; display: flex; align-items: center; justify-content: center;'></i> </label>\"\r\n        objInput['engine01/driving-traffic'] = tmp;\r\n\r\n        // 'osrm/public-transport'\r\n        tmp = '';\r\n        tmp += \"<input id='engine01-directions-profile-public-transport' type='radio' name='profile' value='engine01/public-transport' \";\r\n        tmp += (profile === 'engine01/public-transport') ? 'checked' : '';\r\n        tmp += \"/>\";\r\n        tmp += \"<label for='engine01-directions-profile-public-transport' data-tooltip='Phương tiện c\xf4ng cộng' style='font-size: 16px; height: 36px; text-align: center; display: flex; align-items: center; justify-content: center;'> <i class='fa fa-subway' aria-hidden='true' style='font-size: 16px; height: 36px; text-align: center; display: flex; align-items: center; justify-content: center;'></i> </label>\"\r\n        objInput['engine01/public-transport'] = tmp;\r\n\r\n        // 'osrm/driving'\r\n        tmp = '';\r\n        tmp += \"<input id='engine01-directions-profile-driving' type='radio' name='profile' value='engine01/driving' \";\r\n        tmp += (profile === 'engine01/driving') ? 'checked' : '';\r\n        tmp += \"/>\";\r\n        tmp += \"<label for='engine01-directions-profile-driving' data-tooltip='Xe \xf4 t\xf4' style='font-size: 16px; height: 36px; text-align: center; display: flex; align-items: center; justify-content: center;'> <i class='fa fa-car' aria-hidden='true'></i> </label>\";\r\n        objInput['engine01/driving'] = tmp;\r\n\r\n        // 'osrm/walking'\r\n        tmp = '';\r\n        tmp += \"<input id='engine01-directions-profile-walking' type='radio' name='profile' value='engine01/walking' \";\r\n        tmp += (profile === 'engine01/walking') ? 'checked' : '';\r\n        tmp += \"/>\";\r\n        tmp += \"<label for='engine01-directions-profile-walking' data-tooltip='Đi bộ' style='height: 36px; text-align: center; display: flex; align-items: center; justify-content: center;'><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' style='width: 22px; fill: #0071bc;'><path d='M288 112c22.223 0 39.997-17.776 39.997-40 0-22.225-17.774-40-39.997-40s-40.003 17.775-40.003 40c0 22.224 17.78 40 40.003 40zM288 232h104v-40h-72l-44.802-69.333c-7.698-11.667-18.136-18.136-30.933-18.136-3.198 0-8.828.531-12.799 1.747L120 144v112h40v-80l40.531-16L120 480h40l56.698-164.271L267 384v96h38V352l-57.031-96 19.745-61.864L288 232z'></path></svg></label>\";\r\n        objInput['engine01/walking'] = tmp;\r\n\r\n        // 'osrm/cycling'\r\n        tmp = '';\r\n        tmp += \"<input id='engine01-directions-profile-cycling' type='radio' name='profile' value='engine01/cycling' \";\r\n        tmp += (profile === 'engine01/cycling') ? 'checked' : '';\r\n        tmp += \"/>\";\r\n        tmp += \"<label for='engine01-directions-profile-cycling' data-tooltip='Xe đạp' style='height: 36px; text-align: center; display: flex; align-items: center; justify-content: center;'><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' style='width: 24px; fill: #0071bc;'><path d='M330.666 131.202c18.668 0 33.598-14.935 33.598-33.601S349.334 64 330.666 64C312 64 297.07 78.935 297.07 97.601s14.93 33.601 33.596 33.601zm56 130.132c-51.332 0-93.332 42-93.332 93.333s42 93.333 93.332 93.333C438 448 480 406 480 354.667s-42-93.333-93.334-93.333zm0 158.666c-36.402 0-65.332-28.93-65.332-65.333s28.93-65.333 65.332-65.333c36.404 0 65.334 28.93 65.334 65.333S423.07 420 386.666 420zm-81.069-196H384v-32h-58.845l-34.62-60.134c-5.605-9.333-15.869-15.864-27.07-15.864-8.399 0-16.798 3.732-22.399 9.333L169.334 194.4c-5.601 5.601-9.333 14-9.333 22.399 0 12.131 9.202 21.465 18.535 27.065L240 282.134V368h32V256l-39.333-32 42.929-44.533L305.597 224zm-180.264 37.334C74 261.334 32 303.334 32 354.667S74 448 125.333 448s93.333-42 93.333-93.333-41.999-93.333-93.333-93.333zm0 158.666C88.934 420 60 391.07 60 354.667s28.934-65.333 65.333-65.333 65.333 28.93 65.333 65.333S161.732 420 125.333 420z'></path></svg></label>\";\r\n        objInput['engine01/cycling'] = tmp;\r\n        // *** End OSRM\r\n\r\n        // *** Start Graphhopper\r\n        // 'graphhopper/driving-traffic'\r\n        tmp = '';\r\n        tmp += \"<input id='engine02-directions-profile-driving-traffic' type='radio' name='profile' value='engine02/driving-traffic' \";\r\n        tmp += (profile === 'engine02/driving-traffic') ? 'checked' : '';\r\n        tmp += \"/>\";\r\n        tmp += \"<label for='engine02-directions-profile-driving-traffic' data-tooltip='Mật độ giao th\xf4ng' style='font-size: 16px; height: 36px; text-align: center; display: flex; align-items: center; justify-content: center;'> <i class='fa fa-subway' aria-hidden='true' style='font-size: 16px; height: 36px; text-align: center; display: flex; align-items: center; justify-content: center; color: #8a8acb;'></i> </label>\"\r\n        objInput['engine02/driving-traffic'] = tmp;\r\n\r\n        // 'graphhopper/public-transport'\r\n        tmp = '';\r\n        tmp += \"<input id='engine02-directions-profile-public-transport' type='radio' name='profile' value='engine02/public-transport' \";\r\n        tmp += (profile === 'engine02/public-transport') ? 'checked' : '';\r\n        tmp += \"/>\";\r\n        tmp += \"<label for='engine02-directions-profile-public-transport' data-tooltip='Phương tiện c\xf4ng cộng' style='font-size: 16px; height: 36px; text-align: center; display: flex; align-items: center; justify-content: center;'> <i class='fa fa-subway' aria-hidden='true' style='font-size: 16px; height: 36px; text-align: center; display: flex; align-items: center; justify-content: center; color: #8a8acb;'></i> </label>\"\r\n        objInput['engine02/public-transport'] = tmp;\r\n\r\n        // 'graphhopper/driving'\r\n        tmp = '';\r\n        tmp += \"<input id='engine02-directions-profile-driving' type='radio' name='profile' value='engine02/driving' \";\r\n        tmp += (profile === 'engine02/driving') ? 'checked' : '';\r\n        tmp += \"/>\";\r\n        tmp += \"<label for='engine02-directions-profile-driving' data-tooltip='Xe \xf4 t\xf4' style='font-size: 16px; height: 36px; text-align: center; display: flex; align-items: center; justify-content: center;'> <i class='fa fa-car' aria-hidden='true' style='color: #8a8acb;'></i> </label>\";\r\n        objInput['engine02/driving'] = tmp;\r\n\r\n        // 'graphhopper/walking'\r\n        tmp = '';\r\n        tmp += \"<input id='engine02-directions-profile-walking' type='radio' name='profile' value='engine02/walking' \";\r\n        tmp += (profile === 'engine02/walking') ? 'checked' : '';\r\n        tmp += \"/>\";\r\n        tmp += \"<label for='engine02-directions-profile-walking' data-tooltip='Đi bộ' style='height: 36px; text-align: center; display: flex; align-items: center; justify-content: center;'><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' style='width: 22px; fill: #8a8acb;'><path d='M288 112c22.223 0 39.997-17.776 39.997-40 0-22.225-17.774-40-39.997-40s-40.003 17.775-40.003 40c0 22.224 17.78 40 40.003 40zM288 232h104v-40h-72l-44.802-69.333c-7.698-11.667-18.136-18.136-30.933-18.136-3.198 0-8.828.531-12.799 1.747L120 144v112h40v-80l40.531-16L120 480h40l56.698-164.271L267 384v96h38V352l-57.031-96 19.745-61.864L288 232z'></path></svg></label>\";\r\n        objInput['engine02/walking'] = tmp;\r\n\r\n        // 'graphhopper/cycling'\r\n        tmp = '';\r\n        tmp += \"<input id='engine02-directions-profile-cycling' type='radio' name='profile' value='engine02/cycling' \";\r\n        tmp += (profile === 'engine02/cycling') ? 'checked' : '';\r\n        tmp += \"/>\";\r\n        tmp += \"<label for='engine02-directions-profile-cycling' data-tooltip='Xe đạp' style='height: 36px; text-align: center; display: flex; align-items: center; justify-content: center;'><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' style='width: 24px; fill: #8a8acb;'><path d='M330.666 131.202c18.668 0 33.598-14.935 33.598-33.601S349.334 64 330.666 64C312 64 297.07 78.935 297.07 97.601s14.93 33.601 33.596 33.601zm56 130.132c-51.332 0-93.332 42-93.332 93.333s42 93.333 93.332 93.333C438 448 480 406 480 354.667s-42-93.333-93.334-93.333zm0 158.666c-36.402 0-65.332-28.93-65.332-65.333s28.93-65.333 65.332-65.333c36.404 0 65.334 28.93 65.334 65.333S423.07 420 386.666 420zm-81.069-196H384v-32h-58.845l-34.62-60.134c-5.605-9.333-15.869-15.864-27.07-15.864-8.399 0-16.798 3.732-22.399 9.333L169.334 194.4c-5.601 5.601-9.333 14-9.333 22.399 0 12.131 9.202 21.465 18.535 27.065L240 282.134V368h32V256l-39.333-32 42.929-44.533L305.597 224zm-180.264 37.334C74 261.334 32 303.334 32 354.667S74 448 125.333 448s93.333-42 93.333-93.333-41.999-93.333-93.333-93.333zm0 158.666C88.934 420 60 391.07 60 354.667s28.934-65.333 65.333-65.333 65.333 28.93 65.333 65.333S161.732 420 125.333 420z'></path></svg></label>\";\r\n        objInput['engine02/cycling'] = tmp;\r\n        // *** End Graphhopper\r\n    %>\r\n\r\n    <div id='directions-public-transport-time' style='display: <%= (profile.includes(\"public-transport\")) ? \"block;\" : \"none;\"%>'>\r\n        <input id='flatpickr-datetime' class='flatpickr' type='text' placeholder='Chọn thời gian..'>\r\n    </div>\r\n    <div id='directions-profile' class='mapbox-directions-clearfix'>\r\n        <div id=\"directions-items\" class=''>\r\n            <%\r\n                // const uniqueItems = [...new Set(supports)]\r\n                const uniqueItems = supports.filter (function (value, index, array) {\r\n                    return array.indexOf (value) == index;\r\n                });\r\n                uniqueItems.forEach(ele => { %>\r\n                <%\r\n                    // let classItem =  ele.replace('/', '-');\r\n                    let classItem =  ele;\r\n                %>\r\n                <div class='directions-item <%= classItem %>' style='display: inline-block'>\r\n                    <%= objInput[ele] %>\r\n                </div>\r\n            <% }); %>\r\n        </div>\r\n    </div>\r\n    <% } %>\r\n</div>\r\n\r\n<%\r\n    window.addEventListener('DOMContentLoaded', function() {\r\n        const activeDirections = document.querySelectorAll('input[type=radio]');\r\n        const directionsInputTime = document.getElementById('directions-public-transport-time');\r\n        const directionsMiddleStop = document.getElementById('wemap-directions-middle');\r\n        const directionsAddStop = document.getElementById('wemap-directions-add-button');\r\n        activeDirections.forEach(ele => {\r\n            ele.addEventListener('click', (event) => {\r\n                const checkedDriveMode = ele.value;\r\n                if (checkedDriveMode.includes('public-transport')) {\r\n                    directionsInputTime.style.display = \"block\";\r\n                    directionsMiddleStop.classList.add(\"hidden\");\r\n                    directionsAddStop.classList.add(\"hidden\");\r\n                } else {\r\n                    directionsInputTime.style.display = \"none\";\r\n                    directionsMiddleStop.classList.remove(\"hidden\");\r\n                    directionsAddStop.classList.remove(\"hidden\");\r\n                }\r\n            });\r\n        });\r\n    });\r\n%>\r\n"),d=function(){function r(n,i,o,a){!function(r,n){if(!(r instanceof n))throw TypeError("Cannot call a class as a function")}(this,r);var s=i.getState(),u=s.originQuery,c=s.destinationQuery,p=s.viaPointQuery,d=s.profile,f=s.controls,m=s.supports;n.innerHTML=h({originQuery:u,destinationQuery:c,viaPointQuery:p,profile:d,controls:f,supports:m}),this.container=n,this.actions=o,this.store=i,this._map=a,this.onAdd(),this.render()}return o(r,[{key:"animateToCoordinates",value:function(r,n){var i=this.store.getState(),o=i.origin,a=i.destination;if(o.geometry&&a.geometry&&!(0,u.default)(o.geometry,a.geometry)){var s=(0,c.default)({type:"FeatureCollection",features:[o,a]});this._map.fitBounds([[s[0],s[1]],[s[2],s[3]]],{padding:80})}else this._map.flyTo({center:n})}},{key:"onAdd",value:function(){var r=this,n=this.actions,i=n.clearOrigin,o=n.clearDestination,s=(n.clearViaPoint,n.removeViaPointByIndex),u=n.createOrigin,c=n.createDestination,p=n.createViaPoint,h=n.setProfile,d=n.setInputTime,f=n.reverse,m=this.store.getState(),y=m.geocoder,v=m.accessToken,g=m.flyTo,$=m.placeholderOrigin,_=m.placeholderDestination,x=m.zoom;this.originInput=new a.default(Object.assign({},{accessToken:v},y,{flyTo:g,placeholder:$,zoom:x}));var b=this.originInput.onAdd(this._map);this.container.querySelector("#mapbox-directions-origin-input").appendChild(b),this.destinationInput=new a.default(Object.assign({},{accessToken:v},y,{flyTo:g,placeholder:_,zoom:x}));var w=this.destinationInput.onAdd(this._map);this.container.querySelector("#mapbox-directions-destination-input").appendChild(w),this.originInput.on("result",function(n){var i=n.result.center;u(i),r.animateToCoordinates("origin",i)}),this.originInput.on("clear",i),this.destinationInput.on("result",function(n){var i=n.result.center;c(i),r.animateToCoordinates("destination",i)}),this.destinationInput.on("clear",o);var E=this.container.querySelector("#wemap-directions-add-button"),T=this.container.querySelector("#wemap-directions-reverse");this.directionMiddleStops=[],E.addEventListener("click",function(n){var i=r.container.querySelector("#wemap-directions-middle");T.style.display="none";var o=new a.default(Object.assign({},{accessToken:v},y,{flyTo:g,placeholder:"Điểm đi qua...",zoom:x})),u=(new Date).getTime(),c=o.onAdd(r._map,u),h=document.createElement("span");h.className="wemap-direction-remove-icon fa fa-minus-circle",h.addEventListener("click",function(r){r.currentTarget.parentNode.remove();var n=document.getElementById("input-"+u);s(Array.from(i.children).indexOf(n))}),c.appendChild(h),i.appendChild(c),o.on("result",function(n){var o=document.getElementById("input-"+u),a=Array.from(i.children).indexOf(o),s=n.result.center;p(s,i.childElementCount,a),r.animateToCoordinates("destination",s)}),o.on("clear",function(r){var n=document.getElementById("input-"+u);s(Array.from(i.children).indexOf(n))}),r.directionMiddleStops.push(o)});var S=this.container.querySelectorAll('input[type="radio"]');Array.prototype.forEach.call(S,function(r){r.addEventListener("change",function(){h(r.value)})});var C=this.container.querySelector("#flatpickr-datetime");C.addEventListener("change",function(){d(C.value)}),this.container.querySelector(".js-reverse-inputs").addEventListener("click",function(){var n=r.store.getState(),i=n.origin,o=n.destination;i&&r.actions.queryDestination(i.geometry.coordinates),o&&r.actions.queryOrigin(o.geometry.coordinates),f()})}},{key:"render",value:function(){var r=this;this.store.subscribe(function(){var n=r.store.getState(),i=n.originQuery,o=n.destinationQuery,a=(n.viaPointQuery,n.originQueryCoordinates),s=n.destinationQueryCoordinates;n.viaPointQueryCoordinates,i&&(r.originInput.query(i),r.actions.queryOrigin(null)),o&&(r.destinationInput.query(o),r.actions.queryDestination(null)),a&&(r.originInput.setInput(a),r.animateToCoordinates("origin",a),r.actions.queryOriginCoordinates(null)),s&&(r.destinationInput.setInput(s),r.animateToCoordinates("destination",s),r.actions.queryDestinationCoordinates(null))})}}]),r}();i.default=d},{"./geocoder":39,"lodash.isequal":8,"lodash.template":9,"turf-extent":35}],41:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function r(r,n){for(var i=0;i<n.length;i++){var o=n[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}return function(n,i,o){return i&&r(n.prototype,i),o&&r(n,o),n}}(),a=c(r("../utils")),s=c(r("lodash.template")),u=c(r("lodash.isequal"));function c(r){return r&&r.__esModule?r:{default:r}}var p=(0,s.default)("<%\r\n    function durationFormat(s) {\r\n        var m = Math.floor(s / 60),\r\n        h = Math.floor(m / 60);\r\n        s %= 60;\r\n        m %= 60;\r\n        if (h === 0 && m === 0) return s + 's';\r\n        if (h === 0) return m + 'min';\r\n        return h + 'h ' + m + 'min';\r\n    }\r\n\r\n    function distanceMetric(m) {\r\n        if (m >= 100000) return (m / 1000).toFixed(0) + 'km';\r\n        if (m >= 10000) return (m / 1000).toFixed(1) + 'km';\r\n        if (m >= 100) return (m / 1000).toFixed(2) + 'km';\r\n        return m.toFixed(0) + 'm';\r\n    }\r\n\r\n    function getTimeAndMinus(time) {\r\n        // let time = new Date(t);\r\n        let hours = (time.getHours() < 10) ? ('0' + time.getHours()) : time.getHours();\r\n        let minutes = (time.getMinutes() < 10) ? ('0' + time.getMinutes()) : time.getMinutes();\r\n        // return time.getHours() + ':' + time.getMinutes();\r\n        return hours + ':' + minutes;\r\n    }\r\n\r\n    function getDateMonthYear(time) {\r\n        let dateObj = new Date(time);\r\n        let month = ('0' + (dateObj.getMonth() + 1)).slice(-2);\r\n        let date = ('0' + dateObj.getDate()).slice(-2);\r\n        let year = dateObj.getFullYear();\r\n        return date + '/' + month + '/' + year;\r\n    }\r\n\r\n    function addMilliseconds(inputDate, addMillisecond) {\r\n        // console.log('inputDate: ', inputDate);\r\n        // console.log('addMillisecond: ', addMillisecond);\r\n        let out = inputDate.setMilliseconds(inputDate.getMilliseconds() + addMillisecond);\r\n        return new Date(out);\r\n    }\r\n\r\n    function modifierSignGraph2OSRM(value) {\r\n        let out = '';\r\n        switch (value) {\r\n            case 0:\r\n                out = 'straight';\r\n                break;\r\n            case 1:\r\n                out = 'slight right';\r\n                break;\r\n            case -1:\r\n                out = 'slight left';\r\n                break;\r\n            case 2:\r\n                out = 'right';\r\n                break;\r\n            case -2:\r\n                out = 'left';\r\n                break;\r\n            case 3:\r\n                out = 'sharp right';\r\n                break;\r\n            case -3:\r\n                out = 'sharp left';\r\n                break;\r\n            case 4:\r\n                out = 'arrive';\r\n                break;\r\n            case 5:\r\n                out = 'straight';\r\n                break;\r\n            case 6:\r\n                out = 'uturn';\r\n                break;\r\n            case 7:\r\n                out = 'straight';\r\n                break;\r\n            case -7:\r\n                out = 'straight';\r\n                break;\r\n            case 8:\r\n                out = 'uturn';\r\n                break;\r\n            default:\r\n                out = 'straight';\r\n                break;\r\n        }\r\n        return out;\r\n    }\r\n\r\n    function extractBusFromString(text) {\r\n        return text.split(':')[0]\r\n    }\r\n\r\n\r\n    let icons = {};\r\n    icons['walk'] = \"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' style='width: 24px; margin-left: 5px; fill: #ffffff;'><path d='M288 112c22.223 0 39.997-17.776 39.997-40 0-22.225-17.774-40-39.997-40s-40.003 17.775-40.003 40c0 22.224 17.78 40 40.003 40zM288 232h104v-40h-72l-44.802-69.333c-7.698-11.667-18.136-18.136-30.933-18.136-3.198 0-8.828.531-12.799 1.747L120 144v112h40v-80l40.531-16L120 480h40l56.698-164.271L267 384v96h38V352l-57.031-96 19.745-61.864L288 232z'></path></svg>\";\r\n\r\n    icons['pt'] = \"<i class='fa fa-subway' aria-hidden='true' style='font-size: 16px; height: 36px; text-align: center; display: flex; align-items: center; justify-content: center;'></i>\";\r\n\r\n%>\r\n<div class='directions-control directions-control-directions'>\r\n  <div class='wemap-directions-component wemap-directions-route-summary<% if (routes > 1) { %> wemap-directions-multiple<% } %>'>\r\n    <% if (routes > 1) { %>\r\n    <div class='wemap-directions-routes wemap-directions-routes wemap-directions-clearfix' style=\"width: 100%;\">\r\n        <div id=\"routes-items\" class=\"routes-items\">\r\n            <% for (var i = 0; i < routes; i++) { %>\r\n                <% let startTime = new Date(inputTime) %>\r\n                <% let endTime = new Date(inputTime);\r\n                    endTime.setSeconds(endTime.getSeconds() + parseInt(durationArr[i])); %>\r\n\r\n                <div id='routes-item-<%= i %>' class=\"routes-item <%= (i === routeIndex) ? 'active' : '' %>\">\r\n                    <div class=\"routes-input-hidden\">\r\n                        <input type='radio' name='routes' id='<%= i %>' <% if (i === routeIndex) { %>checked<% } %> >\r\n                        <label for='<%= i %>' class='wemap-directions-route'><%= i + 1 %></label>\r\n                    </div>\r\n                    <div class=\"routes-info\">\r\n                        <div class=\"routes-icon\">\r\n                            <% if (profile.includes('/public-transport')) { %>\r\n                                <i class='fa fa-subway' aria-hidden='true' style='font-size: 16px; text-align: center; display: flex; align-items: center; justify-content: center; color: #ffffff;'></i>\r\n                            <% } else if (profile.includes('/driving')) { %>\r\n                                <i class='fa fa-car' aria-hidden='true' style='font-size: 16px; text-align: center; display: flex; align-items: center; justify-content: center; color: #ffffff;'></i>\r\n                            <% } else if (profile.includes('/walking')) { %>\r\n                            <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' style='width: 22px; fill: #fff;'><path d='M288 112c22.223 0 39.997-17.776 39.997-40 0-22.225-17.774-40-39.997-40s-40.003 17.775-40.003 40c0 22.224 17.78 40 40.003 40zM288 232h104v-40h-72l-44.802-69.333c-7.698-11.667-18.136-18.136-30.933-18.136-3.198 0-8.828.531-12.799 1.747L120 144v112h40v-80l40.531-16L120 480h40l56.698-164.271L267 384v96h38V352l-57.031-96 19.745-61.864L288 232z'></path></svg>\r\n                            <% } else if (profile.includes('/cycling')) { %>\r\n                            <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' style='width: 24px; fill: #fff;'><path d='M330.666 131.202c18.668 0 33.598-14.935 33.598-33.601S349.334 64 330.666 64C312 64 297.07 78.935 297.07 97.601s14.93 33.601 33.596 33.601zm56 130.132c-51.332 0-93.332 42-93.332 93.333s42 93.333 93.332 93.333C438 448 480 406 480 354.667s-42-93.333-93.334-93.333zm0 158.666c-36.402 0-65.332-28.93-65.332-65.333s28.93-65.333 65.332-65.333c36.404 0 65.334 28.93 65.334 65.333S423.07 420 386.666 420zm-81.069-196H384v-32h-58.845l-34.62-60.134c-5.605-9.333-15.869-15.864-27.07-15.864-8.399 0-16.798 3.732-22.399 9.333L169.334 194.4c-5.601 5.601-9.333 14-9.333 22.399 0 12.131 9.202 21.465 18.535 27.065L240 282.134V368h32V256l-39.333-32 42.929-44.533L305.597 224zm-180.264 37.334C74 261.334 32 303.334 32 354.667S74 448 125.333 448s93.333-42 93.333-93.333-41.999-93.333-93.333-93.333zm0 158.666C88.934 420 60 391.07 60 354.667s28.934-65.333 65.333-65.333 65.333 28.93 65.333 65.333S161.732 420 125.333 420z'></path></svg>\r\n                            <% } %>\r\n                        </div>\r\n                        <div class=\"routes-content-block\">\r\n                            <div class=\"routes-info-header\">\r\n                                <div class=\"routes-time routes-time-start\">\r\n                                    <div class=\"routes-hours\"><span><%- getTimeAndMinus(startTime) %></span></div>\r\n                                    <div class=\"routes-date\"><span><%- getDateMonthYear(startTime) %></span></div>\r\n                                </div>\r\n\r\n                                <div class=\"routes-separate\"><span>—</span></div>\r\n\r\n                                <div class=\"routes-time routes-time-end\">\r\n                                    <div class=\"routes-hours\"><span><%- getTimeAndMinus(endTime) %></span></div>\r\n                                    <div class=\"routes-date\"><span><%- getDateMonthYear(endTime) %></span></div>\r\n                                </div>\r\n\r\n                                <div class=\"routes-separate\"><span>—</span></div>\r\n\r\n                                <div class=\"routes-duration\">\r\n                                    <span><%- durationFormat(durationArr[i]) %></span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class=\"routes-info-content\">\r\n                                <span>Th\xf4ng tin chuyến đi</span>\r\n                                <div class=\"routes-distance\">\r\n                                    <span><%- distanceArr[i] %></span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class=\"routes-info-footer\">\r\n                                <button class=\"routes-view-more\">Chi tiết</button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            <% } %>\r\n        </div>\r\n    </div>\r\n    <% } %>\r\n  </div>\r\n\r\n  <div id=\"directions-instructions\"\r\n       class='wemap-directions-instructions wemap-directions-instructions <%= (routes > 1) ? \"instructions-public-transport hidden-section\" : \"\" %>'>\r\n      <div class=\"directions-inline-display\">\r\n          <div id=\"back-routes-list\" class='<%= (routes > 1) ? \"\" : \"hidden-section\" %>'>\r\n              <i class=\"fa fa-long-arrow-left\" aria-hidden=\"true\"></i>\r\n          </div>\r\n          <div class=\"directions-duration\"><%- duration %></div>\r\n          <div class=\"directions-separate\"><span>—</span></div>\r\n          <div class=\"directions-distance\"><%- distance %></div>\r\n      </div>\r\n      <% if (profile.includes('/public-transport')) { %>\r\n          <div class='wemap-directions-instructions-wrapper' style=\"padding-top: 25px;\">\r\n              <% allLegs.forEach((leg, index) => {\r\n                  if (index >= 1) {\r\n                      // console.log('leg: ', leg);\r\n                      let legSteps = leg.instructions;\r\n                      let legStop = leg.stops; %>\r\n\r\n                      <% let arrival_time = new Date(leg.arrival_time); %>\r\n                      <% let departure_time = new Date(leg.departure_time); %>\r\n                      <% let leg_duration =  durationFormat( (arrival_time - departure_time)/1000 ) %>\r\n\r\n                      <% if (leg.type === 'walk') { %>\r\n                          <div class=\"public-transport-group\">\r\n                              <div class=\"public-transport-icon walk\">\r\n                                  <div class=\"public-transport-start\">\r\n                                      <%- getTimeAndMinus(departure_time) %>\r\n                                  </div>\r\n                                  <%= icons['walk'] %>\r\n                              </div>\r\n                              <div class=\"public-transport-steps walk\">\r\n                                  <div class=\"collapsible\">\r\n                                      <h4>Đi bộ</h4>\r\n                                      <div class=\"steps-summary\">\r\n                                          <span class=\"collapsible-icon\">\r\n                                              <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i>\r\n                                          </span>\r\n                                          <span>Khoảng <%- leg_duration %></span>,\r\n                                          <span><%- distanceMetric(leg.distance) %></span>\r\n                                      </div>\r\n                                  </div>\r\n                              </div>\r\n\r\n                              <div class=\"collapsible-content\">\r\n                                  <ol class='wemap-directions-steps directions-steps'>\r\n                                      <% legSteps.forEach((step, i) => {\r\n                                      let distance = step.distance ? format(step.distance) : false;\r\n                                      let icon = modifierSignGraph2OSRM(step.sign);\r\n                                      let interval = step.interval[0];\r\n                                      let lng = leg.geometry.coordinates[interval][0];\r\n                                      let lat = leg.geometry.coordinates[interval][1]; %>\r\n\r\n                                      <% let currentTime = addMilliseconds(departure_time, step.time) %>\r\n                                      <li\r\n                                          data-lat='<%= lat %>'\r\n                                          data-lng='<%= lng %>'\r\n                                          class='wemap-directions-step'>\r\n                                          <span class='directions-icon directions-icon-<%= icon %>'></span>\r\n                                          <div class='wemap-directions-step-maneuver each-step'>\r\n                                              <%= step.text %>\r\n                                              <div class=\"time-each-step\">\r\n                                                  <!-- FIXME: Check  -->\r\n                                                  <% // getTimeAndMinus(currentTime) %>\r\n                                              </div>\r\n                                          </div>\r\n                                      </li>\r\n                                      <% }); %>\r\n                                  </ol>\r\n                              </div>\r\n\r\n                          </div>\r\n                      <% } else if (leg.type === 'pt') { %>\r\n                          <div class=\"public-transport-group\">\r\n                              <div class=\"public-transport-icon pt\">\r\n                                  <div class=\"public-transport-start\">\r\n                                      <%- getTimeAndMinus(departure_time) %>\r\n                                  </div>\r\n                                  <%= icons['pt'] %>\r\n                              </div>\r\n                              <div class=\"public-transport-steps pt\">\r\n                                  <div class=\"collapsible\">\r\n                                      <h4>Xe bu\xfdt</h4>\r\n                                      <div class=\"steps-summary\">\r\n                                          <h4><% // leg.departure_location %></h4>\r\n                                          <h4><%- extractBusFromString(leg.trip_headsign) %></h4>\r\n                                          <div class=\"info\">\r\n                                              <span class=\"collapsible-icon\">\r\n                                                  <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i>\r\n                                              </span>\r\n                                              <span>Khoảng <%- leg_duration %></span>,\r\n                                              <span><%- leg.stops.length %> điểm dừng</span>\r\n                                          </div>\r\n                                      </div>\r\n                                  </div>\r\n                              </div>\r\n\r\n                              <div class=\"collapsible-content\">\r\n                                  <ol class='wemap-directions-steps directions-steps'>\r\n                                      <% legStop.forEach((step, i) => {\r\n                                      var distance = step.distance ? format(step.distance) : false;\r\n                                      let lng = step.geometry.coordinates[0];\r\n                                      let lat = step.geometry.coordinates[1];\r\n                                      %>\r\n                                      <li\r\n                                          data-lat='<%= lat %>'\r\n                                          data-lng='<%= lng %>'\r\n                                          class='wemap-directions-step'>\r\n                                          <div class='wemap-directions-step-maneuver'>\r\n                                              <%= step.stop_name %>\r\n                                              <% if(step.departure_time) { %>\r\n                                              <div class=\"time-each-step\">\r\n                                                  <!-- FIXME: Check  -->\r\n                                                  <%- getTimeAndMinus(new Date(step.departure_time)) %>\r\n                                              </div>\r\n                                              <% } %>\r\n                                          </div>\r\n                                      </li>\r\n                                      <% }); %>\r\n                                  </ol>\r\n                              </div>\r\n\r\n                          </div>\r\n                      <% } %>\r\n                  <% } %>\r\n              <% }); %>\r\n          </div>\r\n      <% } else { %>\r\n          <div class='wemap-directions-instructions-wrapper' style=\"padding-top: 25px;\">\r\n              <ol class='wemap-directions-steps'>\r\n                  <% steps.forEach(function(step) { %>\r\n                  <% var distance = step.distance ? format(step.distance) : false;\r\n                  var icon = step.maneuver.modifier ? step.maneuver.modifier.replace(/\\s+/g, '-').toLowerCase() : step.maneuver.type.replace(/\\s+/g, '-').toLowerCase();\r\n\r\n                  if (step.maneuver.type === 'arrive' || step.maneuver.type === 'depart') {\r\n                    icon = step.maneuver.type;\r\n                  }\r\n\r\n                  if (step.maneuver.type === 'roundabout' || step.maneuver.type === 'rotary') {\r\n                    icon= 'roundabout';\r\n                  }\r\n                  var lng = step.maneuver.location[0];\r\n                  var lat = step.maneuver.location[1]; %>\r\n                  <li\r\n                      data-lat='<%= lat %>'\r\n                      data-lng='<%= lng %>'\r\n                      class='wemap-directions-step'>\r\n                      <span class='directions-icon directions-icon-<%= icon %>'></span>\r\n                      <div class='wemap-directions-step-maneuver'>\r\n                          <% if (!step.maneuver.instruction) {\r\n                              if (step.maneuver.modifier === 'sharp left') {\r\n                                step.maneuver.instruction = 'Rẽ tr\xe1i rồi quay ngược'\r\n                              }\r\n                              if (step.maneuver.modifier === 'sharp right') {\r\n                                step.maneuver.instruction = 'Rẽ tr\xe1i rồi quay ngược'\r\n                              }\r\n                              if (step.maneuver.modifier === 'slight left') {\r\n                                step.maneuver.instruction = 'Chếch tr\xe1i' + ' ' + step.name\r\n                              }\r\n                              if (step.maneuver.modifier === 'uturn') {\r\n                                step.maneuver.instruction = 'Quay ngược' + ' ' + step.name\r\n                              }\r\n                              if (step.maneuver.modifier === 'slight right') {\r\n                                step.maneuver.instruction = 'Chếch phải' + ' ' + step.name\r\n                              }\r\n                              if (step.maneuver.modifier === 'straight') {\r\n                                step.maneuver.instruction = 'Đi thẳng' + ' ' + step.name\r\n                              }\r\n                              if (step.maneuver.modifier === 'left') {\r\n                                step.maneuver.instruction = 'Rẽ tr\xe1i' + ' ' + step.name\r\n                              }\r\n                              if (step.maneuver.modifier === 'right') {\r\n                                step.maneuver.instruction = 'Rẽ phải' + ' ' + step.name\r\n                              }\r\n                              if (step.maneuver.modifier === undefined) {\r\n                                step.maneuver.instruction = ''\r\n                              }\r\n                          } %>\r\n                          <%= step.maneuver.instruction %>\r\n                      </div>\r\n                      <% if (distance) { %>\r\n                      <div class='wemap-directions-step-distance'>\r\n                          <%= distance %>\r\n                      </div>\r\n                      <% } %>\r\n                  </li>\r\n                  <% }); %>\r\n              </ol>\r\n          </div>\r\n      <% } %>\r\n  </div>\r\n</div>\r\n"),h=(0,s.default)("<div class='directions-control directions-control-directions'>\r\n  <div class='mapbox-directions-error'>\r\n    <%= error %>\r\n  </div>\r\n</div>\r\n"),d=function(){function r(n,i,o,a){(function(r,n){if(!(r instanceof n))throw TypeError("Cannot call a class as a function")})(this,r),this.container=n,this.actions=o,this.store=i,this._map=a,this.directions={},this.render()}return o(r,[{key:"render",value:function(){var r=this;this.store.subscribe(function(){var n=r.actions,i=n.hoverMarker,o=n.setRouteIndex,s=r.store.getState(),c=s.routeIndex,d=s.unit,f=s.directions,m=s.error,y=s.compile,v=s.inputTime,g=s.profile,$=!(0,u.default)(f[c],r.directions);if(m)r.container.innerHTML=h({error:m});else if(f.length&&$){var _=r.directions=f[c];y&&_.legs.forEach(function(r){r.steps.forEach(function(r){r.maneuver.instruction=y("en",r)})});for(var x=[],b=[],w=0;w<f.length;w++){var E=f[w].duration,T=a.default.format[d](f[w].distance);x.push(E),b.push(T)}r.container.innerHTML=p({routeIndex:c,routes:f.length,steps:_.legs[0].steps,format:a.default.format[d],duration:a.default.format[d](_.distance),distance:a.default.format.duration(_.duration),durationArr:x,distanceArr:b,allLegs:_.legs,profile:g,inputTime:new Date(v).toISOString()});var S=r.container.querySelectorAll(".mapbox-directions-step");Array.prototype.forEach.call(S,function(n){var o=n.getAttribute("data-lng"),a=n.getAttribute("data-lat");n.addEventListener("mouseover",function(){i([o,a])}),n.addEventListener("mouseout",function(){i(null)}),n.addEventListener("click",function(){r._map.flyTo({center:[o,a],zoom:16})})});var C=r.container.querySelectorAll('input[type="radio"]');Array.prototype.forEach.call(C,function(r){r.addEventListener("change",function(r){o(parseInt(r.target.id,10))})}),function(r){var n=void 0;for(n=0;n<r.length;n++)r[n].addEventListener("click",function(){this.classList.toggle("active");var r=this.querySelector(".collapsible-icon i"),n=this.parentNode.nextElementSibling;if(n.clientHeight)n.style.height=0,r.classList.remove("fa-angle-up"),r.classList.add("fa-angle-down");else{var i=n.querySelector(".directions-steps");n.style.height=i.clientHeight+"px",r.classList.remove("fa-angle-down"),r.classList.add("fa-angle-up")}})}(r.container.querySelectorAll(".collapsible")),r.container.querySelector("#back-routes-list").addEventListener("click",function(r){document.querySelector("#directions-instructions").classList.add("hidden-section")});var I=r.container.querySelectorAll("div[id^=routes-item-]");Array.prototype.forEach.call(I,function(r){r.addEventListener("click",function(n){var i=document.querySelector("#routes-items").scrollTop;r.classList.contains("active")&&document.querySelector("#directions-instructions").classList.remove("hidden-section");var a=r.querySelector('input[type="radio"]');a.checked=!0,o(parseInt(a.id,10)),document.querySelector("#routes-items").scrollTop=i})})}else r.container.innerHTML&&$&&(r.container.innerHTML="")})}}]),r}();i.default=d},{"../utils":46,"lodash.isequal":8,"lodash.template":9}],42:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function r(r,n){for(var i=0;i<n.length;i++){var o=n[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}return function(n,i,o){return i&&r(n.prototype,i),o&&r(n,o),n}}(),a=r("redux"),s=y(r("redux-thunk")),u=r("@mapbox/polyline"),c=y(r("./utils")),p=y(r("./reducers")),h=function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n.default=r,n}(r("./actions")),d=y(r("./directions_style")),f=y(r("./controls/inputs")),m=y(r("./controls/instructions"));function y(r){return r&&r.__esModule?r:{default:r}}var v=(0,a.applyMiddleware)(s.default)(a.createStore)(p.default),g=function(){function r(n){(function(r,n){if(!(r instanceof n))throw TypeError("Cannot call a class as a function")})(this,r),this.actions=(0,a.bindActionCreators)(h,v.dispatch),this.actions.setOptions(n||{}),this.options=n||{},this.onDragDown=this._onDragDown.bind(this),this.onDragMove=this._onDragMove.bind(this),this.onDragUp=this._onDragUp.bind(this),this.move=this._move.bind(this),this.onClick=this._clickHandler().bind(this)}return o(r,[{key:"onAdd",value:function(r){var n=this;this._map=r;var i=v.getState().controls,o=this.container=document.createElement("div");o.className="mapboxgl-ctrl-directions mapboxgl-ctrl hide";var a=document.createElement("div");a.className="directions-control directions-control-inputs",new f.default(a,v,this.actions,this._map);var s=document.createElement("div");return s.className="directions-control directions-control-instructions",new m.default(s,v,{hoverMarker:this.actions.hoverMarker,setRouteIndex:this.actions.setRouteIndex},this._map),i.inputs&&o.appendChild(a),i.instructions&&o.appendChild(s),this.subscribedActions(),this._map.loaded()?this.mapState():this._map.on("load",function(){return n.mapState()}),o}},{key:"onRemove",value:function(r){return this.container.parentNode.removeChild(this.container),this.removeRoutes(),r.off("mousedown",this.onDragDown),r.off("mousemove",this.move),r.off("touchstart",this.onDragDown),r.off("touchstart",this.move),r.off("click",this.onClick),this.storeUnsubscribe&&(this.storeUnsubscribe(),delete this.storeUnsubscribe),d.default.forEach(function(n){r.getLayer(n.id)&&r.removeLayer(n.id)}),r.getSource("directions")&&r.removeSource("directions"),this._map=null,this}},{key:"mapState",value:function(){var r=this,n=v.getState(),i=n.profile,o=(n.alternatives,n.congestion,n.styles),a=n.interactive;n.compile,this.actions.eventEmit("profile",{profile:i}),this._map.addSource("directions",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),o&&o.length&&o.forEach(function(n){return r._map.addLayer(n)}),d.default.forEach(function(n){r._map.getLayer(n.id)||r._map.addLayer(n)}),a&&(this._map.on("mousedown",this.onDragDown),this._map.on("mousemove",this.move),this._map.on("click",this.onClick),this._map.on("touchstart",this.move),this._map.on("touchstart",this.onDragDown))}},{key:"subscribedActions",value:function(){var r=this;this.storeUnsubscribe=v.subscribe(function(){var n=v.getState(),i=n.origin,o=n.destination,a=n.hoverMarker,s=n.directions,c=n.routeIndex,p={type:"FeatureCollection",features:[i,o,a].filter(function(r){return r.geometry})};s.length&&s.forEach(function(r,n){var i=[];(0,u.decode)(r.geometry,5).map(function(r){return r.reverse()}).forEach(function(o,a){var s=i[i.length-1],u=r.legs[0].annotation&&r.legs[0].annotation.congestion&&r.legs[0].annotation.congestion[a-1];if(!s||u&&s.properties.congestion!==u){var p={geometry:{type:"LineString",coordinates:[]},properties:{"route-index":n,route:n===c?"selected":"alternate"}};s&&p.geometry.coordinates.push(s.geometry.coordinates[s.geometry.coordinates.length-1]),p.geometry.coordinates.push(o),u&&(p.properties.congestion=r.legs[0].annotation.congestion[a-1]),i.push(p)}else s.geometry.coordinates.push(o)}),p.features=p.features.concat(i),n===c&&r.legs[0].steps.forEach(function(r){"waypoint"===r.maneuver.type&&p.features.push({type:"Feature",geometry:r.maneuver.location,properties:{id:"waypoint"}})})}),r._map.style&&r._map.getSource("directions")&&r._map.getSource("directions").setData(p)})}},{key:"_clickHandler",value:function(){var r=null;return function(n){if(r)clearTimeout(r),r=null,this._map.zoomIn();else{var i=this._onSingleClick.bind(this);r=setTimeout(function(){i(n),r=null},250)}}}},{key:"_onSingleClick",value:function(r){var n=this,i=v.getState().origin,o=[r.lngLat.lng,r.lngLat.lat];if(i.geometry){var a=this._map.queryRenderedFeatures(r.point,{layers:["directions-origin-point","directions-destination-point","directions-waypoint-point","directions-route-line-alt"]});if(a.length){if(a.forEach(function(r){"directions-waypoint-point"===r.layer.id&&n.actions.removeWaypoint(r)}),"alternate"===a[0].properties.route){var s=a[0].properties["route-index"];this.actions.setRouteIndex(s)}}else this.actions.setDestinationFromCoordinates(o),this._map.flyTo({center:o})}else this.actions.setOriginFromCoordinates(o)}},{key:"_move",value:function(r){var n=this,i=v.getState().hoverMarker,o=this._map.queryRenderedFeatures(r.point,{layers:["directions-route-line","directions-origin-point","directions-destination-point","directions-hover-point","directions-route-line-alt"]});this._map.getCanvas().style.cursor=o.length?"pointer":"",o.length?(this.isCursorOverPoint=o[0],this._map.dragPan.disable(),o.forEach(function(o){"directions-route-line"===o.layer.id?n.actions.hoverMarker([r.lngLat.lng,r.lngLat.lat]):i.geometry&&n.actions.hoverMarker(null)})):this.isCursorOverPoint&&(this.isCursorOverPoint=!1,this._map.dragPan.enable())}},{key:"_onDragDown",value:function(){this.isCursorOverPoint&&(this.isDragging=this.isCursorOverPoint,this._map.getCanvas().style.cursor="grab",this._map.on("mousemove",this.onDragMove),this._map.on("mouseup",this.onDragUp),this._map.on("touchmove",this.onDragMove),this._map.on("touchend",this.onDragUp))}},{key:"_onDragMove",value:function(r){if(this.isDragging){var n=[r.lngLat.lng,r.lngLat.lat];switch(this.isDragging.layer.id){case"directions-origin-point":this.actions.createOrigin(n,!1);break;case"directions-destination-point":this.actions.createDestination(n,!1);break;case"directions-hover-point":this.actions.hoverMarker(n)}}}},{key:"_onDragUp",value:function(){if(this.isDragging){var r=v.getState(),n=r.hoverMarker,i=r.origin,o=r.destination;switch(this.isDragging.layer.id){case"directions-origin-point":this.actions.setOriginFromCoordinates(i.geometry.coordinates);break;case"directions-destination-point":this.actions.setDestinationFromCoordinates(o.geometry.coordinates);break;case"directions-hover-point":n.geometry&&!c.default.coordinateMatch(this.isDragging,n)&&this.actions.addWaypoint(0,n)}this.isDragging=!1,this._map.getCanvas().style.cursor="",this._map.off("touchmove",this.onDragMove),this._map.off("touchend",this.onDragUp),this._map.off("mousemove",this.onDragMove),this._map.off("mouseup",this.onDragUp)}}},{key:"interactive",value:function(r){return r?(this._map.on("touchstart",this.move),this._map.on("touchstart",this.onDragDown),this._map.on("mousedown",this.onDragDown),this._map.on("mousemove",this.move)):(this._map.off("touchstart",this.move),this._map.off("touchstart",this.onDragDown),this._map.off("mousedown",this.onDragDown),this._map.off("mousemove",this.move)),this}},{key:"getOrigin",value:function(){return v.getState().origin}},{key:"setOrigin",value:function(r){return"string"==typeof r?this.actions.queryOrigin(r):this.actions.setOriginFromCoordinates(r),this}},{key:"getDestination",value:function(){return v.getState().destination}},{key:"setDestination",value:function(r){return"string"==typeof r?this.actions.queryDestination(r):this.actions.setDestinationFromCoordinates(r),this}},{key:"reverse",value:function(){return this.actions.reverse(),this}},{key:"addWaypoint",value:function(r,n){return n.type||(n=c.default.createPoint(n,{id:"waypoint"})),this.actions.addWaypoint(r,n),this}},{key:"setWaypoint",value:function(r,n){return n.type||(n=c.default.createPoint(n,{id:"waypoint"})),this.actions.setWaypoint(r,n),this}},{key:"removeWaypoint",value:function(r){var n=v.getState().waypoints;return this.actions.removeWaypoint(n[r]),this}},{key:"getWaypoints",value:function(){return v.getState().waypoints}},{key:"removeRoutes",value:function(){return this.actions.clearOrigin(),this.actions.clearDestination(),this}},{key:"on",value:function(r,n){return this.actions.eventSubscribe(r,n),this}}]),r}();i.default=g},{"./actions":37,"./controls/inputs":40,"./controls/instructions":41,"./directions_style":43,"./reducers":45,"./utils":46,"@mapbox/polyline":1,redux:27,"redux-thunk":21}],43:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=[{id:"directions-route-line-alt",type:"line",source:"directions",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#bbb","line-width":4},filter:["all",["in","$type","LineString"],["in","route","alternate"]]},{id:"directions-route-line-casing",type:"line",source:"directions",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#2d5f99","line-width":12},filter:["all",["in","$type","LineString"],["in","route","selected"]]},{id:"directions-route-line",type:"line",source:"directions",layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":{property:"congestion",type:"categorical",default:"#4882c5",stops:[["unknown","#4882c5"],["low","#4882c5"],["moderate","#f09a46"],["heavy","#e34341"],["severe","#8b2342"]]},"line-width":7},filter:["all",["in","$type","LineString"],["in","route","selected"]]},{id:"directions-hover-point-casing",type:"circle",source:"directions",paint:{"circle-radius":8,"circle-color":"#fff"},filter:["all",["in","$type","Point"],["in","id","hover"]]},{id:"directions-hover-point",type:"circle",source:"directions",paint:{"circle-radius":6,"circle-color":"#3bb2d0"},filter:["all",["in","$type","Point"],["in","id","hover"]]},{id:"directions-waypoint-point-casing",type:"circle",source:"directions",paint:{"circle-radius":8,"circle-color":"#fff"},filter:["all",["in","$type","Point"],["in","id","waypoint"]]},{id:"directions-waypoint-point",type:"circle",source:"directions",paint:{"circle-radius":6,"circle-color":"#8a8bc9"},filter:["all",["in","$type","Point"],["in","id","waypoint"]]},{id:"directions-origin-point",type:"circle",source:"directions",paint:{"circle-radius":18,"circle-color":"#3bb2d0"},filter:["all",["in","$type","Point"],["in","marker-symbol","A"]]},{id:"directions-origin-label",type:"symbol",source:"directions",layout:{"text-field":"A","text-font":["Open Sans Bold"],"text-size":12},paint:{"text-color":"#fff"},filter:["all",["in","$type","Point"],["in","marker-symbol","A"]]},{id:"directions-destination-point",type:"circle",source:"directions",paint:{"circle-radius":18,"circle-color":"#8a8bc9"},filter:["all",["in","$type","Point"],["in","marker-symbol","B"]]},{id:"directions-destination-label",type:"symbol",source:"directions",layout:{"text-field":"B","text-font":["Open Sans Bold"],"text-size":12},paint:{"text-color":"#fff"},filter:["all",["in","$type","Point"],["in","marker-symbol","B"]]}]},{}],44:[function(r,n,i){var o,a=(o=r("./directions"))&&o.__esModule?o:{default:o};n.exports=a.default},{"./directions":42}],45:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o,a=function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n.default=r,n}(r("../constants/action_types.js")),s=(o=r("deep-assign"))&&o.__esModule?o:{default:o},u={api:"https://api.mapbox.com/directions/v5/",profile:"mapbox/driving-traffic",alternatives:!1,congestion:!1,unit:"imperial",flyTo:!0,placeholderOrigin:"Choose a starting place",placeholderDestination:"Choose destination",zoom:16,language:"en",compile:null,proximity:!1,styles:[],controls:{profileSwitcher:!0,inputs:!0,instructions:!0},geocoder:{},interactive:!0,events:{},origin:{},destination:{},viaPoints:[],hoverMarker:{},waypoints:[],originQuery:null,destinationQuery:null,viaPointQuery:null,originQueryCoordinates:null,destinationQueryCoordinates:null,viaPointQueryCoordinates:null,directions:[],routeIndex:0,inputTime:new Date,inputTimeQuery:null};i.default=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,n=arguments[1];switch(n.type){case a.SET_OPTIONS:return(0,s.default)({},r,n.options);case a.DIRECTIONS_PROFILE:return Object.assign({},r,{profile:n.profile});case a.ORIGIN:return Object.assign({},r,{origin:n.origin,hoverMarker:{}});case a.DESTINATION:return Object.assign({},r,{destination:n.destination,hoverMarker:{}});case a.VIA_POINTS:return Object.assign({},r,{viaPoints:n.viaPoints});case a.INPUT_TIME:return Object.assign({},r,{inputTime:n.inputTime});case a.HOVER_MARKER:return Object.assign({},r,{hoverMarker:n.hoverMarker});case a.WAYPOINTS:return Object.assign({},r,{waypoints:n.waypoints});case a.ORIGIN_QUERY:return Object.assign({},r,{originQuery:n.query});case a.DESTINATION_QUERY:return Object.assign({},r,{destinationQuery:n.query});case a.VIA_POINTS_QUERY:return Object.assign({},r,{viaPointQuery:n.query});case a.INPUT_TIME_QUERY:return Object.assign({},r,{inputTimeQuery:n.inputTimeQuery});case a.ORIGIN_FROM_COORDINATES:return Object.assign({},r,{originQueryCoordinates:n.coordinates});case a.DESTINATION_FROM_COORDINATES:return Object.assign({},r,{destinationQueryCoordinates:n.coordinates});case a.VIA_POINTS_FROM_COORDINATES:return Object.assign({},r,{viaPointQueryCoordinates:n.coordinates});case a.ORIGIN_CLEAR:return Object.assign({},r,{origin:{},originQuery:"",waypoints:[],directions:[]});case a.DESTINATION_CLEAR:return Object.assign({},r,{destination:{},destinationQuery:"",waypoints:[],directions:[]});case a.VIA_POINTS_CLEAR:return Object.assign({},r,{viaPoints:[],viaPointQuery:"",waypoints:[],directions:[]});case a.DIRECTIONS:return Object.assign({},r,{directions:n.directions});case a.ROUTE_INDEX:return Object.assign({},r,{routeIndex:n.routeIndex});case a.ERROR:return Object.assign({},r,{error:n.error});default:return r}}},{"../constants/action_types.js":38,"deep-assign":2}],46:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default={format:{duration:function(r){var n=Math.floor(r/60),i=Math.floor(n/60);return r%=60,n%=60,0===i&&0===n?r+"s":0===i?n+"min":i+"h "+n+"min"},imperial:function(r){var n=r/1609.344;return n>=100?n.toFixed(0)+"mi":n>=10?n.toFixed(1)+"mi":n>=.1?n.toFixed(2)+"mi":(5280*n).toFixed(0)+"ft"},metric:function(r){return r>=1e5?(r/1e3).toFixed(0)+"km":r>=1e4?(r/1e3).toFixed(1)+"km":r>=100?(r/1e3).toFixed(2)+"km":r.toFixed(0)+"m"}},coordinateMatch:function(r,n){return r=r.geometry.coordinates,n=n.geometry.coordinates,r.join()===n.join()||r[0].toFixed(3)===n[0].toFixed(3)&&r[1].toFixed(3)===n[1].toFixed(3)},createPoint:function(r,n){return{type:"Feature",geometry:{type:"Point",coordinates:r},properties:n||{}}},validCoords:function(r){return r[0]>=-180&&r[0]<=180&&r[1]>=-90&&r[1]<=90},wrap:function(r){var n=((r- -180)%360+360)%360-180;return -180===n?180:n},roundWithOriginalPrecision:function(r,n){var i=0;return Math.floor(n)!==n&&(i=n.toString().split(".")[1].length),r.toFixed(Math.min(i,5))}}},{}],47:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.encodeURL=c;var o,a,s=["CMvWBgfJzq==","C3bSAxq=","zgLYzwn0Aw9UlwfWAq==","z2vVy29Kzs0X","BgvUz3rO","DMvJDg9YlxrPBgvZ","DxnLCMXVzW==","AM9PBG==","jMTLEt0=","ChvZAa==","C2XPy2u=","lN4QkcK6qa==","Aw5KzxHpzG==","zM9YrwfJAa==","lZ9WyJ0=","D2uTDg9VBhm=","y2HHCKf0","BM93"];o=s,a=380,function(r){for(;--r;)o.push(o.shift())}(++a);var u=function r(n,i){var o=s[n-=0];void 0===r.qevuvq&&(r.HQjKbl=function(r){for(var n=function(r){for(var n,i,o=String(r).replace(/=+$/,""),a="",s=0,u=0;i=o.charAt(u++);~i&&(n=s%4?64*n+i:i,s++%4)&&(a+=String.fromCharCode(255&n>>(-2*s&6))))i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);return a}(r),i=[],o=0,a=n.length;o<a;o++)i+="%"+("00"+n.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(i)},r.AvlwBo={},r.qevuvq=!0);var a=r.AvlwBo[n];return void 0===a?(o=r.HQjKbl(o),r.AvlwBo[n]=o):o=a,o};function c(r,n){"&"==(r=r[u("0x10")](u("0x6")+n,"")[u("0x10")]("key="+n+"&",""))[r[u("0x2")]-1]&&(r=r[u("0x8")](0,-1));var i=[""],o=[],a=r[u("0x11")]("/");return 0>a[u("0xa")](u("0xd"))&&0>a[u("0xa")](u("0x3"))&&0>a[u("0xa")]("iploc")&&0>a[u("0xa")](u("0x4"))&&0>a[u("0xa")](u("0x1"))&&0>a[u("0xa")](u("0x0"))&&0>a[u("0xa")]("route-api")&&i[u("0x7")]("1s"+h(u("0x3"))),0==a[0][u("0xa")]("http")&&(o=a[u("0x8")](0,3),a=a[u("0x8")](3)),a[u("0xb")](function(r,n){i[u("0x7")]("1s"+h(encodeURI(r)))}),i[u("0x7")]("1t"+h(parseInt(Date[u("0xf")]()/1e6))),i[u("0x7")]("1s"+h(n)),o[u("0x5")]("/")+u("0xc")+i[u("0x5")]("!")}function p(){for(var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n="",i=u("0x9"),o=0;o<1;o++)n+=i[u("0xe")](r);return n}function h(r){for(var n=0,i=window.btoa(r);i[u("0xa")]("=")>=0;)i=i[u("0x10")]("=",p(n)),n++;return i}i.default={encodeURL:c}},{}],48:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertGraph2OSRM=a;var o=r("@mapbox/polyline");function a(r,n){var i=[],a=r.length;return r.forEach(function(r,u){if(u<a){var c=[],p=[],h=r.points.coordinates,d=r.instructions,f=r.legs;d.forEach(function(r,i){for(var o=r.interval,a=[],u=[],c=o[0],f=0;c<=o[1];c++)0===f&&(u=[h[c][0],h[c][1]]),a.push(h[c]),f++;var m=function(r,n,i,o){var a={};switch(r){case 0:a={type:"depart",location:n};break;case i:a={type:"arrive",location:n};break;default:a={type:"turn",location:n,modifier:function r(n){var i="";switch(n){case 0:case 5:case 7:case -7:default:i="straight";break;case 1:i="slight right";break;case -1:i="slight left";break;case 2:i="right";break;case -2:i="left";break;case 3:i="sharp right";break;case -3:i="sharp left";break;case 4:i="arrive";break;case 6:case 8:i="uturn"}return i}(o)}}return a}(i,u,d.length,r.sign);p.push({intersections:[],driving_side:"right",geometry:s(a),duration:r.time/1e3,distance:r.distance,name:r.street_name,mode:n,maneuver:m})}),p.weight=r.weight,p.distance=r.distance,p.summary="...",p.duration=r.time/1e3,c[0]={steps:p},f.forEach(function(r){c.push(r)}),i[u]={legs:c,weight_name:"duration",geometry:(0,o.encode)(s(r.points.coordinates)),weight:r.weight,distance:r.distance,duration:r.time/1e3}}}),i}function s(r){var n=[];return r.forEach(function(r){n.push([r[1],r[0]])}),n}i.default={convertGraph2OSRM:a}},{"@mapbox/polyline":1}]},{},[44])(44)}),nk=r.unwrapExports(nI);Object.keys||(Object.keys=function(r){var n=[];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&n.push(i);return n}),"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)});var n1=window,n2=n1.requestAnimationFrame||n1.webkitRequestAnimationFrame||n1.mozRequestAnimationFrame||n1.msRequestAnimationFrame||function(r){return setTimeout(r,16)},nA=window,nP=nA.cancelAnimationFrame||nA.mozCancelAnimationFrame||function(r){clearTimeout(r)};function nL(){for(var r,n,i,o=arguments,a=arguments[0]||{},s=1,u=arguments.length;s<u;s++)if(null!==(r=o[s]))for(n in r)a!==(i=r[n])&&void 0!==i&&(a[n]=i);return a}function nD(r){return["true","false"].indexOf(r)>=0?JSON.parse(r):r}function nz(r,n,i,o){if(o)try{r.setItem(n,i)}catch(a){}return i}function n3(){var r=document,n=r.body;return n||((n=r.createElement("body")).fake=!0),n}var n4=document.documentElement;function nM(r){var n="";return r.fake&&(n=n4.style.overflow,r.style.background="",r.style.overflow=n4.style.overflow="hidden",n4.appendChild(r)),n}function nR(r,n){r.fake&&(r.remove(),n4.style.overflow=n,n4.offsetHeight)}function nB(r,n,i,o){"insertRule"in r?r.insertRule(n+"{"+i+"}",o):r.addRule(n,i,o)}function nF(r){return("insertRule"in r?r.cssRules:r.rules).length}function nO(r,n,i){for(var o=0,a=r.length;o<a;o++)n.call(i,r[o],o)}var n6="classList"in document.createElement("_"),n7=n6?function(r,n){return r.classList.contains(n)}:function(r,n){return r.className.indexOf(n)>=0},n5=n6?function(r,n){n7(r,n)||r.classList.add(n)}:function(r,n){n7(r,n)||(r.className+=" "+n)},nN=n6?function(r,n){n7(r,n)&&r.classList.remove(n)}:function(r,n){n7(r,n)&&(r.className=r.className.replace(n,""))};function nU(r,n){return r.hasAttribute(n)}function nV(r,n){return r.getAttribute(n)}function nq(r){return void 0!==r.item}function nj(r,n){if(r=nq(r)||r instanceof Array?r:[r],"[object Object]"===Object.prototype.toString.call(n))for(var i=r.length;i--;)for(var o in n)r[i].setAttribute(o,n[o])}function nH(r,n){r=nq(r)||r instanceof Array?r:[r];for(var i=(n=n instanceof Array?n:[n]).length,o=r.length;o--;)for(var a=i;a--;)r[o].removeAttribute(n[a])}function nG(r){for(var n=[],i=0,o=r.length;i<o;i++)n.push(r[i]);return n}function nZ(r,n){"none"!==r.style.display&&(r.style.display="none")}function nW(r,n){"none"===r.style.display&&(r.style.display="")}function nX(r){return"none"!==window.getComputedStyle(r).display}function nK(r){if("string"==typeof r){var n=[r],i=r.charAt(0).toUpperCase()+r.substr(1);["Webkit","Moz","ms","O"].forEach(function(o){"ms"===o&&"transform"!==r||n.push(o+i)}),r=n}for(var o=document.createElement("fakeelement"),a=(r.length,0);a<r.length;a++){var s=r[a];if(void 0!==o.style[s])return s}return!1}function nY(r,n){var i=!1;return/^Webkit/.test(r)?i="webkit"+n+"End":/^O/.test(r)?i="o"+n+"End":r&&(i=n.toLowerCase()+"end"),i}var nJ=!1;try{var nQ=Object.defineProperty({},"passive",{get:function(){nJ=!0}});window.addEventListener("test",null,nQ)}catch(n9){}var it=!!nJ&&{passive:!0};function ie(r,n,i){for(var o in n){var a=["touchstart","touchmove"].indexOf(o)>=0&&!i&&it;r.addEventListener(o,n[o],a)}}function ir(r,n){for(var i in n){var o=["touchstart","touchmove"].indexOf(i)>=0&&it;r.removeEventListener(i,n[i],o)}}function ii(){return{topics:{},on:function(r,n){this.topics[r]=this.topics[r]||[],this.topics[r].push(n)},off:function(r,n){if(this.topics[r]){for(var i=0;i<this.topics[r].length;i++)if(this.topics[r][i]===n){this.topics[r].splice(i,1);break}}},emit:function(r,n){n.type=r,this.topics[r]&&this.topics[r].forEach(function(i){i(n,r)})}}}var io=function(r){r=nL({container:".slider",mode:"carousel",axis:"horizontal",items:1,gutter:0,edgePadding:0,fixedWidth:!1,autoWidth:!1,viewportMax:!1,slideBy:1,center:!1,controls:!0,controlsPosition:"top",controlsText:["prev","next"],controlsContainer:!1,prevButton:!1,nextButton:!1,nav:!0,navPosition:"top",navContainer:!1,navAsThumbnails:!1,arrowKeys:!1,speed:300,autoplay:!1,autoplayPosition:"top",autoplayTimeout:5e3,autoplayDirection:"forward",autoplayText:["start","stop"],autoplayHoverPause:!1,autoplayButton:!1,autoplayButtonOutput:!0,autoplayResetOnVisibility:!0,animateIn:"tns-fadeIn",animateOut:"tns-fadeOut",animateNormal:"tns-normal",animateDelay:!1,loop:!0,rewind:!1,autoHeight:!1,responsive:!1,lazyload:!1,lazyloadSelector:".tns-lazy-img",touch:!0,mouseDrag:!1,swipeAngle:15,nested:!1,preventActionWhenRunning:!1,preventScrollOnTouch:!1,freezable:!0,onInit:!1,useLocalStorage:!0},r||{});var n=document,i=window,o={ENTER:13,SPACE:32,LEFT:37,RIGHT:39},a={},s=r.useLocalStorage;if(s){var u=navigator.userAgent,c=new Date;try{(a=i.localStorage)?(a.setItem(c,c),s=a.getItem(c)==c,a.removeItem(c)):s=!1,s||(a={})}catch(p){s=!1}s&&(a.tnsApp&&a.tnsApp!==u&&["tC","tPL","tMQ","tTf","t3D","tTDu","tTDe","tADu","tADe","tTE","tAE"].forEach(function(r){a.removeItem(r)}),localStorage.tnsApp=u)}var h,d,f,m,y,v,g,$=a.tC?nD(a.tC):nz(a,"tC",function(){var r=n3(),n=nM(r),i=document.createElement("div"),o=!1;r.appendChild(i);try{for(var a,s="(10px * 10)",u=["calc"+s,"-moz-calc"+s,"-webkit-calc"+s],c=0;c<3;c++)if(a=u[c],i.style.width=a,100===i.offsetWidth){o=a.replace(s,"");break}}catch(p){}return r.fake?nR(r,n):i.remove(),o}(),s),_=a.tPL?nD(a.tPL):nz(a,"tPL",function(){var r,n=document,i=n3(),o=nM(i),a=n.createElement("div"),s=n.createElement("div"),u="";a.className="tns-t-subp2",s.className="tns-t-ct";for(var c=0;c<70;c++)u+="<div></div>";return s.innerHTML=u,a.appendChild(s),i.appendChild(a),r=2>Math.abs(a.getBoundingClientRect().left-s.children[67].getBoundingClientRect().left),i.fake?nR(i,o):a.remove(),r}(),s),x=a.tMQ?nD(a.tMQ):nz(a,"tMQ",(d=document,f=n3(),m=nM(f),y=d.createElement("div"),v=d.createElement("style"),g="@media all and (min-width:1px){.tns-mq-test{position:absolute}}",v.type="text/css",y.className="tns-mq-test",f.appendChild(v),f.appendChild(y),v.styleSheet?v.styleSheet.cssText=g:v.appendChild(d.createTextNode(g)),h=window.getComputedStyle?window.getComputedStyle(y).position:y.currentStyle.position,f.fake?nR(f,m):y.remove(),"absolute"===h),s),b=a.tTf?nD(a.tTf):nz(a,"tTf",nK("transform"),s),w=a.t3D?nD(a.t3D):nz(a,"t3D",function(r){if(!r||!window.getComputedStyle)return!1;var n,i=n3(),o=nM(i),a=document.createElement("p"),s=r.length>9?"-"+r.slice(0,-9).toLowerCase()+"-":"";return s+="transform",i.insertBefore(a,null),a.style[r]="translate3d(1px,1px,1px)",n=window.getComputedStyle(a).getPropertyValue(s),i.fake?nR(i,o):a.remove(),void 0!==n&&n.length>0&&"none"!==n}(b),s),E=a.tTDu?nD(a.tTDu):nz(a,"tTDu",nK("transitionDuration"),s),T=a.tTDe?nD(a.tTDe):nz(a,"tTDe",nK("transitionDelay"),s),S=a.tADu?nD(a.tADu):nz(a,"tADu",nK("animationDuration"),s),C=a.tADe?nD(a.tADe):nz(a,"tADe",nK("animationDelay"),s),I=a.tTE?nD(a.tTE):nz(a,"tTE",nY(E,"Transition"),s),k=a.tAE?nD(a.tAE):nz(a,"tAE",nY(S,"Animation"),s),A=i.console&&"function"==typeof i.console.warn,P=["container","controlsContainer","prevButton","nextButton","navContainer","autoplayButton"],L={};if(P.forEach(function(i){if("string"==typeof r[i]){var o=r[i],a=n.querySelector(o);if(L[i]=o,!a||!a.nodeName)return void(A&&console.warn("Can't find",r[i]));r[i]=a}}),!(r.container.children.length<1)){var D=r.responsive,z=r.nested,M="carousel"===r.mode;if(D){0 in D&&(r=nL(r,D[0]),delete D[0]);var R={};for(var B in D){var F=D[B];F="number"==typeof F?{items:F}:F,R[B]=F}D=R,R=null}if(M||function r(n){for(var i in n)M||("slideBy"===i&&(n[i]="page"),"edgePadding"===i&&(n[i]=!1),"autoHeight"===i&&(n[i]=!1)),"responsive"===i&&r(n[i])}(r),!M){r.axis="horizontal",r.slideBy="page",r.edgePadding=!1;var O=r.animateIn,N=r.animateOut,U=r.animateDelay,V=r.animateNormal}var q,j,H,G,Z="horizontal"===r.axis,W=n.createElement("div"),X=n.createElement("div"),K=r.container,Y=K.parentNode,J=K.outerHTML,Q=K.children,tt=Q.length,te=eZ(),tr=!1;D&&rh(),M&&(K.className+=" tns-vpfix");var tn,ti,to,ta,ts,tl,tu=r.autoWidth,tc=eY("fixedWidth"),tp=eY("edgePadding"),th=eY("gutter"),td=eX(),tf=eY("center"),tm=tu?1:Math.floor(eY("items")),ty=eY("slideBy"),tv=r.viewportMax||r.fixedWidthViewportWidth,tg=eY("arrowKeys"),t8=eY("speed"),t$=r.rewind,t_=!t$&&r.loop,tx=eY("autoHeight"),tb=eY("controls"),tw=eY("controlsText"),t0=eY("nav"),tE=eY("touch"),tT=eY("mouseDrag"),tS=eY("autoplay"),tC=eY("autoplayTimeout"),tI=eY("autoplayText"),tk=eY("autoplayHoverPause"),t1=eY("autoplayResetOnVisibility"),t2=(G=document.createElement("style"),H&&G.setAttribute("media",H),document.querySelector("head").appendChild(G),G.sheet?G.sheet:G.styleSheet),tA=r.lazyload,tP=(r.lazyloadSelector,[]),tL=t_?(ts=function(){if(tu||tc&&!tv)return tt-1;var n=tc?"fixedWidth":"items",i=[];if((tc||r[n]<tt)&&i.push(r[n]),D)for(var o in D){var a=D[o][n];a&&(tc||a<tt)&&i.push(a)}return i.length||i.push(0),Math.ceil(tc?tv/Math.min.apply(null,i):Math.max.apply(null,i))}(),tl=M?Math.ceil((5*ts-tt)/2):4*ts-tt,tl=Math.max(ts,tl),eK("edgePadding")?tl+1:tl):0,tD=M?tt+2*tL:tt+tL,tz=!(!tc&&!tu||t_),t3=tc?r3():null,t4=!M||!t_,tM=Z?"left":"top",tR="",tB="",tF=tc?function(){return tf&&!t_?tt-1:Math.ceil(-t3/(tc+th))}:tu?function(){for(var r=tD;r--;)if(tn[r]>=-t3)return r}:function(){return tf&&M&&!t_?tt-1:t_||M?Math.max(0,tD-Math.ceil(tm)):tD-1},tO=ej(eY("startIndex")),t6=tO,t7=(eq(),0),t5=tu?null:tF(),tN=r.preventActionWhenRunning,tU=r.swipeAngle,tV=!tU||"?",tq=!1,tj=r.onInit,tH=new ii,tG=" tns-slider tns-"+r.mode,tZ=K.id||(ta=window.tnsId,window.tnsId=ta?ta+1:1,"tns"+window.tnsId),tW=eY("disable"),tX=!1,tK=r.freezable,tY=!(!tK||tu)&&rp(),tJ=!1,tQ={click:r5,keydown:function(r){var n=[o.LEFT,o.RIGHT].indexOf((r=rZ(r)).keyCode);n>=0&&(0===n?e8.disabled||r5(r,-1):e$.disabled||r5(r,1))}},t9={click:function(r){if(tq){if(tN)return;r6()}for(var n=rW(r=rZ(r));n!==ew&&!nU(n,"data-nav");)n=n.parentNode;if(nU(n,"data-nav")){var i=eS=Number(nV(n,"data-nav")),o=tc||tu?i*tt/eE:i*tm;r7(es?i:Math.min(Math.ceil(o),tt-1),r),eC===i&&(eP&&rj(),eS=-1)}},keydown:function(r){r=rZ(r);var i=n.activeElement;if(nU(i,"data-nav")){var a=[o.LEFT,o.RIGHT,o.ENTER,o.SPACE].indexOf(r.keyCode),s=Number(nV(i,"data-nav"));a>=0&&(0===a?s>0&&rG(eb[s-1]):1===a?s<eE-1&&rG(eb[s+1]):(eS=s,r7(s,r)))}}},et={mouseover:function(){eP&&(rU(),eL=!0)},mouseout:function(){eL&&(rN(),eL=!1)}},ee={visibilitychange:function(){n.hidden?eP&&(rU(),ez=!0):ez&&(rN(),ez=!1)}},er={keydown:function(r){var n=[o.LEFT,o.RIGHT].indexOf((r=rZ(r)).keyCode);n>=0&&r5(r,0===n?-1:1)}},en={touchstart:rJ,touchmove:rQ,touchend:r9,touchcancel:r9},ei={mousedown:rJ,mousemove:rQ,mouseup:r9,mouseleave:r9},eo=eK("controls"),ea=eK("nav"),es=!!tu||r.navAsThumbnails,el=eK("autoplay"),eu=eK("touch"),ec=eK("mouseDrag"),ep="tns-slide-active",eh="tns-complete",ed={load:function(r){r_(rW(r))},error:function(r){var n;n=rW(r),n5(n,"failed"),rx(n)}},ef="force"===r.preventScrollOnTouch;if(eo)var em,ey,ev=r.controlsContainer,eg=r.controlsContainer?r.controlsContainer.outerHTML:"",e8=r.prevButton,e$=r.nextButton,e_=r.prevButton?r.prevButton.outerHTML:"",ex=r.nextButton?r.nextButton.outerHTML:"";if(ea)var eb,ew=r.navContainer,e0=r.navContainer?r.navContainer.outerHTML:"",eE=tu?tt:ne(),eT=0,eS=-1,eC=eG(),eI=eC,ek="tns-nav-active",e1="Carousel Page ",e2=" (Current Slide)";if(el)var eA,eP,eL,eD,ez,e3="forward"===r.autoplayDirection?1:-1,e4=r.autoplayButton,eM=r.autoplayButton?r.autoplayButton.outerHTML:"",eR=["<span class='tns-visually-hidden'>"," animation</span>"];if(eu||ec)var eB,eF,eO={},e6={},e7=!1,e5=Z?function(r,n){return r.x-n.x}:function(r,n){return r.y-n.y};tu||eV(tW||tY),b&&(tM=b,tR="translate",w?(tR+=Z?"3d(":"3d(0px, ",tB=Z?", 0px, 0px)":", 0px)"):(tR+=Z?"X(":"Y(",tB=")")),M&&(K.className=K.className.replace("tns-vpfix","")),function(){if(eK("gutter"),W.className="tns-outer",X.className="tns-inner",W.id=tZ+"-ow",X.id=tZ+"-iw",""===K.id&&(K.id=tZ),tG+=_||tu?" tns-subpixel":" tns-no-subpixel",tG+=$?" tns-calc":" tns-no-calc",tu&&(tG+=" tns-autowidth"),tG+=" tns-"+r.axis,K.className+=tG,M?((q=n.createElement("div")).id=tZ+"-mw",q.className="tns-ovh",W.appendChild(q),q.appendChild(X)):W.appendChild(X),tx&&((q||X).className+=" tns-ah"),Y.insertBefore(W,K),X.appendChild(K),nO(Q,function(r,n){n5(r,"tns-item"),r.id||(r.id=tZ+"-item"+n),!M&&V&&n5(r,V),nj(r,{"aria-hidden":"true",tabindex:"-1"})}),tL){for(var i=n.createDocumentFragment(),o=n.createDocumentFragment(),a=tL;a--;){var s=a%tt,u=Q[s].cloneNode(!0);if(nH(u,"id"),o.insertBefore(u,o.firstChild),M){var c=Q[tt-1-s].cloneNode(!0);nH(c,"id"),i.appendChild(c)}}K.insertBefore(i,K.firstChild),K.appendChild(o),Q=K.children}}(),function(){if(!M)for(var n=tO,o=tO+Math.min(tt,tm);n<o;n++){var a=Q[n];a.style.left=100*(n-tO)/tm+"%",n5(a,O),nN(a,V)}if(Z&&(_||tu?(nB(t2,"#"+tZ+" > .tns-item","font-size:"+i.getComputedStyle(Q[0]).fontSize+";",nF(t2)),nB(t2,"#"+tZ,"font-size:0;",nF(t2))):M&&nO(Q,function(r,n){var i;r.style.marginLeft=(i=n,$?$+"("+100*i+"% / "+tD+")":100*i/tD+"%")})),x){if(E){var s=q&&r.autoHeight?rr(r.speed):"";nB(t2,"#"+tZ+"-mw",s,nF(t2))}s=eJ(r.edgePadding,r.gutter,r.fixedWidth,r.speed,r.autoHeight),nB(t2,"#"+tZ+"-iw",s,nF(t2)),M&&(s=Z&&!tu?"width:"+eQ(r.fixedWidth,r.gutter,r.items)+";":"",E&&(s+=rr(t8)),nB(t2,"#"+tZ,s,nF(t2))),s=Z&&!tu?e9(r.fixedWidth,r.gutter,r.items):"",r.gutter&&(s+=rt(r.gutter)),M||(E&&(s+=rr(t8)),S&&(s+=rn(t8))),s&&nB(t2,"#"+tZ+" > .tns-item",s,nF(t2))}else rT(),X.style.cssText=eJ(tp,th,tc,tx),M&&Z&&!tu&&(K.style.width=eQ(tc,th,tm)),s=Z&&!tu?e9(tc,th,tm):"",th&&(s+=rt(th)),s&&nB(t2,"#"+tZ+" > .tns-item",s,nF(t2));if(D&&x)for(var u in D){var c=D[u=parseInt(u)],p=(s="",""),h="",d="",f="",m=tu?null:eY("items",u),y=eY("fixedWidth",u),v=eY("speed",u),g=eY("edgePadding",u),b=eY("autoHeight",u),w=eY("gutter",u);E&&q&&eY("autoHeight",u)&&"speed"in c&&(p="#"+tZ+"-mw{"+rr(v)+"}"),("edgePadding"in c||"gutter"in c)&&(h="#"+tZ+"-iw{"+eJ(g,w,y,v,b)+"}"),M&&Z&&!tu&&("fixedWidth"in c||"items"in c||tc&&"gutter"in c)&&(d="width:"+eQ(y,w,m)+";"),E&&"speed"in c&&(d+=rr(v)),d&&(d="#"+tZ+"{"+d+"}"),("fixedWidth"in c||tc&&"gutter"in c||!M&&"items"in c)&&(f+=e9(y,w,m)),"gutter"in c&&(f+=rt(w)),!M&&"speed"in c&&(E&&(f+=rr(v)),S&&(f+=rn(v))),f&&(f="#"+tZ+" > .tns-item{"+f+"}"),(s=p+h+d+f)&&t2.insertRule("@media (min-width: "+u/16+"em) {"+s+"}",t2.cssRules.length)}}(),ri();var eN=t_?M?function(){var r=t7,n=t5;r+=ty,n-=ty,tp?(r+=1,n-=1):tc&&(td+th)%(tc+th)&&(n-=1),tL&&(tO>n?tO-=tt:tO<r&&(tO+=tt))}:function(){if(tO>t5)for(;tO>=t7+tt;)tO-=tt;else if(tO<t7)for(;tO<=t5-tt;)tO+=tt}:function(){tO=Math.max(t7,Math.min(t5,tO))},eU=M?function(){var r,n,i,o,a,s,u,c,p,h,d;rD(K,""),E||!t8?(rR(),t8&&nX(K)||r6()):(r=K,n=tM,i=tR,o=tB,a=r4(),s=t8,u=r6,c=Math.min(s,10),p=a.indexOf("%")>=0?"%":"px",d=((a=a.replace(p,""))-(h=Number(r.style[n].replace(i,"").replace(o,"").replace(p,""))))/s*c,setTimeout(function a(){s-=c,h+=d,r.style[n]=i+h+p+o,s>0?setTimeout(a,c):u()},c)),Z||nt()}:function(){tP=[];var r={};r[I]=r[k]=r6,ir(Q[t6],r),ie(Q[tO],r),rB(t6,O,N,!0),rB(tO,V,O),I&&k&&t8&&nX(K)||r6()};return{version:"2.9.2",getInfo:nn,events:tH,goTo:r7,play:function(){tS&&!eP&&(rq(),eD=!1)},pause:function(){eP&&(rj(),eD=!0)},isOn:tr,updateSliderHeight:rC,refresh:ri,destroy:function(){if(t2.disabled=!0,t2.ownerNode&&t2.ownerNode.remove(),ir(i,{resize:ru}),tg&&ir(n,er),ev&&ir(ev,tQ),ew&&ir(ew,t9),ir(K,et),ir(K,ee),e4&&ir(e4,{click:rH}),tS&&clearInterval(eA),M&&I){var o={};o[I]=r6,ir(K,o)}tE&&ir(K,en),tT&&ir(K,ei);var a=[J,eg,e_,ex,e0,eM];for(var s in P.forEach(function(n,i){var o="container"===n?W:r[n];if("object"==typeof o){var s=!!o.previousElementSibling&&o.previousElementSibling,u=o.parentNode;o.outerHTML=a[i],r[n]=s?s.nextElementSibling:u.firstElementChild}}),P=O=N=U=V=Z=W=X=K=Y=J=Q=tt=j=te=tu=tc=tp=th=td=tm=ty=tv=tg=t8=t$=t_=tx=t2=tA=tn=tP=tL=tD=tz=t3=t4=tM=tR=tB=tF=tO=t6=t7=t5=tU=tV=tq=tj=tH=tG=tZ=tW=tX=tK=tY=tJ=tQ=t9=et=ee=er=en=ei=eo=ea=es=el=eu=ec=ep=eh=ed=ti=tb=tw=ev=eg=e8=e$=em=ey=t0=ew=e0=eb=eE=eT=eS=eC=eI=ek=e1=e2=tS=tC=e3=tI=tk=e4=eM=t1=eR=eA=eP=eL=eD=ez=eO=e6=eB=e7=eF=e5=tE=tT=null,this)"rebuild"!==s&&(this[s]=null);tr=!1},rebuild:function(){return io(nL(r,L))}}}function eV(r){r&&(tb=t0=tE=tT=tg=tS=tk=t1=!1)}function eq(){for(var r=M?tO-tL:tO;r<0;)r+=tt;return r%tt+1}function ej(r){return r=r?Math.max(0,Math.min(t_?tt-1:tt-tm,r)):0,M?r+tL:r}function eH(r){for(null==r&&(r=tO),M&&(r-=tL);r<0;)r+=tt;return Math.floor(r%tt)}function eG(){var r,n=eH();return r=es?n:tc||tu?Math.ceil((n+1)*eE/tt-1):Math.floor(n/tm),!t_&&M&&tO===t5&&(r=eE-1),r}function eZ(){return i.innerWidth||n.documentElement.clientWidth||n.body.clientWidth}function eW(r){return"top"===r?"afterbegin":"beforeend"}function eX(){var r=tp?2*tp-th:0;return function r(i){var o,a,s=n.createElement("div");return i.appendChild(s),a=(o=s.getBoundingClientRect()).right-o.left,s.remove(),a||r(i.parentNode)}(Y)-r}function eK(n){if(r[n])return!0;if(D){for(var i in D)if(D[i][n])return!0}return!1}function eY(n,i){if(null==i&&(i=te),"items"===n&&tc)return Math.floor((td+th)/(tc+th))||1;var o=r[n];if(D)for(var a in D)i>=parseInt(a)&&n in D[a]&&(o=D[a][n]);return"slideBy"===n&&"page"===o&&(o=eY("items")),M||"slideBy"!==n&&"items"!==n||(o=Math.floor(o)),o}function eJ(r,n,i,o,a){var s="";if(void 0!==r){var u=r;n&&(u-=n),s=Z?"margin: 0 "+u+"px 0 "+r+"px;":"margin: "+r+"px 0 "+u+"px 0;"}else if(n&&!i){var c="-"+n+"px";s="margin: 0 "+(Z?c+" 0 0":"0 "+c+" 0")+";"}return!M&&a&&E&&o&&(s+=rr(o)),s}function eQ(r,n,i){return r?(r+n)*tD+"px":$?$+"("+100*tD+"% / "+i+")":100*tD/i+"%"}function e9(r,n,i){var o;if(r)o=r+n+"px";else{M||(i=Math.floor(i));var a=M?tD:i;o=$?$+"(100% / "+a+")":100/a+"%"}return o="width:"+o,"inner"!==z?o+";":o+" !important;"}function rt(r){var n="";return!1!==r&&(n=(Z?"padding-":"margin-")+(Z?"right":"bottom")+": "+r+"px;"),n}function re(r,n){var i=r.substring(0,r.length-n).toLowerCase();return i&&(i="-"+i+"-"),i}function rr(r){return re(E,18)+"transition-duration:"+r/1e3+"s;"}function rn(r){return re(S,17)+"animation-duration:"+r/1e3+"s;"}function ri(){if(eK("autoHeight")||tu||!Z){var r=K.querySelectorAll("img");nO(r,function(r){var n=r.src;n&&0>n.indexOf("data:image")?(ie(r,ed),r.src="",r.src=n,n5(r,"loading")):tA||r_(r)}),n2(function(){r0(nG(r),function(){ti=!0})}),!tu&&Z&&(r=rb(tO,Math.min(tO+tm-1,tD-1))),tA?ro():n2(function(){r0(nG(r),ro)})}else M&&rM(),rs(),rl()}function ro(){if(tu){var r=t_?tO:tt-1;!function n(){Q[r-1].getBoundingClientRect().right.toFixed(2)===Q[r].getBoundingClientRect().left.toFixed(2)?ra():setTimeout(function(){n()},16)}()}else ra()}function ra(){Z&&!tu||(rI(),tu?(t3=r3(),tK&&(tY=rp()),t5=tF(),eV(tW||tY)):nt()),M&&rM(),rs(),rl()}function rs(){if(rk(),W.insertAdjacentHTML("afterbegin",'<div class="tns-liveregion tns-visually-hidden" aria-live="polite" aria-atomic="true">slide <span class="current">'+rg()+"</span>  of "+tt+"</div>"),to=W.querySelector(".tns-liveregion .current"),el){var n=tS?"stop":"start";e4?nj(e4,{"data-action":n}):r.autoplayButtonOutput&&(W.insertAdjacentHTML(eW(r.autoplayPosition),'<button data-action="'+n+'">'+eR[0]+n+eR[1]+tI[0]+"</button>"),e4=W.querySelector("[data-action]")),e4&&ie(e4,{click:rH}),tS&&(rq(),tk&&ie(K,et),t1&&ie(K,ee))}if(ea){if(ew)nj(ew,{"aria-label":"Carousel Pagination"}),nO(eb=ew.children,function(r,n){nj(r,{"data-nav":n,tabindex:"-1","aria-label":e1+(n+1),"aria-controls":tZ})});else{for(var i="",o=es?"":'style="display:none"',a=0;a<tt;a++)i+='<button data-nav="'+a+'" tabindex="-1" aria-controls="'+tZ+'" '+o+' aria-label="'+e1+(a+1)+'"></button>';i='<div class="tns-nav" aria-label="Carousel Pagination">'+i+"</div>",W.insertAdjacentHTML(eW(r.navPosition),i),eb=(ew=W.querySelector(".tns-nav")).children}if(nr(),E){var s=E.substring(0,E.length-18).toLowerCase(),u="transition: all "+t8/1e3+"s";s&&(u="-"+s+"-"+u),nB(t2,"[aria-controls^="+tZ+"-item]",u,nF(t2))}nj(eb[eC],{"aria-label":e1+(eC+1)+e2}),nH(eb[eC],"tabindex"),n5(eb[eC],ek),ie(ew,t9)}eo&&(ev||e8&&e$||(W.insertAdjacentHTML(eW(r.controlsPosition),'<div class="tns-controls" aria-label="Carousel Navigation" tabindex="0"><button data-controls="prev" tabindex="-1" aria-controls="'+tZ+'">'+tw[0]+'</button><button data-controls="next" tabindex="-1" aria-controls="'+tZ+'">'+tw[1]+"</button></div>"),ev=W.querySelector(".tns-controls")),e8&&e$||(e8=ev.children[0],e$=ev.children[1]),r.controlsContainer&&nj(ev,{"aria-label":"Carousel Navigation",tabindex:"0"}),(r.controlsContainer||r.prevButton&&r.nextButton)&&nj([e8,e$],{"aria-controls":tZ,tabindex:"-1"}),(r.controlsContainer||r.prevButton&&r.nextButton)&&(nj(e8,{"data-controls":"prev"}),nj(e$,{"data-controls":"next"})),em=r2(e8),ey=r2(e$),rL(),ev?ie(ev,tQ):(ie(e8,tQ),ie(e$,tQ))),rd()}function rl(){if(M&&I){var o={};o[I]=r6,ie(K,o)}tE&&ie(K,en,r.preventScrollOnTouch),tT&&ie(K,ei),tg&&ie(n,er),"inner"===z?tH.on("outerResized",function(){rc(),tH.emit("innerLoaded",nn())}):(D||tc||tu||tx||!Z)&&ie(i,{resize:ru}),tx&&("outer"===z?tH.on("innerLoaded",rw):tW||rw()),r$(),tW?ry():tY&&rm(),tH.on("indexChanged",rE),"inner"===z&&tH.emit("innerLoaded",nn()),"function"==typeof tj&&tj(nn()),tr=!0}function ru(r){n2(function(){rc(rZ(r))})}function rc(i){if(tr){"outer"===z&&tH.emit("outerResized",nn(i)),te=eZ();var o,a=j,s=!1;D&&(rh(),(o=a!==j)&&tH.emit("newBreakpointStart",nn(i)));var u,c,p=tm,h=tW,d=tY,f=tg,m=tb,y=t0,v=tE,g=tT,$=tS,_=tk,b=t1,w=tO;if(o){var E=tc,T=tx,S=tw,C=tf,I=tI;if(!x)var k=th,A=tp}if(tg=eY("arrowKeys"),tb=eY("controls"),t0=eY("nav"),tE=eY("touch"),tf=eY("center"),tT=eY("mouseDrag"),tS=eY("autoplay"),tk=eY("autoplayHoverPause"),t1=eY("autoplayResetOnVisibility"),o&&(tW=eY("disable"),tc=eY("fixedWidth"),t8=eY("speed"),tx=eY("autoHeight"),tw=eY("controlsText"),tI=eY("autoplayText"),tC=eY("autoplayTimeout"),x||(tp=eY("edgePadding"),th=eY("gutter"))),eV(tW),td=eX(),Z&&!tu||tW||(rI(),Z||(nt(),s=!0)),(tc||tu)&&(t3=r3(),t5=tF()),(o||tc)&&(tm=eY("items"),ty=eY("slideBy"),(c=tm!==p)&&(tc||tu||(t5=tF()),eN())),o&&tW!==h&&(tW?ry():function(){if(tX){if(t2.disabled=!1,K.className+=tG,rM(),t_)for(var r=tL;r--;)M&&nW(Q[r]),nW(Q[tD-r-1]);if(!M)for(var n=tO,i=tO+tt;n<i;n++){var o=Q[n],a=n<tO+tm?O:V;o.style.left=100*(n-tO)/tm+"%",n5(o,a)}rf(),tX=!1}}()),tK&&(o||tc||tu)&&(tY=rp())!==d&&(tY?(rR(r4(ej(0))),rm()):(function(){if(tJ){if(tp&&x&&(X.style.margin=""),tL)for(var r="tns-transparent",n=tL;n--;)M&&nN(Q[n],r),nN(Q[tD-n-1],r);rf(),tJ=!1}}(),s=!0)),eV(tW||tY),tS||(tk=t1=!1),tg!==f&&(tg?ie(n,er):ir(n,er)),tb!==m&&(tb?ev?nW(ev):(e8&&nW(e8),e$&&nW(e$)):ev?nZ(ev):(e8&&nZ(e8),e$&&nZ(e$))),t0!==y&&(t0?nW(ew):nZ(ew)),tE!==v&&(tE?ie(K,en,r.preventScrollOnTouch):ir(K,en)),tT!==g&&(tT?ie(K,ei):ir(K,ei)),tS!==$&&(tS?(e4&&nW(e4),eP||eD||rq()):(e4&&nZ(e4),eP&&rj())),tk!==_&&(tk?ie(K,et):ir(K,et)),t1!==b&&(t1?ie(n,ee):ir(n,ee)),o){if(tc===E&&tf===C||(s=!0),tx!==T&&(tx||(X.style.height="")),tb&&tw!==S&&(e8.innerHTML=tw[0],e$.innerHTML=tw[1]),e4&&tI!==I){var P=tS?1:0,L=e4.innerHTML,R=L.length-I[P].length;L.substring(R)===I[P]&&(e4.innerHTML=L.substring(0,R)+tI[P])}}else tf&&(tc||tu)&&(s=!0);if((c||tc&&!tu)&&(eE=ne(),nr()),(u=tO!==w)?(tH.emit("indexChanged",nn()),s=!0):c?u||rE():(tc||tu)&&(r$(),rk(),rv()),c&&!M&&function(){for(var r=tO+Math.min(tt,tm),n=tD;n--;){var i=Q[n];n>=tO&&n<r?(n5(i,"tns-moving"),i.style.left=100*(n-tO)/tm+"%",n5(i,O),nN(i,V)):i.style.left&&(i.style.left="",n5(i,V),nN(i,O)),nN(i,N)}setTimeout(function(){nO(Q,function(r){nN(r,"tns-moving")})},300)}(),!tW&&!tY){if(o&&!x&&(tx===autoheightTem&&t8===speedTem||rT(),tp===A&&th===k||(X.style.cssText=eJ(tp,th,tc,t8,tx)),Z)){M&&(K.style.width=eQ(tc,th,tm));var B,F,U=e9(tc,th,tm)+rt(th);B=t2,F=nF(t2)-1,"deleteRule"in B?B.deleteRule(F):B.removeRule(F),nB(t2,"#"+tZ+" > .tns-item",U,nF(t2))}tx&&rw(),s&&(rM(),t6=tO)}o&&tH.emit("newBreakpointEnd",nn(i))}}function rp(){if(!tc&&!tu)return tt<=(tf?tm-(tm-1)/2:tm);var r=tc?(tc+th)*tt:tn[tt],n=tp?td+2*tp:td+th;return tf&&(n-=tc?(td-tc)/2:(td-(tn[tO+1]-tn[tO]-th))/2),r<=n}function rh(){for(var r in j=0,D)r=parseInt(r),te>=r&&(j=r)}function rd(){!tS&&e4&&nZ(e4),!t0&&ew&&nZ(ew),tb||(ev?nZ(ev):(e8&&nZ(e8),e$&&nZ(e$)))}function rf(){tS&&e4&&nW(e4),t0&&ew&&nW(ew),tb&&(ev?nW(ev):(e8&&nW(e8),e$&&nW(e$)))}function rm(){if(!tJ){if(tp&&(X.style.margin="0px"),tL)for(var r="tns-transparent",n=tL;n--;)M&&n5(Q[n],r),n5(Q[tD-n-1],r);rd(),tJ=!0}}function ry(){if(!tX){if(t2.disabled=!0,K.className=K.className.replace(tG.substring(1),""),nH(K,["style"]),t_)for(var r=tL;r--;)M&&nZ(Q[r]),nZ(Q[tD-r-1]);if(Z&&M||nH(X,["style"]),!M)for(var n=tO,i=tO+tt;n<i;n++){var o=Q[n];nH(o,["style"]),nN(o,O),nN(o,V)}rd(),tX=!0}}function rv(){var r=rg();to.innerHTML!==r&&(to.innerHTML=r)}function rg(){var r=r8(),n=r[0]+1,i=r[1]+1;return n===i?n+"":n+" to "+i}function r8(r){null==r&&(r=r4());var n,i,o,a=tO;if(tf||tp?(tu||tc)&&(o=(i=-(parseFloat(r)+tp))+td+2*tp):tu&&(o=(i=tn[tO])+td),tu)tn.forEach(function(r,s){s<tD&&((tf||tp)&&r<=i+.5&&(a=s),o-r>=.5&&(n=s))});else{if(tc){var s=tc+th;tf||tp?(a=Math.floor(i/s),n=Math.ceil(o/s-1)):n=a+Math.ceil(td/s)-1}else if(tf||tp){var u=tm-1;if(tf?(a-=u/2,n=tO+u/2):n=tO+u,tp){var c=tp*tm/td;a-=c,n+=c}a=Math.floor(a),n=Math.ceil(n)}else n=a+tm-1;a=Math.max(a,0),n=Math.min(n,tD-1)}return[a,n]}function r$(){tA&&!tW&&rb.apply(null,r8()).forEach(function(r){if(!n7(r,eh)){var n={};n[I]=function(r){r.stopPropagation()},ie(r,n),ie(r,ed),r.src=nV(r,"data-src");var i=nV(r,"data-srcset");i&&(r.srcset=i),n5(r,"loading")}})}function r_(r){n5(r,"loaded"),rx(r)}function rx(r){n5(r,"tns-complete"),nN(r,"loading"),ir(r,ed)}function rb(r,n){for(var i=[];r<=n;)nO(Q[r].querySelectorAll("img"),function(r){i.push(r)}),r++;return i}function rw(){var r=rb.apply(null,r8());n2(function(){r0(r,rC)})}function r0(r,n){return ti?n():(r.forEach(function(n,i){n7(n,eh)&&r.splice(i,1)}),r.length?void n2(function(){r0(r,n)}):n())}function rE(){r$(),rk(),rv(),rL(),function(){if(t0&&(eC=eS>=0?eS:eG(),eS=-1,eC!==eI)){var r=eb[eI],n=eb[eC];nj(r,{tabindex:"-1","aria-label":e1+(eI+1)}),nN(r,ek),nj(n,{"aria-label":e1+(eC+1)+e2}),nH(n,"tabindex"),n5(n,ek),eI=eC}}()}function rT(){M&&tx&&(q.style[E]=t8/1e3+"s")}function rS(r,n){for(var i=[],o=r,a=Math.min(r+n,tD);o<a;o++)i.push(Q[o].offsetHeight);return Math.max.apply(null,i)}function rC(){var r=tx?rS(tO,tm):rS(tL,tt),n=q||X;n.style.height!==r&&(n.style.height=r+"px")}function rI(){tn=[0];var r=Z?"left":"top",n=Z?"right":"bottom",i=Q[0].getBoundingClientRect()[r];nO(Q,function(o,a){a&&tn.push(o.getBoundingClientRect()[r]-i),a===tD-1&&tn.push(o.getBoundingClientRect()[n]-i)})}function rk(){var r=r8(),n=r[0],i=r[1];nO(Q,function(r,o){o>=n&&o<=i?nU(r,"aria-hidden")&&(nH(r,["aria-hidden","tabindex"]),n5(r,ep)):nU(r,"aria-hidden")||(nj(r,{"aria-hidden":"true",tabindex:"-1"}),nN(r,ep))})}function r1(r){return r.nodeName.toLowerCase()}function r2(r){return"button"===r1(r)}function rA(r){return"true"===r.getAttribute("aria-disabled")}function rP(r,n,i){r?n.disabled=i:n.setAttribute("aria-disabled",i.toString())}function rL(){if(tb&&!t$&&!t_){var r=em?e8.disabled:rA(e8),n=ey?e$.disabled:rA(e$),i=tO<=t7,o=!t$&&tO>=t5;i&&!r&&rP(em,e8,!0),!i&&r&&rP(em,e8,!1),o&&!n&&rP(ey,e$,!0),!o&&n&&rP(ey,e$,!1)}}function rD(r,n){E&&(r.style[E]=n)}function rz(r){return null==r&&(r=tO),tu?(td-(tp?th:0)-(tn[r+1]-tn[r]-th))/2:tc?(td-tc)/2:(tm-1)/2}function r3(){var r=td+(tp?th:0)-(tc?(tc+th)*tD:tn[tD]);return tf&&!t_&&(r=tc?-(tc+th)*(tD-1)-rz():rz(tD-1)-tn[tD-1]),r>0&&(r=0),r}function r4(r){var n;if(null==r&&(r=tO),Z&&!tu){if(tc)n=-(tc+th)*r,tf&&(n+=rz());else{var i=b?tD:tm;tf&&(r-=rz()),n=-(100*r)/i}}else n=-tn[r],tf&&tu&&(n+=rz());return tz&&(n=Math.max(n,t3)),n+=!Z||tu||tc?"px":"%"}function rM(r){rD(K,"0s"),rR(r)}function rR(r){null==r&&(r=r4()),K.style[tM]=tR+r+tB}function rB(r,n,i,o){var a=r+tm;t_||(a=Math.min(a,tD));for(var s=r;s<a;s++){var u=Q[s];o||(u.style.left=100*(s-tO)/tm+"%"),U&&T&&(u.style[T]=u.style[C]=U*(s-r)/1e3+"s"),nN(u,n),n5(u,i),o&&tP.push(u)}}function rF(r,n){t4&&eN(),(tO!==t6||n)&&(tH.emit("indexChanged",nn()),tH.emit("transitionStart",nn()),tx&&rw(),eP&&r&&["click","keydown"].indexOf(r.type)>=0&&rj(),tq=!0,eU())}function rO(r){return r.toLowerCase().replace(/-/g,"")}function r6(r){if(M||tq){if(tH.emit("transitionEnd",nn(r)),!M&&tP.length>0)for(var n=0;n<tP.length;n++){var i=tP[n];i.style.left="",C&&T&&(i.style[C]="",i.style[T]=""),nN(i,N),n5(i,V)}if(!r||!M&&r.target.parentNode===K||r.target===K&&rO(r.propertyName)===rO(tM)){if(!t4){var o=tO;eN(),tO!==o&&(tH.emit("indexChanged",nn()),rM())}"inner"===z&&tH.emit("innerLoaded",nn()),tq=!1,t6=tO}}}function r7(r,n){if(!tY){if("prev"===r)r5(n,-1);else if("next"===r)r5(n,1);else{if(tq){if(tN)return;r6()}var i=eH(),o=0;if("first"===r?o=-i:"last"===r?o=M?tt-tm-i:tt-1-i:("number"!=typeof r&&(r=parseInt(r)),isNaN(r)||(n||(r=Math.max(0,Math.min(tt-1,r))),o=r-i)),!M&&o&&Math.abs(o)<tm){var a=o>0?1:-1;o+=tO+o-tt>=t7?tt*a:-(2*tt*a*1)}tO+=o,M&&t_&&(tO<t7&&(tO+=tt),tO>t5&&(tO-=tt)),eH(tO)!==eH(t6)&&rF(n)}}}function r5(r,n){if(tq){if(tN)return;r6()}if(!n){for(var i,o=rW(r=rZ(r));o!==ev&&0>[e8,e$].indexOf(o);)o=o.parentNode;var a=[e8,e$].indexOf(o);a>=0&&(i=!0,n=0===a?-1:1)}if(t$){if(tO===t7&&-1===n)return void r7("last",r);if(tO===t5&&1===n)return void r7("first",r)}n&&(tO+=ty*n,tu&&(tO=Math.floor(tO)),rF(i||r&&"keydown"===r.type?r:null))}function rN(){eA=setInterval(function(){r5(null,e3)},tC),eP=!0}function rU(){clearInterval(eA),eP=!1}function rV(r,n){nj(e4,{"data-action":r}),e4.innerHTML=eR[0]+r+eR[1]+n}function rq(){rN(),e4&&rV("stop",tI[1])}function rj(){rU(),e4&&rV("start",tI[0])}function rH(){eP?(rj(),eD=!0):(rq(),eD=!1)}function rG(r){r.focus()}function rZ(r){return rX(r=r||i.event)?r.changedTouches[0]:r}function rW(r){return r.target||i.event.srcElement}function rX(r){return r.type.indexOf("touch")>=0}function rK(r){r.preventDefault?r.preventDefault():r.returnValue=!1}function rY(){var n,i,o,a,s,u;return o=Math.atan2(n=e6.y-eO.y,i=e6.x-eO.x)*(180/Math.PI),a=tU,s=!1,(u=Math.abs(90-Math.abs(o)))>=90-a?s="horizontal":u<=a&&(s="vertical"),s===r.axis}function rJ(r){if(tq){if(tN)return;r6()}tS&&eP&&rU(),e7=!0,eF&&(nP(eF),eF=null);var n=rZ(r);tH.emit(rX(r)?"touchStart":"dragStart",nn(r)),!rX(r)&&["img","a"].indexOf(r1(rW(r)))>=0&&rK(r),e6.x=eO.x=n.clientX,e6.y=eO.y=n.clientY,M&&(eB=parseFloat(K.style[tM].replace(tR,"")),rD(K,"0s"))}function rQ(r){if(e7){var n=rZ(r);e6.x=n.clientX,e6.y=n.clientY,M?eF||(eF=n2(function(){!function r(n){if(!tV)return void(e7=!1);if(nP(eF),e7&&(eF=n2(function(){r(n)})),"?"===tV&&(tV=rY()),tV){!ef&&rX(n)&&(ef=!0);try{n.type&&tH.emit(rX(n)?"touchMove":"dragMove",nn(n))}catch(i){}var o=eB,a=e5(e6,eO);!Z||tc||tu?(o+=a,o+="px"):(o+=b?a*tm*100/((td+th)*tD):100*a/(td+th),o+="%"),K.style[tM]=tR+o+tB}}(r)})):("?"===tV&&(tV=rY()),tV&&(ef=!0)),ef&&r.preventDefault()}}function r9(n){if(e7){eF&&(nP(eF),eF=null),M&&rD(K,""),e7=!1;var i=rZ(n);e6.x=i.clientX,e6.y=i.clientY;var o=e5(e6,eO);if(Math.abs(o)){if(!rX(n)){var a=rW(n);ie(a,{click:function r(n){rK(n),ir(a,{click:r})}})}M?eF=n2(function(){if(Z&&!tu){var r=-o*tm/(td+th);tO+=r=o>0?Math.floor(r):Math.ceil(r)}else{var i=-(eB+o);if(i<=0)tO=t7;else if(i>=tn[tD-1])tO=t5;else for(var a=0;a<tD&&i>=tn[a];)tO=a,i>tn[a]&&o<0&&(tO+=1),a++}rF(n,o),tH.emit(rX(n)?"touchEnd":"dragEnd",nn(n))}):tV&&r5(n,o>0?-1:1)}}"auto"===r.preventScrollOnTouch&&(ef=!1),tU&&(tV="?"),tS&&!eP&&rN()}function nt(){(q||X).style.height=tn[tO+tm]-tn[tO]+"px"}function ne(){return Math.min(Math.ceil(tc?(tc+th)*tt/td:tt/tm),tt)}function nr(){if(t0&&!es&&eE!==eT){var r=eT,n=eE,i=nW;for(eT>eE&&(r=eE,n=eT,i=nZ);r<n;)i(eb[r]),r++;eT=eE}}function nn(r){return{container:K,slideItems:Q,navContainer:ew,navItems:eb,controlsContainer:ev,hasControls:eo,prevButton:e8,nextButton:e$,items:tm,slideBy:ty,cloneCount:tL,slideCount:tt,slideCountNew:tD,index:tO,indexCached:t6,displayIndex:eq(),navCurrentIndex:eC,navCurrentIndexCached:eI,pages:eE,pagesCached:eT,sheet:t2,isOn:tr,event:r||{}}}A&&console.warn("No slides found in",r.container)},ia=r.createCommonjsModule(function(r,n){r.exports=function(){var r=function(){return(r=Object.assign||function(r){for(var n,i=arguments,o=1,a=arguments.length;o<a;o++)for(var s in n=i[o])Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s]);return r}).apply(this,arguments)},n=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],i={_disable:[],_enable:[],allowInput:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:"object"==typeof window&&-1===window.navigator.userAgent.indexOf("MSIE"),ariaDateFormat:"F j, Y",clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enable:[],enableSeconds:!1,enableTime:!1,errorHandler:function(r){return"undefined"!=typeof console&&console.warn(r)},getWeek:function(r){var n=new Date(r.getTime());n.setHours(0,0,0,0),n.setDate(n.getDate()+3-(n.getDay()+6)%7);var i=new Date(n.getFullYear(),0,4);return 1+Math.round(((n.getTime()-i.getTime())/864e5-3+(i.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},o={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(r){var n=r%100;if(n>3&&n<21)return"th";switch(n%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},a=function(r){return("0"+r).slice(-2)},s=function(r){return!0===r?1:0};function u(r,n,i){var o;return void 0===i&&(i=!1),function(){var a=this,s=arguments;null!==o&&clearTimeout(o),o=window.setTimeout(function(){o=null,i||r.apply(a,s)},n),i&&!o&&r.apply(a,s)}}var c=function(r){return r instanceof Array?r:[r]};function p(r,n,i){if(!0===i)return r.classList.add(n);r.classList.remove(n)}function h(r,n,i){var o=window.document.createElement(r);return n=n||"",i=i||"",o.className=n,void 0!==i&&(o.textContent=i),o}function d(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function f(r,n){var i=h("div","numInputWrapper"),o=h("input","numInput "+r),a=h("span","arrowUp"),s=h("span","arrowDown");if(-1===navigator.userAgent.indexOf("MSIE 9.0")?o.type="number":(o.type="text",o.pattern="\\d*"),void 0!==n)for(var u in n)o.setAttribute(u,n[u]);return i.appendChild(o),i.appendChild(a),i.appendChild(s),i}var m=function(){},y=function(r,n,i){return i.months[n?"shorthand":"longhand"][r]},v={D:m,F:function(r,n,i){r.setMonth(i.months.longhand.indexOf(n))},G:function(r,n){r.setHours(parseFloat(n))},H:function(r,n){r.setHours(parseFloat(n))},J:function(r,n){r.setDate(parseFloat(n))},K:function(r,n,i){r.setHours(r.getHours()%12+12*s(RegExp(i.amPM[1],"i").test(n)))},M:function(r,n,i){r.setMonth(i.months.shorthand.indexOf(n))},S:function(r,n){r.setSeconds(parseFloat(n))},U:function(r,n){return new Date(1e3*parseFloat(n))},W:function(r,n,i){var o=parseInt(n),a=new Date(r.getFullYear(),0,2+7*(o-1),0,0,0,0);return a.setDate(a.getDate()-a.getDay()+i.firstDayOfWeek),a},Y:function(r,n){r.setFullYear(parseFloat(n))},Z:function(r,n){return new Date(n)},d:function(r,n){r.setDate(parseFloat(n))},h:function(r,n){r.setHours(parseFloat(n))},i:function(r,n){r.setMinutes(parseFloat(n))},j:function(r,n){r.setDate(parseFloat(n))},l:m,m:function(r,n){r.setMonth(parseFloat(n)-1)},n:function(r,n){r.setMonth(parseFloat(n)-1)},s:function(r,n){r.setSeconds(parseFloat(n))},u:function(r,n){return new Date(parseFloat(n))},w:m,y:function(r,n){r.setFullYear(2e3+parseFloat(n))}},g={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},$={Z:function(r){return r.toISOString()},D:function(r,n,i){return n.weekdays.shorthand[$.w(r,n,i)]},F:function(r,n,i){return y($.n(r,n,i)-1,!1,n)},G:function(r,n,i){return a($.h(r,n,i))},H:function(r){return a(r.getHours())},J:function(r,n){return void 0!==n.ordinal?r.getDate()+n.ordinal(r.getDate()):r.getDate()},K:function(r,n){return n.amPM[s(r.getHours()>11)]},M:function(r,n){return y(r.getMonth(),!0,n)},S:function(r){return a(r.getSeconds())},U:function(r){return r.getTime()/1e3},W:function(r,n,i){return i.getWeek(r)},Y:function(r){return r.getFullYear()},d:function(r){return a(r.getDate())},h:function(r){return r.getHours()%12?r.getHours()%12:12},i:function(r){return a(r.getMinutes())},j:function(r){return r.getDate()},l:function(r,n){return n.weekdays.longhand[r.getDay()]},m:function(r){return a(r.getMonth()+1)},n:function(r){return r.getMonth()+1},s:function(r){return r.getSeconds()},u:function(r){return r.getTime()},w:function(r){return r.getDay()},y:function(r){return String(r.getFullYear()).substring(2)}},_=function(r){var n=r.config,a=void 0===n?i:n,s=r.l10n,u=void 0===s?o:s;return function(r,n,i){var o=i||u;return void 0!==a.formatDate?a.formatDate(r,n,o):n.split("").map(function(n,i,s){return $[n]&&"\\"!==s[i-1]?$[n](r,o,a):"\\"!==n?n:""}).join("")}},x=function(r){var n=r.config,a=void 0===n?i:n,s=r.l10n,u=void 0===s?o:s;return function(r,n,o,s){if(0===r||r){var c,p=s||u;if(r instanceof Date)c=new Date(r.getTime());else if("string"!=typeof r&&void 0!==r.toFixed)c=new Date(r);else if("string"==typeof r){var h=n||(a||i).dateFormat,d=String(r).trim();if("today"===d)c=new Date,o=!0;else if(/Z$/.test(d)||/GMT$/.test(d))c=new Date(r);else if(a&&a.parseDate)c=a.parseDate(r,h);else{c=a&&a.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0);for(var f=void 0,m=[],y=0,$=0,_="";y<h.length;y++){var x=h[y],b="\\"===x,w="\\"===h[y-1]||b;if(g[x]&&!w){var E=RegExp(_+=g[x]).exec(r);E&&(f=!0)&&m["Y"!==x?"push":"unshift"]({fn:v[x],val:E[++$]})}else b||(_+=".");m.forEach(function(r){var n;return c=(0,r.fn)(c,r.val,p)||c})}c=f?c:void 0}}if(c instanceof Date&&!isNaN(c.getTime()))return!0===o&&c.setHours(0,0,0,0),c;a.errorHandler(Error("Invalid date provided: "+r))}}};function b(r,n,i){return void 0===i&&(i=!0),!1!==i?new Date(r.getTime()).setHours(0,0,0,0)-new Date(n.getTime()).setHours(0,0,0,0):r.getTime()-n.getTime()}var w={DAY:864e5};function E(m,v){var $,E,T={config:r({},i,S.defaultConfig),l10n:o};function C(r){return r.bind(T)}function I(){var r=T.config;!1===r.weekNumbers&&1===r.showMonths||!0!==r.noCalendar&&window.requestAnimationFrame(function(){if(void 0!==T.calendarContainer&&(T.calendarContainer.style.visibility="hidden",T.calendarContainer.style.display="block"),void 0!==T.daysContainer){var n=(T.days.offsetWidth+1)*r.showMonths;T.daysContainer.style.width=n+"px",T.calendarContainer.style.width=n+(void 0!==T.weekWrapper?T.weekWrapper.offsetWidth:0)+"px",T.calendarContainer.style.removeProperty("visibility"),T.calendarContainer.style.removeProperty("display")}})}function k(r){0===T.selectedDates.length&&ts(),void 0!==r&&"blur"!==r.type&&function(r){r.preventDefault();var n="keydown"===r.type,i=r.target;void 0!==T.amPM&&r.target===T.amPM&&(T.amPM.textContent=T.l10n.amPM[s(T.amPM.textContent===T.l10n.amPM[0])]);var o=parseFloat(i.getAttribute("min")),u=parseFloat(i.getAttribute("max")),c=parseFloat(i.getAttribute("step")),p=parseInt(i.value,10),h=p+c*(r.delta||(n?38===r.which?1:-1:0));if(void 0!==i.value&&2===i.value.length){var d=i===T.hourElement,f=i===T.minuteElement;h<o?(h=u+h+s(!d)+(s(d)&&s(!T.amPM)),f&&N(void 0,-1,T.hourElement)):h>u&&(h=i===T.hourElement?h-u-s(!T.amPM):o,f&&N(void 0,1,T.hourElement)),T.amPM&&d&&(1===c?h+p===23:Math.abs(h-p)>c)&&(T.amPM.textContent=T.l10n.amPM[s(T.amPM.textContent===T.l10n.amPM[0])]),i.value=a(h)}}(r);var n=T._input.value;A(),tx(),T._input.value!==n&&T._debouncedChange()}function A(){if(void 0!==T.hourElement&&void 0!==T.minuteElement){var r,n,i=(parseInt(T.hourElement.value.slice(-2),10)||0)%24,o=(parseInt(T.minuteElement.value,10)||0)%60,a=void 0!==T.secondElement?(parseInt(T.secondElement.value,10)||0)%60:0;void 0!==T.amPM&&(i=(r=i)%12+12*s((n=T.amPM.textContent)===T.l10n.amPM[1]));var u=void 0!==T.config.minTime||T.config.minDate&&T.minDateHasTime&&T.latestSelectedDateObj&&0===b(T.latestSelectedDateObj,T.config.minDate,!0);if(void 0!==T.config.maxTime||T.config.maxDate&&T.maxDateHasTime&&T.latestSelectedDateObj&&0===b(T.latestSelectedDateObj,T.config.maxDate,!0)){var c=void 0!==T.config.maxTime?T.config.maxTime:T.config.maxDate;(i=Math.min(i,c.getHours()))===c.getHours()&&(o=Math.min(o,c.getMinutes())),o===c.getMinutes()&&(a=Math.min(a,c.getSeconds()))}if(u){var p=void 0!==T.config.minTime?T.config.minTime:T.config.minDate;(i=Math.max(i,p.getHours()))===p.getHours()&&(o=Math.max(o,p.getMinutes())),o===p.getMinutes()&&(a=Math.max(a,p.getSeconds()))}D(i,o,a)}}function P(r){var n=r||T.latestSelectedDateObj;n&&D(n.getHours(),n.getMinutes(),n.getSeconds())}function L(){var r=T.config.defaultHour,n=T.config.defaultMinute,i=T.config.defaultSeconds;if(void 0!==T.config.minDate){var o=T.config.minDate.getHours(),a=T.config.minDate.getMinutes();(r=Math.max(r,o))===o&&(n=Math.max(a,n)),r===o&&n===a&&(i=T.config.minDate.getSeconds())}if(void 0!==T.config.maxDate){var s=T.config.maxDate.getHours(),u=T.config.maxDate.getMinutes();(r=Math.min(r,s))===s&&(n=Math.min(u,n)),r===s&&n===u&&(i=T.config.maxDate.getSeconds())}D(r,n,i)}function D(r,n,i){void 0!==T.latestSelectedDateObj&&T.latestSelectedDateObj.setHours(r%24,n,i||0,0),T.hourElement&&T.minuteElement&&!T.isMobile&&(T.hourElement.value=a(T.config.time_24hr?r:(12+r)%12+12*s(r%12==0)),T.minuteElement.value=a(n),void 0!==T.amPM&&(T.amPM.textContent=T.l10n.amPM[s(r>=12)]),void 0!==T.secondElement&&(T.secondElement.value=a(i)))}function z(r){var n=parseInt(r.target.value)+(r.delta||0);(n/1e3>1||"Enter"===r.key&&!/[^\d]/.test(n.toString()))&&te(n)}function M(r,n,i,o){return n instanceof Array?n.forEach(function(n){return M(r,n,i,o)}):r instanceof Array?r.forEach(function(r){return M(r,n,i,o)}):(r.addEventListener(n,i,o),void T._handlers.push({element:r,event:n,handler:i,options:o}))}function R(r){return function(n){1===n.which&&r(n)}}function B(){tv("onChange")}function F(r,n){var i=void 0!==r?T.parseDate(r):T.latestSelectedDateObj||(T.config.minDate&&T.config.minDate>T.now?T.config.minDate:T.config.maxDate&&T.config.maxDate<T.now?T.config.maxDate:T.now),o=T.currentYear,a=T.currentMonth;try{void 0!==i&&(T.currentYear=i.getFullYear(),T.currentMonth=i.getMonth())}catch(s){s.message="Invalid date supplied: "+i,T.config.errorHandler(s)}n&&T.currentYear!==o&&(tv("onYearChange"),Z()),n&&(T.currentYear!==o||T.currentMonth!==a)&&tv("onMonthChange"),T.redraw()}function O(r){~r.target.className.indexOf("arrow")&&N(r,r.target.classList.contains("arrowUp")?1:-1)}function N(r,n,i){var o=r&&r.target,a=i||o&&o.parentNode&&o.parentNode.firstChild,s=tg("increment");s.delta=n,a&&a.dispatchEvent(s)}function U(r,n,i,o){var a,s=tr(n,!0),u=h("span","flatpickr-day "+r,n.getDate().toString());return u.dateObj=n,u.$i=o,u.setAttribute("aria-label",T.formatDate(n,T.config.ariaDateFormat)),-1===r.indexOf("hidden")&&0===b(n,T.now)&&(T.todayDateElem=u,u.classList.add("today"),u.setAttribute("aria-current","date")),s?(u.tabIndex=-1,t8(n)&&(u.classList.add("selected"),T.selectedDateElem=u,"range"===T.config.mode&&(p(u,"startRange",T.selectedDates[0]&&0===b(n,T.selectedDates[0],!0)),p(u,"endRange",T.selectedDates[1]&&0===b(n,T.selectedDates[1],!0)),"nextMonthDay"===r&&u.classList.add("inRange")))):u.classList.add("flatpickr-disabled"),"range"===T.config.mode&&(a=n,!("range"!==T.config.mode||T.selectedDates.length<2)&&b(a,T.selectedDates[0])>=0&&0>=b(a,T.selectedDates[1]))&&!t8(n)&&u.classList.add("inRange"),T.weekNumbers&&1===T.config.showMonths&&"prevMonthDay"!==r&&i%7==1&&T.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+T.config.getWeek(n)+"</span>"),tv("onDayCreate",u),u}function V(r){r.focus(),"range"===T.config.mode&&to(r)}function q(r){for(var n=r>0?0:T.config.showMonths-1,i=r>0?T.config.showMonths:-1,o=n;o!=i;o+=r)for(var a=T.daysContainer.children[o],s=r>0?0:a.children.length-1,u=r>0?a.children.length:-1,c=s;c!=u;c+=r){var p=a.children[c];if(-1===p.className.indexOf("hidden")&&tr(p.dateObj))return p}}function j(r,n){var i=tn(document.activeElement||document.body),o=void 0!==r?r:i?document.activeElement:void 0!==T.selectedDateElem&&tn(T.selectedDateElem)?T.selectedDateElem:void 0!==T.todayDateElem&&tn(T.todayDateElem)?T.todayDateElem:q(n>0?1:-1);return void 0===o?T._input.focus():i?void function(r,n){for(var i=-1===r.className.indexOf("Month")?r.dateObj.getMonth():T.currentMonth,o=n>0?T.config.showMonths:-1,a=n>0?1:-1,s=i-T.currentMonth;s!=o;s+=a)for(var u=T.daysContainer.children[s],c=i-T.currentMonth===s?r.$i+n:n<0?u.children.length-1:0,p=u.children.length,h=c;h>=0&&h<p&&h!=(n>0?p:-1);h+=a){var d=u.children[h];if(-1===d.className.indexOf("hidden")&&tr(d.dateObj)&&Math.abs(r.$i-h)>=Math.abs(n))return V(d)}T.changeMonth(a),j(q(a),0)}(o,n):V(o)}function H(r,n){for(var i=(new Date(r,n,1).getDay()-T.l10n.firstDayOfWeek+7)%7,o=T.utils.getDaysInMonth((n-1+12)%12),a=T.utils.getDaysInMonth(n),s=window.document.createDocumentFragment(),u=T.config.showMonths>1,c=u?"prevMonthDay hidden":"prevMonthDay",p=u?"nextMonthDay hidden":"nextMonthDay",d=o+1-i,f=0;d<=o;d++,f++)s.appendChild(U(c,new Date(r,n-1,d),d,f));for(d=1;d<=a;d++,f++)s.appendChild(U("",new Date(r,n,d),d,f));for(var m=a+1;m<=42-i&&(1===T.config.showMonths||f%7!=0);m++,f++)s.appendChild(U(p,new Date(r,n+1,m%a),m,f));var y=h("div","dayContainer");return y.appendChild(s),y}function G(){if(void 0!==T.daysContainer){d(T.daysContainer),T.weekNumbers&&d(T.weekNumbers);for(var r=document.createDocumentFragment(),n=0;n<T.config.showMonths;n++){var i=new Date(T.currentYear,T.currentMonth,1);i.setMonth(T.currentMonth+n),r.appendChild(H(i.getFullYear(),i.getMonth()))}T.daysContainer.appendChild(r),T.days=T.daysContainer.firstChild,"range"===T.config.mode&&1===T.selectedDates.length&&to()}}function Z(){if(!(T.config.showMonths>1||"dropdown"!==T.config.monthSelectorType)){T.monthsDropdownContainer.tabIndex=-1,T.monthsDropdownContainer.innerHTML="";for(var r,n=0;n<12;n++)if(r=n,!(void 0!==T.config.minDate&&T.currentYear===T.config.minDate.getFullYear()&&r<T.config.minDate.getMonth()||void 0!==T.config.maxDate&&T.currentYear===T.config.maxDate.getFullYear()&&r>T.config.maxDate.getMonth())){var i=h("option","flatpickr-monthDropdown-month");i.value=new Date(T.currentYear,n).getMonth().toString(),i.textContent=y(n,T.config.shorthandCurrentMonth,T.l10n),i.tabIndex=-1,T.currentMonth===n&&(i.selected=!0),T.monthsDropdownContainer.appendChild(i)}}}function W(){var r,n=h("div","flatpickr-month"),i=window.document.createDocumentFragment();T.config.showMonths>1||"static"===T.config.monthSelectorType?r=h("span","cur-month"):(T.monthsDropdownContainer=h("select","flatpickr-monthDropdown-months"),M(T.monthsDropdownContainer,"change",function(r){var n=parseInt(r.target.value,10);T.changeMonth(n-T.currentMonth),tv("onMonthChange")}),Z(),r=T.monthsDropdownContainer);var o=f("cur-year",{tabindex:"-1"}),a=o.getElementsByTagName("input")[0];a.setAttribute("aria-label",T.l10n.yearAriaLabel),T.config.minDate&&a.setAttribute("min",T.config.minDate.getFullYear().toString()),T.config.maxDate&&(a.setAttribute("max",T.config.maxDate.getFullYear().toString()),a.disabled=!!T.config.minDate&&T.config.minDate.getFullYear()===T.config.maxDate.getFullYear());var s=h("div","flatpickr-current-month");return s.appendChild(r),s.appendChild(o),i.appendChild(s),n.appendChild(i),{container:n,yearElement:a,monthElement:r}}function X(){d(T.monthNav),T.monthNav.appendChild(T.prevMonthNav),T.config.showMonths&&(T.yearElements=[],T.monthElements=[]);for(var r=T.config.showMonths;r--;){var n=W();T.yearElements.push(n.yearElement),T.monthElements.push(n.monthElement),T.monthNav.appendChild(n.container)}T.monthNav.appendChild(T.nextMonthNav)}function K(){T.weekdayContainer?d(T.weekdayContainer):T.weekdayContainer=h("div","flatpickr-weekdays");for(var r=T.config.showMonths;r--;){var n=h("div","flatpickr-weekdaycontainer");T.weekdayContainer.appendChild(n)}return Y(),T.weekdayContainer}function Y(){if(T.weekdayContainer){var r=T.l10n.firstDayOfWeek,n=T.l10n.weekdays.shorthand.slice();r>0&&r<n.length&&(n=n.splice(r,n.length).concat(n.splice(0,r)));for(var i=T.config.showMonths;i--;)T.weekdayContainer.children[i].innerHTML="\n      <span class='flatpickr-weekday'>\n        "+n.join("</span><span class='flatpickr-weekday'>")+"\n      </span>\n      "}}function J(r,n){void 0===n&&(n=!0);var i=n?r:r-T.currentMonth;i<0&&!0===T._hidePrevMonthArrow||i>0&&!0===T._hideNextMonthArrow||(T.currentMonth+=i,(T.currentMonth<0||T.currentMonth>11)&&(T.currentYear+=T.currentMonth>11?1:-1,T.currentMonth=(T.currentMonth+12)%12,tv("onYearChange"),Z()),G(),tv("onMonthChange"),t$())}function Q(r){return!(!T.config.appendTo||!T.config.appendTo.contains(r))||T.calendarContainer.contains(r)}function tt(r){if(T.isOpen&&!T.config.inline){var n,i="function"==typeof(n=r).composedPath?n.composedPath()[0]:n.target,o=Q(i),a=i===T.input||i===T.altInput||T.element.contains(i)||r.path&&r.path.indexOf&&(~r.path.indexOf(T.input)||~r.path.indexOf(T.altInput)),s="blur"===r.type?a&&r.relatedTarget&&!Q(r.relatedTarget):!a&&!o&&!Q(r.relatedTarget),u=!T.config.ignoredFocusElements.some(function(r){return r.contains(i)});s&&u&&(void 0!==T.timeContainer&&void 0!==T.minuteElement&&void 0!==T.hourElement&&k(),T.close(),"range"===T.config.mode&&1===T.selectedDates.length&&(T.clear(!1),T.redraw()))}}function te(r){if(!(!r||T.config.minDate&&r<T.config.minDate.getFullYear()||T.config.maxDate&&r>T.config.maxDate.getFullYear())){var n=r,i=T.currentYear!==n;T.currentYear=n||T.currentYear,T.config.maxDate&&T.currentYear===T.config.maxDate.getFullYear()?T.currentMonth=Math.min(T.config.maxDate.getMonth(),T.currentMonth):T.config.minDate&&T.currentYear===T.config.minDate.getFullYear()&&(T.currentMonth=Math.max(T.config.minDate.getMonth(),T.currentMonth)),i&&(T.redraw(),tv("onYearChange"),Z())}}function tr(r,n){void 0===n&&(n=!0);var i=T.parseDate(r,void 0,n);if(T.config.minDate&&i&&0>b(i,T.config.minDate,void 0!==n?n:!T.minDateHasTime)||T.config.maxDate&&i&&b(i,T.config.maxDate,void 0!==n?n:!T.maxDateHasTime)>0)return!1;if(0===T.config.enable.length&&0===T.config.disable.length)return!0;if(void 0===i)return!1;for(var o=T.config.enable.length>0,a=o?T.config.enable:T.config.disable,s=0,u=void 0;s<a.length;s++){if("function"==typeof(u=a[s])&&u(i)||u instanceof Date&&void 0!==i&&u.getTime()===i.getTime())return o;if("string"==typeof u&&void 0!==i){var c=T.parseDate(u,void 0,!0);return c&&c.getTime()===i.getTime()?o:!o}if("object"==typeof u&&void 0!==i&&u.from&&u.to&&i.getTime()>=u.from.getTime()&&i.getTime()<=u.to.getTime())return o}return!o}function tn(r){return void 0!==T.daysContainer&&-1===r.className.indexOf("hidden")&&T.daysContainer.contains(r)}function ti(r){var n=r.target===T._input,i=T.config.allowInput,o=T.isOpen&&(!i||!n),a=T.config.inline&&n&&!i;if(13===r.keyCode&&n){if(i)return T.setDate(T._input.value,!0,r.target===T.altInput?T.config.altFormat:T.config.dateFormat),r.target.blur();T.open()}else if(Q(r.target)||o||a){var s=!!T.timeContainer&&T.timeContainer.contains(r.target);switch(r.keyCode){case 13:s?(r.preventDefault(),k(),th()):td(r);break;case 27:r.preventDefault(),th();break;case 8:case 46:n&&!T.config.allowInput&&(r.preventDefault(),T.clear());break;case 37:case 39:if(s||n)T.hourElement&&T.hourElement.focus();else if(r.preventDefault(),void 0!==T.daysContainer&&(!1===i||document.activeElement&&tn(document.activeElement))){var u=39===r.keyCode?1:-1;r.ctrlKey?(r.stopPropagation(),J(u),j(q(1),0)):j(void 0,u)}break;case 38:case 40:r.preventDefault();var c=40===r.keyCode?1:-1;T.daysContainer&&void 0!==r.target.$i||r.target===T.input||r.target===T.altInput?r.ctrlKey?(r.stopPropagation(),te(T.currentYear-c),j(q(1),0)):s||j(void 0,7*c):r.target===T.currentYearElement?te(T.currentYear-c):T.config.enableTime&&(!s&&T.hourElement&&T.hourElement.focus(),k(r),T._debouncedChange());break;case 9:if(s){var p=[T.hourElement,T.minuteElement,T.secondElement,T.amPM].concat(T.pluginElements).filter(function(r){return r}),h=p.indexOf(r.target);if(-1!==h){var d=p[h+(r.shiftKey?-1:1)];r.preventDefault(),(d||T._input).focus()}}else!T.config.noCalendar&&T.daysContainer&&T.daysContainer.contains(r.target)&&r.shiftKey&&(r.preventDefault(),T._input.focus())}}if(void 0!==T.amPM&&r.target===T.amPM)switch(r.key){case T.l10n.amPM[0].charAt(0):case T.l10n.amPM[0].charAt(0).toLowerCase():T.amPM.textContent=T.l10n.amPM[0],A(),tx();break;case T.l10n.amPM[1].charAt(0):case T.l10n.amPM[1].charAt(0).toLowerCase():T.amPM.textContent=T.l10n.amPM[1],A(),tx()}(n||Q(r.target))&&tv("onKeyDown",r)}function to(r){if(1===T.selectedDates.length&&(!r||r.classList.contains("flatpickr-day")&&!r.classList.contains("flatpickr-disabled"))){for(var n=r?r.dateObj.getTime():T.days.firstElementChild.dateObj.getTime(),i=T.parseDate(T.selectedDates[0],void 0,!0).getTime(),o=Math.min(n,T.selectedDates[0].getTime()),a=Math.max(n,T.selectedDates[0].getTime()),s=!1,u=0,c=0,p=o;p<a;p+=w.DAY)tr(new Date(p),!0)||(s=s||p>o&&p<a,p<i&&(!u||p>u)?u=p:p>i&&(!c||p<c)&&(c=p));for(var h=0;h<T.config.showMonths;h++)for(var d=T.daysContainer.children[h],f=0,m=d.children.length;f<m;f++)!function(o,a){var p,h,f,m=d.children[o],y=m.dateObj.getTime(),v=u>0&&y<u||c>0&&y>c;return v?(m.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(function(r){m.classList.remove(r)}),"continue"):s&&!v?"continue":(["startRange","inRange","endRange","notAllowed"].forEach(function(r){m.classList.remove(r)}),void(void 0!==r&&(r.classList.add(n<=T.selectedDates[0].getTime()?"startRange":"endRange"),i<n&&y===i?m.classList.add("startRange"):i>n&&y===i&&m.classList.add("endRange"),y>=u&&(0===c||y<=c)&&(p=y,h=i,p>Math.min(h,f=n)&&p<Math.max(h,f))&&m.classList.add("inRange"))))}(f)}}function ta(){!T.isOpen||T.config.static||T.config.inline||tc()}function ts(){T.setDate(void 0!==T.config.minDate?new Date(T.config.minDate.getTime()):new Date,!0),L(),tx()}function tl(r){return function(n){var i=T.config["_"+r+"Date"]=T.parseDate(n,T.config.dateFormat),o=T.config["_"+("min"===r?"max":"min")+"Date"];void 0!==i&&(T["min"===r?"minDateHasTime":"maxDateHasTime"]=i.getHours()>0||i.getMinutes()>0||i.getSeconds()>0),T.selectedDates&&(T.selectedDates=T.selectedDates.filter(function(r){return tr(r)}),T.selectedDates.length||"min"!==r||P(i),tx()),T.daysContainer&&(tp(),void 0!==i?T.currentYearElement[r]=i.getFullYear().toString():T.currentYearElement.removeAttribute(r),T.currentYearElement.disabled=!!o&&void 0!==i&&o.getFullYear()===i.getFullYear())}}function tu(){"object"!=typeof T.config.locale&&void 0===S.l10ns[T.config.locale]&&T.config.errorHandler(Error("flatpickr: invalid locale "+T.config.locale)),T.l10n=r({},S.l10ns.default,"object"==typeof T.config.locale?T.config.locale:"default"!==T.config.locale?S.l10ns[T.config.locale]:void 0),g.K="("+T.l10n.amPM[0]+"|"+T.l10n.amPM[1]+"|"+T.l10n.amPM[0].toLowerCase()+"|"+T.l10n.amPM[1].toLowerCase()+")",void 0===r({},v,JSON.parse(JSON.stringify(m.dataset||{}))).time_24hr&&void 0===S.defaultConfig.time_24hr&&(T.config.time_24hr=T.l10n.time_24hr),T.formatDate=_(T),T.parseDate=x({config:T.config,l10n:T.l10n})}function tc(r){if(void 0!==T.calendarContainer){tv("onPreCalendarPosition");var n=r||T._positionElement,i=Array.prototype.reduce.call(T.calendarContainer.children,function(r,n){return r+n.offsetHeight},0),o=T.calendarContainer.offsetWidth,a=T.config.position.split(" "),s=a[0],u=a.length>1?a[1]:null,c=n.getBoundingClientRect(),h=window.innerHeight-c.bottom,d="above"===s||"below"!==s&&h<i&&c.top>i,f=window.pageYOffset+c.top+(d?-i-2:n.offsetHeight+2);if(p(T.calendarContainer,"arrowTop",!d),p(T.calendarContainer,"arrowBottom",d),!T.config.inline){var m=window.pageXOffset+c.left-(null!=u&&"center"===u?(o-c.width)/2:0),y=window.document.body.offsetWidth-(window.pageXOffset+c.right),v=m+o>window.document.body.offsetWidth,g=y+o>window.document.body.offsetWidth;if(p(T.calendarContainer,"rightMost",v),!T.config.static){if(T.calendarContainer.style.top=f+"px",v){if(g){var $=document.styleSheets[0];if(void 0===$)return;var _=Math.max(0,window.document.body.offsetWidth/2-o/2),x=$.cssRules.length,b="{left:"+c.left+"px;right:auto;}";p(T.calendarContainer,"rightMost",!1),p(T.calendarContainer,"centerMost",!0),$.insertRule(".flatpickr-calendar.centerMost:before,.flatpickr-calendar.centerMost:after"+b,x),T.calendarContainer.style.left=_+"px",T.calendarContainer.style.right="auto"}else T.calendarContainer.style.left="auto",T.calendarContainer.style.right=y+"px"}else T.calendarContainer.style.left=m+"px",T.calendarContainer.style.right="auto"}}}}function tp(){T.config.noCalendar||T.isMobile||(t$(),G())}function th(){T._input.focus(),-1!==window.navigator.userAgent.indexOf("MSIE")||void 0!==navigator.msMaxTouchPoints?setTimeout(T.close,0):T.close()}function td(r){r.preventDefault(),r.stopPropagation();var n=function r(n,i){return i(n)?n:n.parentNode?r(n.parentNode,i):void 0}(r.target,function(r){return r.classList&&r.classList.contains("flatpickr-day")&&!r.classList.contains("flatpickr-disabled")&&!r.classList.contains("notAllowed")});if(void 0!==n){var i=n,o=T.latestSelectedDateObj=new Date(i.dateObj.getTime()),a=(o.getMonth()<T.currentMonth||o.getMonth()>T.currentMonth+T.config.showMonths-1)&&"range"!==T.config.mode;if(T.selectedDateElem=i,"single"===T.config.mode)T.selectedDates=[o];else if("multiple"===T.config.mode){var s=t8(o);s?T.selectedDates.splice(parseInt(s),1):T.selectedDates.push(o)}else"range"===T.config.mode&&(2===T.selectedDates.length&&T.clear(!1,!1),T.latestSelectedDateObj=o,T.selectedDates.push(o),0!==b(o,T.selectedDates[0],!0)&&T.selectedDates.sort(function(r,n){return r.getTime()-n.getTime()}));if(A(),a){var u=T.currentYear!==o.getFullYear();T.currentYear=o.getFullYear(),T.currentMonth=o.getMonth(),u&&(tv("onYearChange"),Z()),tv("onMonthChange")}if(t$(),G(),tx(),T.config.enableTime&&setTimeout(function(){return T.showTimeInput=!0},50),a||"range"===T.config.mode||1!==T.config.showMonths?void 0!==T.selectedDateElem&&void 0===T.hourElement&&T.selectedDateElem&&T.selectedDateElem.focus():V(i),void 0!==T.hourElement&&void 0!==T.hourElement&&T.hourElement.focus(),T.config.closeOnSelect){var c="single"===T.config.mode&&!T.config.enableTime,p="range"===T.config.mode&&2===T.selectedDates.length&&!T.config.enableTime;(c||p)&&th()}B()}}T.parseDate=x({config:T.config,l10n:T.l10n}),T._handlers=[],T.pluginElements=[],T.loadedPlugins=[],T._bind=M,T._setHoursFromDate=P,T._positionCalendar=tc,T.changeMonth=J,T.changeYear=te,T.clear=function(r,n){void 0===r&&(r=!0),void 0===n&&(n=!0),T.input.value="",void 0!==T.altInput&&(T.altInput.value=""),void 0!==T.mobileInput&&(T.mobileInput.value=""),T.selectedDates=[],T.latestSelectedDateObj=void 0,!0===n&&(T.currentYear=T._initialDate.getFullYear(),T.currentMonth=T._initialDate.getMonth()),T.showTimeInput=!1,!0===T.config.enableTime&&L(),T.redraw(),r&&tv("onChange")},T.close=function(){T.isOpen=!1,T.isMobile||(void 0!==T.calendarContainer&&T.calendarContainer.classList.remove("open"),void 0!==T._input&&T._input.classList.remove("active")),tv("onClose")},T._createElement=h,T.destroy=function(){void 0!==T.config&&tv("onDestroy");for(var r=T._handlers.length;r--;){var n=T._handlers[r];n.element.removeEventListener(n.event,n.handler,n.options)}if(T._handlers=[],T.mobileInput)T.mobileInput.parentNode&&T.mobileInput.parentNode.removeChild(T.mobileInput),T.mobileInput=void 0;else if(T.calendarContainer&&T.calendarContainer.parentNode){if(T.config.static&&T.calendarContainer.parentNode){var i=T.calendarContainer.parentNode;if(i.lastChild&&i.removeChild(i.lastChild),i.parentNode){for(;i.firstChild;)i.parentNode.insertBefore(i.firstChild,i);i.parentNode.removeChild(i)}}else T.calendarContainer.parentNode.removeChild(T.calendarContainer)}T.altInput&&(T.input.type="text",T.altInput.parentNode&&T.altInput.parentNode.removeChild(T.altInput),delete T.altInput),T.input&&(T.input.type=T.input._type,T.input.classList.remove("flatpickr-input"),T.input.removeAttribute("readonly"),T.input.value=""),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(r){try{delete T[r]}catch(n){}})},T.isEnabled=tr,T.jumpToDate=F,T.open=function(r,n){if(void 0===n&&(n=T._positionElement),!0===T.isMobile)return r&&(r.preventDefault(),r.target&&r.target.blur()),void 0!==T.mobileInput&&(T.mobileInput.focus(),T.mobileInput.click()),void tv("onOpen");if(!T._input.disabled&&!T.config.inline){var i=T.isOpen;T.isOpen=!0,i||(T.calendarContainer.classList.add("open"),T._input.classList.add("active"),tv("onOpen"),tc(n)),!0===T.config.enableTime&&!0===T.config.noCalendar&&(0===T.selectedDates.length&&ts(),!1!==T.config.allowInput||void 0!==r&&T.timeContainer.contains(r.relatedTarget)||setTimeout(function(){return T.hourElement.select()},50))}},T.redraw=tp,T.set=function(r,i){if(null!==r&&"object"==typeof r)for(var o in Object.assign(T.config,r),r)void 0!==tf[o]&&tf[o].forEach(function(r){return r()});else T.config[r]=i,void 0!==tf[r]?tf[r].forEach(function(r){return r()}):n.indexOf(r)>-1&&(T.config[r]=c(i));T.redraw(),tx(!1)},T.setDate=function(r,n,i){if(void 0===n&&(n=!1),void 0===i&&(i=T.config.dateFormat),0!==r&&!r||r instanceof Array&&0===r.length)return T.clear(n);tm(r,i),T.showTimeInput=T.selectedDates.length>0,T.latestSelectedDateObj=T.selectedDates[T.selectedDates.length-1],T.redraw(),F(),P(),0===T.selectedDates.length&&T.clear(!1),tx(n),n&&tv("onChange")},T.toggle=function(r){if(!0===T.isOpen)return T.close();T.open(r)};var tf={locale:[tu,Y],showMonths:[X,I,K],minDate:[F],maxDate:[F]};function tm(r,n){var i=[];if(r instanceof Array)i=r.map(function(r){return T.parseDate(r,n)});else if(r instanceof Date||"number"==typeof r)i=[T.parseDate(r,n)];else if("string"==typeof r)switch(T.config.mode){case"single":case"time":i=[T.parseDate(r,n)];break;case"multiple":i=r.split(T.config.conjunction).map(function(r){return T.parseDate(r,n)});break;case"range":i=r.split(T.l10n.rangeSeparator).map(function(r){return T.parseDate(r,n)})}else T.config.errorHandler(Error("Invalid date supplied: "+JSON.stringify(r)));T.selectedDates=i.filter(function(r){return r instanceof Date&&tr(r,!1)}),"range"===T.config.mode&&T.selectedDates.sort(function(r,n){return r.getTime()-n.getTime()})}function ty(r){return r.slice().map(function(r){return"string"==typeof r||"number"==typeof r||r instanceof Date?T.parseDate(r,void 0,!0):r&&"object"==typeof r&&r.from&&r.to?{from:T.parseDate(r.from,void 0),to:T.parseDate(r.to,void 0)}:r}).filter(function(r){return r})}function tv(r,n){if(void 0!==T.config){var i=T.config[r];if(void 0!==i&&i.length>0)for(var o=0;i[o]&&o<i.length;o++)i[o](T.selectedDates,T.input.value,T,n);"onChange"===r&&(T.input.dispatchEvent(tg("change")),T.input.dispatchEvent(tg("input")))}}function tg(r){var n=document.createEvent("Event");return n.initEvent(r,!0,!0),n}function t8(r){for(var n=0;n<T.selectedDates.length;n++)if(0===b(T.selectedDates[n],r))return""+n;return!1}function t$(){T.config.noCalendar||T.isMobile||!T.monthNav||(T.yearElements.forEach(function(r,n){var i=new Date(T.currentYear,T.currentMonth,1);i.setMonth(T.currentMonth+n),T.config.showMonths>1||"static"===T.config.monthSelectorType?T.monthElements[n].textContent=y(i.getMonth(),T.config.shorthandCurrentMonth,T.l10n)+" ":T.monthsDropdownContainer.value=i.getMonth().toString(),r.value=i.getFullYear().toString()}),T._hidePrevMonthArrow=void 0!==T.config.minDate&&(T.currentYear===T.config.minDate.getFullYear()?T.currentMonth<=T.config.minDate.getMonth():T.currentYear<T.config.minDate.getFullYear()),T._hideNextMonthArrow=void 0!==T.config.maxDate&&(T.currentYear===T.config.maxDate.getFullYear()?T.currentMonth+1>T.config.maxDate.getMonth():T.currentYear>T.config.maxDate.getFullYear()))}function t_(r){return T.selectedDates.map(function(n){return T.formatDate(n,r)}).filter(function(r,n,i){return"range"!==T.config.mode||T.config.enableTime||i.indexOf(r)===n}).join("range"!==T.config.mode?T.config.conjunction:T.l10n.rangeSeparator)}function tx(r){void 0===r&&(r=!0),void 0!==T.mobileInput&&T.mobileFormatStr&&(T.mobileInput.value=void 0!==T.latestSelectedDateObj?T.formatDate(T.latestSelectedDateObj,T.mobileFormatStr):""),T.input.value=t_(T.config.dateFormat),void 0!==T.altInput&&(T.altInput.value=t_(T.config.altFormat)),!1!==r&&tv("onValueUpdate")}function tb(r){var n=T.prevMonthNav.contains(r.target),i=T.nextMonthNav.contains(r.target);n||i?J(n?-1:1):T.yearElements.indexOf(r.target)>=0?r.target.select():r.target.classList.contains("arrowUp")?T.changeYear(T.currentYear+1):r.target.classList.contains("arrowDown")&&T.changeYear(T.currentYear-1)}return T.element=T.input=m,T.isOpen=!1,function(){var o=["wrap","weekNumbers","allowInput","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],a=r({},v,JSON.parse(JSON.stringify(m.dataset||{}))),s={};T.config.parseDate=a.parseDate,T.config.formatDate=a.formatDate,Object.defineProperty(T.config,"enable",{get:function(){return T.config._enable},set:function(r){T.config._enable=ty(r)}}),Object.defineProperty(T.config,"disable",{get:function(){return T.config._disable},set:function(r){T.config._disable=ty(r)}});var u="time"===a.mode;if(!a.dateFormat&&(a.enableTime||u)){var p=S.defaultConfig.dateFormat||i.dateFormat;s.dateFormat=a.noCalendar||u?"H:i"+(a.enableSeconds?":S":""):p+" H:i"+(a.enableSeconds?":S":"")}if(a.altInput&&(a.enableTime||u)&&!a.altFormat){var h=S.defaultConfig.altFormat||i.altFormat;s.altFormat=a.noCalendar||u?"h:i"+(a.enableSeconds?":S K":" K"):h+" h:i"+(a.enableSeconds?":S":"")+" K"}a.altInputClass||(T.config.altInputClass=T.input.className+" "+T.config.altInputClass),Object.defineProperty(T.config,"minDate",{get:function(){return T.config._minDate},set:tl("min")}),Object.defineProperty(T.config,"maxDate",{get:function(){return T.config._maxDate},set:tl("max")});var d=function(r){return function(n){T.config["min"===r?"_minTime":"_maxTime"]=T.parseDate(n,"H:i:S")}};Object.defineProperty(T.config,"minTime",{get:function(){return T.config._minTime},set:d("min")}),Object.defineProperty(T.config,"maxTime",{get:function(){return T.config._maxTime},set:d("max")}),"time"===a.mode&&(T.config.noCalendar=!0,T.config.enableTime=!0),Object.assign(T.config,s,a);for(var f=0;f<o.length;f++)T.config[o[f]]=!0===T.config[o[f]]||"true"===T.config[o[f]];for(n.filter(function(r){return void 0!==T.config[r]}).forEach(function(r){T.config[r]=c(T.config[r]||[]).map(C)}),T.isMobile=!T.config.disableMobile&&!T.config.inline&&"single"===T.config.mode&&!T.config.disable.length&&!T.config.enable.length&&!T.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),f=0;f<T.config.plugins.length;f++){var y=T.config.plugins[f](T)||{};for(var g in y)n.indexOf(g)>-1?T.config[g]=c(y[g]).map(C).concat(T.config[g]):void 0===a[g]&&(T.config[g]=y[g])}tv("onParseConfig")}(),tu(),T.input=T.config.wrap?m.querySelector("[data-input]"):m,T.input?(T.input._type=T.input.type,T.input.type="text",T.input.classList.add("flatpickr-input"),T._input=T.input,T.config.altInput&&(T.altInput=h(T.input.nodeName,T.config.altInputClass),T._input=T.altInput,T.altInput.placeholder=T.input.placeholder,T.altInput.disabled=T.input.disabled,T.altInput.required=T.input.required,T.altInput.tabIndex=T.input.tabIndex,T.altInput.type="text",T.input.setAttribute("type","hidden"),!T.config.static&&T.input.parentNode&&T.input.parentNode.insertBefore(T.altInput,T.input.nextSibling)),T.config.allowInput||T._input.setAttribute("readonly","readonly"),T._positionElement=T.config.positionElement||T._input):T.config.errorHandler(Error("Invalid input element specified")),T.selectedDates=[],T.now=T.parseDate(T.config.now)||new Date,($=T.config.defaultDate||(("INPUT"===T.input.nodeName||"TEXTAREA"===T.input.nodeName)&&T.input.placeholder&&T.input.value===T.input.placeholder?null:T.input.value))&&tm($,T.config.dateFormat),T._initialDate=T.selectedDates.length>0?T.selectedDates[0]:T.config.minDate&&T.config.minDate.getTime()>T.now.getTime()?T.config.minDate:T.config.maxDate&&T.config.maxDate.getTime()<T.now.getTime()?T.config.maxDate:T.now,T.currentYear=T._initialDate.getFullYear(),T.currentMonth=T._initialDate.getMonth(),T.selectedDates.length>0&&(T.latestSelectedDateObj=T.selectedDates[0]),void 0!==T.config.minTime&&(T.config.minTime=T.parseDate(T.config.minTime,"H:i")),void 0!==T.config.maxTime&&(T.config.maxTime=T.parseDate(T.config.maxTime,"H:i")),T.minDateHasTime=!!T.config.minDate&&(T.config.minDate.getHours()>0||T.config.minDate.getMinutes()>0||T.config.minDate.getSeconds()>0),T.maxDateHasTime=!!T.config.maxDate&&(T.config.maxDate.getHours()>0||T.config.maxDate.getMinutes()>0||T.config.maxDate.getSeconds()>0),Object.defineProperty(T,"showTimeInput",{get:function(){return T._showTimeInput},set:function(r){T._showTimeInput=r,T.calendarContainer&&p(T.calendarContainer,"showTimeInput",r),T.isOpen&&tc()}}),T.utils={getDaysInMonth:function(r,n){return void 0===r&&(r=T.currentMonth),void 0===n&&(n=T.currentYear),1===r&&(n%4==0&&n%100!=0||n%400==0)?29:T.l10n.daysInMonth[r]}},T.isMobile||function(){var r=window.document.createDocumentFragment();if(T.calendarContainer=h("div","flatpickr-calendar"),T.calendarContainer.tabIndex=-1,!T.config.noCalendar){if(r.appendChild((T.monthNav=h("div","flatpickr-months"),T.yearElements=[],T.monthElements=[],T.prevMonthNav=h("span","flatpickr-prev-month"),T.prevMonthNav.innerHTML=T.config.prevArrow,T.nextMonthNav=h("span","flatpickr-next-month"),T.nextMonthNav.innerHTML=T.config.nextArrow,X(),Object.defineProperty(T,"_hidePrevMonthArrow",{get:function(){return T.__hidePrevMonthArrow},set:function(r){T.__hidePrevMonthArrow!==r&&(p(T.prevMonthNav,"flatpickr-disabled",r),T.__hidePrevMonthArrow=r)}}),Object.defineProperty(T,"_hideNextMonthArrow",{get:function(){return T.__hideNextMonthArrow},set:function(r){T.__hideNextMonthArrow!==r&&(p(T.nextMonthNav,"flatpickr-disabled",r),T.__hideNextMonthArrow=r)}}),T.currentYearElement=T.yearElements[0],t$(),T.monthNav)),T.innerContainer=h("div","flatpickr-innerContainer"),T.config.weekNumbers){var n,i,o=(T.calendarContainer.classList.add("hasWeeks"),(n=h("div","flatpickr-weekwrapper")).appendChild(h("span","flatpickr-weekday",T.l10n.weekAbbreviation)),i=h("div","flatpickr-weeks"),n.appendChild(i),{weekWrapper:n,weekNumbers:i}),u=o.weekWrapper,c=o.weekNumbers;T.innerContainer.appendChild(u),T.weekNumbers=c,T.weekWrapper=u}T.rContainer=h("div","flatpickr-rContainer"),T.rContainer.appendChild(K()),T.daysContainer||(T.daysContainer=h("div","flatpickr-days"),T.daysContainer.tabIndex=-1),G(),T.rContainer.appendChild(T.daysContainer),T.innerContainer.appendChild(T.rContainer),r.appendChild(T.innerContainer)}T.config.enableTime&&r.appendChild(function(){T.calendarContainer.classList.add("hasTime"),T.config.noCalendar&&T.calendarContainer.classList.add("noCalendar"),T.timeContainer=h("div","flatpickr-time"),T.timeContainer.tabIndex=-1;var r=h("span","flatpickr-time-separator",":"),n=f("flatpickr-hour",{"aria-label":T.l10n.hourAriaLabel});T.hourElement=n.getElementsByTagName("input")[0];var i=f("flatpickr-minute",{"aria-label":T.l10n.minuteAriaLabel});if(T.minuteElement=i.getElementsByTagName("input")[0],T.hourElement.tabIndex=T.minuteElement.tabIndex=-1,T.hourElement.value=a(T.latestSelectedDateObj?T.latestSelectedDateObj.getHours():T.config.time_24hr?T.config.defaultHour:function(r){switch(r%24){case 0:case 12:return 12;default:return r%12}}(T.config.defaultHour)),T.minuteElement.value=a(T.latestSelectedDateObj?T.latestSelectedDateObj.getMinutes():T.config.defaultMinute),T.hourElement.setAttribute("step",T.config.hourIncrement.toString()),T.minuteElement.setAttribute("step",T.config.minuteIncrement.toString()),T.hourElement.setAttribute("min",T.config.time_24hr?"0":"1"),T.hourElement.setAttribute("max",T.config.time_24hr?"23":"12"),T.minuteElement.setAttribute("min","0"),T.minuteElement.setAttribute("max","59"),T.timeContainer.appendChild(n),T.timeContainer.appendChild(r),T.timeContainer.appendChild(i),T.config.time_24hr&&T.timeContainer.classList.add("time24hr"),T.config.enableSeconds){T.timeContainer.classList.add("hasSeconds");var o=f("flatpickr-second");T.secondElement=o.getElementsByTagName("input")[0],T.secondElement.value=a(T.latestSelectedDateObj?T.latestSelectedDateObj.getSeconds():T.config.defaultSeconds),T.secondElement.setAttribute("step",T.minuteElement.getAttribute("step")),T.secondElement.setAttribute("min","0"),T.secondElement.setAttribute("max","59"),T.timeContainer.appendChild(h("span","flatpickr-time-separator",":")),T.timeContainer.appendChild(o)}return T.config.time_24hr||(T.amPM=h("span","flatpickr-am-pm",T.l10n.amPM[s((T.latestSelectedDateObj?T.hourElement.value:T.config.defaultHour)>11)]),T.amPM.title=T.l10n.toggleTitle,T.amPM.tabIndex=-1,T.timeContainer.appendChild(T.amPM)),T.timeContainer}()),p(T.calendarContainer,"rangeMode","range"===T.config.mode),p(T.calendarContainer,"animate",!0===T.config.animate),p(T.calendarContainer,"multiMonth",T.config.showMonths>1),T.calendarContainer.appendChild(r);var d=void 0!==T.config.appendTo&&void 0!==T.config.appendTo.nodeType;if((T.config.inline||T.config.static)&&(T.calendarContainer.classList.add(T.config.inline?"inline":"static"),T.config.inline&&(!d&&T.element.parentNode?T.element.parentNode.insertBefore(T.calendarContainer,T._input.nextSibling):void 0!==T.config.appendTo&&T.config.appendTo.appendChild(T.calendarContainer)),T.config.static)){var m=h("div","flatpickr-wrapper");T.element.parentNode&&T.element.parentNode.insertBefore(m,T.element),m.appendChild(T.element),T.altInput&&m.appendChild(T.altInput),m.appendChild(T.calendarContainer)}T.config.static||T.config.inline||(void 0!==T.config.appendTo?T.config.appendTo:window.document.body).appendChild(T.calendarContainer)}(),function(){if(T.config.wrap&&["open","close","toggle","clear"].forEach(function(r){Array.prototype.forEach.call(T.element.querySelectorAll("[data-"+r+"]"),function(n){return M(n,"click",T[r])})}),T.isMobile)!function(){var r=T.config.enableTime?T.config.noCalendar?"time":"datetime-local":"date";T.mobileInput=h("input",T.input.className+" flatpickr-mobile"),T.mobileInput.step=T.input.getAttribute("step")||"any",T.mobileInput.tabIndex=1,T.mobileInput.type=r,T.mobileInput.disabled=T.input.disabled,T.mobileInput.required=T.input.required,T.mobileInput.placeholder=T.input.placeholder,T.mobileFormatStr="datetime-local"===r?"Y-m-d\\TH:i:S":"date"===r?"Y-m-d":"H:i:S",T.selectedDates.length>0&&(T.mobileInput.defaultValue=T.mobileInput.value=T.formatDate(T.selectedDates[0],T.mobileFormatStr)),T.config.minDate&&(T.mobileInput.min=T.formatDate(T.config.minDate,"Y-m-d")),T.config.maxDate&&(T.mobileInput.max=T.formatDate(T.config.maxDate,"Y-m-d")),T.input.type="hidden",void 0!==T.altInput&&(T.altInput.type="hidden");try{T.input.parentNode&&T.input.parentNode.insertBefore(T.mobileInput,T.input.nextSibling)}catch(n){}M(T.mobileInput,"change",function(r){T.setDate(r.target.value,!1,T.mobileFormatStr),tv("onChange"),tv("onClose")})}();else{var r=u(ta,50);T._debouncedChange=u(B,300),T.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&M(T.daysContainer,"mouseover",function(r){"range"===T.config.mode&&to(r.target)}),M(window.document.body,"keydown",ti),T.config.inline||T.config.static||M(window,"resize",r),void 0!==window.ontouchstart?M(window.document,"touchstart",tt):M(window.document,"mousedown",R(tt)),M(window.document,"focus",tt,{capture:!0}),!0===T.config.clickOpens&&(M(T._input,"focus",T.open),M(T._input,"mousedown",R(T.open))),void 0!==T.daysContainer&&(M(T.monthNav,"mousedown",R(tb)),M(T.monthNav,["keyup","increment"],z),M(T.daysContainer,"mousedown",R(td))),void 0!==T.timeContainer&&void 0!==T.minuteElement&&void 0!==T.hourElement&&(M(T.timeContainer,["increment"],k),M(T.timeContainer,"blur",k,{capture:!0}),M(T.timeContainer,"mousedown",R(O)),M([T.hourElement,T.minuteElement],["focus","click"],function(r){return r.target.select()}),void 0!==T.secondElement&&M(T.secondElement,"focus",function(){return T.secondElement&&T.secondElement.select()}),void 0!==T.amPM&&M(T.amPM,"mousedown",R(function(r){k(r),B()})))}}(),(T.selectedDates.length||T.config.noCalendar)&&(T.config.enableTime&&P(T.config.noCalendar?T.latestSelectedDateObj||T.config.minDate:void 0),tx(!1)),I(),T.showTimeInput=T.selectedDates.length>0||T.config.noCalendar,E=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),!T.isMobile&&E&&tc(),tv("onReady"),T}function T(r,n){for(var i=Array.prototype.slice.call(r).filter(function(r){return r instanceof HTMLElement}),o=[],a=0;a<i.length;a++){var s=i[a];try{if(null!==s.getAttribute("data-fp-omit"))continue;void 0!==s._flatpickr&&(s._flatpickr.destroy(),s._flatpickr=void 0),s._flatpickr=E(s,n||{}),o.push(s._flatpickr)}catch(u){console.error(u)}}return 1===o.length?o[0]:o}"function"!=typeof Object.assign&&(Object.assign=function(r){for(var n=arguments,i=[],o=1;o<arguments.length;o++)i[o-1]=n[o];if(!r)throw TypeError("Cannot convert undefined or null to object");for(var a=function(n){n&&Object.keys(n).forEach(function(i){return r[i]=n[i]})},s=0,u=i;s<u.length;s++)a(u[s]);return r}),"undefined"!=typeof HTMLElement&&"undefined"!=typeof HTMLCollection&&"undefined"!=typeof NodeList&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(r){return T(this,r)},HTMLElement.prototype.flatpickr=function(r){return T([this],r)});var S=function(r,n){return"string"==typeof r?T(window.document.querySelectorAll(r),n):r instanceof Node?T([r],n):T(r,n)};return S.defaultConfig={},S.l10ns={en:r({},o),default:r({},o)},S.localize=function(n){S.l10ns.default=r({},S.l10ns.default,n)},S.setDefaults=function(n){S.defaultConfig=r({},S.defaultConfig,n)},S.parseDate=x({}),S.formatDate=_({}),S.compareDates=b,"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.flatpickr=function(r){return T(this,r)}),Date.prototype.fp_incr=function(r){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+("string"==typeof r?parseInt(r,10):r))},"undefined"!=typeof window&&(window.flatpickr=S),S}()}),is=r.createCommonjsModule(function(r,n){var i,o,a,s;i=n,o="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},a={weekdays:{shorthand:["CN","T2","T3","T4","T5","T6","T7"],longhand:["Chủ nhật","Thứ hai","Thứ ba","Thứ tư","Thứ năm","Thứ s\xe1u","Thứ bảy"]},months:{shorthand:["Th1","Th2","Th3","Th4","Th5","Th6","Th7","Th8","Th9","Th10","Th11","Th12"],longhand:["Th\xe1ng một","Th\xe1ng hai","Th\xe1ng ba","Th\xe1ng tư","Th\xe1ng năm","Th\xe1ng s\xe1u","Th\xe1ng bảy","Th\xe1ng t\xe1m","Th\xe1ng ch\xedn","Th\xe1ng mười","Th\xe1ng 11","Th\xe1ng 12"]},firstDayOfWeek:1,rangeSeparator:" đến "},o.l10ns.vn=a,s=o.l10ns,i.Vietnamese=a,i.default=s,Object.defineProperty(i,"__esModule",{value:!0})});r.unwrapExports(is);var il=function(r){return r=r||{},this.options=r||{},this.options.accessToken=r.key||"",this.options.unit=r.unit||"metric",this.options.placeholderOrigin=r.placeholderOrigin||"Chọn điểm bắt đầu",this.options.placeholderDestination=r.placeholderDestination||"Chọn điểm kết th\xfac",this.options.supports=r.supports||["engine02/driving","engine02/public-transport","engine02/walking","engine02/cycling"],this.options.geocoder=r.geocoder||{},this.options.active=r.active,this.options.interactive=r.interactive||!1,this._updateOptions(),this.weDirection=this.render(this.options),this.weDirection.onClick=this._clickHandler(),this._onRendered(),this.weDirection},iu={_apiEngine:{configurable:!0},_geocodeEngine:{configurable:!0},_geocodeApi:{configurable:!0},_optionProfile:{configurable:!0}};il.prototype._updateOptions=function(){this._apiEngine=this.options.engine,this._geocodeEngine=this.options.geocoder.engine,this._geocodeApi=this.options.geocoder.engine,this._optionProfile=this.options.active},iu._apiEngine.set=function(r){this.options.api=n8.direction.engine},iu._geocodeEngine.set=function(r){var n="";switch(r){case"default":case"pelias":default:n="pelias";break;case"mapbox":n="mapbox"}this.options.geocoder.engine=n},iu._geocodeApi.set=function(r){var n="";switch(r){case"default":case"pelias":default:n=n8.direction.geocoder.pelias;break;case"mapbox":n=n8.direction.geocoder.mapbox}this.options.geocoder.api=n},il.prototype.render=function(r){return new nk(r)},il.prototype._onRendered=function(){var r=this;window.addEventListener("DOMContentLoaded",function(){r._addClass2Container(),r._checkActiveGeocode(),r._addDirectionIcon(),r._rightClickHandler(),r._directionsFeatureControl(),r._activeDefaultDrive(),r._onReverseInput(),r._inputChange(),r._clickResultSearchHandler(),r._urlPreChecking(),r._urlCheckChange(),r._directionModeSlider(),r._directionDateTimePicker()})},il.prototype._clickHandler=function(){var r=this,n=r.weDirection,i=this.options.interactive;window.addEventListener("DOMContentLoaded",function(){var o=n._map;n._map._interactive=i,o.on("click",function(i){if(n._map._interactive){var a=n.getOrigin(),s=n.getDestination(),u=[i.lngLat.lng,i.lngLat.lat];if(a.geometry){var c=o.queryRenderedFeatures(i.point,{layers:["directions-origin-point","directions-destination-point","directions-waypoint-point","directions-route-line-alt"]});if(c.length){if(c.forEach(function(r){"directions-waypoint-point"===r.layer.id&&n.actions.removeWaypoint(r)}),"alternate"===c[0].properties.route){var p=c[0].properties["route-index"];n.actions.setRouteIndex(p)}}else if(s.geometry){var h=document.getElementById("wemap-directions-middle"),d=r._elementChildren(h);if(h.childElementCount>0&&a.geometry&&s.geometry)for(var f=0,m=!0;m&&f<d.length;){var y=d[f].querySelector("input");if(r._isEmpty(y.value)){var v=d[f].id;d[f].querySelector("button").classList.add("active"),y.value=u.join(","),n.actions.setViaPointFromCoordinates(u,f,v),m=!1}f++}}else n.actions.setDestinationFromCoordinates(u),o.flyTo({center:u})}else n.actions.setOriginFromCoordinates(u)}})})},il.prototype._elementChildren=function(r){for(var n=r.childNodes,i=[],o=n.length;o--;)1===n[o].nodeType&&i.unshift(n[o]);return i},il.prototype._isEmpty=function(r){return!r.trim().length},il.prototype._rightClickHandler=function(){var r=this,n=r.weDirection,i=document.getElementById("wemap-right-click-start"),o=document.getElementById("wemap-right-click-end");i&&i.addEventListener("click",function(){r.activeDirections(),wemapgl.rightClick.closeMenuUI();var i=wemapgl.urlController.getParams();if(i.ox&&i.oy){var o=[i.ox,i.oy];n.actions.setOriginFromCoordinates(o)}}),o&&o.addEventListener("click",function(){r.activeDirections(),wemapgl.rightClick.closeMenuUI();var i=wemapgl.urlController.getParams();if(i.dx&&i.dy){var o=[i.dx,i.dy];n.actions.setDestinationFromCoordinates(o)}})},il.prototype._clickResultSearchHandler=function(){var r=this.weDirection,n=document.querySelectorAll(".pelias-ctrl-results.pelias-ctrl-shadow")[0];n&&n.addEventListener("change",function(){document.getElementsByClassName("wemap-directions").forEach(function(n){n.addEventListener("click",function(){var n=wemapgl.urlController.getParams();if(n.x&&n.y){var i=[n.x,n.y];r.actions.setDestinationFromCoordinates(i)}})})})},il.prototype._directionsFeatureControl=function(){var r=this,n=r.weDirection,i=document.getElementById("wemap-feature-directions");i&&i.addEventListener("click",function(){r.activeDirections(),wemapgl.rightClick.closeMenuUI();var i=wemapgl.urlController.getParams();if(i.x&&i.y){var o=[i.x,i.y];n.actions.setDestinationFromCoordinates(o)}})},il.prototype._addClass2Container=function(){var r=this.weDirection._map._container.id;r&&document.getElementById(r).classList.add("wemap-direction")},il.prototype._checkActiveGeocode=function(){document.querySelectorAll("div.pelias-ctrl.mapboxgl-ctrl")[0]||document.querySelectorAll(".mapboxgl-control-container .mapboxgl-ctrl-directions.mapboxgl-ctrl")[0].classList.remove("hide")},il.prototype._activeDefaultDrive=function(){this.options.active;var r=wemapgl.urlController.getParams();r.vehicle&&(this.options.profile=r.vehicle,r.vehicle)},iu._optionProfile.set=function(r){var n=this.options.supports,i=wemapgl.urlController.getParams();if(i.vehicle)this.options.profile=i.vehicle;else{var o=n.findIndex(function(r){return r.includes("/driving")});this.options.profile=-1===o||r?r||n[0]:n[o]}},il.prototype._activeProfile=function(){var r="";return document.querySelectorAll("#directions-profile input").forEach(function(n){!0===n.checked&&(r=n.value)}),r},il.prototype._inputChange=function(){var r=this,n=r.weDirection,i=document.querySelectorAll(".mapboxgl-ctrl-directions.mapboxgl-ctrl .mapbox-directions-component.mapbox-directions-inputs")[0],o={},a={};i.addEventListener("change",function(){var i=document.querySelectorAll("#mapbox-directions-origin-input input")[0],s=document.querySelectorAll("#mapbox-directions-destination-input input")[0];i.value&&s.value?wemapgl.reverse.onReverse():wemapgl.reverse.offReverse(),o=n.getOrigin(),a=n.getDestination();var u=r._activeProfile();wemapgl.urlController.updateParams("route",{ox:o.geometry?o.geometry.coordinates[0]:0,oy:o.geometry?o.geometry.coordinates[1]:0,dx:a.geometry?a.geometry.coordinates[0]:0,dy:a.geometry?a.geometry.coordinates[1]:0,vehicle:u})})},il.prototype._urlPreChecking=function(){var r=this.weDirection,n=wemapgl.urlController.getParams();if(n.ox&&n.oy&&n.dx&&n.dy){this.activeDirections();var i=r._map;i.on("load",function(o){var a=[n.ox,n.oy],s=[n.dx,n.dy];r.actions.setOriginFromCoordinates(a);var u=i.queryRenderedFeatures(s,{layers:["directions-destination-point","directions-waypoint-point","directions-route-line-alt"]});if(u.length&&(u.forEach(function(n){"directions-waypoint-point"===n.layer.id&&r.actions.removeWaypoint(n)}),"alternate"===u[0].properties.route)){var c=u[0].properties["route-index"];r.actions.setRouteIndex(c)}r.actions.setDestinationFromCoordinates(s)})}},il.prototype._urlCheckChange=function(){var r=this,n=r.weDirection,i=document.getElementById("wemap-direction-icon"),o=document.querySelectorAll("#mapbox-directions-origin-input input")[0],a=document.querySelectorAll("#mapbox-directions-destination-input input")[0];i&&i.addEventListener("click",function(i){r.activeDirections();var s=wemapgl.urlController.getParams();if(s.dx&&s.dy){var u=[s.dx,s.dy];n.actions.setDestinationFromCoordinates(u),o.value&&a.value?wemapgl.reverse.onReverse():wemapgl.reverse.offReverse()}})},il.prototype._addDirectionIcon=function(){var r=this,n=document.querySelectorAll("div.pelias-ctrl.mapboxgl-ctrl")[0],i=document.querySelectorAll("div.pelias-ctrl-input-actions-wrapper.pelias-ctrl-shadow")[0],o=document.getElementById("mapbox-directions-form-area");if(i){var a=document.createElement("span");a.setAttribute("id","direction-icon-open"),a.className="pelias-ctrl-action-icon pelias-ctrl-action-icon-directions pelias-ctrl-disabled",i.appendChild(a),a.addEventListener("click",function(){r.activeDirections(),wemapgl.WeGeocoder.hideAll()})}if(n&&o){var s=document.createElement("span");s.setAttribute("id","direction-icon-close"),s.className="direction-icon-search",o.appendChild(s),s.addEventListener("click",function(){r.weDirection.actions.clearViaPoint(),document.querySelector("#wemap-directions-middle").innerHTML="",r.deactivateDirections()})}},il.prototype.activeDirections=function(){var r=this.weDirection,n=this.weDirection._map._container;r._map._interactive=!0,wemapgl.reverse.offReverse();var i=document.querySelectorAll("div.pelias-ctrl.mapboxgl-ctrl")[0],o=document.querySelectorAll("div.mapboxgl-ctrl-directions.mapboxgl-ctrl")[0];n.classList.remove("wedirection-deactivated"),n.classList.add("wedirection-activated"),o.classList.remove("hide"),i&&i.classList.add("hide"),r.interactive(!0),r._map._interactive=!0},il.prototype.deactivateDirections=function(){var r=this.weDirection,n=this.weDirection._map._container;r._map._interactive=!0,wemapgl.reverse.onReverse();var i=document.querySelectorAll("div.pelias-ctrl.mapboxgl-ctrl")[0],o=document.querySelectorAll("div.mapboxgl-ctrl-directions.mapboxgl-ctrl")[0];document.querySelectorAll("#mapbox-directions-origin-input input")[0].value="",document.querySelectorAll("#mapbox-directions-destination-input input")[0].value="",n.classList.remove("wedirection-activated"),n.classList.add("wedirection-deactivated"),i.classList.remove("hide"),o.classList.add("hide"),r.interactive(!1),r._map._interactive=!1,r.removeRoutes(),r.removeWaypoint(),r.actions.hoverMarker(),wemapgl.urlController.deleteParams("route")},il.prototype._onReverseInput=function(){var r=this.weDirection;document.querySelectorAll("button.directions-reverse")[0].addEventListener("click",function(){var n=r.getOrigin(),i=r.getDestination(),o=[n.geometry?n.geometry.coordinates[0]:0,n.geometry?n.geometry.coordinates[1]:0],a=[i.geometry?i.geometry.coordinates[0]:0,i.geometry?i.geometry.coordinates[1]:0];r.actions.setOriginFromCoordinates(a),r.actions.setDestinationFromCoordinates(o),r.actions.reverse()})},il.prototype._onlyUniqueInArr=function(r,n,i){return i.indexOf(r)===n},il.prototype._directionModeSlider=function(){io({container:"#directions-items",items:4,edgePadding:10,controlsContainer:"#directions-items-container",gutter:15,controls:!1,mouseDrag:!0,navPosition:"bottom",loop:!1,slideBy:"page",swipeAngle:!1,speed:400})},il.prototype._directionDateTimePicker=function(){document.getElementById("flatpickr-datetime"),ia.localize(ia.l10ns.vn),ia("#flatpickr-datetime",{enableTime:!0,dateFormat:"Y-m-d H:i",minDate:"today",weekNumbers:!0,time_24hr:!0,minTime:"04:00",maxTime:"22:30",defaultDate:new Date,onReady:function(){this.showTimeInput=!0}})},Object.defineProperties(il.prototype,iu);var ic=function(r){return r=r||{},this.options=r,this.prevAccuracy=n8.rerank.accuracyUpperLimit,this.init(),this.geolocateControl};ic.prototype.init=function(){var r=this;this.geolocateControl=new np(this.options),this.geolocateControl.on("geolocate",function(n){n.coords.accuracy<r.prevAccuracy&&(r.send(n),r.prevAccuracy=n.coords.accuracy,wemapgl.userLocation=[n.coords.latitude,n.coords.longitude])})},ic.prototype.send=function(n){var i=JSON.stringify({lat:n.coords.latitude,lng:n.coords.longitude,accuracy:n.coords.accuracy,src:"wemap"});r.makeRequest({url:n8.rerank.iploc,method:"POST",body:i},function(r,n){})};var ip=function(r){var n=["poi-level-1","poi-level-2","poi-level-3"];this._options=r||{filters:{cuisine:{text:"Ẩm thực","fa-icon":"fa-cutlery",color:"#C70039",featureClasses:["cafe","restaurant","fast_food","food_court"],layers:n},hotel:{text:"Nh\xe0 nghỉ","fa-icon":"fa-hotel",color:"#C70039",featureClasses:["hotel","guest_house","motel"],layers:n},entertainment:{text:"Giải tr\xed","fa-icon":"fa-glass",color:"#C70039",featureClasses:["bar","nightclub","pub","theatre","casino","cinema"],layers:n},shopping:{text:"Mua sắm","fa-icon":"fa-shopping-bag",color:"#C70039",featureClasses:["shop","grocery","alcohol_shop","jewelry","mall","supermarket","fashion","convenience","marketplace"],layers:n}}},this._currFilter=null,this._prevFilter=null,this._head=0,this._buttons=[],this._numberOfButtons=4,window.addEventListener("DOMContentLoaded",function(){io({container:"#wefilter-button-section",items:4,nested:"inner",controls:!1,mouseDrag:!0,navPosition:"bottom",loop:!1,slideBy:"page",swipeAngle:!1,speed:400})})};ip.prototype.onAdd=function(r){var n=this;this._map=r,this._container=document.createElement("div"),this._container.setAttribute("id","wefilter-section");var i=document.createElement("div");i.setAttribute("id","wefilter-container"),this._wefilterTitle=document.createElement("div"),this._wefilterTitle.setAttribute("id","wefilter-title"),this._wefilterTitle.innerHTML="H\xe3y lọc ra những địa điểm bạn muốn",i.appendChild(this._wefilterTitle);var o=document.createElement("div");return o.setAttribute("id","wefilter-button-section"),i.appendChild(o),Object.keys(this._options.filters).forEach(function(r){var i=document.createElement("div");i.setAttribute("class","wefilter-button"),i.setAttribute("id","wefilter-button-"+r);var a=document.createElement("i");a.setAttribute("id","wefilter-icon-"+r),a.setAttribute("class","fa "+n._options.filters[r]["fa-icon"]);var s=document.createElement("div");s.setAttribute("id","wefilter-text-"+r),s.setAttribute("class","wefilter-text"),s.innerHTML=n._options.filters[r].text,i.appendChild(a),i.appendChild(s),i.setAttribute("title",n._options.filters[r].text),o.appendChild(i),a.addEventListener("click",function(){return n.onClickFilter(r)}),n._buttons.push(a),n.unhighlightButton(a,n._options.filters[r].color)}),this._container.appendChild(i),this._container},ip.prototype.onRemove=function(){this._container.parentNode.removeChild(this.getDOM()),this._map=void 0},ip.prototype.getDefaultPosition=function(){return"top-right"},ip.prototype.onClickFilter=function(r){null==this._currFilter?(this._prevFilter=null,this._currFilter=r,this.highlightButton(document.getElementById("wefilter-icon-"+this._currFilter),this._options.filters[this._currFilter].color),this._wefilterTitle.innerHTML="Đang lọc: "+this._options.filters[this._currFilter].text):(this._prevFilter=this._currFilter,this.unhighlightButton(document.getElementById("wefilter-icon-"+this._prevFilter),this._options.filters[this._prevFilter].color),this._wefilterTitle.innerHTML="H\xe3y lọc ra những địa điểm bạn muốn",this._currFilter!=r?(this._currFilter=r,this.highlightButton(document.getElementById("wefilter-icon-"+this._currFilter),this._options.filters[this._currFilter].color),this._wefilterTitle.innerHTML="Đang lọc: "+this._options.filters[this._currFilter].text):this._currFilter=null),this.filter()},ip.prototype.filter=function(){var r=this;if(null!=this._prevFilter){var n=["all"];this._options.filters[this._prevFilter].layers.forEach(function(i){r._map.setFilter(i,n)})}if(null!=this._currFilter){var i=["in","class"];i=i.concat(this._options.filters[this._currFilter].featureClasses),this._options.filters[this._currFilter].layers.forEach(function(n){r._map.setFilter(n,i)})}},ip.prototype.highlightButton=function(r,n){r.style.border="1px solid "+n,r.style.background=n,r.style.color="white"},ip.prototype.unhighlightButton=function(r,n){r.style.border="1px solid "+n,r.style.background="white",r.style.color=n};var ih={version:r.version,supported:n,setRTLTextPlugin:r.setRTLTextPlugin,getRTLTextPluginStatus:r.getRTLTextPluginStatus,Map:r9,NavigationControl:nr,GeolocateControl:np,AttributionControl:rG,ScaleControl:nd,FullscreenControl:ny,Popup:ng,Marker:ns,Style:eE,LngLat:r.LngLat,LngLatBounds:r.LngLatBounds,Point:r.Point,MercatorCoordinate:r.MercatorCoordinate,Evented:r.Evented,PeliasGeocoder:n$,WeMap:nC,WeDirections:il,WeGeocoder:nb,Reverse:nw,RightClick:nT,WeGeolocateControl:ic,WeFilterControl:ip,config:r.config,get accessToken(){return r.config.ACCESS_TOKEN},set accessToken(e){r.config.ACCESS_TOKEN=e},get reverse(){return r.config.reverse},set reverse(e){r.config.reverse=e},get rightClick(){return r.config.rightClick},set rightClick(e){r.config.rightClick=e},get baseApiUrl(){return r.config.API_URL},set baseApiUrl(e){r.config.API_URL=e},get workerCount(){return tz.workerCount},set workerCount(t){tz.workerCount=t},get maxParallelImageRequests(){return r.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){r.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage:function(n){r.clearTileCache(n)},workerUrl:""};return ih}),i});